<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>ä»é›¶å¼€å§‹é…ç½® react + typescriptï¼ˆä¸‰ï¼‰ï¼šwebpack</title>
    <url>/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E9%85%8D%E7%BD%AE-react-typescript%EF%BC%88%E4%B8%89%EF%BC%89%EF%BC%9Awebpack/</url>
    <content><![CDATA[<p>æœ¬ç¯‡ä¸º <code>ä»é›¶å¼€å§‹é…ç½® react + typescript</code> ç³»åˆ—ç¬¬ä¸‰ç¯‡ï¼Œå°†å¸¦å¤§å®¶å®Œæˆæ¨¡æ¿é¡¹ç›®çš„ webpack é…ç½®ã€‚æ•´ä¸ªé¡¹ç›®çš„é…ç½®æˆ‘åŠ›æ±‚è¾¾åˆ°ä»¥ä¸‹ç›®æ ‡ï¼š</p><p><strong>çµæ´»ï¼š</strong> æˆ‘åœ¨é…ç½® eslint æ˜¯é€‰æ‹©ä½¿ç”¨ js æ ¼å¼è€Œä¸æ˜¯ jsonï¼Œå°±æ˜¯ä¸ºäº†çµæ´»æ€§ï¼Œä½¿ç”¨ js æ–‡ä»¶å¯ä»¥è®©ä½ ä½¿ç”¨ç¯å¢ƒå˜é‡åŠ¨æ€é…ç½®ï¼Œå……åˆ†å‘æŒ¥ js è¯­è¨€çš„èƒ½åŠ›ã€‚å½“ç„¶äº†ï¼Œç”¨ js ä½œé…ç½®æ–‡ä»¶ä¹Ÿæ˜¯æœ‰ç¼ºç‚¹çš„ï¼Œä¸èƒ½ä½¿ç”¨ json schema æ ¡éªŒã€‚</p><p><strong>æ–°æ½®ï¼š</strong> æˆ‘è§‰å¾—æ—¶åˆ»ä¿æŒå¯¹æ–°äº‹ç‰©çš„å…³æ³¨å’Œå°è¯•å»ä½¿ç”¨å®ƒæ˜¯ä¸€ä¸ªä¼˜ç§€çš„ç´ è´¨ã€‚å½“ç„¶ï¼Œè¿½æ–°å¾ˆå®¹æ˜“ç¢°åˆ°å‘ï¼Œä½†æ˜¯ï¼Œæ²¡å…³ç³»ï¼Œæˆ‘å·²ç»å¸®ä½ ä»¬è¸©è¿‡äº†ï¼Œè¸©ä¸è¿‡å»æˆ‘ä¹Ÿä¸ä¼šå†™å‡ºæ¥ ğŸ˜‚ã€‚ä»æˆ‘ eslint <code>parserOptions.ecmaVersion</code> è®¾ç½®ä¸º 2020ï¼Œ è¿˜æœ‰ç»å¸¸æ¥ä¸€å‘ <code>yarn upgrade --latest</code> éƒ½å¯ä»¥ä½“ç°å‡ºæ¥ã€‚</p><p><strong>ä¸¥æ ¼ï¼š</strong> å°±åƒæˆ‘å¹³æ—¶åˆ¤æ–­ç›¸ç­‰æ€§æˆ‘å¤§å¤šæ•°æƒ…å†µéƒ½æ˜¯ä½¿ç”¨ä¸¥æ ¼ç­‰ <code>===</code>ï¼Œè€Œä¸æ˜¯éä¸¥æ ¼ç­‰ <code>==</code>ï¼Œæˆ‘è§‰å¾—è¶Šä¸¥æ ¼ï¼Œåˆ†æèµ·æ¥å°±è¶Šæ¸…æ™°ï¼Œè¶Šæ—©èƒ½å‘ç°é—®é¢˜ã€‚ä¾‹å¦‚æˆ‘ä¹ˆåé¢ä¼šä½¿ç”¨ä¸€äº› webpack æ’ä»¶æ¥ä¸¥æ ¼æ£€æŸ¥æ¨¡å—å¤§å°å†™ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰å¾ªç¯ä¾èµ–ã€‚</p><p><strong>å®‰é€¸ï¼š</strong> é¡¹ç›®ä¸­ä¼šå°½é‡é›†æˆå½“å‰å‰ç«¯ç”Ÿæ€ç•Œå®ç”¨çš„å’Œèƒ½æé«˜å¼€å‘æ„‰æ‚¦æ€§çš„ï¼ˆæ¢ä¸ªè¯å°±æ˜¯èŠ±é‡Œèƒ¡å“¨ï¼‰å·¥å…·ã€‚</p><p><strong>ç”Ÿäº§ ready</strong>ï¼šé…ç½®çš„æ—¶å€™é’ˆå¯¹ä¸åŒçš„æ‰“åŒ…ç¯å¢ƒé’ˆå¯¹æ€§ä¼˜åŒ–ï¼Œå¹¶ç¡®ä¿èƒ½å¤ŸæŠ•å…¥ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ã€‚</p><p>å¦‚æœè¯»è€…æ˜¯åˆæ¬¡çœ‹åˆ°è¿™ç¯‡æ–‡ç« ï¼Œå»ºè®®å…ˆçœ‹ä¸‹å‰ä¸¤ç¯‡ï¼š</p><ol><li><a href="https://lyreal666.com/ä»é›¶å¼€å§‹é…ç½®-react-typescriptï¼ˆä¸€ï¼‰ï¼šdotfiles/">ä»é›¶å¼€å§‹é…ç½® react + typescriptï¼ˆä¸€ï¼‰ï¼šdotfiles</a></li><li><a href="https://lyreal666.com/ä»é›¶å¼€å§‹é…ç½®-react-typescriptï¼ˆäºŒï¼‰ï¼šlinters-å’Œ-formatter/">ä»é›¶å¼€å§‹é…ç½® react + typescriptï¼ˆäºŒï¼‰ï¼šlinters å’Œ formatter</a></li></ol><p>é¡¹ç›®åœ°å€ï¼š<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RqeDY2Ni9yZWFjdC10eXBlc2NyaXB0LWJvaWxlcnBsYXRl" title="https://github.com/tjx666/react-typescript-boilerplate">react-typescript-boilerplate<i class="fa fa-external-link"></i></span></p><a id="more"></a><h2 id="dev-server"><a href="#dev-server" class="headerlink" title="dev server"></a>dev server</h2><p>æƒ³å½“åˆæˆ‘åˆšå¼€å§‹å­¦å‰ç«¯æ¡†æ¶çš„é‚£æ—¶å€™ï¼Œä¹Ÿæ˜¯è¢« webpack æŠ˜ç£¨çš„æ¬²ä»™æ¬²æ­»ï¼Œæˆ‘æ˜¯å…ˆè‡ªå­¦çš„ node æ‰å¼€å§‹å†™å‰ç«¯ï¼Œå†™ nodejs å¾ˆæ–¹ä¾¿ï¼Œè‡ªå¸¦çš„æ¨¡å—åŒ–æ–¹æ¡ˆ <code>commonjs</code>ï¼Œå†™å‰ç«¯é¡¹ç›®å°±è¦é…ç½®æ‰“åŒ…å·¥å…·ã€‚å½“æ—¶æœ€ç«çš„æ‰“åŒ…å·¥å…·å·²ç»æ˜¯ webpack äº†ï¼Œå…¶æ¬¡å°±æ˜¯ <code>gulp</code>ã€‚é…ç½® webpack æ€»æ˜¯è®°ä¸ä½ webpack é…ç½®æœ‰å“ªäº›å­—æ®µï¼Œè¿˜è¦æ‰¯åˆ°ä¸€å †ç›¸å…³çš„å·¥å…·åƒ ES6 ç¼–è¯‘å™¨ <code>babel</code>ï¼ŒCSS é¢„å¤„ç†å™¨ <code>sass</code>/<code>less</code>ï¼ŒCSS åå¤„ç†å™¨ <code>postcss</code>ï¼Œä»¥åŠå„ç§ webpack çš„ loader å’Œ pluginã€‚ç„¶åå«Œéº»çƒ¦å°±æœ‰ä¸€æ®µæ—¶é—´éƒ½æ˜¯ç”¨å®˜æ–¹çš„è„šæ‰‹æ¶ï¼Œreact å°±ç”¨ <code>cra</code>ï¼Œä¹Ÿå°±æ˜¯ <code>create-react-app</code>ï¼Œvue å°±ç”¨ <code>vue-cli</code>ã€‚å…¶å®ä¹ŸæŒºå¥½ç”¨çš„ï¼Œä¸è¿‡è¯´å®è¯ï¼Œæˆ‘ä¸ªäººè§‰å¾—ï¼Œ<code>cra</code> æ²¡ <code>vue-cli</code> è®¾è®¡çš„å¥½ï¼Œæ— è®ºæ˜¯æ˜“ç”¨æ€§å’Œæ‰©å±•æ€§éƒ½å®Œè´¥ï¼Œcra ä¸æ–¹ä¾¿ç”¨æˆ·ä¿®æ”¹ webpack é…ç½®ï¼Œvue-cli ä¸ä½†æ˜“äºç”¨æˆ·ä¿®æ”¹ webpack é…ç½®ï¼Œè¿˜èƒ½è®©ç”¨æˆ·ä¿å­˜æ¨¡æ¿ä»¥åŠè‡ªå¸¦æ’ä»¶ç³»ç»Ÿã€‚æˆ‘æ„Ÿè§‰ react å®˜æ–¹ä¹Ÿæ„è¯†åˆ°äº†è¿™ç‚¹ï¼Œæ‰€ä»¥å®˜æ–¹å£°ç§°è¿‘æœŸå°†ä¼šé‡ç‚¹ä¼˜åŒ–ç›¸å…³å·¥å…·é“¾ã€‚ç°åœ¨çš„è¯ï¼Œå¦‚æœæˆ‘æ–°å»ºä¸€ä¸ªå‰ç«¯é¡¹ç›®ï¼Œæˆ‘ä¼šé€‰æ‹©è‡ªå·±é…ï¼Œä¸ä¼šå»é‡‡ç”¨å®˜æ–¹çš„ cliï¼Œå› ä¸ºæˆ‘è§‰å¾—æˆ‘è‡ªå·±å·²ç»ç›¸å½“ç†Ÿæ‚‰å‰ç«¯å„ç§æ„å»ºå·¥å…·äº†ï¼Œç­‰æˆ‘ä¸ŠåŠå¹´å¿™å®Œæ¯•ä¸šå’Œæ‰¾å·¥ä½œçš„äº‹æƒ…æˆ‘åº”è¯¥ä¼šå°†ä¸€äº›å¸¸ç”¨çš„é…ç½®æŠ½æˆä¸€ä¸ª npm åŒ…ï¼Œç°åœ¨æ¯æ¬¡å†™ä¸€ä¸ªé¡¹ç›®éƒ½ copy æ”¹å¤ªç´¯äº†ï¼Œä¸€ä¸ªé¡¹ç›®çš„æ„å»ºé…ç½®æœ‰ä¼˜åŒ–ç‚¹ï¼Œå…¶å®ƒé¡¹ç›®éƒ½è¦æ‰‹åŠ¨åŒæ­¥ä¸€ä¸‹ï¼Œæ•ˆç‡å¤ªä½ã€‚</p><h3 id="æŠ€æœ¯é€‰å‹"><a href="#æŠ€æœ¯é€‰å‹" class="headerlink" title="æŠ€æœ¯é€‰å‹"></a>æŠ€æœ¯é€‰å‹</h3><p>TypeScript ä½œä¸ºé™æ€ç±»å‹è¯­è¨€ï¼Œç›¸å¯¹äº js è€Œè¨€ï¼Œåœ¨ç±»å‹æç¤ºä¸Šå¸¦æ¥çš„æå‡æ— ç–‘æ˜¯å·¨å¤§çš„ã€‚å€ŸåŠ© IDE çš„ç±»å‹æç¤ºå’Œä»£ç è¡¥å…¨ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“ webpack é…ç½®å¯¹è±¡æœ‰å“ªäº›å­—æ®µå°±ä¸ç”¨å»æŸ¥å®˜æ–¹æ–‡æ¡£äº†ï¼Œè€Œä¸”è¿˜ä¸ä¼šæ•²é”™ï¼Œå¾ˆå®‰é€¸ï¼Œæ‰€ä»¥å¼€å‘è¯­è¨€å°±é€‰æ‹© <strong>TypeScript</strong>ã€‚</p><p>å®˜æ–¹æ–‡æ¡£ä¸Šæœ‰ä¸“é—¨ä¸€èŠ‚ <span class="exturl" data-url="aHR0cHM6Ly93ZWJwYWNrLmpzLm9yZy9jb25maWd1cmF0aW9uL2NvbmZpZ3VyYXRpb24tbGFuZ3VhZ2VzLw==" title="https://webpack.js.org/configuration/configuration-languages/">Configuration Languages<i class="fa fa-external-link"></i></span> ä»‹ç»æ€ä¹ˆä½¿ç”¨ ts æ ¼å¼çš„é…ç½®æ–‡ä»¶é…ç½® webpack å‘½ä»¤è¡Œå·¥å…·ï¼Œæˆ‘è§‰å¾— <code>webpack-dev-server</code> å‘½ä»¤è¡Œå·¥å…·åº”è¯¥æ˜¯ä¸€æ ·çš„ã€‚</p><p>ä½†æ˜¯æˆ‘ä¸æ‰“ç®—ä½¿ç”¨å®˜æ–¹æ–‡æ¡£ä»‹ç»çš„æ–¹å¼ï¼Œæˆ‘å‹æ ¹ä¸æ‰“ç®—ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨ node API æ‰æ˜¯<strong>æœ€çµæ´»</strong>çš„é…ç½®æ–¹å¼ã€‚é…ç½® <code>webpack devServer</code> æ€»ç»“ä¸€ä¸‹æœ‰ä»¥ä¸‹æ–¹å¼ï¼š</p><ol><li><code>webpack-dev-server</code>ï¼Œè¿™æ˜¯æœ€ä¸çµæ´»çš„æ–¹å¼ï¼Œå½“ç„¶ä½¿ç”¨åœºæ™¯ç®€å•çš„æƒ…å†µä¸‹è¿˜æ˜¯å¾ˆæ–¹ä¾¿çš„</li><li><code>webpack-dev-server</code> node APIï¼Œåœ¨ node è„šæœ¬é‡Œé¢è°ƒç”¨ <code>web-dev-server</code> åŒ…æä¾›çš„ node API æ¥å¯åŠ¨ devServer</li><li><code>express</code> + <code>webpack devServer ç›¸å…³ä¸­é—´ä»¶</code>ï¼Œå®é™…ä¸Š <code>webpack-dev-server</code> å°±æ˜¯ä½¿ç”¨ <code>express</code> ä»¥åŠä¸€äº› devServer ç›¸å…³çš„ä¸­é—´ä»¶å¼€å‘çš„ã€‚åœ¨è¿™ç§æ–¹å¼ä¸‹ï¼Œ å„ç§ä¸­é—´ä»¶ç›´æ¥æš´éœ²å‡ºæ¥äº†ï¼Œæˆ‘ä»¬å¯ä»¥çµæ´»é…ç½®å„ä¸ªä¸­é—´ä»¶çš„é€‰é¡¹ã€‚</li><li><code>koa</code> + <code>webpack devServer ç›¸å…³ä¸­é—´ä»¶</code>ï¼Œæˆ‘åœ¨ github ä¸Šè¿˜çœŸçš„æœåˆ°äº†å’Œ webpack devServer ç›¸å…³çš„ webpack ä¸­é—´ä»¶ã€‚å…¶å® webpack devServer å°±æ˜¯ä¸€ä¸ª node server å˜›ï¼Œç”¨ä»€ä¹ˆæ¡†æ¶æŠ€æœ¯å®ç°ä¸é‡è¦ï¼Œèƒ½å®ç°æˆ‘ä»¬éœ€è¦çš„åŠŸèƒ½å°±è¡Œã€‚</li></ol><p>æˆ‘æœ€ç»ˆé‡‡ç”¨ <code>express</code> + <code>webpack devServer ç›¸å…³ä¸­é—´ä»¶</code>çš„æ–¹å¼ï¼Œä¸ºä»€ä¹ˆä¸é€‰æ‹©ç”¨ <code>koa</code> ï¼Ÿå› ä¸ºæˆ‘è§‰å¾—å®˜æ–¹ç”¨çš„å°±æ˜¯ <code>express</code>ï¼Œç”¨ <code>express</code> è‚¯å®šè¦æ¯” <code>koa</code> æ›´æˆç†Ÿç¨³å®šï¼Œå‘è¦å°‘ä¸€äº›ã€‚</p><h3 id="å®ç°æœ€åŸºæœ¬çš„æ‰“åŒ…åŠŸèƒ½"><a href="#å®ç°æœ€åŸºæœ¬çš„æ‰“åŒ…åŠŸèƒ½" class="headerlink" title="å®ç°æœ€åŸºæœ¬çš„æ‰“åŒ…åŠŸèƒ½"></a>å®ç°æœ€åŸºæœ¬çš„æ‰“åŒ…åŠŸèƒ½</h3><p>ä»ç®€åˆ°ç¹ï¼Œæˆ‘ä»¬å…ˆæ¥å®ç°æœ€åŸºæœ¬çš„æ‰“åŒ…åŠŸèƒ½ä½¿å…¶èƒ½å¤Ÿæ‰“åŒ… <code>tsx</code> æ–‡ä»¶ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šä¸€æ­¥ä¸€æ­¥ä¸°å¯Œï¼Œä¼˜åŒ–æˆ‘ä»¬çš„é…ç½®ã€‚</p><h4 id="é…ç½®å…¥å£æ–‡ä»¶"><a href="#é…ç½®å…¥å£æ–‡ä»¶" class="headerlink" title="é…ç½®å…¥å£æ–‡ä»¶"></a>é…ç½®å…¥å£æ–‡ä»¶</h4><p>å…ˆå®‰è£… TypeScriptï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æœ¬åœ°å®‰è£…å¼€å‘ä¾èµ– typescript</span></span><br><span class="line">yarn add typescript -D</span><br></pre></td></tr></table></figure><p>æ¯ä¸ª TypeScript é¡¹ç›®éƒ½éœ€è¦æœ‰ä¸€ä¸ª <code>tsconfig.json</code> é…ç½®æ–‡ä»¶ï¼Œä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤åœ¨ <code>src</code> ç›®å½•ä¸‹æ–°å»º <code>tsconfig.json</code> æ–‡ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> src &amp;&amp; npx tsc --init &amp;&amp; <span class="built_in">cd</span> ..</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æš‚æ—¶è°ƒæ•´æˆè¿™æ ·ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/tsconfig.json</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"compilerOptions"</span>: &#123;</span><br><span class="line">        <span class="comment">/* Basic Options */</span></span><br><span class="line">        <span class="string">"jsx"</span>: <span class="string">"react"</span>,</span><br><span class="line">        <span class="string">"isolatedModules"</span>: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* Strict Type-Checking Options */</span></span><br><span class="line">        <span class="string">"strict"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"noImplicitAny"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"strictNullChecks"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"strictFunctionTypes"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"strictBindCallApply"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"strictPropertyInitialization"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"noImplicitThis"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"alwaysStrict"</span>: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* Module Resolution Options */</span></span><br><span class="line">        <span class="string">"moduleResolution"</span>: <span class="string">"node"</span>,</span><br><span class="line">        <span class="string">"esModuleInterop"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"resolveJsonModule"</span>: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* Experimental Options */</span></span><br><span class="line">        <span class="string">"experimentalDecorators"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"emitDecoratorMetadata"</span>: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* Advanced Options */</span></span><br><span class="line">        <span class="string">"forceConsistentCasingInFileNames"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"skipLibCheck"</span>: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å°†ä½¿ç”¨ babel å»ç¼–è¯‘ TypeScriptï¼Œbabel åœ¨ç¼–è¯‘ TypeScript ä»£ç æ˜¯ç›´æ¥å»æ‰ TypeScript çš„ç±»å‹ï¼Œç„¶åå½“æˆæ™®é€šçš„ javascript ä»£ç ä½¿ç”¨å„ç§æ’ä»¶è¿›è¡Œç¼–è¯‘ï¼Œå› æ­¤ <code>tsconfig.json</code> ä¸­å¾ˆå¤šé€‰é¡¹ä¾‹å¦‚ <code>target</code> å’Œ <code>module</code> æ˜¯æ²¡æœ‰ç”¨çš„ã€‚</p><blockquote><p>å¯ç”¨ <code>isolatedModules</code> é€‰é¡¹ä¼šåœ¨ babel ç¼–è¯‘ä»£ç æ—¶æä¾›ä¸€äº›é¢å¤–çš„æ£€æŸ¥ï¼Œ<code>esModuleInterop</code> è¿™ä¸ªé€‰é¡¹æ˜¯ç”¨æ¥ä¸ºäº†è®©æ²¡æœ‰ default å±æ€§çš„æ¨¡å—ä¹Ÿå¯ä»¥ä½¿ç”¨é»˜è®¤å¯¼å…¥ï¼Œä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼Œå¦‚æœè¿™ä¸ªé€‰é¡¹æ²¡å¼€å¯ï¼Œé‚£ä½ å¯¼å…¥ fs æ¨¡å—åªèƒ½åƒä¸‹é¢è¿™æ ·å¯¼å…¥ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> fs <span class="keyword">from</span> <span class="string">'fs'</span>;</span><br></pre></td></tr></table></figure><p>å¼€å¯äº†ä»¥åï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨é»˜è®¤å¯¼å…¥ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> fs <span class="keyword">from</span> <span class="string">'fs'</span>;</span><br></pre></td></tr></table></figure><p>æœ¬è´¨ä¸Š ESM é»˜è®¤å¯¼å…¥æ˜¯å¯¼å…¥æ¨¡å—çš„ default å±æ€§ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> fs <span class="keyword">from</span> <span class="string">'fs'</span>;</span><br><span class="line"><span class="comment">// ç­‰åŒäº</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> __module__ <span class="keyword">from</span> <span class="string">'fs'</span>;</span><br><span class="line"><span class="keyword">let</span> fs = __module__.default;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯ node å†…å»ºæ¨¡å— fs æ˜¯æ²¡æœ‰ default å±æ€§çš„ï¼Œå¼€å¯ <code>isolatedModules</code> é€‰é¡¹å°±ä¼šåœ¨æ²¡æœ‰ default å±æ€§çš„æƒ…å†µä¸‹è‡ªåŠ¨è½¬æ¢ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> fs, &#123; resolve &#125; <span class="keyword">from</span> <span class="string">'fs'</span>;</span><br><span class="line"><span class="comment">// è½¬æ¢æˆ</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> fs <span class="keyword">from</span> <span class="string">'fs'</span>;</span><br><span class="line"><span class="keyword">let</span> &#123; resolve &#125; = fs;</span><br></pre></td></tr></table></figure></blockquote><p>æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªå…¥å£æ–‡ä»¶ <code>src/index.tsx</code>ï¼Œå†…å®¹å¾ˆç®€å•ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> plus <span class="keyword">from</span> <span class="string">'./plus'</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(plus(<span class="number">404</span>, <span class="number">404</span>, <span class="number">404</span>, <span class="number">404</span>, <span class="number">404</span>)); <span class="comment">// =&gt; 2020</span></span><br></pre></td></tr></table></figure><p><code>src/plus.ts</code> å†…å®¹ä¸ºï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">plus</span>(<span class="params">...nums: number[]</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> nums.reduce(<span class="function">(<span class="params">pre, current</span>) =&gt;</span> pre + current, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ç¼–è¯‘-TypeScript"><a href="#ç¼–è¯‘-TypeScript" class="headerlink" title="ç¼–è¯‘ TypeScript"></a>ç¼–è¯‘ TypeScript</h4><p>æˆ‘ä»¬çŸ¥é“ webpack é»˜è®¤çš„æ¨¡å—åŒ–ç³»ç»Ÿåªæ”¯æŒ js æ–‡ä»¶ï¼Œå¯¹äºå…¶å®ƒç±»å‹çš„æ–‡ä»¶å¦‚ jsx, ts, tsx, vue ä»¥åŠå›¾ç‰‡å­—ä½“ç­‰æ–‡ä»¶ç±»å‹ï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…å¯¹åº”çš„ loaderã€‚å¯¹äº ts æ–‡ä»¶ï¼Œç›®å‰å­˜åœ¨æ¯”è¾ƒæµè¡Œçš„æ–¹æ¡ˆæœ‰ä¸‰ç§:</p><ol><li><p>babel + <span class="exturl" data-url="aHR0cHM6Ly9iYWJlbGpzLmlvL2RvY3MvZW4vYmFiZWwtcHJlc2V0LXR5cGVzY3JpcHQ=" title="https://babeljs.io/docs/en/babel-preset-typescript">@babel/preset-typescript<i class="fa fa-external-link"></i></span></p></li><li><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL1R5cGVTdHJvbmcvdHMtbG9hZGVy" title="https://github.com/TypeStrong/ts-loader">ts-loader<i class="fa fa-external-link"></i></span></p></li><li><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3MtcGFuZmVyb3YvYXdlc29tZS10eXBlc2NyaXB0LWxvYWRlcg==" title="https://github.com/s-panferov/awesome-typescript-loader">awesome-typescript-loader<i class="fa fa-external-link"></i></span></p></li></ol><p>awesome-typescript-loader å°±ç®—äº†ï¼Œä½œè€…å·²ç»æ”¾å¼ƒç»´æŠ¤äº†ã€‚é¦–å…ˆ babel æˆ‘ä»¬ä¸€å®šè¦ç”¨çš„ï¼Œå› ä¸º babel ç”Ÿæ€æœ‰å¾ˆå¤šå®ç”¨çš„æ’ä»¶ã€‚è™½ç„¶ babel æ˜¯å¯ä»¥å’Œ ts-loader ä¸€èµ·ç”¨ï¼Œts-loader å®˜æ–¹ç»™äº†ä¸€ä¸ªä¾‹å­ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL1R5cGVTdHJvbmcvdHMtbG9hZGVyL3RyZWUvbWFzdGVyL2V4YW1wbGVzL3JlYWN0LWJhYmVsLWthcm1hLWd1bHA=" title="https://github.com/TypeStrong/ts-loader/tree/master/examples/react-babel-karma-gulp">react-babel-karma-gulp<i class="fa fa-external-link"></i></span>ï¼Œä½†æ˜¯æˆ‘è§‰å¾—æ—¢ç„¶ babel å·²ç»èƒ½å¤Ÿç¼–è¯‘ TypeScript æˆ‘ä»¬å°±æ²¡å¿…è¦å†åŠ ä¸€ä¸ª ts-loaderï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©æ–¹æ¡ˆä¸€ã€‚éœ€è¦æŒ‡å‡ºçš„ä¸€ç‚¹å°±æ˜¯å°±æ˜¯ babel é»˜è®¤ä¸ä¼šæ£€æŸ¥ TypeScript çš„ç±»å‹ï¼Œåé¢ webpack æ’ä»¶éƒ¨åˆ†æˆ‘ä»¬ä¼šé€šè¿‡é…ç½® <code>fork-ts-checker-webpack-plugin</code> æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><h4 id="æ·»åŠ -webpack-é…ç½®"><a href="#æ·»åŠ -webpack-é…ç½®" class="headerlink" title="æ·»åŠ  webpack é…ç½®"></a>æ·»åŠ  webpack é…ç½®</h4><p>æˆ‘ä»¬å°†æŠŠæ‰€æœ‰ node è„šæœ¬æ”¾åˆ°é¡¹ç›®æ ¹ç›®çš„ <code>scripts</code> æ–‡ä»¶å¤¹ï¼Œå› ä¸º <code>src</code> æ–‡ä»¶å¤¹æ˜¯å‰ç«¯é¡¹ç›®ï¼Œè€Œ <code>scripts</code> æ–‡ä»¶å¤¹æ˜¯ node é¡¹ç›®ï¼Œæˆ‘ä»¬åº”è¯¥åˆ†åˆ«é…ç½® <code>tsconfig.json</code>ï¼Œé€šè¿‡ä¸‹é¢çš„å‘½ä»¤åœ¨å…¶ä¸­ç”Ÿæˆåˆå§‹çš„ <code>tsconfig.json</code> æ–‡ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> ./scripts &amp;&amp; npx tsc --init &amp;&amp; <span class="built_in">cd</span> ..</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬è°ƒæ•´æˆé…±ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// scripts/tsconfig.json</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"compilerOptions"</span>: &#123;</span><br><span class="line">        <span class="comment">/* Basic Options */</span></span><br><span class="line">        <span class="string">"target"</span>: <span class="string">"ES2020"</span>,</span><br><span class="line">        <span class="string">"module"</span>: <span class="string">"commonjs"</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* Strict Type-Checking Options */</span></span><br><span class="line">        <span class="string">"strict"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"noImplicitAny"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"strictNullChecks"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"strictFunctionTypes"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"strictBindCallApply"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"strictPropertyInitialization"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"noImplicitThis"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"alwaysStrict"</span>: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* Module Resolution Options */</span></span><br><span class="line">        <span class="string">"moduleResolution"</span>: <span class="string">"node"</span>,</span><br><span class="line">        <span class="string">"esModuleInterop"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"resolveJsonModule"</span>: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* Experimental Options */</span></span><br><span class="line">        <span class="string">"experimentalDecorators"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"emitDecoratorMetadata"</span>: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* Advanced Options */</span></span><br><span class="line">        <span class="string">"forceConsistentCasingInFileNames"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"skipLibCheck"</span>: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æå‡ ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼š</p><ul><li><p><code>&quot;target&quot;: &quot;ES2020&quot;</code>ï¼Œå…¶å®ç¼–è¯‘çº§åˆ«ä½ è°ƒçš„å¾ˆä½æ˜¯æ²¡é—®é¢˜çš„ï¼Œä½ ç”¨é«˜çº§è¯­æ³• tsc å°±è½¬ç å‘—ï¼Œç¼ºç‚¹å°±æ˜¯è½¬ç åä»£ç ä½“ç§¯ä¼šå˜å¤§ï¼Œæ‰§è¡Œæ•ˆç‡ä¹Ÿä¼šé™ä½ï¼ŒåŸç”Ÿè¯­æ³•ä¸€èˆ¬éƒ½æ˜¯è¢«ä¼˜åŒ–è¿‡çš„ã€‚æˆ‘å–œæ¬¢è°ƒé«˜ä¸€ç‚¹ï¼Œä¸€èˆ¬æ¥è¯´åªè¦ä¸ç”¨é‚£äº›åœ¨ä»£ç è¿è¡Œå¹³å°è¿˜ä¸æ”¯æŒçš„è¯­æ³•å°±æ²¡é—®é¢˜ã€‚è‡ªä» TypeScript3.7 æ”¯æŒäº†å¯é€‰é“¾ï¼Œæˆ‘å°±å¼€å§‹å°è¯•åœ¨ TypeScript ä½¿ç”¨å®ƒï¼Œä½†æ˜¯é—®é¢˜æ¥äº†ï¼Œæˆ‘ä¹‹å‰ç¼–è¯‘çº§åˆ«ä¸€ç›´éƒ½æ˜¯è°ƒæˆæœ€é«˜ï¼Œä¹Ÿå°±æ˜¯ <code>ESNext</code>ï¼Œå› ä¸ºå¯é€‰é“¾åœ¨ <code>ESNext</code> å·²ç»æ˜¯æ ‡å‡†äº†ï¼Œæ‰€ä»¥ tsc å¯¹äºå¯é€‰é“¾ä¸ä¼šè½¬ç çš„ã€‚ç„¶å node 12 è¿˜ä¸æ”¯æŒå¯é€‰é“¾ï¼Œå°±ä¼šæŠ¥è¯­æ³•é”™è¯¯ï¼Œäºæ˜¯æˆ‘å°±é™åˆ° <code>ES2020</code> äº†ã€‚</p></li><li><p><code>Strict Type-Checking Options</code>ï¼Œè¿™éƒ¨åˆ†å…¨å¼€ï¼Œæ—¢ç„¶ä¸Šäº† TypeScript çš„èˆ¹ï¼Œå°±ç”¨æœ€ä¸¥æ ¼çš„ç±»å‹æ£€æŸ¥ï¼Œæ‹’ç» AnyScript</p></li><li><p>åˆ æ‰ <code>Additional Checks</code> éƒ¨ä»½çš„é…ç½®ï¼Œè¿™éƒ¨åˆ† eslint èƒ½åšçš„æ›´å¤šï¼Œæ›´å¥½</p></li></ul><p>æ¥ç€æˆ‘ä»¬æ–°å»º <code>scripts/configs</code>æ–‡ä»¶å¤¹ï¼Œé‡Œé¢ç”¨æ¥å­˜æ”¾åŒ…æ‹¬ webpack çš„é…ç½®æ–‡ä»¶ã€‚åœ¨å…¶ä¸­æ–°å»ºä¸‰ä¸ª webpack çš„é…ç½®æ–‡ä»¶ <code>webpack.common.ts</code>ï¼Œ <code>webpack.dev.ts</code>å’Œ <code>webapck.prod.ts</code>ã€‚<code>webpack.common.ts</code> ä¿å­˜ä¸€äº›å…¬å…±çš„é…ç½®æ–‡ä»¶ï¼Œ<code>webpack.dev.ts</code> æ˜¯å¼€å‘ç¯å¢ƒç”¨çš„ï¼Œä¼šè¢« devServer è¯»å–ï¼Œ<code>webapck.prod.ts</code> æ˜¯æˆ‘ä»¬åœ¨æ„å»ºç”Ÿäº§ç¯å¢ƒçš„ bundle æ—¶ç”¨çš„ã€‚</p><p>æˆ‘ä»¬æ¥ç€å®‰è£… webpack å’Œ webpack-merge ä»¥åŠå®ƒä»¬çš„ç±»å‹å£°æ˜æ–‡ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add webpack webpack-merge @types/webpack @types/webpack-merge -D</span><br></pre></td></tr></table></figure><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3N1cnZpdmVqcy93ZWJwYWNrLW1lcmdl" title="https://github.com/survivejs/webpack-merge">webpack-merge<i class="fa fa-external-link"></i></span> æ˜¯ä¸€ä¸ªä¸º merge webpack é…ç½®è®¾è®¡çš„ merge å·¥å…·ï¼Œæä¾›äº†ä¸€äº›é«˜çº§çš„ merge æ–¹å¼ã€‚ä¸è¿‡æˆ‘ç›®å‰å¹¶æ²¡æœ‰ç”¨åˆ°é‚£äº›é«˜çº§çš„ merge æ–¹å¼ï¼Œå°±æ˜¯å½“æˆæ™®é€šçš„ merge å·¥å…·ä½¿ç”¨ï¼Œåç»­å¯ä»¥æ¢ç´¢ä¸€ä¸‹è¿™æ–¹é¢çš„ä¼˜åŒ–ã€‚</p><p>ä¸ºäº†ç¼–è¯‘ tsxï¼Œæˆ‘ä»¬éœ€è¦å®‰è£… <code>babel-loader</code> å’Œç›¸å…³æ’ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add babel-loader @babel/core @babel/preset-typescript -D</span><br></pre></td></tr></table></figure><p>æ–°å»º babel é…ç½®æ–‡ä»¶ <code>babel.config.js</code>ï¼Œç°åœ¨æˆ‘ä»¬åªæ·»åŠ ä¸€ä¸ª TypeScript presetï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// babel.config.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">api</span>) </span>&#123;</span><br><span class="line">  api.cache(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> presets = [<span class="string">'@babel/preset-typescript'</span>];</span><br><span class="line">  <span class="keyword">const</span> plugins = [];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    presets,</span><br><span class="line">    plugins,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ·»åŠ  babel-loader åˆ° <code>webpack.common.ts</code>ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.common.ts`</span></span><br><span class="line"><span class="keyword">import</span> &#123; Configuration &#125; <span class="keyword">from</span> <span class="string">'webpack'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; projectName, projectRoot, resolvePath &#125; <span class="keyword">from</span> <span class="string">'../env'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> commonConfig: Configuration = &#123;</span><br><span class="line">  context: projectRoot,</span><br><span class="line">  entry: resolvePath(projectRoot, <span class="string">'./src/index.tsx'</span>),</span><br><span class="line">  output: &#123;</span><br><span class="line">    publicPath: <span class="string">'/'</span>,</span><br><span class="line">    path: resolvePath(projectRoot, <span class="string">'./dist'</span>),</span><br><span class="line">    filename: <span class="string">'js/[name]-[hash].bundle.js'</span>,</span><br><span class="line">    <span class="comment">// åŠ ç› hash</span></span><br><span class="line">    hashSalt: projectName || <span class="string">'react typescript boilerplate'</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  resolve: &#123;</span><br><span class="line">    <span class="comment">// æˆ‘ä»¬å¯¼å…¥ts ç­‰æ¨¡å—ä¸€èˆ¬ä¸å†™åç¼€åï¼Œwebpack ä¼šå°è¯•ä½¿ç”¨è¿™ä¸ªæ•°ç»„æä¾›çš„åç¼€åå»å¯¼å…¥</span></span><br><span class="line">    extensions: [<span class="string">'.ts'</span>, <span class="string">'.tsx'</span>, <span class="string">'.js'</span>, <span class="string">'.json'</span>],</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// å¯¼å…¥ jsx çš„äººå°‘å–ç‚¹</span></span><br><span class="line">        test: <span class="regexp">/\.(tsx?|js)$/</span>,</span><br><span class="line">        loader: <span class="string">'babel-loader'</span>,</span><br><span class="line">        <span class="comment">// å¼€å¯ç¼“å­˜</span></span><br><span class="line">        options: &#123; <span class="attr">cacheDirectory</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">        exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æˆ‘è§‰å¾—è¿™ä¸ª react + ts é¡¹ç›®ä¸åº”è¯¥ä¼šå‡ºç° jsx æ–‡ä»¶ï¼Œå¦‚æœå¯¼å…¥äº† jsx æ–‡ä»¶ webpack å°±ä¼šæŠ¥é”™æ‰¾ä¸åˆ°å¯¹åº”çš„ loaderï¼Œå¯ä»¥è®©æˆ‘ä»¬åŠæ—¶å¤„ç†æ‰è¿™ä¸ªæœ‰é—®é¢˜çš„æ–‡ä»¶ã€‚</p><h4 id="ä½¿ç”¨-express-å¼€å‘-devServer"><a href="#ä½¿ç”¨-express-å¼€å‘-devServer" class="headerlink" title="ä½¿ç”¨ express å¼€å‘ devServer"></a>ä½¿ç”¨ express å¼€å‘ devServer</h4><p>æˆ‘ä»¬å…ˆå®‰è£… <code>express</code> ä»¥åŠå’Œ webpack devServer ç›¸å…³çš„ä¸€äº›ä¸­é—´ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add express webpack-dev-middleware webpack-hot-middleware @types/express @t</span><br><span class="line">ypes/webpack-dev-middleware @types/webpack-hot-middleware -D</span><br></pre></td></tr></table></figure><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3dlYnBhY2svd2VicGFjay1kZXYtbWlkZGxld2FyZQ==" title="https://github.com/webpack/webpack-dev-middleware">webpack-dev-middleware<i class="fa fa-external-link"></i></span> è¿™ä¸ª <code>express</code> ä¸­é—´ä»¶çš„ä¸»è¦ä½œç”¨ï¼š</p><ol><li>ä½œä¸ºä¸€ä¸ªé™æ€æ–‡ä»¶æœåŠ¡å™¨ï¼Œä½¿ç”¨å†…å­˜æ–‡ä»¶ç³»ç»Ÿæ‰˜ç®¡ webpack ç¼–è¯‘å‡ºçš„ bundle</li><li>å¦‚æœæ–‡ä»¶è¢«ä¿®æ”¹äº†ï¼Œä¼šå»¶è¿ŸæœåŠ¡å™¨çš„è¯·æ±‚ç›´åˆ°ç¼–è¯‘å®Œæˆ</li><li>é…åˆ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3dlYnBhY2stY29udHJpYi93ZWJwYWNrLWhvdC1taWRkbGV3YXJl" title="https://github.com/webpack-contrib/webpack-hot-middleware">webpack-hot-middleware<i class="fa fa-external-link"></i></span> å®ç°çƒ­æ›´æ–°åŠŸèƒ½</li></ol><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3dlYnBhY2stY29udHJpYi93ZWJwYWNrLWhvdC1taWRkbGV3YXJl" title="https://github.com/webpack-contrib/webpack-hot-middleware">webpack-hot-middleware<i class="fa fa-external-link"></i></span> è¿™ä¸ª express ä¸­é—´ä»¶ä¼šå°†è‡ªå·±æ³¨å†Œä¸ºä¸€ä¸ª webpack æ’ä»¶ï¼Œç›‘å¬ webpack çš„ç¼–è¯‘äº‹ä»¶ã€‚ ä½ å“ªä¸ª chunck éœ€è¦å®ç°çƒ­æ›´æ–°ï¼Œå°±è¦åœ¨é‚£ä¸ª chunk ä¸­å¯¼å…¥è¿™ä¸ªæ’ä»¶æä¾›çš„ <code>webpack-hot-middleware/client.js</code> å®¢æˆ·ç«¯è¡¥ä¸ã€‚è¿™ä¸ªå‰ç«¯ä»£ç ä¼šè·å– devServer çš„ <span class="exturl" data-url="aHR0cDovL3d3dy5odG1sNXJvY2tzLmNvbS9lbi90dXRvcmlhbHMvZXZlbnRzb3VyY2UvYmFzaWNzLw==" title="http://www.html5rocks.com/en/tutorials/eventsource/basics/">Server Sent Events<i class="fa fa-external-link"></i></span> è¿æ¥ï¼Œå½“æœ‰ç¼–è¯‘äº‹ä»¶å‘ç”Ÿï¼ŒdevServer ä¼šå‘å¸ƒé€šçŸ¥ç»™è¿™ä¸ªå®¢æˆ·ç«¯ã€‚å®¢æˆ·ç«¯æ¥å—åˆ°é€šçŸ¥åï¼Œä¼šé€šè¿‡æ¯”å¯¹ hash å€¼åˆ¤æ–­æœ¬åœ°ä»£ç æ˜¯ä¸æ˜¯æœ€æ–°çš„ï¼Œå¦‚æœä¸æ˜¯å°±ä¼šå‘ devServer æ‹‰å–æ›´æ–°è¡¥ä¸å€ŸåŠ©ä¸€äº›å…¶å®ƒçš„å·¥å…·ä¾‹å¦‚ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2dhZWFyb24vcmVhY3QtaG90LWxvYWRlcg==" title="https://github.com/gaearon/react-hot-loader">react-hot-loader<i class="fa fa-external-link"></i></span> å®ç°çƒ­æ›´æ–°ã€‚</p><p>ä¸‹é¢æ˜¯æˆ‘å¦å¤–ä¸€ä¸ªè¿˜åœ¨å¼€å‘çš„ electron é¡¹ç›®ä¿®æ”¹äº†ä¸€è¡Œä»£ç åï¼Œ client è¡¥ä¸å‘é€çš„ä¸¤æ¬¡è¯·æ±‚ï¼š</p><p><img data-src="https://i.loli.net/2020/02/16/QS1lFJt7fbIYEcG.png" alt="hash"></p><p><img data-src="https://i.loli.net/2020/02/16/PVpnHNC9G7rEtQT.png" alt="update"></p><p>ç¬¬ä¸€æ¬¡è¯·æ±‚è¿”å›çš„é‚£ä¸ª h å€¼åŠ¨åŠ¨è„šè¶¾å¤´å°±èƒ½çŒœå‡ºæ¥å°±æ˜¯ hash å€¼ï¼Œå‘ç°å’Œæœ¬åœ°çš„ hash å€¼æ¯”å¯¹ä¸ä¸Šåï¼Œå†æ¬¡è¯·æ±‚æ›´æ–°è¡¥ä¸ã€‚</p><p>æˆ‘ä»¬æ–°å»ºæ–‡ä»¶ <code>scripts/start.ts</code> ç”¨æ¥å¯åŠ¨æˆ‘ä»¬çš„ devServerï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> chalk <span class="keyword">from</span> <span class="string">'chalk'</span>;</span><br><span class="line"><span class="keyword">import</span> getPort <span class="keyword">from</span> <span class="string">'get-port'</span>;</span><br><span class="line"><span class="keyword">import</span> logSymbols <span class="keyword">from</span> <span class="string">'log-symbols'</span>;</span><br><span class="line"><span class="keyword">import</span> open <span class="keyword">from</span> <span class="string">'open'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; argv &#125; <span class="keyword">from</span> <span class="string">'yargs'</span>;</span><br><span class="line"><span class="keyword">import</span> express, &#123; Express &#125; <span class="keyword">from</span> <span class="string">'express'</span>;</span><br><span class="line"><span class="keyword">import</span> webpack, &#123; Compiler, Stats &#125; <span class="keyword">from</span> <span class="string">'webpack'</span>;</span><br><span class="line"><span class="keyword">import</span> historyFallback <span class="keyword">from</span> <span class="string">'connect-history-api-fallback'</span>;</span><br><span class="line"><span class="keyword">import</span> cors <span class="keyword">from</span> <span class="string">'cors'</span>;</span><br><span class="line"><span class="keyword">import</span> webpackDevMiddleware <span class="keyword">from</span> <span class="string">'webpack-dev-middleware'</span>;</span><br><span class="line"><span class="keyword">import</span> webpackHotMiddleware <span class="keyword">from</span> <span class="string">'webpack-hot-middleware'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> proxy <span class="keyword">from</span> <span class="string">'./proxy'</span>;</span><br><span class="line"><span class="keyword">import</span> devConfig <span class="keyword">from</span> <span class="string">'./configs/webpack.dev'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; hmrPath &#125; <span class="keyword">from</span> <span class="string">'./env'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">openBrowser</span>(<span class="params">compiler: Compiler, address: string</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (argv.open) &#123;</span><br><span class="line">        <span class="keyword">let</span> hadOpened = <span class="literal">false</span>;</span><br><span class="line">        <span class="comment">// ç¼–è¯‘å®Œæˆæ—¶æ‰§è¡Œ</span></span><br><span class="line">        compiler.hooks.done.tap(<span class="string">'open-browser-plugin'</span>, <span class="keyword">async</span> (stats: Stats) =&gt; &#123;</span><br><span class="line">            <span class="comment">// æ²¡æœ‰æ‰“å¼€è¿‡æµè§ˆå™¨å¹¶ä¸”æ²¡æœ‰ç¼–è¯‘é”™è¯¯å°±æ‰“å¼€æµè§ˆå™¨</span></span><br><span class="line">            <span class="keyword">if</span> (!hadOpened &amp;&amp; !stats.hasErrors()) &#123;</span><br><span class="line">                <span class="keyword">await</span> open(address);</span><br><span class="line">                hadOpened = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setupMiddlewares</span>(<span class="params">compiler: Compiler, server: Express</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> publicPath = devConfig.output!.publicPath!;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¾ç½®ä»£ç†</span></span><br><span class="line">    proxy(server);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ browserRouter éœ€è¦é‡å®šå‘æ‰€æœ‰ html é¡µé¢åˆ°é¦–é¡µ</span></span><br><span class="line">    server.use(historyFallback());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¼€å‘ chrome æ‰©å±•çš„æ—¶å€™å¯èƒ½éœ€è¦å¼€å¯è·¨åŸŸï¼Œå‚è€ƒï¼šhttps://juejin.im/post/5e2027096fb9a02fe971f6b8</span></span><br><span class="line">    server.use(cors());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> devMiddlewareOptions: webpackDevMiddleware.Options = &#123;</span><br><span class="line">        <span class="comment">// ä¿æŒå’Œ webpack ä¸­é…ç½®ä¸€è‡´</span></span><br><span class="line">        publicPath,</span><br><span class="line">        <span class="comment">// åªåœ¨å‘ç”Ÿé”™è¯¯æˆ–æœ‰æ–°çš„ç¼–è¯‘æ—¶è¾“å‡º</span></span><br><span class="line">        stats: <span class="string">'minimal'</span>,</span><br><span class="line">        <span class="comment">// éœ€è¦è¾“å‡ºæ–‡ä»¶åˆ°ç£ç›˜å¯ä»¥å¼€å¯</span></span><br><span class="line">        <span class="comment">// writeToDisk: true</span></span><br><span class="line">    &#125;;</span><br><span class="line">    server.use(webpackDevMiddleware(compiler, devMiddlewareOptions));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> hotMiddlewareOptions: webpackHotMiddleware.Options = &#123;</span><br><span class="line">        <span class="comment">// sse è·¯ç”±</span></span><br><span class="line">        path: hmrPath,</span><br><span class="line">        <span class="comment">// ç¼–è¯‘å‡ºé”™ä¼šåœ¨ç½‘é¡µä¸­æ˜¾ç¤ºå‡ºé”™ä¿¡æ¯é®ç½©</span></span><br><span class="line">        overlay: <span class="literal">true</span>,</span><br><span class="line">        <span class="comment">// webpack å¡ä½è‡ªåŠ¨åˆ·æ–°é¡µé¢</span></span><br><span class="line">        reload: <span class="literal">true</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">    server.use(webpackHotMiddleware(compiler, hotMiddlewareOptions));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">start</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> HOST = <span class="string">'127.0.0.1'</span>;</span><br><span class="line">    <span class="comment">// 4ä¸ªå¤‡é€‰ç«¯å£ï¼Œéƒ½è¢«å ç”¨ä¼šä½¿ç”¨éšæœºç«¯å£</span></span><br><span class="line">    <span class="keyword">const</span> PORT = <span class="keyword">await</span> getPort(&#123; <span class="attr">port</span>: [<span class="number">3000</span>, <span class="number">4000</span>, <span class="number">8080</span>, <span class="number">8888</span>] &#125;);</span><br><span class="line">    <span class="keyword">const</span> address = <span class="string">`http://<span class="subst">$&#123;HOST&#125;</span>:<span class="subst">$&#123;PORT&#125;</span>`</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åŠ è½½ webpack é…ç½®</span></span><br><span class="line">    <span class="keyword">const</span> compiler = webpack(devConfig);</span><br><span class="line">    openBrowser(compiler, address);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> devServer = express();</span><br><span class="line">    setupMiddlewares(compiler, devServer);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> httpServer = devServer.listen(PORT, HOST, err =&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">            <span class="built_in">console</span>.error(err);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// logSymbols.success åœ¨ windows å¹³å°æ¸²æŸ“ä¸º âˆš ï¼Œæ”¯æŒçš„å¹³å°ä¼šæ˜¾ç¤º âœ”</span></span><br><span class="line">        <span class="built_in">console</span>.log(</span><br><span class="line">            <span class="string">`DevServer is running at <span class="subst">$&#123;chalk.magenta.underline(address)&#125;</span> <span class="subst">$&#123;logSymbols.success&#125;</span>`</span>,</span><br><span class="line">        );</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æˆ‘ä»¬ç›‘å¬äº† node ä¿¡å·ï¼Œæ‰€ä»¥ä½¿ç”¨ cross-env-shell è€Œä¸æ˜¯ cross-env</span></span><br><span class="line">    process.on(<span class="string">'SIGINT'</span>, () =&gt; &#123;</span><br><span class="line">        <span class="comment">// å…ˆå…³é—­ devServer</span></span><br><span class="line">        httpServer.close();</span><br><span class="line">        <span class="comment">// åœ¨ ctrl + c çš„æ—¶å€™éšæœºè¾“å‡º 'See you again' å’Œ 'Goodbye'</span></span><br><span class="line">        <span class="built_in">console</span>.log(</span><br><span class="line">            chalk.greenBright.bold(<span class="string">`\n<span class="subst">$&#123;<span class="built_in">Math</span>.random() &gt; <span class="number">0.5</span> ? <span class="string">'See you again'</span> : <span class="string">'Goodbye'</span>&#125;</span>!`</span>),</span><br><span class="line">        );</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å†™è¿‡ python çš„äººåº”è¯¥ä¸ä¼šé™Œç”Ÿè¿™ç§å†™æ³•</span></span><br><span class="line"><span class="comment">// require.main === module åˆ¤æ–­è¿™ä¸ªæ¨¡å—æ˜¯ä¸æ˜¯è¢«ç›´æ¥è¿è¡Œçš„</span></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">require</span>.main === <span class="built_in">module</span>) &#123;</span><br><span class="line">    start();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>webpackHotMiddleware</code> çš„ <code>overlay</code> é€‰é¡¹æ˜¯ç”¨äºæ˜¯å¦å¼€å¯é”™è¯¯é®ç½©ï¼š</p><p><img data-src="https://i.loli.net/2020/02/20/lLQEXfwgY5khOeM.png" alt="overlay"></p><p>å¾ˆå¤šç»†èŠ‚æˆ‘éƒ½å†™åˆ°æ³¨é‡Šé‡Œé¢äº†ï¼Œå®‰è£…å…¶ä¸­ç”¨åˆ°çš„ä¸€äº›å·¥å…·åº“ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add get-port <span class="built_in">log</span>-symbols open yarg -D</span><br></pre></td></tr></table></figure><p>å‰ä¸‰ä¸ªéƒ½æ˜¯ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NpbmRyZXNvcmh1cw==" title="https://github.com/sindresorhus">sindresorhus<i class="fa fa-external-link"></i></span> å¤§ä½¬çš„ä½œå“ï¼Œ<code>get-port</code> ç”¨äºè·å–å¯ç”¨ç«¯å£ï¼Œ<code>log-symbols</code> æä¾›äº†ä¸‹é¢å››ä¸ª log å­—ç¬¦ï¼Œ<code>open</code> ç”¨äºç³»ç»Ÿåº”ç”¨æ‰“å¼€ <code>uri</code> ï¼ˆ<code>uri</code> åŒ…æ‹¬æ–‡ä»¶å’Œç½‘å€å¤§å®¶åº”è¯¥éƒ½çŸ¥é“ï¼‰, <code>yargs</code> ç”¨äºè§£æå‘½ä»¤è¡Œå‚æ•°ã€‚</p><p><img data-src="https://github.com/sindresorhus/log-symbols/raw/master/screenshot.png" alt="log-symbols"></p><p><code>webpack-dev-middleware</code> å¹¶ä¸æ”¯æŒ <code>webpack-dev-server</code> ä¸­çš„ <code>historyFallback</code> å’Œ <code>proxy</code> åŠŸèƒ½ï¼Œå…¶å®æ— æ‰€è°“ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <strong>DIY</strong> æˆ‘ä»¬çš„ express server æ¥å®ç°ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥ä½¿ç”¨ <code>express</code> æ¥é›†æˆ <code>mock</code> åŠŸèƒ½ã€‚å®‰è£…å¯¹åº”çš„ä¸¤ä¸ªä¸­é—´ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add connect-history-api-fallback http-proxy-middleware @types/connect-history-api-fallback @types/http-proxy-middleware -D</span><br></pre></td></tr></table></figure><p><code>connect-history-api-fallback</code> å¯ä»¥ç›´æ¥ä½œä¸º <code>express</code> ä¸­é—´ä»¶é›†æˆåˆ° express serverï¼Œå°è£…ä¸€ä¸‹ <code>http-proxy-middleware</code>ï¼Œå¯ä»¥åœ¨ <code>proxyTable</code> ä¸­æ·»åŠ è‡ªå·±çš„ä»£ç†é…ç½®ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createProxyMiddleware &#125; <span class="keyword">from</span> <span class="string">'http-proxy-middleware'</span>;</span><br><span class="line"><span class="keyword">import</span> chalk <span class="keyword">from</span> <span class="string">'chalk'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; Express &#125; <span class="keyword">from</span> <span class="string">'express'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Options &#125; <span class="keyword">from</span> <span class="string">'http-proxy-middleware/dist/types'</span>;</span><br><span class="line"></span><br><span class="line">interface ProxyTable &#123;</span><br><span class="line">    [path: string]: Options;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> proxyTable: ProxyTable = &#123;</span><br><span class="line">    <span class="comment">// ç¤ºä¾‹é…ç½®</span></span><br><span class="line">    <span class="string">'/path_to_be_proxy'</span>: &#123; <span class="attr">target</span>: <span class="string">'http://target.domain.com'</span>, <span class="attr">changeOrigin</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¿®é¥°é“¾æ¥çš„è¾…åŠ©å‡½æ•°, ä¿®æ”¹é¢œè‰²å¹¶æ·»åŠ ä¸‹åˆ’çº¿</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">renderLink</span>(<span class="params">str: string</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> chalk.magenta.underline(str);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">proxy</span>(<span class="params">server: Express</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">Object</span>.entries(proxyTable).forEach(<span class="function">(<span class="params">[path, options]</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">from</span> = path;</span><br><span class="line">        <span class="keyword">const</span> to = options.target <span class="keyword">as</span> string;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`proxy <span class="subst">$&#123;renderLink(<span class="keyword">from</span>)&#125;</span> <span class="subst">$&#123;chalk.green(<span class="string">'-&gt;'</span>)&#125;</span> <span class="subst">$&#123;renderLink(to)&#125;</span>`</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// eslint-disable-next-line no-param-reassign</span></span><br><span class="line">        <span class="keyword">if</span> (!options.logLevel) options.logLevel = <span class="string">'warn'</span>;</span><br><span class="line">        server.use(path, createProxyMiddleware(options));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¦‚æœéœ€è¦æ›´çµæ´»çš„å®šä¹‰æ–¹å¼ï¼Œè¯·åœ¨ä¸‹é¢ç›´æ¥ä½¿ç”¨ server.use(path, proxyMiddleware(options)) å®šä¹‰</span></span><br><span class="line">    &#125;);</span><br><span class="line">    process.stdout.write(<span class="string">'\n'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> proxy;</span><br></pre></td></tr></table></figure><p>ä¸ºäº†å¯åŠ¨ devServerï¼Œæˆ‘ä»¬è¿˜éœ€è¦å®‰è£…ä¸¤ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add ts-node cross-env -D</span><br></pre></td></tr></table></figure><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL1R5cGVTdHJvbmcvdHMtbm9kZQ==" title="https://github.com/TypeStrong/ts-node">ts-node<i class="fa fa-external-link"></i></span> å¯ä»¥è®©æˆ‘ä»¬ç›´æ¥è¿è¡Œ TypeScript ä»£ç ï¼Œ<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2tlbnRjZG9kZHMvY3Jvc3MtZW52Lw==" title="https://github.com/kentcdodds/cross-env/">cross-env<i class="fa fa-external-link"></i></span> æ˜¯ä¸€ä¸ªè·¨æ“ä½œç³»ç»Ÿçš„è®¾ç½®ç¯å¢ƒå˜é‡çš„å·¥å…·ï¼Œæ·»åŠ å¯åŠ¨å‘½ä»¤åˆ° npm scriptï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// package.json</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"scripts"</span>: &#123;</span><br><span class="line">        <span class="string">"start"</span>: <span class="string">"cross-env-shell NODE_ENV=development ts-node --files -P ./scripts/tsconfig.json ./scripts/start.ts --open"</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2tlbnRjZG9kZHMvY3Jvc3MtZW52LyNjcm9zcy1lbnYtdnMtY3Jvc3MtZW52LXNoZWxs" title="https://github.com/kentcdodds/cross-env/#cross-env-vs-cross-env-shell">cross-env<i class="fa fa-external-link"></i></span> å®˜æ–¹æ–‡æ¡£æåˆ°å¦‚æœè¦åœ¨ windows å¹³å°å¤„ç† node ä¿¡å·ä¾‹å¦‚ <code>SIGINT</code>ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ <code>ctrl + c</code> æ—¶è§¦å‘çš„ä¿¡å·åº”è¯¥ä½¿ç”¨ <code>cross-env-shell</code> å‘½ä»¤è€Œä¸æ˜¯ <code>cross-env</code> ã€‚</p><p>ts-node ä¸ºäº†æé«˜æ‰§è¡Œé€Ÿåº¦ï¼Œé»˜è®¤ä¸ä¼šè¯»å– <code>tsconfig.json</code> ä¸­çš„ <code>files</code>, <code>include</code> å’Œ <code>exclude</code> å­—æ®µï¼Œè€Œæ˜¯åŸºäºæ¨¡å—ä¾èµ–è¯»å–çš„ã€‚è¿™ä¼šå¯¼è‡´æˆ‘ä»¬åé¢å†™çš„ä¸€äº›å…¨å±€çš„ <code>.d.ts</code> æ–‡ä»¶ä¸ä¼šè¢«è¯»å–ï¼Œä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦æŒ‡å®š <code>--files</code> å‚æ•°ï¼Œè¯¦æƒ…å¯ä»¥æŸ¥çœ‹ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL1R5cGVTdHJvbmcvdHMtbm9kZSNoZWxwLW15LXR5cGVzLWFyZS1taXNzaW5n" title="https://github.com/TypeStrong/ts-node#help-my-types-are-missing">help-my-types-are-missing<i class="fa fa-external-link"></i></span>ã€‚æˆ‘ä»¬çš„ node ä»£ç å¹¶ä¸å¤šï¼Œè€Œä¸”åˆä¸æ˜¯ç»å¸¸æ€§é‡å¯é¡¹ç›®ï¼Œç›´æ¥è®© ts-node æ‰«ææ•´ä¸ª <code>scripts</code> æ–‡ä»¶å¤¹æ²¡å¤šå¤§å½±å“ã€‚</p><p>å¯åŠ¨æˆ‘ä»¬çš„ dev serverï¼Œé€šè¿‡ ctrl + c é€€å‡ºï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm start</span><br></pre></td></tr></table></figure><p><img data-src="https://i.loli.net/2020/02/16/DevliamMEKy1hTt.gif" alt="dev server"></p><h2 id="å¼€å‘ç¯å¢ƒä¼˜åŒ–"><a href="#å¼€å‘ç¯å¢ƒä¼˜åŒ–" class="headerlink" title="å¼€å‘ç¯å¢ƒä¼˜åŒ–"></a>å¼€å‘ç¯å¢ƒä¼˜åŒ–</h2><h3 id="plugins"><a href="#plugins" class="headerlink" title="plugins"></a>plugins</h3><p>æ¯ä¸ª webpack plugin éƒ½æ˜¯ä¸€ä¸ªåŒ…å« apply æ–¹æ³•çš„ classï¼Œåœ¨æˆ‘ä»¬è°ƒç”¨ <code>compiler.run</code> æˆ–è€… <code>compiler.watch</code> çš„æ—¶å€™å®ƒå°±ä¼šè¢«è°ƒç”¨ï¼Œå¹¶ä¸”æŠŠ compiler ä½œä¸ºå‚æ•°ä¼ å®ƒã€‚compiler å¯¹è±¡æä¾›äº†å„ä¸ªæ—¶æœŸçš„ hooksï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™äº› hooks æŒ‚è½½å›è°ƒå‡½æ•°æ¥å®ç°å„ç§åŠŸèƒ½ï¼Œä¾‹å¦‚å‹ç¼©ï¼Œä¼˜åŒ–ç»Ÿè®¡ä¿¡æ¯ï¼Œåœ¨åœ¨ç¼–è¯‘å®Œå¼¹ä¸ªç¼–è¯‘æˆåŠŸçš„é€šçŸ¥ç­‰ã€‚</p><p><img data-src="https://i.loli.net/2020/02/17/kqngMuoNQWj2CyG.png" alt="hooks"></p><h4 id="æ˜¾ç¤ºæ‰“åŒ…è¿›åº¦"><a href="#æ˜¾ç¤ºæ‰“åŒ…è¿›åº¦" class="headerlink" title="æ˜¾ç¤ºæ‰“åŒ…è¿›åº¦"></a>æ˜¾ç¤ºæ‰“åŒ…è¿›åº¦</h4><p><code>webpack-dev-server</code> åœ¨æ‰“åŒ…æ—¶ä½¿ç”¨ <code>--progress</code> å‚æ•°ä¼šåœ¨æ§åˆ¶å°å®æ—¶è¾“å‡ºç™¾åˆ†æ¯”è¡¨ç¤ºå½“å‰çš„æ‰“åŒ…è¿›åº¦ï¼Œä½†æ˜¯ä»ä¸Šé¢çš„å›¾ä¸­å¯ä»¥çœ‹å‡ºåªæ˜¯è¾“å‡ºäº†ä¸€äº›ç»Ÿè®¡ä¿¡æ¯ï¼ˆstatsï¼‰ã€‚æƒ³è¦å®æ—¶æ˜¾ç¤ºæ‰“åŒ…è¿›åº¦æˆ‘äº†è§£çš„æœ‰ä¸‰ç§æ–¹å¼ï¼š</p><ol><li><p>webpack å†…ç½®çš„ <span class="exturl" data-url="aHR0cHM6Ly93ZWJwYWNrLmRvY3NjaGluYS5vcmcvcGx1Z2lucy9wcm9ncmVzcy1wbHVnaW4=" title="https://webpack.docschina.org/plugins/progress-plugin">webpack.ProgressPlugin<i class="fa fa-external-link"></i></span> æ’ä»¶</p></li><li><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2NsZXNzZy9wcm9ncmVzcy1iYXItd2VicGFjay1wbHVnaW4=" title="https://github.com/clessg/progress-bar-webpack-plugin">progress-bar-webpack-plugin<i class="fa fa-external-link"></i></span></p></li><li><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL251eHQvd2VicGFja2Jhcg==" title="https://github.com/nuxt/webpackbar">webpackbar<i class="fa fa-external-link"></i></span></p></li></ol><p>å†…ç½®çš„ <code>ProgressPlugig</code> éå¸¸çš„åŸå§‹ï¼Œä½ å¯ä»¥åœ¨å›è°ƒå‡½æ•°è·å–å½“å‰è¿›åº¦ï¼Œç„¶åæŒ‰ç…§è‡ªå·±å–œæ¬¢çš„æ ¼å¼å»æ‰“å°ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> handler = <span class="function">(<span class="params">percentage, message, ...args</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// e.g. Output each progress message directly to the console:</span></span><br><span class="line">  <span class="built_in">console</span>.info(percentage, message, ...args);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">new</span> webpack.ProgressPlugin(handler);</span><br></pre></td></tr></table></figure><p><code>progress-bar-webpack-plugin</code> è¿™ä¸ªæ’ä»¶ä¸æ˜¯æ˜¾ç¤ºç™¾åˆ†æ¯”ï¼Œè€Œæ˜¯æ˜¾ç¤ºä¸€ä¸ªç”¨å­—ç¬¦ç”»å‡ºæ¥çš„è¿›åº¦æ¡ï¼š</p><p><img data-src="https://camo.githubusercontent.com/cb9c82719765ad966a2771f084175c9ec935124e/687474703a2f2f692e696d6775722e636f6d2f4f495031676e6a2e676966" alt="progress-bar-webpack-plugin"></p><p>è¿™ä¸ªæ’ä»¶å…¶å®è¿˜æ˜¯æŒºç®€æ´å®ç”¨çš„ï¼Œä½†æ˜¯æœ‰ä¸ª bug ï¼Œå¦‚æœåœ¨æ‰“å°è¿›åº¦æ¡çš„æ—¶å€™è¾“å‡ºäº†å…¶å®ƒè¯­å¥ï¼Œè¿›åº¦æ¡å°±ä¼šé”™ä½ï¼Œæˆ‘ä»¬çš„ devServer ä¼šåœ¨å¯åŠ¨åä¼šè¾“å‡ºåœ°å€ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">`DevServer is running at <span class="subst">$&#123;chalk.magenta.underline(address)&#125;</span> <span class="subst">$&#123;logSymbols.success&#125;</span>`</span>);</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨è¿™ä¸ªè¿›åº¦æ¡æ’ä»¶å°±ä¼šå‡ºé—®é¢˜ä¸‹é¢çš„é—®é¢˜ï¼Œé‚æ”¾å¼ƒã€‚</p><p><img data-src="https://i.loli.net/2020/02/16/MvEgi4sw7WkjbnT.png" alt="progress-bar-webpack-plugin"></p><p><code>webpackbar</code> æ˜¯ nuxt é¡¹ç›®ä¸‹çš„åº“ï¼ŒèƒŒé  <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL251eHQ=" title="https://github.com/nuxt">nuxt<i class="fa fa-external-link"></i></span>ï¼Œè´¨é‡ç»å¯¹æœ‰ä¿è¯ã€‚æˆ‘ä¹‹å‰æœ‰æ®µæ—¶é—´ç”¨çš„æ˜¯ <code>progress-bar-webpack-plugin</code>ï¼Œå› ä¸ºæˆ‘åœ¨ npm å®˜ç½‘æœç´¢ <code>webpack progress</code>ï¼Œç»¼åˆçœ‹ä¸‹æ¥å°±å®ƒæ¯”è¾ƒé è°±ï¼Œ<code>webpackbar</code> éƒ½æ²¡æœå‡ºæ¥ã€‚ çœ‹äº†ä¸‹ <code>webpackbar</code> çš„ <code>package.json</code>ï¼Œæœç„¶ <code>keywords</code> éƒ½æ˜¯ç©ºçš„ã€‚<code>webpackBar</code> è¿˜æ˜¯æˆ‘åœ¨ç ”ç©¶ <code>ant design</code> çš„ webpack é…ç½®çœ‹åˆ°å®ƒç”¨äº†è¿™ä¸ªæ’ä»¶ï¼Œæ‰å‘ç°äº†è¿™ä¸ªå®è—ï¼š</p><p><img data-src="https://i.loli.net/2020/02/19/MGDZLJBcK2yToN6.png" alt="webpackbar"></p><p>å®‰è£… <code>webpackbar</code>ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add webpackbar @types/webpackbar -D</span><br></pre></td></tr></table></figure><p>æ·»åŠ é…ç½®åˆ° <code>webpack.common.ts</code> çš„ plugins æ•°ç»„ï¼Œé¢œè‰²æˆ‘ä»¬ä½¿ç”¨ react è“ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Configuration &#125; <span class="keyword">from</span> <span class="string">'webpack'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> commonConfig: Configuration = &#123;</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> WebpackBar(&#123;</span><br><span class="line">      name: <span class="string">'react-typescript-boilerplate'</span>,</span><br><span class="line">      <span class="comment">// react è“</span></span><br><span class="line">      color: <span class="string">'#61dafb'</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="æ·»åŠ ç‰ˆæƒå£°æ˜"><a href="#æ·»åŠ ç‰ˆæƒå£°æ˜" class="headerlink" title="æ·»åŠ ç‰ˆæƒå£°æ˜"></a>æ·»åŠ ç‰ˆæƒå£°æ˜</h4><p>è¿™ä¸ªç›´æ¥ç”¨ webpack å†…ç½®çš„ <code>BannerPlugin</code> å³å¯:</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; BannerPlugin, Configuration &#125; <span class="keyword">from</span> <span class="string">'webpack'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> commonConfig: Configuration = &#123;</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> BannerPlugin(&#123;</span><br><span class="line">      raw: <span class="literal">true</span>,</span><br><span class="line">      banner: <span class="string">`/** @preserve Powered by react-typescript-boilerplate (https://github.com/tjx666/react-typescript-boilerplate) */`</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><img data-src="https://i.loli.net/2020/02/20/DusmAYnTV2JL4Xv.png" alt="copyright"></p><p>éœ€è¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬åœ¨ç‰ˆæƒå£°æ˜çš„æ³¨é‡Šä¸­åŠ äº† <code>@preserve</code> æ ‡è®°ï¼Œæˆ‘ä»¬åé¢ä¼šä½¿ç”¨ <code>terser</code> åœ¨ç”Ÿäº§ç¯å¢ƒæ„å»ºæ—¶å‹ç¼©ä»£ç ï¼Œå‹ç¼©ä»£ç æ—¶ä¼šå»æ‰æ‰€æœ‰æ³¨é‡Šï¼Œé™¤äº†ä¸€äº›åŒ…å«ç‰¹æ®Šæ ‡è®°çš„æ³¨é‡Šï¼Œä¾‹å¦‚æˆ‘ä»¬æ·»åŠ çš„ <code>@preserve</code>ã€‚</p><h4 id="ä¼˜åŒ–æ§åˆ¶å°è¾“å‡º"><a href="#ä¼˜åŒ–æ§åˆ¶å°è¾“å‡º" class="headerlink" title="ä¼˜åŒ–æ§åˆ¶å°è¾“å‡º"></a>ä¼˜åŒ–æ§åˆ¶å°è¾“å‡º</h4><p>æˆ‘ä»¬ä½¿ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2dlb3dhcmluL2ZyaWVuZGx5LWVycm9ycy13ZWJwYWNrLXBsdWdpbg==" title="https://github.com/geowarin/friendly-errors-webpack-plugin">friendly-errors-webpack-plugin<i class="fa fa-external-link"></i></span> æ’ä»¶è®©æ§åˆ¶å°çš„è¾“å‡ºæ›´åŠ å‹å¥½ï¼Œä¸‹é¢ä½¿ç”¨äº†ä¹‹åç¼–è¯‘æˆåŠŸæ—¶çš„æ•ˆæœï¼š</p><p><img data-src="https://i.loli.net/2020/02/19/bj9hRKeUBMG1Hmv.png" alt="build successful"></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add friendly-errors-webpack-plugin @types/friendly-errors-webpack-plugin -D</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.common.ts</span></span><br><span class="line"><span class="keyword">import</span> FriendlyErrorsPlugin <span class="keyword">from</span> <span class="string">'friendly-errors-webpack-plugin'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> commonConfig: Configuration = &#123;</span><br><span class="line">  plugins: [<span class="keyword">new</span> FriendlyErrorsPlugin()],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="æ„å»ºé€šçŸ¥"><a href="#æ„å»ºé€šçŸ¥" class="headerlink" title="æ„å»ºé€šçŸ¥"></a>æ„å»ºé€šçŸ¥</h4><p><img data-src="https://i.loli.net/2020/02/19/wsWuPkh3x9GlL4a.png" alt="build notification"></p><p>åœ¨æˆ‘å¤§å››å®ä¹ ä¹‹å‰ï¼Œæˆ‘å°±æ²¡å®Œæ•´å†™è¿‡ vue é¡¹ç›®çš„ï¼Œåœ¨ä¸Šå®¶å…¬å¸å®ä¹ çš„é‚£æ®µæ—¶é—´ä¸»è¦å°±æ˜¯å†™ vueï¼Œå½“æ—¶æˆ‘å¯¹ vue-cli é‚£ä¸ªé¢‘ç¹çš„é”™è¯¯é€šçŸ¥å¾ˆåæ„Ÿï¼Œæˆ‘å’ŒåŒäº‹è¯´æˆ‘æƒ³å»æ‰è¿™ä¸ªé€šçŸ¥ï¼Œæ²¡æ›¾æƒ³åŒäº‹éƒ½æ˜¯æ¯”è¾ƒå–œæ¬¢é‚£ä¸ªé€šçŸ¥ï¼Œæ—¢ç„¶æœ‰äººéœ€è¦ï¼Œé‚£æˆ‘ä»¬è¿™ä¸ªé¡¹ç›®ä¹Ÿé…ä¸€ä¸‹ã€‚</p><p>æˆ‘ä»¬ä½¿ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL1JvY2NvQy93ZWJwYWNrLWJ1aWxkLW5vdGlmaWVy" title="https://github.com/RoccoC/webpack-build-notifier">webpack-build-notifier<i class="fa fa-external-link"></i></span> æ¥æ”¯æŒé”™è¯¯é€šçŸ¥ï¼Œè¿™ä¸ªæ’ä»¶æ˜¯ TypeScript å†™çš„ï¼Œä¸éœ€è¦å®‰è£… typesï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add webpack-build-notifier -D</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.common.ts</span></span><br><span class="line"><span class="keyword">import</span> WebpackBuildNotifierPlugin <span class="keyword">from</span> <span class="string">'webpack-build-notifier'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> commonConfig: Configuration = &#123;</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="comment">// suppressSuccess: true è®¾ç½®åªåœ¨ç¬¬ä¸€æ¬¡ç¼–è¯‘æˆåŠŸæ—¶è¾“å‡ºæˆåŠŸçš„é€šçŸ¥, rebuild æˆåŠŸçš„æ—¶å€™ä¸é€šçŸ¥</span></span><br><span class="line">    <span class="keyword">new</span> WebpackBuildNotifierPlugin(&#123; <span class="attr">suppressSuccess</span>: <span class="literal">true</span> &#125;),</span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><blockquote><p>å› ä¸ºæˆ‘ä¸å–œæ¬¢å¼¹é€šçŸ¥ï¼Œæ‰€ä»¥æ¨¡æ¿é¡¹ç›®ä¸­çš„æˆ‘æ³¨é‡Šæ‰äº†è¿™ä¸ªæ’ä»¶ï¼Œæœ‰éœ€è¦çš„è‡ªå·±æ‰“å¼€å°±è¡Œäº†ã€‚</p></blockquote><h4 id="ä¸¥æ ¼æ£€æŸ¥è·¯å¾„å¤§å°å†™"><a href="#ä¸¥æ ¼æ£€æŸ¥è·¯å¾„å¤§å°å†™" class="headerlink" title="ä¸¥æ ¼æ£€æŸ¥è·¯å¾„å¤§å°å†™"></a>ä¸¥æ ¼æ£€æŸ¥è·¯å¾„å¤§å°å†™</h4><p>ä¸‹é¢çš„æµ‹è¯•è¡¨æ˜ webpack é»˜è®¤å¯¹è·¯å¾„çš„å¤§å°å†™ä¸æ•æ„Ÿï¼š</p><p><img data-src="https://i.loli.net/2020/02/16/czN2UDhGiXb3TJ5.png" alt="path case"></p><p>æˆ‘ä»¬ä½¿ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL1VydGhlbi9jYXNlLXNlbnNpdGl2ZS1wYXRocy13ZWJwYWNrLXBsdWdpbg==" title="https://github.com/Urthen/case-sensitive-paths-webpack-plugin">case-sensitive-paths-webpack-plugin<i class="fa fa-external-link"></i></span> å¯¹è·¯å¾„è¿›è¡Œä¸¥æ ¼çš„å¤§å°å†™æ£€æŸ¥ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add <span class="keyword">case</span>-sensitive-paths-webpack-plugin @types/<span class="keyword">case</span>-sensitive-paths-webpack-plugin -D</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.common.ts</span></span><br><span class="line"><span class="keyword">import</span> CaseSensitivePathsPlugin <span class="keyword">from</span> <span class="string">'case-sensitive-paths-webpack-plugin'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> commonConfig: Configuration = &#123;</span><br><span class="line">  plugins: [<span class="keyword">new</span> CaseSensitivePathsPlugin()],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><img data-src="https://i.loli.net/2020/02/16/FWdazBElvG8Mq4U.png" alt="path-case-check"></p><h4 id="å¾ªç¯ä¾èµ–æ£€æŸ¥"><a href="#å¾ªç¯ä¾èµ–æ£€æŸ¥" class="headerlink" title="å¾ªç¯ä¾èµ–æ£€æŸ¥"></a>å¾ªç¯ä¾èµ–æ£€æŸ¥</h4><p><img data-src="https://i.loli.net/2020/02/16/bHQEPLK1WiCXlBA.png" alt="circle-dependencies"></p><p>webpack é»˜è®¤ä¸ä¼šå¯¹å¾ªç¯ä¾èµ–æŠ¥é”™ï¼Œé€šè¿‡ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FhY2tlcm1hbi9jaXJjdWxhci1kZXBlbmRlbmN5LXBsdWdpbg==" title="https://github.com/aackerman/circular-dependency-plugin">circular-dependency-plugin <i class="fa fa-external-link"></i></span>è¿™ä¸ª webpack æ’ä»¶å¯ä»¥å¸®æˆ‘ä»¬åŠæ—¶å‘ç°å¾ªç¯ä¾èµ–çš„é—®é¢˜ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add circular-dependency-plugin @types/circular-dependency-plugin -D</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.common.ts</span></span><br><span class="line"><span class="keyword">import</span> CircularDependencyPlugin <span class="keyword">from</span> <span class="string">'circular-dependency-plugin'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; projectRoot, resolvePath &#125; <span class="keyword">from</span> <span class="string">'../env'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> commonConfig: Configuration = &#123;</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> CircularDependencyPlugin(&#123;</span><br><span class="line">      exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">      failOnError: <span class="literal">true</span>,</span><br><span class="line">      allowAsyncCycles: <span class="literal">false</span>,</span><br><span class="line">      cwd: projectRoot,</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><img data-src="https://i.loli.net/2020/02/16/VOxjym6zZFftkhr.png" alt="circle dependencies error"></p><p>è¿™é‡Œé¡ºä¾¿æä¸€ä¸‹ <code>cwd</code> ä¹Ÿå°±æ˜¯å·¥ä½œè·¯å¾„çš„é—®é¢˜ï¼Œå®˜æ–¹æ–‡æ¡£ç›´æ¥ç”¨ <code>process.cwd()</code>ï¼Œè¿™æ˜¯ä¸€ç§ä¸å¥½çš„åšæ³•ï¼Œé¡¹ç›®è·¯å¾„å’Œå·¥ä½œè·¯å¾„æ˜¯ä¸åŒçš„ä¸¤ä¸ªæ¦‚å¿µã€‚åœ¨ node ä¸­è¡¨ç¤ºé¡¹ç›®è·¯å¾„æ°¸è¿œä¸è¦ç”¨ <code>preocess.cwd()</code>ï¼Œå› ä¸ºæ€»ä¼šæœ‰äº›æ²™é›•ç”¨æˆ·ä¸å»é¡¹ç›®æ ¹ç›®å½•å¯åŠ¨ã€‚<code>process.cwd()</code> ä¹Ÿå°±æ˜¯å·¥ä½œè·¯å¾„è¿”å›çš„æ˜¯ä½ è¿è¡Œ node æ—¶æ‰€åœ¨çš„è·¯å¾„ï¼Œå‡è®¾è¯´é¡¹ç›®åœ¨ <code>/code/projectRoot</code>ï¼Œæœ‰äº›ç”¨æˆ·ç›´æ¥åœ¨ç³»ç»Ÿæ ¹ç›®å½•æ‰“å¼€ terminalï¼Œæ¥ä¸€å¥ <code>node ./code/projectRoot/index.js</code>ï¼Œè¿™æ—¶ <code>index.js</code> ä¸­ <code>process.cwd()</code> è¿”å›çš„æ˜¯å°±æ˜¯ç³»ç»Ÿæ ¹è·¯å¾„ <code>/</code>ï¼Œä¸æ˜¯æœ‰äº›äººè®¤ä¸ºçš„è¿˜æ˜¯ <code>/code/projectRoot</code>ã€‚</p><p>è·å–é¡¹ç›®è·¯å¾„åº”è¯¥ä½¿ç”¨ <code>path.resolve</code>ï¼š</p><p><img data-src="https://i.loli.net/2020/02/19/4wW75dVszApkQGe.png" alt="project root"></p><h4 id="æ¸…ç†ä¸Šæ¬¡æ‰“åŒ…çš„-bundle"><a href="#æ¸…ç†ä¸Šæ¬¡æ‰“åŒ…çš„-bundle" class="headerlink" title="æ¸…ç†ä¸Šæ¬¡æ‰“åŒ…çš„ bundle"></a>æ¸…ç†ä¸Šæ¬¡æ‰“åŒ…çš„ bundle</h4><p>å‰é¢ä»‹ç»äº†ä¸€äº›èŠ±é‡Œèƒ¡å“¨çš„æ’ä»¶ï¼Œä¹Ÿä»‹ç»äº†ä¸€äº›è®©æˆ‘ä»¬é¡¹ç›®ä¿æŒå¥åº·çš„æ’ä»¶ï¼Œç°åœ¨æˆ‘ä»¬å¼€å§‹ä»‹ç»ä¸€äº›æ‰“åŒ…ç”¨çš„æ’ä»¶ã€‚</p><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2pvaG5hZ2FuL2NsZWFuLXdlYnBhY2stcGx1Z2lu" title="https://github.com/johnagan/clean-webpack-plugin">clean-webpack-plugin<i class="fa fa-external-link"></i></span> å®ƒä¼šåœ¨ç¬¬ä¸€æ¬¡ç¼–è¯‘çš„æ—¶å€™åˆ é™¤ <code>dist</code> ç›®å½•ä¸­æ‰€æœ‰çš„æ–‡ä»¶ï¼Œä¸è¿‡ä¼šä¿ç•™ <code>dist</code> æ–‡ä»¶å¤¹ï¼Œå¹¶ä¸”å†æ¯æ¬¡ <code>rebuild</code> çš„æ—¶å€™ä¼šåˆ é™¤æ‰€æœ‰ä¸å†è¢«ä½¿ç”¨çš„æ–‡ä»¶ã€‚</p><p>è¿™ä¸ªé¡¹ç›®ä¹Ÿæ˜¯ TypeScript å†™çš„ï¼Œæ€»æ„Ÿè§‰ TypeScript å†™çš„é¡¹ç›®æœ‰ç§è«åçš„è¸å®æ„Ÿï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add clean-webpack-plugin -D</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.common.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; CleanWebpackPlugin &#125; <span class="keyword">from</span> <span class="string">'clean-webpack-plugin'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> commonConfig: Configuration = &#123;</span><br><span class="line">  plugins: [<span class="keyword">new</span> CleanWebpackPlugin()],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="è‡ªåŠ¨ç”Ÿæˆ-index-html"><a href="#è‡ªåŠ¨ç”Ÿæˆ-index-html" class="headerlink" title="è‡ªåŠ¨ç”Ÿæˆ index.html"></a>è‡ªåŠ¨ç”Ÿæˆ index.html</h4><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œè…¾è®¯çš„å‰ç«¯é¢è¯•å¾ˆå–œæ¬¢è€ƒè®¡ç®—æœºç½‘ç»œï¼Œæˆ‘æ›¾å¤šæ¬¡è¢«é—®åˆ°è¿‡å¦‚ä½•æ›´æ–°å¼ºç¼“å­˜çš„é—®é¢˜ã€‚è§£å†³å¼ºç¼“å­˜ç«‹å³æ›´æ–°çš„é—®é¢˜æˆ‘ä»¬ä¸€èˆ¬å°±æ˜¯é‡‡å–åœ¨æ–‡ä»¶åä¸­æ’å…¥æ–‡ä»¶å†…å®¹çš„ hash å€¼ï¼Œç„¶åé¦–é¡µä¸ä½¿ç”¨å¼ºç¼“å­˜ã€‚è¿™æ ·åªè¦ä½ æ›´æ–°äº†æŸä¸ªè¢«å¼ºç¼“å­˜çš„èµ„æºæ–‡ä»¶ï¼Œç”±äºæ›´æ–°åå†…å®¹çš„ hash å€¼ä¼šå˜åŒ–ï¼Œç”Ÿæˆçš„æ–‡ä»¶åä¹Ÿä¼šå˜åŒ–ï¼Œè¿™æ ·ä½ è¯·æ±‚é¦–é¡µçš„æ—¶å€™ç”±äºè®¿é—®çš„æ˜¯ä¸€ä¸ªæ–°çš„èµ„æºè·¯å¾„ï¼Œå°±ä¼šå‘æœåŠ¡å™¨è¯·æ±‚æœ€æ–°çš„èµ„æºã€‚å…³äºæµè§ˆå™¨ HTTP ç¼“å­˜å¯ä»¥çœ‹æˆ‘å¦ä¸€ç¯‡æ–‡ç« ï¼š<a href="https://lyreal666.com/é€šè¿‡-koa2-æœåŠ¡å™¨å®è·µæ¢ç©¶æµè§ˆå™¨HTTPç¼“å­˜æœºåˆ¶/">é€šè¿‡-koa2-æœåŠ¡å™¨å®è·µæ¢ç©¶æµè§ˆå™¨ HTTP ç¼“å­˜æœºåˆ¶</a>ã€‚</p><p>æˆ‘ä»¬åç»­ä¼˜åŒ–ç”Ÿäº§ç¯å¢ƒæ„å»ºçš„æ—¶å€™ä¼šå¯¹å°† CSS æ‹†åˆ†æˆå•ç‹¬çš„æ–‡ä»¶ï¼Œå¦‚æœ index.html ä¸­æ’å…¥çš„å¼•å…¥å¤–éƒ¨æ ·å¼çš„ <code>link</code> æ ‡ç­¾çš„ <code>href</code> æ˜¯æˆ‘ä»¬æ‰‹åŠ¨è®¾ç½®çš„ï¼Œé‚£æ¯æ¬¡ä¿®æ”¹æ ·å¼æ–‡ä»¶ï¼Œéƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„ hash å€¼ï¼Œæˆ‘ä»¬éƒ½è¦æ‰‹åŠ¨å»ä¿®æ”¹è¿™ä¸ªè·¯å¾„ï¼Œå¤ªéº»çƒ¦äº†ï¼Œæ›´ä¸è¦è¯´åœ¨å¼€å‘ç¯å¢ƒä¸‹æ–‡ä»¶æ˜¯ä¿å­˜åœ¨å†…å­˜æ–‡ä»¶ç³»ç»Ÿçš„ï¼Œä½ éƒ½çœ‹ä¸åˆ°æ–‡ä»¶åã€‚</p><p><img data-src="https://i.loli.net/2020/02/19/8OnBuWedj5z2CFP.png" alt="build hash"></p><p>ä½¿ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2phbnRpbW9uL2h0bWwtd2VicGFjay1wbHVnaW4=" title="https://github.com/jantimon/html-webpack-plugin">html-webpack-plugin<i class="fa fa-external-link"></i></span> å¯ä»¥è‡ªåŠ¨ç”Ÿæˆ index.htmlï¼Œå¹¶ä¸”æ’å…¥å¼•ç”¨åˆ°çš„ bundle å’Œè¢«æ‹†åˆ†çš„ CSS ç­‰èµ„æºè·¯å¾„ã€‚</p><p>å‚è€ƒ <code>creat-react-app</code> çš„æ¨¡æ¿ï¼Œæˆ‘ä»¬æ–°å»º <code>public</code> æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨å…¶ä¸­åŠ å…¥ <code>index.html</code>ï¼Œ<code>favico.ico</code>ï¼Œ<code>manifest.json</code> ç­‰æ–‡ä»¶ã€‚<code>public</code> æ–‡ä»¶å¤¹ç”¨äºå­˜æ”¾ä¸€äº›å°†è¢«æ‰“åŒ…åˆ° <code>dist</code> æ–‡ä»¶å¤¹ä¸€åŒå‘å¸ƒçš„æ–‡ä»¶ã€‚</p><p>å®‰è£…å¹¶é…ç½® <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2phbnRpbW9uL2h0bWwtd2VicGFjay1wbHVnaW4=" title="https://github.com/jantimon/html-webpack-plugin">html-webpack-plugin<i class="fa fa-external-link"></i></span>ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add html-webpack-plugin @types/html-webpack-plugin -D</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> HtmlWebpackPlugin <span class="keyword">from</span> <span class="string">'html-webpack-plugin'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; __DEV__, projectName, resolvePath, projectRoot, hmrPath &#125; <span class="keyword">from</span> <span class="string">'../env'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> htmlMinifyOptions: HtmlMinifierOptions = &#123;</span><br><span class="line">    collapseWhitespace: <span class="literal">true</span>,</span><br><span class="line">    collapseBooleanAttributes: <span class="literal">true</span>,</span><br><span class="line">    collapseInlineTagWhitespace: <span class="literal">true</span>,</span><br><span class="line">    removeComments: <span class="literal">true</span>,</span><br><span class="line">    removeRedundantAttributes: <span class="literal">true</span>,</span><br><span class="line">    removeScriptTypeAttributes: <span class="literal">true</span>,</span><br><span class="line">    removeStyleLinkTypeAttributes: <span class="literal">true</span>,</span><br><span class="line">    minifyCSS: <span class="literal">true</span>,</span><br><span class="line">    minifyJS: <span class="literal">true</span>,</span><br><span class="line">    minifyURLs: <span class="literal">true</span>,</span><br><span class="line">    useShortDoctype: <span class="literal">true</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> commonConfig: Configuration = &#123;</span><br><span class="line">    output: &#123;</span><br><span class="line">        publicPath: <span class="string">'/'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">            <span class="comment">// HtmlWebpackPlugin ä¼šè°ƒç”¨ HtmlMinifier å¯¹ HTMl æ–‡ä»¶è¿›è¡Œå‹ç¼©</span></span><br><span class="line">            <span class="comment">// åªåœ¨ç”Ÿäº§ç¯å¢ƒå‹ç¼©</span></span><br><span class="line">            minify: __DEV__ ? <span class="literal">false</span> : htmlMinifyOptions,</span><br><span class="line">            <span class="comment">// æŒ‡å®š html æ¨¡æ¿è·¯å¾„</span></span><br><span class="line">            template: resolvePath(projectRoot, <span class="string">'./public/index.html'</span>),</span><br><span class="line">            <span class="comment">// ç±»å‹ä¸å¥½å®šä¹‰ï¼Œany ä¸€æ—¶çˆ½...</span></span><br><span class="line">            <span class="comment">// å®šä¹‰ä¸€äº›å¯ä»¥åœ¨æ¨¡æ¿ä¸­è®¿é—®çš„æ¨¡æ¿å‚æ•°</span></span><br><span class="line">            templateParameters: <span class="function">(<span class="params">...args: any[]</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">const</span> [compilation, assets, assetTags, options] = args;</span><br><span class="line">                <span class="keyword">const</span> rawPublicPath = commonConfig.output!.publicPath!;</span><br><span class="line">                <span class="keyword">return</span> &#123;</span><br><span class="line">                    compilation,</span><br><span class="line">                    webpackConfig: compilation.options,</span><br><span class="line">                    htmlWebpackPlugin: &#123;</span><br><span class="line">                        tags: assetTags,</span><br><span class="line">                        files: assets,</span><br><span class="line">                        options,</span><br><span class="line">                    &#125;,</span><br><span class="line">        			<span class="comment">// é™¤æ‰ publicPath çš„åæ–œæ ï¼Œè®©ç”¨æˆ·åœ¨æ¨¡æ¿ä¸­æ‹¼æ¥è·¯å¾„æ›´è‡ªç„¶</span></span><br><span class="line">                    PUBLIC_PATH: rawPublicPath.endsWith(<span class="string">'/'</span>)</span><br><span class="line">                        ? rawPublicPath.slice(<span class="number">0</span>, <span class="number">-1</span>)</span><br><span class="line">                        : rawPublicPath,</span><br><span class="line">                &#125;;</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;),</span><br><span class="line">    ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ä¸ºäº†è®©ç”¨æˆ·å¯ä»¥åƒ <code>create-react-app</code> ä¸€æ ·åœ¨ <code>index.html</code> é‡Œé¢é€šè¿‡ <code>PUBLIC_PATH</code> è®¿é—®å‘å¸ƒè·¯å¾„ï¼Œéœ€è¦é…ç½® <code>templateParameters</code> é€‰é¡¹æ·»åŠ  <code>PUBLIC_PATH</code> å˜é‡åˆ°æ¨¡æ¿å‚æ•°ï¼Œ<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2phbnRpbW9uL2h0bWwtd2VicGFjay1wbHVnaW4=" title="https://github.com/jantimon/html-webpack-plugin">html-webpack-plugin<i class="fa fa-external-link"></i></span> é»˜è®¤æ”¯æŒéƒ¨åˆ† ejs è¯­æ³•ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹å¼åŠ¨æ€è®¾ç½® <code>favicon.ico</code> , <code>mainfest.json</code> ç­‰èµ„æºè·¯å¾„ï¼š</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"icon"</span> <span class="attr">href</span>=<span class="string">"&lt;%= `$&#123;PUBLIC_PATH&#125;/favicon.ico` %&gt;"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"apple-touch-icon"</span> <span class="attr">href</span>=<span class="string">"&lt;%= `$&#123;PUBLIC_PATH&#125;/logo192.png` %&gt;"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"manifest"</span> <span class="attr">href</span>=<span class="string">"&lt;%= `$&#123;PUBLIC_PATH&#125;/manifest.json` %&gt;"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>React App<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">noscript</span>&gt;</span>You need to enable JavaScript to run this app.<span class="tag">&lt;/<span class="name">noscript</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="æ‹·è´æ–‡ä»¶åˆ°-dist"><a href="#æ‹·è´æ–‡ä»¶åˆ°-dist" class="headerlink" title="æ‹·è´æ–‡ä»¶åˆ° dist"></a>æ‹·è´æ–‡ä»¶åˆ° dist</h4><p><code>public</code> æ–‡ä»¶å¤¹ä¸­æœ‰ä¸€äº›æ–‡ä»¶ä¾‹å¦‚ <code>favico.icon</code> å’Œ <code>mainfest.json</code> éœ€è¦è¢«æ‹·è´åˆ° <code>dist</code> æ–‡ä»¶å¤¹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3dlYnBhY2stY29udHJpYi9jb3B5LXdlYnBhY2stcGx1Z2lu" title="https://github.com/webpack-contrib/copy-webpack-plugin">copy-webpack-plugin<i class="fa fa-external-link"></i></span> åœ¨ä½¿ç”¨ devServer çš„æƒ…å†µä¸‹å°†æ–‡ä»¶æ‹·è´åˆ°å†…å­˜æ–‡ä»¶ç³»ç»Ÿï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒæ„å»ºçš„æ—¶æ‹·è´åˆ°ç£ç›˜ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add copy-webpack-plugin @types/copy-webpack-plugin -D</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.common.ts</span></span><br><span class="line"><span class="keyword">import</span> CopyPlugin <span class="keyword">from</span> <span class="string">'copy-webpack-plugin'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> commonConfig: Configuration = &#123;</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> CopyPlugin(</span><br><span class="line">      [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="comment">// æ‰€æœ‰ä¸€çº§æ–‡ä»¶</span></span><br><span class="line">          <span class="keyword">from</span>: <span class="string">'*'</span>,</span><br><span class="line">          to: resolvePath(projectRoot, <span class="string">'./dist'</span>),</span><br><span class="line">          <span class="comment">// ç›®æ ‡ç±»å‹æ˜¯æ–‡ä»¶å¤¹</span></span><br><span class="line">          toType: <span class="string">'dir'</span>,</span><br><span class="line">          <span class="comment">// index.html ä¼šé€šè¿‡ html-webpack-plugin è‡ªåŠ¨ç”Ÿæˆï¼Œæ‰€ä»¥éœ€è¦è¢«å¿½ç•¥æ‰</span></span><br><span class="line">          ignore: [<span class="string">'index.html'</span>],</span><br><span class="line">        &#125;,</span><br><span class="line">      ],</span><br><span class="line">      &#123; <span class="attr">context</span>: resolvePath(projectRoot, <span class="string">'./public'</span>) &#125;</span><br><span class="line">    ),</span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="æ£€æŸ¥-TypeScript-ç±»å‹"><a href="#æ£€æŸ¥-TypeScript-ç±»å‹" class="headerlink" title="æ£€æŸ¥ TypeScript ç±»å‹"></a>æ£€æŸ¥ TypeScript ç±»å‹</h4><p>babel ä¸ºäº†æé«˜ç¼–è¯‘é€Ÿåº¦åªæ”¯æŒ TypeScript è¯­æ³•ç¼–è¯‘è€Œä¸æ”¯æŒç±»å‹æ£€æŸ¥ï¼Œä¸ºäº†åœ¨ webpack æ‰“åŒ…çš„åŒæ—¶æ”¯æŒ ts ç±»å‹æ£€æŸ¥ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨ webpack æ’ä»¶ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL1R5cGVTdHJvbmcvZm9yay10cy1jaGVja2VyLXdlYnBhY2stcGx1Z2lu" title="https://github.com/TypeStrong/fork-ts-checker-webpack-plugin">fork-ts-checker-webpack-plugin<i class="fa fa-external-link"></i></span>ï¼Œè¿™ä¸ª webpack æ’ä»¶ä¼šåœ¨ä¸€ä¸ªå•ç‹¬çš„è¿›ç¨‹å¹¶è¡Œçš„è¿›è¡Œ TypeScript çš„ç±»å‹æ£€æŸ¥ï¼Œè¿™ä¸ªé¡¹ç›®ä¹Ÿæ˜¯ TypeScript å†™çš„ï¼Œæˆ‘ä»¬ä¸éœ€è¦å®‰è£… typesã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add fork-ts-checker-webpack-plugin -D</span><br></pre></td></tr></table></figure><p>æ·»åŠ åˆ° <code>webpack.dev.ts</code>ï¼Œé™åˆ¶ä½¿ç”¨çš„å†…å­˜ä¸º 1Gï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> ForkTsCheckerWebpackPlugin <span class="keyword">from</span> <span class="string">'fork-ts-checker-webpack-plugin'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> devConfig = merge(commonConfig, &#123;</span><br><span class="line">  mode: <span class="string">'development'</span>,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> ForkTsCheckerWebpackPlugin(&#123;</span><br><span class="line">      memoryLimit: <span class="number">1024</span>,</span><br><span class="line">      <span class="comment">// babel è½¬æ¢çš„æ˜¯æˆ‘ä»¬å‰ç«¯ä»£ç ï¼Œæ‰€ä»¥æ˜¯æŒ‡å‘å‰ç«¯ä»£ç çš„ tsconfig.json</span></span><br><span class="line">      tsconfig: resolvePath(projectRoot, <span class="string">'./src/tsconfig.json'</span>),</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>åŒæ—¶ä¿®æ”¹ <code>webpack.prod.ts</code>ï¼Œå› ä¸ºæˆ‘ä»¬ç”Ÿäº§ç¯å¢ƒæ„å»ºå¹¶ä¸ä¼šé•¿æ—¶é—´çš„å ç”¨å†…å­˜ï¼Œæ‰€ä»¥å¯ä»¥è°ƒå¤§ç‚¹ï¼Œæˆ‘ä»¬å°±é»˜è®¤é™åˆ¶ç”Ÿäº§ç¯å¢ƒçš„æ„å»ºä½¿ç”¨çš„å†…å­˜ä¸º 2Gï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.prod.ts</span></span><br><span class="line"><span class="keyword">const</span> prodConfig = merge(commonConfig, &#123;</span><br><span class="line">  mode: <span class="string">'production'</span>,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> ForkTsCheckerWebpackPlugin(&#123;</span><br><span class="line">      memoryLimit: <span class="number">1024</span> * <span class="number">2</span>,</span><br><span class="line">      tsconfig: resolvePath(projectRoot, <span class="string">'./src/tsconfig.json'</span>),</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h4 id="ç¼“å­˜ç¥å™¨"><a href="#ç¼“å­˜ç¥å™¨" class="headerlink" title="ç¼“å­˜ç¥å™¨"></a>ç¼“å­˜ç¥å™¨</h4><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL216Z29kZGFyZC9oYXJkLXNvdXJjZS13ZWJwYWNrLXBsdWdpbg==" title="https://github.com/mzgoddard/hard-source-webpack-plugin">hard-source-webpack-plugin<i class="fa fa-external-link"></i></span> æ˜¯ä¸€ä¸ªç»™ <code>modules</code> æä¾›ä¸­é—´ç¼“å­˜æ­¥éª¤çš„ webpack æ’ä»¶ï¼Œä¸ºäº†çœ‹åˆ°æ•ˆæœæˆ‘ä»¬å¯èƒ½éœ€è¦è¿è¡Œä¸¤æ¬¡ï¼Œç¬¬ä¸€æ¬¡å°±æ˜¯æ­£å¸¸çš„ç¼–è¯‘é€Ÿåº¦ï¼Œç¬¬äºŒæ¬¡å¯èƒ½ä¼šå¿«ä¸Šå¾ˆå¤šå€ï¼Œæ‹¿æˆ‘å¼€å‘çš„ä¸€ä¸ª <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RqeDY2Ni92aWV3LWdpdGh1Yi1yZXBvc2l0b3J5" title="https://github.com/tjx666/view-github-repository">VSCode æ’ä»¶ <i class="fa fa-external-link"></i></span>æ¥æµ‹è¯•ä¸€ä¸‹ï¼š</p><p>æˆ‘å…ˆæŠŠ <code>node_modules/.cache/hard-source</code> ç¼“å­˜æ–‡ä»¶å¤¹åˆ æ‰ï¼Œçœ‹çœ‹æ²¡æœ‰ç¼“å­˜çš„æ—¶å€™ç¼–è¯‘é€Ÿåº¦ï¼š</p><p><img data-src="https://i.loli.net/2020/02/17/ZucCU1dEev372bS.png" alt="no cache"></p><p>è€—æ—¶ 3.075 ç§’ï¼Œé‡æ–°ç¼–è¯‘ï¼š</p><p><img data-src="https://i.loli.net/2020/02/17/q5B6kUFSm3TyiLl.png" alt="cache"></p><p>å“‡ ğŸš€ï¼Œç›´æ¥å¿«äº† 3.6 å€å¤šâ€¦</p><p>ç‰›é€¼å½’ç‰›é€¼ï¼Œä½†æ˜¯åœ¨æˆ‘çš„å®é™…ä½¿ç”¨æ—¶å‘ç°å®ƒä¼šå¶å°”ä¼šå‡º bug ï¼Œä¸è¿‡æ¦‚ç‡ä¸æ˜¯å¾ˆé«˜ï¼Œæœ¬æ¥æœ‰ bug å€’æ²¡ä»€ä¹ˆï¼Œåªè¦ä½œè€…è¿˜åœ¨ç»´æŠ¤å°±è¡Œï¼Œä½†æ˜¯è¿™ä¸ªæ’ä»¶çš„ä½œè€…è²Œä¼¼ç»´æŠ¤ä¸æ˜¯å¾ˆç§¯æäº†ï¼Œæœ€åä¸€æ¬¡æäº¤ä»£ç æ˜¯ 18 å¹´ 12 æœˆä»½ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€å¹´å¤šæ²¡ç»´æŠ¤äº†ã€‚</p><p>ä¸è¿‡å‘¢ï¼Œå‡º bug ä¸€èˆ¬æŠŠç¼“å­˜åˆ æ‰å°±èƒ½è§£å†³äº†ï¼Œè™½ç„¶æœ‰ç‚¹å°æ¯›ç—…ï¼Œæˆ‘ä»¬è¿™ä¸ªé¡¹ç›®è¿˜æ˜¯é…ä¸€ä¸‹ï¼Œç¦ä¸ä½å¤ªé¦™äº† ğŸ˜†ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add hard-source-webpack-plugin @types/hard-source-webpack-plugin -D</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> HardSourceWebpackPlugin <span class="keyword">from</span> <span class="string">'hard-source-webpack-plugin'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> commonConfig: Configuration = &#123;</span><br><span class="line">  plugins: [<span class="keyword">new</span> HardSourceWebpackPlugin(&#123; <span class="attr">info</span>: &#123; <span class="attr">mode</span>: <span class="string">'none'</span>, <span class="attr">level</span>: <span class="string">'warn'</span> &#125; &#125;)],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å¥½äº†ï¼Œæ’ä»¶éƒ¨åˆ†ä»‹ç»å®Œäº†ï¼Œæ¥ä¸‹æ¥å¼€å§‹é…ç½® loaders ï¼</p><h3 id="loaders"><a href="#loaders" class="headerlink" title="loaders"></a>loaders</h3><p>webpack é»˜è®¤åªæ”¯æŒå¯¼å…¥ jsï¼Œå¤„ç†ä¸äº†å…¶å®ƒæ–‡ä»¶ï¼Œéœ€è¦é…ç½®å¯¹åº”çš„ loaderï¼Œåƒ <code>excel-loader</code> å°±å¯ä»¥è§£æ excel ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œ<code>file-loader</code> å¯ä»¥è§£æ png å›¾ç‰‡ä¸ºæœ€ç»ˆçš„å‘å¸ƒè·¯å¾„ã€‚loader æ˜¯ä½œç”¨äºä¸€ç±»æ–‡ä»¶çš„ï¼Œplugin æ˜¯ä½œç”¨äº webpack ç¼–è¯‘çš„å„ä¸ªæ—¶æœŸã€‚</p><p>å‰é¢æˆ‘ä»¬åªé…ç½®äº† <code>babel-loader</code>ï¼Œ ä½¿å¾— webpack èƒ½å¤Ÿå¤„ç† TypeScript æ–‡ä»¶ï¼Œå®é™…çš„å¼€å‘ä¸­æˆ‘ä»¬è¿˜éœ€è¦æ”¯æŒå¯¼å…¥æ ·å¼æ–‡ä»¶ï¼Œå›¾ç‰‡æ–‡ä»¶ï¼Œå­—ä½“æ–‡ä»¶ç­‰ã€‚</p><h4 id="å¤„ç†æ ·å¼æ–‡ä»¶"><a href="#å¤„ç†æ ·å¼æ–‡ä»¶" class="headerlink" title="å¤„ç†æ ·å¼æ–‡ä»¶"></a>å¤„ç†æ ·å¼æ–‡ä»¶</h4><p>æˆ‘ä»¬æœ€ç»ˆè¦è¾¾åˆ°çš„ç›®æ ‡æ˜¯æ”¯æŒ css/less/sass ä¸‰ç§è¯­æ³•ï¼Œä»¥åŠé€šè¿‡ <code>postcss</code> å’Œ <code>autoprefixer</code> æ’ä»¶å®ç°è‡ªåŠ¨è¡¥é½æµè§ˆå™¨å¤´ç­‰åŠŸèƒ½ã€‚</p><h5 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h5><p>å¤„ç† css æ–‡ä»¶æˆ‘ä»¬éœ€è¦å®‰è£… <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3dlYnBhY2stY29udHJpYi9zdHlsZS1sb2FkZXI=" title="https://github.com/webpack-contrib/style-loader">style-loader<i class="fa fa-external-link"></i></span> å’Œ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3dlYnBhY2stY29udHJpYi9jc3MtbG9hZGVy" title="https://github.com/webpack-contrib/css-loader">css-loader<i class="fa fa-external-link"></i></span>ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add css-loader style-loader -D</span><br></pre></td></tr></table></figure><p><code>css-loader</code> ä½œç”¨æ˜¯å¤„ç† CSS æ–‡ä»¶ä¸­çš„ <code>@import</code> å’Œ <code>url()</code> è¿”å›ä¸€ä¸ªåˆå¹¶åçš„ CSS å­—ç¬¦ä¸²ï¼Œè€Œ <code>style-loader</code> è´Ÿè´£å°†è¿”å›çš„ CSS å­—ç¬¦ä¸²ç”¨ <code>style</code> æ ‡ç­¾æ’åˆ° DOM ä¸­ï¼Œå¹¶ä¸”è¿˜å®ç°äº† webpack çš„çƒ­æ›´æ–°æ¥å£ã€‚</p><p><code>style-loader</code> å®˜æ–¹ç¤ºä¾‹é…ç½®æ˜¯è¿™æ ·çš„ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// i åç¼€å¿½ç•¥å¤§å°å†™</span></span><br><span class="line">        test: <span class="regexp">/\.css$/i</span>,</span><br><span class="line">        use: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>],</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°åŒ¹é…æ­£åˆ™ç”¨äº† <code>i</code> åç¼€ï¼Œæˆ‘è§‰å¾—è¿™æ ·ä¸å¥½ï¼Œä¸åº”è¯¥æé«˜ä¸€äº›æ— æ„ä¹‰çš„å®¹é”™ç‡ï¼Œç”¨<code>.CSS</code> åšåç¼€å°±ä¸åº”è¯¥è®© webpack ç¼–è¯‘é€šè¿‡ã€‚æˆ‘ä»¬çŸ¥é“ webpack çš„ loaders åŠ è½½é¡ºåºæ˜¯ä»å³åˆ°å·¦çš„ï¼Œæ‰€ä»¥éœ€è¦å…ˆæ‰§è¡Œçš„ <code>css-loader</code> åº”è¯¥åœ¨åæ‰§è¡Œçš„ <code>style-loader</code> åé¢ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.common.ts</span></span><br><span class="line"><span class="keyword">const</span> commonConfig: Configuration = &#123;</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          <span class="string">'style-loader'</span>,</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">'css-loader'</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">              <span class="comment">// CSS modules æ¯”è¾ƒè€—æ€§èƒ½ï¼Œé»˜è®¤å°±æ˜¯ç¦ç”¨çš„</span></span><br><span class="line">              modules: <span class="literal">false</span>,</span><br><span class="line">              <span class="comment">// å¼€å¯ sourcemap</span></span><br><span class="line">              sourceMap: <span class="literal">true</span>,</span><br><span class="line">              <span class="comment">// æŒ‡å®šåœ¨ CSS loader å¤„ç†å‰ä½¿ç”¨çš„ laoder æ•°é‡</span></span><br><span class="line">              importLoaders: <span class="number">0</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">        ],</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h5 id="less"><a href="#less" class="headerlink" title="less"></a>less</h5><p><code>less-loader</code> ä¾èµ– <code>less</code>ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add less less-loader -D</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.common.ts</span></span><br><span class="line"><span class="keyword">const</span> commonConfig: Configuration = &#123;</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.less$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          <span class="string">'style-loader'</span>,</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">'css-loader'</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">              modules: <span class="literal">false</span>,</span><br><span class="line">              sourceMap: <span class="literal">true</span>,</span><br><span class="line">              <span class="comment">// éœ€è¦å…ˆè¢« less-loader å¤„ç†ï¼Œæ‰€ä»¥è¿™é‡Œè®¾ç½®ä¸º 1</span></span><br><span class="line">              importLoaders: <span class="number">1</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="comment">// å…ˆè®© less-loader å°† less æ–‡ä»¶è½¬æ¢æˆ css æ–‡ä»¶</span></span><br><span class="line">            <span class="comment">// å†äº¤ç»™ css-loader å¤„ç†</span></span><br><span class="line">            loader: <span class="string">'less-loader'</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">              sourceMap: <span class="literal">true</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">        ],</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h5 id="sass"><a href="#sass" class="headerlink" title="sass"></a>sass</h5><p>å…¶å®æˆ‘æœ¬äººä»æ¥ä¸ç”¨ <code>less</code> å’Œ <code>stylus</code>ï¼Œæˆ‘ä¸€ç›´ç”¨çš„æ˜¯ <code>sass</code>ã€‚<code>sass</code> æœ‰ä¸¤ç§è¯­æ³•æ ¼å¼ï¼Œé€šè¿‡åç¼€ååŒºåˆ†ã€‚<code>.sass</code> åç¼€åæ˜¯ç±»ä¼¼ <code>yml</code> çš„ç¼©è¿›å†™æ³•ï¼Œ<code>.scss</code> æ˜¯ç±»ä¼¼äº CSS çš„èŠ±æ‹¬å·å†™æ³•ï¼Œä¸è¿‡æ”¯æŒåµŒå¥—å’Œå˜é‡ç­‰ç‰¹æ€§ã€‚é‰´äºæˆ‘åŸºæœ¬ä¸Šæ²¡çœ‹è¿‡å“ªä¸ªé¡¹ç›®ç”¨ <code>yml</code> æ ¼å¼çš„å†™æ³•ï¼Œç”¨çš„äººå¤ªå°‘äº†ï¼Œæˆ‘ä»¬æ¨¡æ¿å°±åªæ”¯æŒ <code>scss</code> åç¼€å¥½äº†ã€‚<code>sass-loader</code> åŒæ ·ä¾èµ– <code>node-sass</code>ï¼Œ<code>node-sass</code> çœŸæ˜¯ä¸ªç¢§æ± ï¼Œæ²¡æœ‰ä»£ç†è¿˜å®‰è£…ä¸äº†ï¼Œæ‰€ä»¥æˆ‘åœ¨ç³»åˆ—ç¬¬ä¸€ç¯‡å°±åœ¨ <code>.npmrc</code> å°±é…ç½®äº† <code>node-sass</code> çš„é•œåƒï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add node-sass sass-loader -D</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.common.ts</span></span><br><span class="line"><span class="keyword">const</span> commonConfig: Configuration = &#123;</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.scss$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          <span class="string">'style-loader'</span>,</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">'css-loader'</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">              modules: <span class="literal">false</span>,</span><br><span class="line">              sourceMap: <span class="literal">true</span>,</span><br><span class="line">              importLoaders: <span class="number">1</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">'sass-loader'</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">              <span class="comment">// ä¸­é—´æ¯ä¸ª loader éƒ½è¦å¼€å¯ sourcemapï¼Œæ‰èƒ½ç”Ÿæˆæ­£ç¡®çš„ soucemap</span></span><br><span class="line">              sourceMap: <span class="literal">true</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">        ],</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h5 id="postcss"><a href="#postcss" class="headerlink" title="postcss"></a>postcss</h5><p><img data-src="https://i.loli.net/2020/02/20/Mxsl8rQdU1tNiYm.png" alt="browser prefix"></p><p>è®°å¾—æˆ‘åœ¨å¤§ä¸€ä¸Šç½‘é¡µè®¾è®¡è¯¾å­¦åˆ° CSS3 çš„æ—¶å€™ï¼Œå¾ˆå¤šå±æ€§éƒ½è¦åŠ æµè§ˆå™¨å¤´å¤„ç†å…¼å®¹æ€§ï¼Œå½“æ—¶å°±å¯¹ CSS å…´è¶£å¤§å‡ï¼Œå¤ªéº»çƒ¦äº†ã€‚è‡ªä» node çš„å‡ºç°ï¼Œå‰ç«¯å·¥ç¨‹åŒ–å¼€å§‹é£é€Ÿå‘å±•ï¼Œä»¥å‰å‰ç«¯è€è¢«å«åšåˆ‡å›¾ä»”ï¼Œç°åœ¨å‰ç«¯å·¥ç¨‹å¸ˆä¹Ÿå¯ä»¥ç”¨ node åšä¼ªå…¨æ ˆå¼€å‘äº†ã€‚</p><p><strong>postcss</strong> æ˜¯ CSS åå¤„ç†å™¨å·¥å…·ï¼Œå› ä¸ºå…ˆæœ‰ CSSï¼Œ<code>postcss</code> åå»å¤„ç†å®ƒï¼Œæ‰€ä»¥å«åå¤„ç†å™¨ã€‚</p><p><strong>less/sass</strong> è¢«ç§°ä¹‹ä¸º CSS é¢„å¤„ç†å™¨ï¼Œå› ä¸ºå®ƒä»¬éœ€è¦è¢« <code>less</code> æˆ– <code>node-sass</code> é¢„å…ˆç¼–è¯‘ä»£ç åˆ° CSS å˜›ã€‚</p><p>å‚è€ƒ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL2NyZWF0ZS1yZWFjdC1hcHAvYmxvYi9tYXN0ZXIvcGFja2FnZXMvcmVhY3Qtc2NyaXB0cy9jb25maWcvd2VicGFjay5jb25maWcuanMjTDk2" title="https://github.com/facebook/create-react-app/blob/master/packages/react-scripts/config/webpack.config.js#L96">create-react-app å¯¹ postcss çš„é…ç½®<i class="fa fa-external-link"></i></span>ï¼Œå®‰è£…ä»¥ä¸‹æ’ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add postcss-loader postcss-flexbugs-fixes postcss-preset-env autoprefixer postcss-normalize -D</span><br></pre></td></tr></table></figure><p>æ·»åŠ  <code>postcss.config.js</code> ç”¨äºé…ç½® <code>postcss</code>ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="comment">// ä¿®å¤ä¸€äº›å’Œ flex å¸ƒå±€ç›¸å…³çš„ bug</span></span><br><span class="line">    <span class="built_in">require</span>(<span class="string">'postcss-flexbugs-fixes'</span>),</span><br><span class="line">    <span class="comment">// å‚è€ƒ browserslist çš„æµè§ˆå™¨å…¼å®¹è¡¨è‡ªåŠ¨å¯¹é‚£äº›è¿˜ä¸æ”¯æŒçš„ç°ä»£ CSS ç‰¹æ€§åšè½¬æ¢</span></span><br><span class="line">    <span class="built_in">require</span>(<span class="string">'postcss-preset-env'</span>)(&#123;</span><br><span class="line">      <span class="comment">// è‡ªåŠ¨æ·»åŠ æµè§ˆå™¨å¤´</span></span><br><span class="line">      autoprefixer: &#123;</span><br><span class="line">        <span class="comment">// will add prefixes only for final and IE versions of specification</span></span><br><span class="line">        flexbox: <span class="string">'no-2009'</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      stage: <span class="number">3</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="comment">// æ ¹æ® browserslist è‡ªåŠ¨å¯¼å…¥éœ€è¦çš„ normalize.css å†…å®¹</span></span><br><span class="line">    <span class="built_in">require</span>(<span class="string">'postcss-normalize'</span>),</span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬è¿˜éœ€è¦æ·»åŠ  <code>browserslist</code> é…ç½®åˆ° <code>package.json</code></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// package.json</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="string">"browserslist"</span>: [</span><br><span class="line">        <span class="string">"last 2 versions"</span>,</span><br><span class="line">        <span class="comment">// ESRï¼ˆExtended Support Releaseï¼‰ é•¿æœŸæ”¯æŒç‰ˆæœ¬</span></span><br><span class="line">        <span class="string">"Firefox ESR"</span>,</span><br><span class="line">        <span class="string">"&gt; 1%"</span>,</span><br><span class="line">        <span class="string">"ie &gt;= 11"</span></span><br><span class="line">    ],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å›é¡¾ CSSï¼Œ lessï¼Œsass çš„é…ç½®å¯ä»¥çœ‹åˆ°æœ‰å¤§é‡çš„é‡å¤ï¼Œæˆ‘ä»¬é‡æ„å¹¶ä¿®æ”¹ <code>importLoaders</code> é€‰é¡¹ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getCssLoaders</span>(<span class="params">importLoaders: number</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> [</span><br><span class="line">    <span class="string">'style-loader'</span>,</span><br><span class="line">    &#123;</span><br><span class="line">      loader: <span class="string">'css-loader'</span>,</span><br><span class="line">      options: &#123;</span><br><span class="line">        modules: <span class="literal">false</span>,</span><br><span class="line">        sourceMap: <span class="literal">true</span>,</span><br><span class="line">        importLoaders,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      loader: <span class="string">'postcss-loader'</span>,</span><br><span class="line">      options: &#123; <span class="attr">sourceMap</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  ];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> commonConfig: Configuration = &#123;</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        use: getCssLoaders(<span class="number">1</span>),</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.less$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          <span class="comment">// postcss-loader + less-loader ä¸¤ä¸ª loaderï¼Œæ‰€ä»¥ importLoaders åº”è¯¥è®¾ç½®ä¸º 2</span></span><br><span class="line">          ...getCssLoaders(<span class="number">2</span>),</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">'less-loader'</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">              sourceMap: <span class="literal">true</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">        ],</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.scss$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          ...getCssLoaders(<span class="number">2</span>),</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">'sass-loader'</span>,</span><br><span class="line">            options: &#123; <span class="attr">sourceMap</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">        ],</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="å¤„ç†å›¾ç‰‡å’Œå­—ä½“"><a href="#å¤„ç†å›¾ç‰‡å’Œå­—ä½“" class="headerlink" title="å¤„ç†å›¾ç‰‡å’Œå­—ä½“"></a>å¤„ç†å›¾ç‰‡å’Œå­—ä½“</h4><p>ä¸€èˆ¬æ¥è¯´æˆ‘ä»¬çš„é¡¹ç›®åœ¨å¼€å‘çš„æ—¶å€™ä¼šä½¿ç”¨ä¸€äº›å›¾ç‰‡æ¥æµ‹è¯•æ•ˆæœï¼Œæ­£å¼ä¸Šçº¿å†æ›¿æ¢æˆ CDN è€Œä¸æ˜¯ä½¿ç”¨ webpack æ‰“åŒ…çš„æœ¬åœ°å›¾ç‰‡ã€‚å¤„ç†æ–‡ä»¶çš„å¸¸ç”¨ loader æœ‰ä¿©ï¼Œ<code>file-loader</code> å’Œ <code>url-loader</code>ï¼Œ<code>file-loader</code> ç”¨äºè§£æå¯¼å…¥çš„æ–‡ä»¶ä¸ºå‘å¸ƒæ—¶çš„ urlï¼Œ å¹¶å°†æ–‡ä»¶è¾“å‡ºåˆ°æŒ‡å®šçš„ä½ç½®ï¼Œè€Œåè€…æ˜¯å¯¹å‰è€…çš„å°è£…ï¼Œæä¾›äº†å°†ä½äºé˜ˆå€¼ä½“ç§¯(ä¸‹é¢å°±è®¾ç½®ä¸º 8192 ä¸ªå­—èŠ‚ï¼‰çš„å›¾ç‰‡è½¬æ¢æˆ base64ã€‚æˆ‘å¿½ç„¶æƒ³èµ·ä»¥å‰è…¾è®¯çš„ä¸€ä¸ªé¢è¯•å®˜é—®è¿‡è¿™ä¹ˆä¸ªé—®é¢˜ï¼šä½¿ç”¨ base64 æœ‰ä»€ä¹ˆåå¤„å—ï¼Ÿå…¶å®æˆ‘è§‰å¾— base64 å¥½å¤„å°±æ˜¯ä¸ç”¨äºŒæ¬¡è¯·æ±‚ï¼Œåå¤„å°±æ˜¯å›¾ç‰‡è½¬ base64 ä½“ç§¯åè€Œä¼šå˜å¤§ï¼Œå˜æˆåŸæ¥çš„ä¸‰åˆ†ä¹‹å››å€ã€‚</p><p><img data-src="https://i.loli.net/2020/02/20/IouO1Kvt5wFAWVl.png" alt="base64"></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add url-loader -D</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> commonConfig: Configuration = &#123;</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: [<span class="regexp">/\.bmp$/</span>, /\.gif$/, /\.jpe?g$/, /\.png$/],</span><br><span class="line">        use: [</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">'url-loader'</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">              <span class="comment">// å›¾ç‰‡ä½äº 10k ä¼šè¢«è½¬æ¢æˆ base64 æ ¼å¼çš„ dataUrl</span></span><br><span class="line">              limit: <span class="number">10</span> * <span class="number">1024</span>,</span><br><span class="line">              <span class="comment">// [hash] å ä½ç¬¦å’Œ [contenthash] æ˜¯ç›¸åŒçš„å«ä¹‰</span></span><br><span class="line">              <span class="comment">// éƒ½æ˜¯è¡¨ç¤ºæ–‡ä»¶å†…å®¹çš„ hash å€¼ï¼Œé»˜è®¤æ˜¯ä½¿ç”¨ md5 hash ç®—æ³•</span></span><br><span class="line">              name: <span class="string">'[name].[contenthash].[ext]'</span>,</span><br><span class="line">              <span class="comment">// ä¿å­˜åˆ° images æ–‡ä»¶å¤¹ä¸‹é¢</span></span><br><span class="line">              outputPath: <span class="string">'images'</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">        ],</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(ttf|woff|woff2|eot|otf)$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">'url-loader'</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">              name: <span class="string">'[name]-[contenthash].[ext]'</span>,</span><br><span class="line">              outputPath: <span class="string">'fonts'</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">        ],</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³¨æ„åˆ°æˆ‘è¿™é‡Œæ–‡ä»¶åä¸­éƒ½æ’å…¥äº†æ–‡ä»¶å†…å®¹ hash å€¼ï¼Œè¿™æ ·å°±å¯ä»¥è§£å†³<strong>å¼ºç¼“å­˜éœ€è¦ç«‹å³æ›´æ–°</strong>çš„é—®é¢˜ã€‚</p><h3 id="sourcemap"><a href="#sourcemap" class="headerlink" title="sourcemap"></a>sourcemap</h3><table><thead><tr><th>devtool</th><th>æ„å»ºé€Ÿåº¦</th><th>é‡æ–°æ„å»ºé€Ÿåº¦</th><th>ç”Ÿäº§ç¯å¢ƒ</th><th>å“è´¨(quality)</th></tr></thead><tbody><tr><td>(none)</td><td>+++</td><td>+++</td><td>yes</td><td>æ‰“åŒ…åçš„ä»£ç </td></tr><tr><td>eval</td><td>+++</td><td>+++</td><td>no</td><td>ç”Ÿæˆåçš„ä»£ç </td></tr><tr><td>cheap-eval-source-map</td><td>+</td><td>++</td><td>no</td><td>è½¬æ¢è¿‡çš„ä»£ç ï¼ˆä»…é™è¡Œï¼‰</td></tr><tr><td>cheap-module-eval-source-map</td><td>o</td><td>++</td><td>no</td><td>åŸå§‹æºä»£ç ï¼ˆä»…é™è¡Œï¼‰</td></tr><tr><td>eval-source-map</td><td>â€“</td><td>+</td><td>no</td><td>åŸå§‹æºä»£ç </td></tr><tr><td>cheap-source-map</td><td>+</td><td>o</td><td>yes</td><td>è½¬æ¢è¿‡çš„ä»£ç ï¼ˆä»…é™è¡Œï¼‰</td></tr><tr><td>cheap-module-source-map</td><td>o</td><td>-</td><td>yes</td><td>åŸå§‹æºä»£ç ï¼ˆä»…é™è¡Œï¼‰</td></tr><tr><td>inline-cheap-source-map</td><td>+</td><td>o</td><td>no</td><td>è½¬æ¢è¿‡çš„ä»£ç ï¼ˆä»…é™è¡Œï¼‰</td></tr><tr><td>inline-cheap-module-source-map</td><td>o</td><td>-</td><td>no</td><td>åŸå§‹æºä»£ç ï¼ˆä»…é™è¡Œï¼‰</td></tr><tr><td>source-map</td><td>â€“</td><td>â€“</td><td>yes</td><td>åŸå§‹æºä»£ç </td></tr><tr><td>inline-source-map</td><td>â€“</td><td>â€“</td><td>no</td><td>åŸå§‹æºä»£ç </td></tr><tr><td>hidden-source-map</td><td>â€“</td><td>â€“</td><td>yes</td><td>åŸå§‹æºä»£ç </td></tr><tr><td>nosources-source-map</td><td>â€“</td><td>â€“</td><td>yes</td><td>æ— æºä»£ç å†…å®¹</td></tr></tbody></table><blockquote><p><code>+++</code> éå¸¸å¿«é€Ÿ, <code>++</code> å¿«é€Ÿ, <code>+</code> æ¯”è¾ƒå¿«, <code>o</code> ä¸­ç­‰, <code>-</code> æ¯”è¾ƒæ…¢, <code>--</code> æ…¢</p></blockquote><p>sourcemap æ˜¯ç°åœ¨å‰ç«¯ç•Œå¾ˆå¤šå·¥å…·å¿…ä¸å¯ç¼ºçš„ä¸€ä¸ªåŠŸèƒ½ï¼Œwebpackï¼ŒTypeScriptï¼Œbabelï¼Œpowser-assert ç­‰è½¬æ¢ä»£ç çš„å·¥å…·éƒ½è¦æä¾› sourcemap åŠŸèƒ½ï¼Œæºä»£ç è¢«å‹ç¼©ï¼Œæ··æ·†ï¼Œpolyfillï¼Œæ²¡æœ‰ sourcemapï¼Œæ ¹æœ¬æ²¡åŠæ³•è°ƒè¯•å®šä½é—®é¢˜ã€‚</p><p>è€ƒè™‘åˆ°ç¼–è¯‘é€Ÿåº¦ï¼Œè°ƒå¼å‹å¥½æ€§ï¼Œæˆ‘é€‰æ‹© <code>eval-source-map</code>ï¼Œå¦‚æœç”¨æˆ·åœ¨æ‰“åŒ…æ—¶è§‰å¾—æ…¢ï¼Œè€Œä¸”èƒ½å¤Ÿå¿å—æ²¡æœ‰åˆ—å·ï¼Œå¯ä»¥è€ƒè™‘è°ƒæˆ <code>cheap-eval-source-map</code>ã€‚</p><p>æˆ‘ä»¬ä¿®æ”¹ <code>webpack.dev.ts</code> çš„ devtool ä¸º <code>eval-source-map</code>ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.dev.ts</span></span><br><span class="line"><span class="keyword">import</span> commonConfig <span class="keyword">from</span> <span class="string">'./webpack.common'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> devConfig = merge(commonConfig, &#123;</span><br><span class="line">  devtool: <span class="string">'eval-source-map'</span>,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¿™é‡Œé¡ºä¾¿æä¸€ä¸‹ webpack æ’ä»¶ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3Ntb290aC1jb2RlL2Vycm9yLW92ZXJsYXktd2VicGFjay1wbHVnaW4=" title="https://github.com/smooth-code/error-overlay-webpack-plugin">error-overlay-webpack-plugin<i class="fa fa-external-link"></i></span>ï¼Œå®ƒæä¾›äº†å’Œ create-react-app ä¸€æ ·çš„é”™è¯¯é®ç½©ï¼š</p><p><img data-src="https://raw.githubusercontent.com/smooth-code/error-overlay-webpack-plugin/master/docs/example.png" alt="error overlay"></p><p>ä½†æ˜¯å®ƒæœ‰ä¸€ä¸ªé™åˆ¶å°±æ˜¯ä¸èƒ½ä½¿ç”¨ä»»ä½•ä¸€ç§åŸºäº <code>eval</code> çš„ sourcemapï¼Œæ„Ÿå…´è¶£çš„è¯»è€…å¯ä»¥å°è¯•ä»¥ä¸‹ã€‚</p><h3 id="çƒ­æ›´æ–°"><a href="#çƒ­æ›´æ–°" class="headerlink" title="çƒ­æ›´æ–°"></a>çƒ­æ›´æ–°</h3><p>æˆ‘ä»¬å‰é¢ç»™ devServer æ·»åŠ äº† <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3dlYnBhY2stY29udHJpYi93ZWJwYWNrLWhvdC1taWRkbGV3YXJl" title="https://github.com/webpack-contrib/webpack-hot-middleware">webpack-hot-middleware<i class="fa fa-external-link"></i></span> ä¸­é—´ä»¶ï¼Œå‚è€ƒå®ƒçš„æ–‡æ¡£æˆ‘ä»¬éœ€è¦å…ˆæ·»åŠ  webapck æ’ä»¶<code>webpack.HotModuleReplacementPlugin</code>ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.dev.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; HotModuleReplacementPlugin, NamedModulesPlugin &#125; <span class="keyword">from</span> <span class="string">'webpack'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> devConfig = merge(commonConfig, &#123;</span><br><span class="line">  plugins: [<span class="keyword">new</span> HotModuleReplacementPlugin(), <span class="keyword">new</span> NamedModulesPlugin()],</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><code>NamedModulesPlugin</code> è¿™ä¸ªæ’ä»¶å¯ä»¥åœ¨ <code>rebuild</code> çš„æ—¶å€™æ˜¾ç¤ºå“ªäº›æ¨¡å—è¢«ä¿®æ”¹äº†ã€‚</p><p>è¿˜è¦æ·»åŠ  <code>&#39;webpack-hot-middleware/client&#39;</code> çƒ­æ›´æ–°è¡¥ä¸åˆ°æˆ‘ä»¬çš„ bundleï¼ŒåŠ å…¥ entry æ•°ç»„å³å¯ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.common.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; __DEV__, hmrPath &#125; <span class="keyword">from</span> <span class="string">'../env'</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> commonConfig: Configuration = &#123;</span><br><span class="line">    entry: [resolvePath(projectRoot, <span class="string">'./src/index.tsx'</span>)],</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (__DEV__) &#123;</span><br><span class="line">    (commonConfig.entry <span class="keyword">as</span> string[]).unshift(<span class="string">`webpack-hot-middleware/client?path=<span class="subst">$&#123;hmrPath&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡åœ¨ entry åé¢åŠ  <code>queryString</code> çš„æ–¹å¼å¯ä»¥è®©æˆ‘ä»¬é…ç½®ä¸€äº›é€‰é¡¹ï¼Œå®ƒæ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼ŸæŸ¥çœ‹ <code>&#39;webpack-hot-middleware/client&#39;</code> æºç å¯ä»¥çœ‹åˆ°ï¼Œwebpack ä¼šå°† <code>queryString</code> ä½œä¸ºå…¨å±€å˜é‡æ³¨å…¥è¿™ä¸ªæ–‡ä»¶ï¼š</p><p><img data-src="https://i.loli.net/2020/02/18/h1njS2olHADUV8R.png" alt="entry query"></p><p>å…¶å®åˆ°è¿™æˆ‘ä»¬ä¹Ÿå°±æ”¯æŒäº† CSS çš„çƒ­æ›´æ–°ï¼ˆstyle-loader å®ç°äº†çƒ­æ›´æ–°æ¥å£ï¼‰ï¼Œå¦‚æœè¦æ”¯æŒ react ç»„ä»¶çš„çƒ­æ›´æ–°æˆ‘ä»¬è¿˜éœ€è¦é…ç½® <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2dhZWFyb24vcmVhY3QtaG90LWxvYWRlcg==" title="https://github.com/gaearon/react-hot-loader">react-hot-loader<i class="fa fa-external-link"></i></span> ï¼Œé…ç½®å®ƒä¹‹å‰æˆ‘ä»¬å…ˆæ¥ä¼˜åŒ–æˆ‘ä»¬çš„ babel é…ç½®ã€‚</p><h3 id="babel-é…ç½®ä¼˜åŒ–"><a href="#babel-é…ç½®ä¼˜åŒ–" class="headerlink" title="babel é…ç½®ä¼˜åŒ–"></a>babel é…ç½®ä¼˜åŒ–</h3><p>å‰é¢æˆ‘ä»¬åœ¨å‰é¢åªé…ç½®äº†ä¸€ä¸ª <code>@babel/preset-typescript</code> æ’ä»¶ç”¨äºç¼–è¯‘ TypeScriptï¼Œå…¶å®è¿˜æœ‰å¾ˆå¤šå¯ä»¥ä¼˜åŒ–çš„ç‚¹ã€‚</p><h4 id="babel-preset-env"><a href="#babel-preset-env" class="headerlink" title="@babel/preset-env"></a>@babel/preset-env</h4><p>åœ¨ babel ä¸­ï¼Œ<strong>preset è¡¨ç¤º plugin çš„é›†åˆ</strong>ï¼Œ<code>@babel/preset-env</code> å¯ä»¥è®© babel æ ¹æ®æˆ‘ä»¬é…ç½®çš„ browserslist åªæ·»åŠ éœ€è¦è½¬æ¢çš„è¯­æ³•å’Œ polyfillã€‚</p><p>å®‰è£… <code>@babel/preset-env</code>ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add @babel/preset-env -D</span><br></pre></td></tr></table></figure><h4 id="babel-plugin-transform-runtime"><a href="#babel-plugin-transform-runtime" class="headerlink" title="@babel/plugin-transform-runtime"></a>@babel/plugin-transform-runtime</h4><p>æˆ‘ä»¬çŸ¥é“é»˜è®¤æƒ…å†µä¸‹ï¼Œ babel åœ¨ç¼–è¯‘æ¯ä¸€ä¸ªæ¨¡å—çš„æ—¶å€™åœ¨éœ€è¦çš„æ—¶å€™ä¼šæ’å…¥ä¸€äº›è¾…åŠ©å‡½æ•°ä¾‹å¦‚ <code>_extend</code>ï¼Œæ¯ä¸€ä¸ªéœ€è¦çš„æ¨¡å—éƒ½ä¼šç”Ÿæˆè¿™ä¸ªè¾…åŠ©å‡½æ•°ä¼šé€ æˆæ²¡å¿…è¦çš„ä»£ç è†¨èƒ€ï¼Œ<code>@babel/plugin-transform-runtime</code> è¿™ä¸ªæ’ä»¶ä¼šå°†æ‰€æœ‰çš„è¾…åŠ©å‡½æ•°éƒ½ä» <code>@babel/runtime</code> å¯¼å…¥ï¼Œæ¥å‡å°‘ä»£ç ä½“ç§¯ã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add @babel/plugin-transform-runtime -D</span><br></pre></td></tr></table></figure><h4 id="babel-preset-react"><a href="#babel-preset-react" class="headerlink" title="@babel/preset-react"></a>@babel/preset-react</h4><p>è™½ç„¶ <code>@babel/preset-typescript</code> å°±èƒ½è½¬æ¢ tsx æˆ js ä»£ç ï¼Œä½†æ˜¯ <code>@babel/preset-react</code> è¿˜é›†æˆäº†ä¸€äº›é’ˆå¯¹ react é¡¹ç›®çš„å®ç”¨çš„æ’ä»¶ã€‚</p><p><code>@babel/preset-react</code> é»˜è®¤ä¼šå¼€å¯ä¸‹é¢è¿™äº›æ’ä»¶:</p><ul><li><span class="exturl" data-url="aHR0cHM6Ly9iYWJlbGpzLmlvL2RvY3MvZW4vYmFiZWwtcGx1Z2luLXN5bnRheC1qc3g=" title="https://babeljs.io/docs/en/babel-plugin-syntax-jsx">@babel/plugin-syntax-jsx<i class="fa fa-external-link"></i></span></li><li><span class="exturl" data-url="aHR0cHM6Ly9iYWJlbGpzLmlvL2RvY3MvZW4vYmFiZWwtcGx1Z2luLXRyYW5zZm9ybS1yZWFjdC1qc3g=" title="https://babeljs.io/docs/en/babel-plugin-transform-react-jsx">@babel/plugin-transform-react-jsx<i class="fa fa-external-link"></i></span></li><li><span class="exturl" data-url="aHR0cHM6Ly9iYWJlbGpzLmlvL2RvY3MvZW4vYmFiZWwtcGx1Z2luLXRyYW5zZm9ybS1yZWFjdC1kaXNwbGF5LW5hbWU=" title="https://babeljs.io/docs/en/babel-plugin-transform-react-display-name">@babel/plugin-transform-react-display-name<i class="fa fa-external-link"></i></span></li></ul><p>å¦‚æœè®¾ç½®äº† <code>development: true</code> è¿˜ä¼šå¼€å¯:</p><ul><li><span class="exturl" data-url="aHR0cHM6Ly9iYWJlbGpzLmlvL2RvY3MvZW4vYmFiZWwtcGx1Z2luLXRyYW5zZm9ybS1yZWFjdC1qc3gtc2VsZg==" title="https://babeljs.io/docs/en/babel-plugin-transform-react-jsx-self">@babel/plugin-transform-react-jsx-self<i class="fa fa-external-link"></i></span></li><li><span class="exturl" data-url="aHR0cHM6Ly9iYWJlbGpzLmlvL2RvY3MvZW4vYmFiZWwtcGx1Z2luLXRyYW5zZm9ybS1yZWFjdC1qc3gtc291cmNl" title="https://babeljs.io/docs/en/babel-plugin-transform-react-jsx-source">@babel/plugin-transform-react-jsx-source<i class="fa fa-external-link"></i></span></li></ul><p>å®‰è£…ä¾èµ– <code>@babel/preset-react</code>ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add @babel/preset-react -D</span><br></pre></td></tr></table></figure><h4 id="react-hot-loader"><a href="#react-hot-loader" class="headerlink" title="react-hot-loader"></a>react-hot-loader</h4><p>ä¸ºäº†å®ç°ç»„ä»¶çš„å±€éƒ¨åˆ·æ–°ï¼Œæˆ‘ä»¬éœ€è¦å®‰è£… <code>react-hot-loader</code> è¿™ä¸ª babel æ’ä»¶ã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add react-hot-loader</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ’ä»¶ä¸éœ€è¦å®‰è£…æˆ <code>devDependencies</code>ï¼Œå®ƒåœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ä¸ä¼šè¢«æ‰§è¡Œå¹¶ä¸”ä¼šç¡®ä¿å®ƒå ç”¨çš„ä½“ç§¯æœ€å°ã€‚å…¶å®å®˜æ–¹æ­£åœ¨å¼€å‘ä¸‹ä¸€ä»£çš„ react çƒ­æ›´æ–°æ’ä»¶ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL3JlYWN0L2lzc3Vlcy8xNjYwNA==" title="https://github.com/facebook/react/issues/16604">React Fast Refresh<i class="fa fa-external-link"></i></span>ï¼Œä¸è¿‡ç›®å‰è¿˜ä¸æ”¯æŒ webpackã€‚</p><p>ä¸ºäº†çœ‹åˆ°æµ‹è¯•æ•ˆæœï¼Œæˆ‘ä»¬å®‰è£… react å…¨å®¶æ¡¶å¹¶ä¸”è°ƒæ•´ä¸€ä¸‹ <code>src</code> æ–‡ä»¶å¤¹ä¸‹çš„é»˜è®¤å†…å®¹ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add react react-dom react-router-dom</span><br><span class="line">yarn add @types/react @types/react-dom @types/react-router-dom -D</span><br></pre></td></tr></table></figure><p><code>react</code> æ˜¯æ¡†æ¶æ ¸å¿ƒæ¥å£ï¼Œ<code>react-dom</code> è´Ÿè´£æŒ‚è½½æˆ‘ä»¬çš„ react ç»„ä»¶åˆ°çœŸå®çš„ DOM ä¸Šï¼Œ <code>react-dom-router</code> æ˜¯å®ç°äº† <code>react-router</code> æ¥å£çš„ web å¹³å°çš„è·¯ç”±åº“ã€‚</p><p>è®© <code>react-hot-loader</code> æ¥ç®¡æˆ‘ä»¬çš„ react æ ¹ç»„ä»¶ï¼Œå…¶å®è¿™ä¸ª hot å‡½æ•°å°±æ˜¯ä¸€ä¸ª <strong>hoc</strong> å˜›ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// App.ts</span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; hot &#125; <span class="keyword">from</span> <span class="string">'react-hot-loader/root'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">'./App.scss'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> App = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div className=<span class="string">"app"</span>&gt;</span><br><span class="line">      &lt;h2 className=<span class="string">"title"</span>&gt;react typescript boilerplate&lt;<span class="regexp">/h2&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> hot(App);</span><br></pre></td></tr></table></figure><p>åœ¨ webpack entry åŠ å…¥çƒ­æ›´æ–°è¡¥ä¸ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> commonConfig: Configuration = &#123;</span><br><span class="line">  entry: [<span class="string">'react-hot-loader/patch'</span>, resolvePath(projectRoot, <span class="string">'./src/index.tsx'</span>)],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å®˜æ–¹æ–‡æ¡£æåˆ°å¦‚æœéœ€è¦æ”¯æŒ <code>react hooks</code> çš„çƒ­æ›´æ–°ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å®‰è£… <code>@hot-loader/react-dom</code>ï¼Œä½¿ç”¨å®ƒæ¥æ›¿æ¢é»˜è®¤çš„ <code>react-dom</code> æ¥æ·»åŠ ä¸€äº›é¢å¤–çš„çƒ­æ›´æ–°ç‰¹æ€§ï¼Œä¸ºäº†æ›¿æ¢ <code>react-dom</code> æˆ‘ä»¬éœ€è¦é…ç½® webpack aliasï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.common.ts</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  resolve: &#123;</span><br><span class="line">    alias: &#123;</span><br><span class="line">      <span class="string">'react-dom'</span>: <span class="string">'@hot-loader/react-dom'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç»“åˆå‰é¢æåˆ° babel æ’ä»¶ï¼Œæœ€ç»ˆä¿®æ”¹ <code>babel.config.js</code> æˆï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> envPreset = [</span><br><span class="line">  <span class="string">'@babel/preset-env'</span>,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// åªå¯¼å…¥éœ€è¦çš„ polyfill</span></span><br><span class="line">    useBuiltIns: <span class="string">'usage'</span>,</span><br><span class="line">    <span class="comment">// æŒ‡å®š corjs ç‰ˆæœ¬</span></span><br><span class="line">    corejs: <span class="number">3</span>,</span><br><span class="line">    <span class="comment">// ç¦ç”¨æ¨¡å—åŒ–æ–¹æ¡ˆè½¬æ¢</span></span><br><span class="line">    modules: <span class="literal">false</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">api</span>) </span>&#123;</span><br><span class="line">  api.cache(<span class="literal">true</span>);</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    presets: [<span class="string">'@babel/preset-typescript'</span>, envPreset],</span><br><span class="line">    plugins: [<span class="string">'@babel/plugin-transform-runtime'</span>],</span><br><span class="line">    env: &#123;</span><br><span class="line">      <span class="comment">// å¼€å‘ç¯å¢ƒé…ç½®</span></span><br><span class="line">      development: &#123;</span><br><span class="line">        presets: [[<span class="string">'@babel/preset-react'</span>, &#123; <span class="attr">development</span>: <span class="literal">true</span> &#125;]],</span><br><span class="line">        plugins: [<span class="string">'react-hot-loader/babel'</span>],</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="comment">// ç”Ÿäº§ç¯å¢ƒé…ç½®</span></span><br><span class="line">      production: &#123;</span><br><span class="line">        presets: [<span class="string">'@babel/preset-react'</span>],</span><br><span class="line">        plugins: [<span class="string">'@babel/plugin-transform-react-constant-elements'</span>, <span class="string">'@babel/plugin-transform-react-inline-elements'</span>],</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ³¨æ„åˆ°æˆ‘ä»¬ç”Ÿäº§ç¯å¢ƒä¸‹è¿˜å®‰è£…äº†ä¸¤ä¸ªæ’ä»¶è¿›è¡Œç”Ÿäº§ç¯å¢ƒçš„ä¼˜åŒ–ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add @babel/plugin-transform-react-constant-elements @babel/plugin-transform-react-inline-elements -D</span><br></pre></td></tr></table></figure><p><code>@babel/plugin-transform-react-constant-elements</code> çš„ä½œç”¨æ˜¯åƒä¸‹é¢æ ·å°†å‡½æ•°ç»„ä»¶ä¸­çš„å˜é‡æå‡åˆ°å‡½æ•°å¤–æ¥é¿å…æ¯æ¬¡é‡æ–°è°ƒç”¨å‡½æ•°ç»„ä»¶é‡å¤å£°æ˜å’Œæ²¡å¿…è¦çš„åƒåœ¾å›æ”¶ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Hr = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">hr</span> <span class="attr">className</span>=<span class="string">"hr"</span> /&gt;</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è½¬æ¢æˆ</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> _ref = <span class="xml"><span class="tag">&lt;<span class="name">hr</span> <span class="attr">className</span>=<span class="string">"hr"</span> /&gt;</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Hr = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> _ref;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><code>@babel/plugin-transform-react-inline-elements</code> çš„ä½œç”¨è¯»è€…å¯ä»¥å‚è€ƒ react çš„è¿™ä¸ª issueï¼š<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL3JlYWN0L2lzc3Vlcy8zMjI4" title="https://github.com/facebook/react/issues/3228">Optimizing Compiler: Inline ReactElements<i class="fa fa-external-link"></i></span>ã€‚</p><h2 id="ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–"><a href="#ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–" class="headerlink" title="ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–"></a>ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–</h2><h3 id="CSS-æ‹†åˆ†"><a href="#CSS-æ‹†åˆ†" class="headerlink" title="CSS æ‹†åˆ†"></a>CSS æ‹†åˆ†</h3><p>å¦‚æœ CSS æ˜¯åŒ…å«åœ¨æˆ‘ä»¬æ‰“åŒ…çš„ JS bundle ä¸­é‚£ä¼šå¯¼è‡´æœ€åä½“ç§¯å¾ˆå¤§ï¼Œä¸¥é‡æƒ…å†µä¸‹è®¿é—®é¦–é¡µä¼šé€ æˆçŸ­æš‚çš„ç™½å±ã€‚æ‹†åˆ† CSS æˆ‘ä»¬ç›´æ¥ä½¿ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3dlYnBhY2stY29udHJpYi9taW5pLWNzcy1leHRyYWN0LXBsdWdpbg==" title="https://github.com/webpack-contrib/mini-css-extract-plugin">mini-css-extract-plugin<i class="fa fa-external-link"></i></span>ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add mini-css-extract-plugin -D</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ç”Ÿäº§ç¯å¢ƒé…ç½®ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.prod.ts</span></span><br><span class="line"><span class="keyword">import</span> MiniCssExtractPlugin <span class="keyword">from</span> <span class="string">'mini-css-extract-plugin'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> prodConfig = merge(commonConfig, &#123;</span><br><span class="line">  mode: <span class="string">'production'</span>,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">      <span class="comment">// æ–‡ä»¶åä¸­æ’å…¥æ–‡ä»¶å†…å®¹çš„ hash å€¼</span></span><br><span class="line">      filename: <span class="string">'css/[name].[contenthash].css'</span>,</span><br><span class="line">      chunkFilename: <span class="string">'css/[id].[contenthash].css'</span>,</span><br><span class="line">      ignoreOrder: <span class="literal">false</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3dlYnBhY2stY29udHJpYi9taW5pLWNzcy1leHRyYWN0LXBsdWdpbg==" title="https://github.com/webpack-contrib/mini-css-extract-plugin">mini-css-extract-plugin<i class="fa fa-external-link"></i></span> è¿˜æä¾›äº† <code>mini-css-extract-plugin.loader</code>ï¼Œå®ƒä¸èƒ½å’Œ <code>style-loader</code> å…±å­˜ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¿®æ”¹ <code>webpack.common.ts</code> çš„é…ç½®ä½¿å¾—å¼€å‘ç¯å¢ƒä¸‹ä½¿ç”¨ <code>style-loader</code> ç”Ÿäº§ç¯å¢ƒä¸‹ä½¿ç”¨ <code>mini-css-extract-plugin.loader</code>ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; loader <span class="keyword">as</span> MiniCssExtractLoader &#125; <span class="keyword">from</span> <span class="string">'mini-css-extract-plugin'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; __DEV__ &#125; <span class="keyword">from</span> <span class="string">'../env'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getCssLoaders</span>(<span class="params">importLoaders: number</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> [</span><br><span class="line">    __DEV__ ? <span class="string">'style-loader'</span> : MiniCssExtractLoader,</span><br><span class="line">    &#123;</span><br><span class="line">      loader: <span class="string">'css-loader'</span>,</span><br><span class="line">      options: &#123;</span><br><span class="line">        modules: <span class="literal">false</span>,</span><br><span class="line">        sourceMap: <span class="literal">true</span>,</span><br><span class="line">        importLoaders,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      loader: <span class="string">'postcss-loader'</span>,</span><br><span class="line">      options: &#123; <span class="attr">sourceMap</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  ];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä»£ç å‹ç¼©"><a href="#ä»£ç å‹ç¼©" class="headerlink" title="ä»£ç å‹ç¼©"></a>ä»£ç å‹ç¼©</h3><h4 id="JavaScript-å‹ç¼©"><a href="#JavaScript-å‹ç¼©" class="headerlink" title="JavaScript å‹ç¼©"></a>JavaScript å‹ç¼©</h4><p>ç½‘ä¸Šå¾ˆå¤šæ•™ç¨‹åœ¨è®² webpack å‹ç¼©ä»£ç çš„æ—¶å€™éƒ½æ˜¯ä½¿ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3dlYnBhY2stY29udHJpYi91Z2xpZnlqcy13ZWJwYWNrLXBsdWdpbg==" title="https://github.com/webpack-contrib/uglifyjs-webpack-plugin">uglifyjs-webpack-plugin<i class="fa fa-external-link"></i></span>ï¼Œå…¶å®è¿™ä¸ªä»“åº“æ—©å°±æ”¾å¼ƒç»´æŠ¤äº†ï¼Œè€Œä¸”å®ƒä¸æ”¯æŒ ES6 è¯­æ³•ï¼Œwebpack çš„æ ¸å¿ƒå¼€å‘è€… <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2V2aWxlYm90dG5hd2k=" title="https://github.com/evilebottnawi">evilebottnawi<i class="fa fa-external-link"></i></span> éƒ½è½¬å‘ç»´æŠ¤ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3dlYnBhY2stY29udHJpYi90ZXJzZXItd2VicGFjay1wbHVnaW4=" title="https://github.com/webpack-contrib/terser-webpack-plugin">terser-webpack-plugin<i class="fa fa-external-link"></i></span> äº†ã€‚æˆ‘ä»¬ä½¿ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3dlYnBhY2stY29udHJpYi90ZXJzZXItd2VicGFjay1wbHVnaW4=" title="https://github.com/webpack-contrib/terser-webpack-plugin">terser-webpack-plugin<i class="fa fa-external-link"></i></span> åœ¨ç”Ÿäº§ç¯å¢ƒå¯¹ä»£ç è¿›è¡Œå‹ç¼©ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ webpack4 æ–°å¢çš„ <span class="exturl" data-url="aHR0cHM6Ly93d3cud2VicGFja2pzLmNvbS9ndWlkZXMvdHJlZS1zaGFraW5nLw==" title="https://www.webpackjs.com/guides/tree-shaking/">tree-shaking<i class="fa fa-external-link"></i></span> å»é™¤ä»£ç ä¸­çš„æ­»ä»£ç ï¼Œè¿›ä¸€æ­¥å‡å° bundle ä½“ç§¯ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add terser-webpack-plugin @types/terser-webpack-plugin -D</span><br></pre></td></tr></table></figure><p>treeshake éœ€è¦åœ¨ <code>package.json</code> ä¸­é…ç½® <code>sideEffects</code> å­—æ®µï¼Œè¯¦æƒ…å¯ä»¥é˜…è¯»å®˜æ–¹æ–‡æ¡£ï¼š<span class="exturl" data-url="aHR0cHM6Ly93ZWJwYWNrLmpzLm9yZy9ndWlkZXMvdHJlZS1zaGFraW5nLw==" title="https://webpack.js.org/guides/tree-shaking/">Tree Shaking<i class="fa fa-external-link"></i></span>ã€‚</p><h4 id="CSS-å‹ç¼©"><a href="#CSS-å‹ç¼©" class="headerlink" title="CSS å‹ç¼©"></a>CSS å‹ç¼©</h4><p>å‹ç¼© CSS ä½¿ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL05NRlIvb3B0aW1pemUtY3NzLWFzc2V0cy13ZWJwYWNrLXBsdWdpbg==" title="https://github.com/NMFR/optimize-css-assets-webpack-plugin">optimize-css-assets-webpack-plugin<i class="fa fa-external-link"></i></span>ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add optimize-css-assets-webpack-plugin @types/optimize-css-assets-webpack-plugin -D</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ <code>webpack.prod.ts</code>ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> TerserPlugin <span class="keyword">from</span> <span class="string">'terser-webpack-plugin'</span>;</span><br><span class="line"><span class="keyword">import</span> OptimizeCSSAssetsPlugin <span class="keyword">from</span> <span class="string">'optimize-css-assets-webpack-plugin'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> prodConfig = merge(commonConfig, &#123;</span><br><span class="line">  mode: <span class="string">'production'</span>,</span><br><span class="line">  optimization: &#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ minimizer è€Œä¸æ˜¯é»˜è®¤çš„ uglifyJS</span></span><br><span class="line">    minimize: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">// ä¸¤ä¸ª minimizerï¼šTerserPlugin å’Œ OptimizeCSSAssetsPlugin</span></span><br><span class="line">    minimizer: [<span class="keyword">new</span> TerserPlugin(&#123; <span class="attr">extractComments</span>: <span class="literal">false</span> &#125;), <span class="keyword">new</span> OptimizeCSSAssetsPlugin()],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="æ„å»ºåˆ†æ"><a href="#æ„å»ºåˆ†æ" class="headerlink" title="æ„å»ºåˆ†æ"></a>æ„å»ºåˆ†æ</h3><p>æˆ‘ä»¬æ·»åŠ ä¸€äº› webpack æ’ä»¶ç”¨æ¥è¿›è¡Œæ„å»ºåˆ†æ</p><h4 id="æ—¶é—´ç»Ÿè®¡"><a href="#æ—¶é—´ç»Ÿè®¡" class="headerlink" title="æ—¶é—´ç»Ÿè®¡"></a>æ—¶é—´ç»Ÿè®¡</h4><p><img data-src="https://i.loli.net/2020/02/19/c1vdoqsT34WCSHX.png" alt="speed measure"></p><p>æˆ‘ä»¬ä½¿ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3N0ZXBoZW5jb29rZGV2L3NwZWVkLW1lYXN1cmUtd2VicGFjay1wbHVnaW4=" title="https://github.com/stephencookdev/speed-measure-webpack-plugin">speed-measure-webpack-plugin<i class="fa fa-external-link"></i></span> å¯¹æ‰“åŒ…æ—¶é—´è¿›è¡Œç»Ÿè®¡ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add speed-measure-webpack-plugin -D</span><br></pre></td></tr></table></figure><p>é¡¹ç›®è¿›è¡Œåˆ°è¿™ï¼Œæˆ‘ä»¬ç»ˆäºç¢°åˆ°ç¬¬ä¸€ä¸ªæ²¡æœ‰ TypeScript ç±»å‹å£°æ˜æ–‡ä»¶çš„åº“äº†ï¼Œæ–°å»º <code>scripts/typings/index.d.ts</code> æ–‡ä»¶ï¼Œå› ä¸ºéœ€è¦ç¼–å†™çš„ç±»å‹å¾ˆå°‘ï¼Œ<code>index.d.ts</code> å°±ä½œä¸ºä¸€ä¸ªå…¨å±€å£°æ˜æ–‡ä»¶ï¼Œåœ¨å…¶ä¸­æ·»åŠ  <code>speed-measure-webpack-plugin</code> çš„å¤–éƒ¨æ¨¡å—å£°æ˜ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// scripts/typings/index.d.ts</span></span><br><span class="line">declare <span class="built_in">module</span> <span class="string">'speed-measure-webpack-plugin'</span> &#123;</span><br><span class="line">    <span class="keyword">import</span> &#123; Configuration, Plugin &#125; <span class="keyword">from</span> <span class="string">'webpack'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼Œéœ€è¦å“ªäº›é€‰é¡¹å°±å£°æ˜å“ªäº›é€‰é¡¹å°±è¡Œ</span></span><br><span class="line">  	<span class="comment">// å¯ä»¥çœ‹å‡º TypeScript æ˜¯éå¸¸çµæ´»çš„</span></span><br><span class="line">    interface SpeedMeasurePluginOptions &#123;</span><br><span class="line">        disable: boolean;</span><br><span class="line">        outputFormat: <span class="string">'json'</span> | <span class="string">'human'</span> | <span class="string">'humanVerbose'</span> | <span class="function">(<span class="params">(outputObj: object</span>) =&gt;</span> <span class="keyword">void</span>);</span><br><span class="line">        outputTarget: string | <span class="function">(<span class="params">(outputObj: string</span>) =&gt;</span> <span class="keyword">void</span>);</span><br><span class="line">        pluginNames: object;</span><br><span class="line">        granularLoaderData: boolean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç»§æ‰¿ Plugin ç±», Plugin ç±»éƒ½æœ‰ apply æ–¹æ³•</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">SpeedMeasurePlugin</span> <span class="keyword">extends</span> <span class="title">Plugin</span> </span>&#123;</span><br><span class="line">        <span class="keyword">constructor</span>(options?: Partial&lt;SpeedMeasurePluginOptions&gt;);</span><br><span class="line">        wrap(webpackConfig: Configuration): Configuration;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    export = SpeedMeasurePlugin;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ <code>webpack.prod.ts</code>ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> SpeedMeasurePlugin <span class="keyword">from</span> <span class="string">'speed-measure-webpack-plugin'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mergedConfig = merge(commonConfig, &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> smp = <span class="keyword">new</span> SpeedMeasurePlugin();</span><br><span class="line"><span class="keyword">const</span> prodConfig = smp.wrap(mergedConfig);</span><br></pre></td></tr></table></figure><h4 id="bundle-åˆ†æ"><a href="#bundle-åˆ†æ" class="headerlink" title="bundle åˆ†æ"></a>bundle åˆ†æ</h4><p><img data-src="https://i.loli.net/2020/02/19/Plifd7e9b2WOxsF.png" alt="bundle analyze"></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add BundleAnalyzerPlugin @types/BundleAnalyzerPlugin -D</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æ·»åŠ ä¸€ä¸ª npm script ç”¨äºå¸¦ bundle åˆ†æçš„æ„å»ºï¼Œå› ä¸ºæœ‰äº›æ—¶å€™æˆ‘ä»¬å¹¶ä¸æƒ³æ‰“å¼€ä¸€ä¸ªæµè§ˆå™¨å»åˆ†æå„ä¸ªæ¨¡å—çš„å¤§å°å’Œå æ¯”ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"build"</span>: <span class="string">"cross-env-shell NODE_ENV=production ts-node --files -P scripts/tsconfig.json scripts/build"</span>,</span><br><span class="line">    <span class="string">"build-analyze"</span>: <span class="string">"cross-env-shell NODE_ENV=production ts-node --files -P scripts/tsconfig.json scripts/build --analyze"</span>,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ <code>webpack.prod.ts</code>ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ·»åŠ </span></span><br><span class="line"><span class="keyword">import</span> &#123; isAnalyze &#125; <span class="keyword">from</span> <span class="string">'../env'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (isAnalyze) &#123;</span><br><span class="line">    mergedConfig.plugins!.push(<span class="keyword">new</span> BundleAnalyzerPlugin());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·å½“æˆ‘ä»¬æƒ³çœ‹å„ä¸ªæ¨¡å—åœ¨ bundle ä¸­çš„å¤§å°å’Œå æ¯”çš„æ—¶å€™å¯ä»¥è¿è¡Œ <code>npm run build-analyze</code>ï¼Œå°†ä¼šè‡ªåŠ¨åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ä¸Šå›¾ä¸­çš„é¡µé¢ã€‚</p><h4 id="å‡†å¤‡-gzip-å‹ç¼©ç‰ˆæœ¬"><a href="#å‡†å¤‡-gzip-å‹ç¼©ç‰ˆæœ¬" class="headerlink" title="å‡†å¤‡ gzip å‹ç¼©ç‰ˆæœ¬"></a>å‡†å¤‡ gzip å‹ç¼©ç‰ˆæœ¬</h4><p>æˆ‘ä»¬ä½¿ç”¨å®˜æ–¹ç»´æŠ¤çš„ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3dlYnBhY2stY29udHJpYi9jb21wcmVzc2lvbi13ZWJwYWNrLXBsdWdpbg==" title="https://github.com/webpack-contrib/compression-webpack-plugin">compression-webpack-plugin<i class="fa fa-external-link"></i></span> æ¥ä¸ºæ‰“åŒ…å‡ºæ¥çš„å„ä¸ªæ–‡ä»¶å‡†å¤‡ gzip å‹ç¼©ç‰ˆï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add compression-webpack-plugin @types/compression-webpack-plugin -D</span><br></pre></td></tr></table></figure><h4 id="è·Ÿè¸ª-gzip-åçš„èµ„æºå¤§å°"><a href="#è·Ÿè¸ª-gzip-åçš„èµ„æºå¤§å°" class="headerlink" title="è·Ÿè¸ª gzip åçš„èµ„æºå¤§å°"></a>è·Ÿè¸ª gzip åçš„èµ„æºå¤§å°</h4><p><img data-src="https://i.loli.net/2020/02/19/Oteqp9js3DPFrCS.png" alt="trace size"></p><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0dvb2dsZUNocm9tZUxhYnMvc2l6ZS1wbHVnaW4=" title="https://github.com/GoogleChromeLabs/size-plugin">size-plugin<i class="fa fa-external-link"></i></span> æ˜¯è°·æ­Œå‡ºå“çš„ä¸€ä¸ªæ˜¾ç¤º webpack å„ä¸ª chunk gzip å‹ç¼©åçš„ä½“ç§¯å¤§å°ä»¥åŠç›¸æ¯”äºä¸Šä¸€æ¬¡çš„å¤§å°å˜åŒ–ï¼Œä¸Šå›¾ä¸­çº¢æ¡†ä¸­çš„éƒ¨åˆ†æ˜¾ç¤ºäº†æˆ‘åŠ äº†ä¸€å¥ log ä¹‹å gizip ä½“ç§¯å¢åŠ äº† 11Bã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add size-plugin -D</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªåº“æœ‰æ²¡æœ‰å®˜æ–¹çš„ types æ–‡ä»¶ï¼Œæˆ‘ä»¬æ·»åŠ  <code>size-plugin</code> çš„å¤–éƒ¨æ¨¡å—å£°æ˜ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// scripts/typings/index.d.ts</span></span><br><span class="line">declare <span class="built_in">module</span> <span class="string">'size-plugin'</span> &#123;</span><br><span class="line">    <span class="keyword">import</span> &#123; Plugin &#125; <span class="keyword">from</span> <span class="string">'webpack'</span>;</span><br><span class="line"></span><br><span class="line">    interface SizePluginOptions &#123;</span><br><span class="line">        pattern: string;</span><br><span class="line">        exclude: string;</span><br><span class="line">        filename: string;</span><br><span class="line">        publish: boolean;</span><br><span class="line">        writeFile: boolean;</span><br><span class="line">        stripHash: <span class="built_in">Function</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">SizePlugin</span> <span class="keyword">extends</span> <span class="title">Plugin</span> </span>&#123;</span><br><span class="line">        <span class="keyword">constructor</span>(options?: Partial&lt;SizePluginOptions&gt;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    export = SizePlugin;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.prod.ts</span></span><br><span class="line"><span class="keyword">const</span> mergedConfig = merge(commonConfig, &#123;</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="comment">// ä¸è¾“å‡ºæ–‡ä»¶å¤§å°åˆ°ç£ç›˜</span></span><br><span class="line">    <span class="keyword">new</span> SizePlugin(&#123; <span class="attr">writeFile</span>: <span class="literal">false</span> &#125;),</span><br><span class="line">  ],</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ€è¿‘åˆšå­¦ä¼šä¸€ä¸ªè¯ <code>TL; DR</code>ï¼Œå…¶å®å°±æ˜¯ï¼š</p><blockquote><p>Too long; didnâ€™t read.</p></blockquote><p>å…¶å®æˆ‘è‡ªå·±ä¹Ÿæ˜¯ç»å¸¸è¿™æ ·ï¼Œå“ˆå“ˆã€‚åˆ°è¿™é‡Œå·²ç»æœ‰ 1 ä¸‡å¤šå­—äº†ï¼Œæˆ‘ä¼°è®¡åº”è¯¥æ²¡å‡ ä¸ªäººä¼šçœ‹åˆ°è¿™ã€‚æ•´ä¸ªæµç¨‹èµ°ä¸‹æ¥æˆ‘è§‰å¾—æ˜¯è¿˜æ˜¯éå¸¸è‡ªç„¶çš„ï¼Œä»å¼€å‘ç¯å¢ƒåˆ°ç”Ÿäº§ç¯å¢ƒï¼Œä»åŸºæœ¬çš„é…ç½®åˆ°ä¼˜åŒ–æ§åˆ¶å°æ˜¾ç¤ºï¼Œå‡†å¤‡ gzip å‹ç¼©ç‰ˆæœ¬è¿™äº›é”¦ä¸Šæ·»èŠ±çš„æ­¥éª¤ã€‚å†™è¿™ç¯‡æ–‡ç« å…¶å®å¤§éƒ¨åˆ†çš„æ—¶é—´éƒ½èŠ±è´¹åœ¨äº†æŸ¥é˜…èµ„æ–™ä¸Šï¼Œæ¯ä¸€ä¸ªæ’ä»¶æˆ‘éƒ½å°½é‡æè¿°å¥½å®ƒä»¬çš„ä½œç”¨ï¼Œå¦‚æœæœ‰å€¼å¾—æ³¨æ„çš„åœ°æ–¹æˆ‘ä¹Ÿä¼šåœ¨ä»£ç æ³¨é‡Šä¸­æˆ–è€…æ–‡å­—æè¿°ä¸­æå‡ºæ¥ã€‚æˆ‘çŸ¥é“å¯èƒ½è¿™ç¯‡æ–‡ç« å¯¹äºä¸€äº›åŸºç¡€æ¯”è¾ƒå·®æˆ–è€…æ²¡æ€ä¹ˆæ‰‹åŠ¨é…ç½®è¿‡ webpack çš„åŒå­¦å‹åŠ›æ¯”è¾ƒå¤§ï¼Œå¾ˆå¯èƒ½çœ‹ä¸ä¸‹å»ï¼Œè¿™æ˜¯æ­£å¸¸çš„ï¼Œæˆ‘ä»¥å‰ä¹Ÿæ˜¯è¿™æ ·ï¼Œä¸è¿‡æˆ‘è§‰å¾—ä½ å¦‚æœèƒ½å¤Ÿå’¬å’¬ç‰™åšæŒè¯»å®Œï¼Œå°½ç®¡å¾ˆå¤šåœ°æ–¹çœ‹ä¸æ‡‚ï¼Œä½ æ€»æ˜¯ä¼šä»ä¸­å­¦åˆ°ä¸€äº›å¯¹ä½ æœ‰ç”¨çš„ä¸œè¥¿ï¼Œæˆ–è€…ä½ ä¹Ÿå¯ä»¥æ”¶è—ä¸‹æ¥å½“è‡ªå­—å…¸æ¥æŸ¥ã€‚è¿™ç¯‡æ–‡ç« å¾ˆå¤šé…ç½®å¹¶ä¸æ˜¯å’Œ react+typescript å¼ºè€¦åˆçš„ï¼Œä½ åŠ ä¸€ä¸ª vue-loader ä¸å°±å¯ä»¥æ­£å¸¸ä½¿ç”¨ vue æ¥å¼€å‘äº†å—ï¼Ÿ<strong>æ›´é‡è¦çš„æ˜¯æˆ‘å¸Œæœ›ä¸€äº›è¯»è€…å¯ä»¥ä»ä¸­å­¦åˆ°æ¢ç´¢ç²¾ç¥ï¼Œå¯æ€•ä¸ä»£è¡¨ä¸å¯èƒ½ï¼Œå®è·µæ¢ç´¢æ‰èƒ½æŒæ¡çœŸçŸ¥ã€‚</strong></p><p>æœ€åæˆ‘ä»¬åŠ ä¸Šæˆ‘ä»¬çš„æ„å»ºè„šæœ¬ <code>build.ts</code>ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// scripts/build.ts</span></span><br><span class="line"><span class="keyword">import</span> webpack <span class="keyword">from</span> <span class="string">'webpack'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> prodConfig <span class="keyword">from</span> <span class="string">'./configs/webpack.prod'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; isAnalyze &#125; <span class="keyword">from</span> <span class="string">'./env'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> compiler = webpack(prodConfig);</span><br><span class="line"></span><br><span class="line">compiler.run(<span class="function">(<span class="params">error, stats</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (error) &#123;</span><br><span class="line">    <span class="built_in">console</span>.error(error);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> prodStatsOpts = &#123;</span><br><span class="line">    preset: <span class="string">'normal'</span>,</span><br><span class="line">    modules: isAnalyze,</span><br><span class="line">    colors: <span class="literal">true</span>,</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(stats.toString(prodStatsOpts));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><img data-src="https://i.loli.net/2020/02/19/ecaJjBtpHIEQoxC.gif" alt="effect"></p><p>æˆ‘æœ€è¿‘ä¸€ç›´åœ¨å¿™æ¯•ä¸šå’Œæ‰¾å·¥ä½œçš„äº‹æƒ…ï¼Œä¸‹ä¸€ç¯‡å¯èƒ½è¦åœ¨ä¸€ä¸ªæœˆåå·¦å³äº†ã€‚å¦‚æœè¯»è€…å¯¹æ–‡ç« ä¸­æœ‰å“ªäº›ä¸ç†è§£çš„åœ°æ–¹å»ºè®®å…ˆå»çœ‹ä¸‹<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RqeDY2Ni9yZWFjdC10eXBlc2NyaXB0LWJvaWxlcnBsYXRl" title="https://github.com/tjx666/react-typescript-boilerplate">æºä»£ç <i class="fa fa-external-link"></i></span>ï¼Œè¿˜æœ‰é—®é¢˜çš„è¯å¯ä»¥åœ¨ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RqeDY2Ni9yZWFjdC10eXBlc2NyaXB0LWJvaWxlcnBsYXRlL2lzc3Vlcw==" title="https://github.com/tjx666/react-typescript-boilerplate/issues">github issues<i class="fa fa-external-link"></i></span> æˆ–è€…å‘å¸ƒå¹³å°çš„è¯„è®ºåŒºå‘æˆ‘æé—®ï¼Œå¦‚æœè§‰å¾—æœ¬æ–‡å¯¹ä½ æœ‰ç”¨ï¼Œä¸å¦¨èµé¢— star ğŸ˜ã€‚</p><p>ä¸‹ä¸€ç¯‡åº”è¯¥ä¼šè®²è¿°å¦‚ä½•é›†æˆ <code>ant design</code>ï¼Œ<code>lodash</code> ç­‰æµè¡Œåº“å¹¶å¯¹å®ƒä»¬çš„æ‰“åŒ…è¿›è¡Œä¼˜åŒ–â€¦</p><p>æœ¬æ–‡ä¸ºåŸåˆ›å†…å®¹ï¼Œé¦–å‘äº<span class="exturl" data-url="aHR0cDovL3d3dy5seXJlYWw2NjYuY29tLw==" title="http://www.lyreal666.com/">ä¸ªäººåšå®¢<i class="fa fa-external-link"></i></span>ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>react</tag>
        <tag>typescript</tag>
        <tag>webpack</tag>
        <tag>express</tag>
        <tag>babel</tag>
      </tags>
  </entry>
  <entry>
    <title>ä»é›¶å¼€å§‹é…ç½® react + typescriptï¼ˆäºŒï¼‰ï¼šlinters å’Œ formatter</title>
    <url>/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E9%85%8D%E7%BD%AE-react-typescript%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9Alinters-%E5%92%8C-formatter/</url>
    <content><![CDATA[<p>ç»§ <a href="https://lyreal666.com/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E9%85%8D%E7%BD%AE-react-typescript%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9Adotfiles/">ä»é›¶å¼€å§‹é…ç½® react + typescriptï¼ˆä¸€ï¼‰ï¼šdotfiles</a> ä»‹ç»äº†ä¸€äº›æœ€å…ˆé…ç½®çš„ dotfilesï¼Œæœ¬ç¯‡å°†ç»§ç»­ä»‹ç» lint å·¥å…· eslintï¼Œstylelintï¼Œä»£ç æ ¼å¼åŒ–å·¥å…· prettierï¼Œç”¨ husky + lint-staged æ¥å®ç°æ¯æ¬¡ commit æ—¶åª lint ä¿®æ”¹è¿‡çš„ä»£ç ï¼Œä»¥åŠä½¿ç”¨ commitlint æ¥è§„èŒƒåŒ– commit messageã€‚</p><p>é¡¹ç›®åœ°å€ï¼š<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RqeDY2Ni9yZWFjdC10eXBlc2NyaXB0LWJvaWxlcnBsYXRl" title="https://github.com/tjx666/react-typescript-boilerplate">react-typescript-boilerplate<i class="fa fa-external-link"></i></span></p><a id="more"></a><h2 id="eslint"><a href="#eslint" class="headerlink" title="eslint"></a>eslint</h2><blockquote><p>Find and fix problems in your JavaScript code</p></blockquote><p><img data-src="https://i.loli.net/2020/02/03/aWBruH69SoGDET5.png" alt="eslint-react-hooks.png"></p><p>å…¶å®ç¤¾åŒºæœ‰å¾ˆå¤šçš„ lint å·¥å…·ï¼Œä¾‹å¦‚ eslint, stylelint, tslint, htmllint, markdownlint ç­‰ã€‚lint å·¥å…·ä¸€æ–¹é¢å¯ä»¥å¸®åŠ©ç»´æŠ¤å›¢é˜Ÿæˆå‘˜ä¿æŒç»Ÿä¸€è‰¯å¥½çš„ä»£ç é£æ ¼ï¼Œè€Œä¸”å¯ä»¥å®šåˆ¶è‡ªå·±å›¢é˜Ÿçš„è§„åˆ™é›†åˆï¼Œå¦ä¸€é¢å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ£€æµ‹å‡ºä»£ç çš„åå‘³é“ï¼Œé™ä½ bug çš„äº§ç”Ÿçš„å¯èƒ½æ€§ï¼Œæé«˜ä»£ç è´¨é‡ã€‚éœ€è¦æŒ‡å‡ºçš„æ˜¯ï¼š<strong>lint å·¥å…·æœ‰ä¸€å®šçš„æ ¼å¼åŒ–èƒ½åŠ›ï¼Œä½†æ˜¯ä¸»è¦åŠŸèƒ½ä¸æ˜¯è´Ÿè´£æ ¼å¼åŒ–ä»£ç ï¼Œæ ¼å¼åŒ–ä»£ç åº”è¯¥äº¤ç»™ä¸“é—¨çš„æ ¼å¼åŒ–å·¥å…·ã€‚</strong> æˆ‘ä»¬è¿™ä¸ªé¡¹ç›®å°±å°†å‡†å¤‡ä½¿ç”¨ prettier è¿›è¡Œä»£ç æ ¼å¼åŒ–ã€‚</p><p>å› ä¸ºæ˜¯æ‰“ç®—ä½¿ç”¨ TypeScript æ¥ç¼–å†™ reactï¼Œæ‰€ä»¥è¦é€‰æ‹©ä¸€æ¬¾æ”¯æŒ TypeScript çš„ lint å·¥å…·ï¼Œæœ€æµè¡Œçš„æ”¯æŒ TypeScript çš„ lint å·¥å…·æœ‰ä¿©ï¼Œtslint å’Œ eslintã€‚å»å¹´ 2019 å¹´ 2 æœˆä»½ tslint å›¢é˜Ÿå°±å®£å¸ƒäº†åºŸå¼ƒ tslintï¼Œè½¬è€Œå°†ç»´æŠ¤ä¸€ç³»åˆ—å°† TypeScript é›†æˆåˆ° ESLint çš„å·¥å…·ã€‚å…·ä½“å¯ä»¥çœ‹è¿™ä¸ª <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3BhbGFudGlyL3RzbGludC9pc3N1ZXMvNDUzNA==" title="https://github.com/palantir/tslint/issues/4534">issue<i class="fa fa-external-link"></i></span> å’Œè¿™ç¯‡åšå®¢ï¼š<span class="exturl" data-url="aHR0cHM6Ly9tZWRpdW0uY29tL3BhbGFudGlyL3RzbGludC1pbi0yMDE5LTFhMTQ0YzIzMTdhOQ==" title="https://medium.com/palantir/tslint-in-2019-1a144c2317a9">TSLint in 2019<i class="fa fa-external-link"></i></span>ã€‚</p><p>2020 å¹´æˆ‘è§‰å¾—æ–°é¡¹ç›®æ²¡æœ‰ä»»ä½•ç†ç”±è¿˜å»é€‰æ‹© tslintï¼Œeslint çš„ TypeScript æ’ä»¶å·²ç»ç®—æ˜¯æ¯”è¾ƒæˆç†Ÿäº†ï¼Œè™½ç„¶è¿˜æ˜¯æœ‰æŒºå¤šçš„ bugï¼Œåé¢ä¼šæåˆ°ä¸€äº›ã€‚</p><p>å…¶å®å‰ç«¯ç»å¤§å¤šæ•°æ„å»ºå·¥å…·éƒ½æ˜¯ç”¨ node ç¼–å†™æ¨¡å—æ¥æä¾› APIï¼Œæœ‰äº›ä¹Ÿä¼šæä¾›å‘½ä»¤è¡Œå·¥å…·ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯è§£æç”¨æˆ·è¾“å…¥è°ƒç”¨ node APIï¼Œç„¶åå¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶æ¥é…ç½®é€‰é¡¹å’Œé›†æˆæ’ä»¶ã€‚</p><p>eslint ä¹Ÿä¸ä¾‹å¤–ï¼Œé…ç½® eslint å»ºè®®ä½¿ç”¨ eslint å‘½ä»¤è¡Œå·¥å…·æä¾›çš„äº¤äº’å¼é…ç½®ç”Ÿæˆå™¨ã€‚å¾ˆå¤šåŒ…æ—¢å¯ä»¥å…¨å±€å®‰è£…ï¼Œä¹Ÿå¯ä»¥æœ¬åœ°å®‰è£…ï¼Œæˆ‘ä»¬é€‰æ‹©æœ¬åœ°å®‰è£…ï¼Œå› ä¸ºä½ æ²¡åŠæ³•ç¡®ä¿åˆ«äººå¼€å‘è¿™ä¸ªé¡¹ç›®çš„æ—¶å€™ä¹Ÿå…¨å±€å®‰è£…äº†ï¼Œè€Œä¸”è¿™æ ·è¿˜å¯ä»¥ä¿è¯éƒ½æ˜¯ä½¿ç”¨åŒä¸€ç‰ˆæœ¬ã€‚</p><p>å®‰è£… eslintï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -D å‚æ•°è¡¨ç¤ºå¼€å‘ä¾èµ–</span></span><br><span class="line">yarn add eslint -D</span><br></pre></td></tr></table></figure><p>è°ƒç”¨ eslint è‡ªå¸¦çš„é…ç½®ç”Ÿæˆå™¨ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npx eslint --init</span><br></pre></td></tr></table></figure><p>npx æ˜¯ npm 5.2 è‡ªå¸¦çš„ä¸€ä¸ªå‘½ä»¤ï¼Œ<code>x</code> å°±æ˜¯å’Œæ–‡ä»¶ç±»å‹æè¿°ç¬¦çš„é‚£ä¸ª <code>x</code> ä¸€æ ·è¡¨ç¤º <code>execute</code> æ‰§è¡Œå˜›ã€‚å¦‚æœæœ¬åœ°å®‰è£…äº†å°±ä¼šç”¨æœ¬åœ°çš„ eslintï¼Œæ²¡å®‰è£…å°±å»æ‰¾å…¨å±€çš„ï¼Œå…¨å±€å†æ²¡æœ‰å°±åœ¨ä¸´æ—¶ç›®å½•ä¸‹è½½ eslintï¼Œç”¨å®Œå°±åˆ ã€‚ç”¨èµ·æ¥æ¯” npm scripts è¿˜æ–¹ä¾¿ï¼Œä¼ å‚æ•°ä¸ç”¨åƒ npm scripts ä¸€æ ·è¦åœ¨å‚æ•°å‰åŠ  <code>--</code>ã€‚æ‰§è¡Œä¸Šé¢çš„ eslint åˆå§‹åŒ–å‘½ä»¤åä¼šè¯¢é—®ä½ ä¸€ç³»åˆ—çš„é—®é¢˜ï¼Œå…³äºæ¯ä¸€ä¸ªé—®é¢˜çš„è¯¦ç»†è¯´æ˜å»ºè®®çœ‹ä¸€ä¸‹è¿™ç¯‡æ–‡ç«  <span class="exturl" data-url="aHR0cHM6Ly9kZXYudG8vZGV2ZGFtbWFrL3NldHRpbmctdXAtZXNsaW50LWluLXlvdXItamF2YXNjcmlwdC1wcm9qZWN0LXdpdGgtdnMtY29kZS0yYW1m" title="https://dev.to/devdammak/setting-up-eslint-in-your-javascript-project-with-vs-code-2amf">Setting up ESLINT in your JavaScript Project with VS Code<i class="fa fa-external-link"></i></span>ï¼Œè¿™ç¯‡æ–‡ç« è¯´çš„å¾ˆç»†ã€‚</p><ul><li><p>How would you like to use ESLint?</p><p>æˆ‘ä»¬é€‰æ‹©ç¬¬ä¸‰æ¡ï¼Œé€‰æ‹©å…¶å®ƒå‡ æ¡å°±ä¸ä¼šé—®æˆ‘ä»¬æ˜¯å¦é€‰æ‹© Googleï¼ŒAirbnb è¿˜æ˜¯ Standard é£æ ¼äº†</p></li><li><p>What type of modules does your project use?</p><p>æˆ‘ä»¬é€‰æ‹© <code>JavaScript modules (import/export)</code>ï¼ŒåŒ…æ‹¬ webpack é…ç½®ç­‰ node è„šæœ¬æˆ‘ä»¬éƒ½å°†ä½¿ç”¨ ts æ¥ç¼–å†™ï¼Œæ‰€ä»¥é€‰æ‹© esm</p></li><li><p>Which framework does your project use?</p><p>æ˜¾ç„¶é€‰æ‹© react</p></li><li><p>Does your project use TypeScript?</p><p>è¿™ä¸€æ­¥ä¸€å®šè¦é€‰ Yï¼Œåªæœ‰å‘Šè¯‰åˆå§‹åŒ–å™¨æˆ‘ä»¬ä½¿ç”¨ TypeScriptï¼Œå®ƒæ‰ä¼šå¸®åŠ©æˆ‘ä»¬é…ç½®å¥½ TypeScript çš„ ESLint parserï¼Œç›¸å…³çš„ pluginsï¼Œ ä»¥åŠå…¶å®ƒé…ç½®</p></li><li><p>Where does your code run?</p><p>è¿™é‡Œæˆ‘ä»¬ browser å’Œ node ä¸¤ä¸ªéƒ½é€‰ä¸Šï¼Œå› ä¸ºæˆ‘ä»¬è¿˜è¦ç¼–å†™ä¸€äº› node ä»£ç </p></li><li><p>How would you like to define a style for your project?</p><p>æˆ‘ä»¬é€‰ç¬¬ä¸€ä¸ª <code>Use a popular style guide</code></p></li><li><p>Which style guide do you want to follow?</p><p>é€‰æ‹© Airbnbï¼ˆçˆ±å½¼è¿ï¼‰çš„ä»£ç é£æ ¼</p></li><li><p>What format do you want your config file to be in?</p><p>æˆ‘ä»¬é€‰æ‹©æœ€çµæ´»çš„é…ç½®æ–¹å¼ï¼šjavascript</p></li><li><p>Would you like to install them now with npm?</p><p>é€‰æ‹© Yï¼Œç«‹å³å®‰è£…ä¾èµ–ã€‚è™½ç„¶æˆ‘ä»¬ç”¨çš„æ˜¯ yarnï¼Œä¸åº”è¯¥ä½¿ç”¨ npm å®‰è£…ä¾èµ–ï¼Œç”¨ npm å®‰è£…ä¾èµ–è¿˜ä¼šç”Ÿæˆå¯¹æˆ‘ä»¬æ²¡æœ‰ç”¨ <code>package-lock.json</code>ã€‚<code>package.lock.json</code> å’Œ <code>yarn.lock</code> ä¸€æ ·éƒ½æ˜¯ç”¨æ¥é”å®šä¾èµ–ç‰ˆæœ¬çš„ã€‚ä¹‹æ‰€ä»¥è¿™é‡Œé€‰æ‹©ç«‹å³å®‰è£…ä¾èµ–æ˜¯å› ä¸ºä½ å¦‚æœä¸ç«‹å³å®‰è£…ä¾èµ–ï¼Œåé¢ä½ æƒ³å†ç”¨ yarn å®‰è£…ä¾èµ–çš„æ—¶è¿˜è¦å»æŸ¥ä¸€ä¸‹å®‰è£…å“ªå‡ ä¸ªä¾èµ–ï¼Œæˆ‘è§‰å¾—å¾ˆéº»çƒ¦ã€‚</p></li></ul><p>å®‰è£…å®Œä¹‹åï¼ŒæŠŠ <code>node_modules</code>, <code>package-lock.json</code>, <code>yarn.lock</code> éƒ½åˆ æ‰ï¼Œä½¿ç”¨ yarn é‡æ–°å®‰è£…ä¾èµ–ï¼Œå†å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…ä¾èµ–</span></span><br><span class="line">yarn</span><br><span class="line"><span class="comment"># å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬</span></span><br><span class="line">yarn upgrade --latest</span><br></pre></td></tr></table></figure><p>é€šè¿‡ eslint è‡ªå¸¦çš„é…ç½®ç”Ÿæˆå™¨æˆ‘ä»¬ç”Ÿæˆäº† <code>.eslintrc.js</code> ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ ¼å¼åŒ–åçš„ .eslintrc.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  env: &#123;</span><br><span class="line">    browser: <span class="literal">true</span>,</span><br><span class="line">    es6: <span class="literal">true</span>,</span><br><span class="line">    node: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  extends: [<span class="string">'plugin:react/recommended'</span>, <span class="string">'airbnb'</span>],</span><br><span class="line">  globals: &#123;</span><br><span class="line">    Atomics: <span class="string">'readonly'</span>,</span><br><span class="line">    SharedArrayBuffer: <span class="string">'readonly'</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  parser: <span class="string">'@typescript-eslint/parser'</span>,</span><br><span class="line">  parserOptions: &#123;</span><br><span class="line">    ecmaFeatures: &#123;</span><br><span class="line">      jsx: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    ecmaVersion: <span class="number">2018</span>,</span><br><span class="line">    sourceType: <span class="string">'module'</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [<span class="string">'react'</span>, <span class="string">'@typescript-eslint'</span>],</span><br><span class="line">  rules: &#123;&#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ç›¸å¯¹äºé TypeScript é¡¹ç›®ï¼Œä½¿ç”¨ <code>@typescript-eslint/parser</code> æ›¿æ¢æ‰äº†é»˜è®¤çš„ parserï¼Œå¹¶æ·»åŠ äº† <code>@typescript-eslint</code> æ’ä»¶ã€‚</p><p>æˆ‘ä»¬å…ˆåšä»¥ä¸‹ä¿®æ”¹ï¼š</p><ul><li><p>æŸ¥çœ‹ <span class="exturl" data-url="aHR0cHM6Ly93d3cubnBtanMuY29tL3BhY2thZ2UvZXNsaW50LWNvbmZpZy1haXJibmI=" title="https://www.npmjs.com/package/eslint-config-airbnb">eslint-config-airbnb<i class="fa fa-external-link"></i></span> çš„è¯´æ˜ï¼Œé‡Œé¢æåˆ°ï¼Œå¦‚æœè¦å¼€å¯ react hooks æ£€æŸ¥ï¼Œéœ€è¦æ·»åŠ  <code>&quot;extends&quot;: &quot;airbnb/hooks&quot;</code> åˆ° <code>.eslintrc.js</code></p></li><li><p>ä¿®æ”¹ <code>parserOptions.ecmaVersion</code> ä¸º 2020ï¼Œäº‰åšæ–°æ—¶ä»£çš„å¼„æ½®å„¿ ğŸ˜‚</p></li><li><p>æŸ¥çœ‹ <span class="exturl" data-url="aHR0cHM6Ly93d3cubnBtanMuY29tL3BhY2thZ2UvQHR5cGVzY3JpcHQtZXNsaW50L2VzbGludC1wbHVnaW4=" title="https://www.npmjs.com/package/@typescript-eslint/eslint-plugin">@typescript-eslint/eslint-plugin<i class="fa fa-external-link"></i></span> æ–‡æ¡£ï¼Œé‡Œé¢æåˆ°æˆ‘ä»¬å¯ä»¥é€šè¿‡æ·»åŠ  <code>extends: &#39;plugin:@typescript-eslint/recommended&#39;</code>æ¥å¼€å¯å®ƒæ¨èçš„ä¸€äº› rulesï¼Œä¿®æ”¹ <code>extends</code>ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// .eslintrc.js</span></span><br><span class="line">&#123;</span><br><span class="line">    extends: [<span class="string">'plugin:react/recommended'</span>, <span class="string">'airbnb'</span>, <span class="string">'airbnb/hooks'</span>,<span class="string">'plugin:@typescript-eslint/recommended'</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ä¸ºäº†è®© <code>eslint-plugin-import</code> èƒ½å¤Ÿæ­£ç¡®è§£æ <code>ts</code>, <code>tsx</code>, <code>json</code> åç¼€åï¼Œæˆ‘ä»¬è¿˜éœ€æŒ‡å®šå…è®¸çš„åç¼€åï¼Œæ·»åŠ  <code>setttings</code> å­—æ®µï¼ŒåŠ å…¥ä»¥ä¸‹é…ç½®ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// .eslintrc.js</span></span><br><span class="line">&#123;</span><br><span class="line">    settings: &#123;</span><br><span class="line">        <span class="string">'import/resolver'</span>: &#123;</span><br><span class="line">            node: &#123;</span><br><span class="line">                <span class="comment">// æŒ‡å®š eslint-plugin-import è§£æçš„åç¼€å</span></span><br><span class="line">                extensions: [<span class="string">'.ts'</span>, <span class="string">'.tsx'</span>, <span class="string">'.js'</span>, <span class="string">'.json'</span>],</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ä¸ºäº†è®© <code>eslint-plugin-import</code> èƒ½å¤Ÿæ­£ç¡®è§£æ <code>tsconfig.json</code> ä¸­çš„ <code>paths</code> æ˜ å°„ï¼Œæˆ‘ä»¬éœ€è¦å®‰è£… <code>eslint-import-resolver-typescript</code>ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add eslint-import-resolver-typescript -D</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ <code>settings</code> å­—æ®µï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// .eslintrc.js</span></span><br><span class="line">&#123;</span><br><span class="line">    settings: &#123;</span><br><span class="line">        <span class="string">'import/resolver'</span>: &#123;</span><br><span class="line">            typescript: &#123;</span><br><span class="line">                <span class="comment">// é…ç½® eslint-import-resolver-typescript è¯»å– tsconfig.json çš„è·¯å¾„</span></span><br><span class="line">                <span class="comment">// ç›®å‰ç”¨ä¸ç€ï¼Œå…ˆæ³¨é‡Šæ‰</span></span><br><span class="line">                <span class="comment">// directory: [resolve('./src/tsconfig.json'), resolve('./scripts/tsconfig.json')],</span></span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p>åœ¨æˆ‘çš„ä½¿ç”¨ä¸­æˆ‘å‘ç°ï¼Œç›®å‰ <code>eslint-plugin-import</code> å’Œ <code>TypeScript</code> æ­é…è¿˜æ˜¯å­˜åœ¨å¾ˆå¤šçš„ bugï¼Œå…¶ä¸­çš„ä¸€ä¸ªä¸èƒ½å¿çš„ bug å°±æ˜¯<code>import/extensions</code> è¿™ä¸ªè§„åˆ™ä¸èƒ½æ­£ç¡®å¤„ç†æ–‡ä»¶åç¼€åï¼š</p><p><img data-src="https://i.loli.net/2020/02/02/iRsYKELCtXvyz9k.png" alt="import-extension.png"></p><p>å» <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2Jlbm1vc2hlci9lc2xpbnQtcGx1Z2luLWltcG9ydC9pc3N1ZXM/dXRmOD0lRTIlOUMlOTMmcT1pcyUzQWlzc3VlK2lzJTNBb3BlbitpbXBvcnQlMkZleHRlbnNpb25zK3R5cGVzY3JpcHQ=" title="https://github.com/benmosher/eslint-plugin-import/issues?utf8=%E2%9C%93&q=is%3Aissue+is%3Aopen+import%2Fextensions+typescript">eslint-plugin-import<i class="fa fa-external-link"></i></span> github issue æœç´¢å…³é”®å­— <code>import/extensions typescript</code> å¯ä»¥æœåˆ°å¾ˆå¤šç›¸å…³çš„ issuesã€‚ç›®å‰æˆ‘é‡‡ç”¨çš„è§£å†³æ–¹æ¡ˆæ˜¯ä¿®æ”¹ <code>import/extension</code> çš„è§„åˆ™é…ç½®ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">'import/extensions'</span>: [</span><br><span class="line">    <span class="string">'2,</span></span><br><span class="line"><span class="string">    '</span>ignorePackages<span class="string">',</span></span><br><span class="line"><span class="string">    &#123;</span></span><br><span class="line"><span class="string">        ts: '</span>never<span class="string">',</span></span><br><span class="line"><span class="string">        tsx: '</span>never<span class="string">',</span></span><br><span class="line"><span class="string">        json: '</span>never<span class="string">',</span></span><br><span class="line"><span class="string">        js: '</span>never<span class="string">'</span></span><br><span class="line"><span class="string">    &#125;,</span></span><br><span class="line"><span class="string">],</span></span><br></pre></td></tr></table></figure><p>å¦å¤–ä¸€ä¸ªè¦æçš„ bug å°±æ˜¯è¿™ä¸ª issueï¼š <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R5cGVzY3JpcHQtZXNsaW50L3R5cGVzY3JpcHQtZXNsaW50L2lzc3Vlcy80MjA=" title="https://github.com/typescript-eslint/typescript-eslint/issues/420">no-useless-constructor: Cannot read property â€˜bodyâ€™ of null<i class="fa fa-external-link"></i></span>ï¼Œç®€å•æ¥è¯´å°±æ˜¯ç›®å‰åœ¨ eslint æ­é… typescript ç›¸å…³æ’ä»¶æ—¶ï¼Œå¦‚æœ <code>.d.ts</code> å£°æ˜æ–‡ä»¶ä¸­å¦‚æœä½¿ç”¨äº† <code>constructor</code> å°±ä¼šæŠ¥è¿™ä¸ªé”™ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">declare <span class="built_in">module</span> <span class="string">'size-plugin'</span> &#123;</span><br><span class="line">    <span class="keyword">import</span> &#123; Plugin &#125; <span class="keyword">from</span> <span class="string">'webpack'</span>;</span><br><span class="line"></span><br><span class="line">    interface SizePluginOptions &#123;</span><br><span class="line">        writeFile?: boolean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">SizePlugin</span> <span class="keyword">extends</span> <span class="title">Plugin</span> </span>&#123;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨äº† constructor å°±æŠ¥é”™ï¼šno-useless-constructor: Cannot read property 'body' of null</span></span><br><span class="line">        <span class="keyword">constructor</span>(options?: SizePluginOptions);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    export = SizePlugin;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›®å‰æˆ‘é‡‡ç”¨çš„è§£å†³åŠæ³•æ—¶æ˜¯æ·»åŠ ä¸‹é¢ä¸¤ä¸ªè§„åˆ™ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">rules: &#123;</span><br><span class="line">    <span class="string">'no-useless-constructor'</span>: <span class="string">'off'</span>,</span><br><span class="line">    <span class="string">'@typescript-eslint/no-useless-constructor'</span>: <span class="string">'error'</span>,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>é’ˆå¯¹ <code>.d.ts</code> æ–‡ä»¶æˆ‘ä»¬è¿˜éœ€è¦è¦ç¦ç”¨ä¸€äº›è§„åˆ™ï¼Œæˆ‘ä»¬åç»­ä¼šåœ¨ <code>script</code> æ–‡ä»¶å¤¹ä¸­å®ç°å’Œ webpack ç›¸å…³çš„ node è„šæœ¬ï¼Œé’ˆå¯¹è¿™ä¸ªæ–‡ä»¶å¤¹ä¹Ÿè°ƒæ•´ä¸€äº›è§„åˆ™ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// .eslintrc.js</span></span><br><span class="line">&#123;</span><br><span class="line">  overrides: [</span><br><span class="line">        &#123;</span><br><span class="line">            files: [<span class="string">'**/*.d.ts'</span>],</span><br><span class="line">            rules: &#123;</span><br><span class="line">                <span class="string">'import/no-duplicates'</span>: OFF,</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            files: [<span class="string">'scripts/**/*.ts'</span>],</span><br><span class="line">            rules: &#123;</span><br><span class="line">                <span class="string">'import/no-extraneous-dependencies'</span>: OFF,</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">    ],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶å®ƒä¸€äº›ä¸ªäººä¹ æƒ¯çš„è§„åˆ™è°ƒæ•´æˆ‘å°±ä¸æäº†ï¼Œè¯»è€…å¯ä»¥ç›´æ¥å»çœ‹æœ€ç»ˆçš„é…ç½®ï¼š<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RqeDY2Ni9yZWFjdC10eXBlc2NyaXB0LWJvaWxlcnBsYXRlL2Jsb2IvbWFzdGVyLy5lc2xpbnRyYy5qcw==" title="https://github.com/tjx666/react-typescript-boilerplate/blob/master/.eslintrc.js">.eslintrc.js<i class="fa fa-external-link"></i></span>ã€‚</p><p>ç›®å‰è¿™ä¸ªé…ç½®è¿˜å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œä¾‹å¦‚å¾ˆå¤š rules ä¼šå’Œ <code>prettier</code> å†²çªï¼Œåé¢æˆ‘ä»¬ä¼šä¸€ä¸€è§£å†³è¿™äº›é—®é¢˜ã€‚</p><h2 id="stylelint"><a href="#stylelint" class="headerlink" title="stylelint"></a>stylelint</h2><blockquote><p>A mighty, modern linter that helps you avoid errors and enforce conventions in your styles</p></blockquote><p><img data-src="https://i.loli.net/2020/02/20/1X387zS5GgclEVo.png" alt="stylelint"></p><p>å¯¹äº stylelintï¼Œæˆ‘ä¸€èˆ¬éƒ½æ˜¯ç›´æ¥å‚è€ƒ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FudC1kZXNpZ24vYW50LWRlc2lnbi9ibG9iL21hc3Rlci8uc3R5bGVsaW50cmMuanNvbg==" title="https://github.com/ant-design/ant-design/blob/master/.stylelintrc.json">ant design çš„ stylint é…ç½®<i class="fa fa-external-link"></i></span>ã€‚æ·»åŠ  <code>.stylelintrc.json</code> åˆ°é¡¹ç›®æ ¹è·¯å¾„ï¼Œcopy è¿‡æ¥ç®€å•ä¿®æ”¹ä¸€ä¸‹ï¼Œï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// .stylelintrc.json</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"extends"</span>: [<span class="string">"stylelint-config-standard"</span>, <span class="string">"stylelint-config-rational-order"</span>],</span><br><span class="line">    <span class="string">"plugins"</span>: [<span class="string">"stylelint-order"</span>, <span class="string">"stylelint-declaration-block-no-ignored-properties"</span>],</span><br><span class="line">    <span class="string">"rules"</span>: &#123;</span><br><span class="line">        <span class="string">"comment-empty-line-before"</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="string">"declaration-empty-line-before"</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="string">"function-name-case"</span>: <span class="string">"lower"</span>,</span><br><span class="line">        <span class="string">"no-descending-specificity"</span>: <span class="literal">null</span>,</span><br><span class="line">        <span class="string">"no-invalid-double-slash-comments"</span>: <span class="literal">null</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"ignoreFiles"</span>: [<span class="string">"node_modules/**/*"</span>, <span class="string">"src/assets/**/*"</span>, <span class="string">"dist/**/*"</span>, <span class="string">"**/typings/**/*"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘å»æ‰äº† <code>stylelint-config-prettier</code> æ’ä»¶ï¼ˆåé¢ä¼šåŠ ä¸Šï¼‰ï¼Œä¿®æ”¹äº† <code>function-name-case</code> è§„åˆ™ï¼Œæœ€åå°† <code>ignoreFiles</code> é€‰é¡¹ä¿®æ”¹ä¸º <code>[&quot;node_modules/**/*&quot;, &quot;src/assets/**/*&quot;, &quot;dist/**/*&quot;, &quot;**/typings/**/*&quot;]</code>ã€‚</p><p><code>src/assets</code> æ–‡ä»¶å¤¹å‡†å¤‡ç”¨æ¥ä¿å­˜ä¸€äº›èµ„æºæ–‡ä»¶ï¼Œä¾‹å¦‚ç¬¬ä¸‰æ–¹çš„ css åº“ï¼Œå¹¶ä¸éœ€è¦ lintã€‚VSCode çš„ stylelint æ’ä»¶ç›®å‰æœ‰ä¸ª bugï¼Œé»˜è®¤å±…ç„¶ä¼š lint <code>.d.ts</code> æ–‡ä»¶ç„¶åæŠ¥é”™ï¼Œæ‰€ä»¥æˆ‘ä¹Ÿæ·»åŠ äº† <code>&quot;**/typings/**/*&quot;</code> æ¥å¿½ç•¥ <code>.d.ts</code> æ–‡ä»¶ï¼š</p><p><img data-src="https://i.loli.net/2020/02/20/H1g5SiBMrslOI7Q.png" alt="vscode stylint bug"></p><p>æ ¹æ®ä¸Šé¢çš„é…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…å¯¹åº”çš„ npm åŒ…ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add stylelint stylelint-config-standard stylelint-config-rational-order stylelint-order stylelint-declaration-block-no-ignored-properties -D</span><br></pre></td></tr></table></figure><p>å’Œ eslint ä¸€æ ·ï¼Œä¼šä¸ prettier å­˜åœ¨å†²çªã€‚</p><h2 id="prettier"><a href="#prettier" class="headerlink" title="prettier"></a>prettier</h2><blockquote><p>An opinionated code formatter</p></blockquote><p><code>opinionated</code> å¯ä»¥ç†è§£ä¸º <code>ç‹¬æ–­ä¸“è¡Œ</code>ï¼Œ<code>è‡ªä»¥ä¸ºæ˜¯</code>ï¼Œå…¶å®å°±æ˜¯è¯´è¿™ä¸ªæ ¼å¼åŒ–å™¨ï¼ˆformatterï¼‰ä¸ç»™ç”¨æˆ·åšé€‰æ‹©ï¼Œå°±æŒ‰ç…§ä¸€å¥—ç¤¾åŒºå…±è¯†ï¼Œæœ€ä½³å®è·µï¼Œæœ€å¥½çœ‹çš„çš„ä»£ç é£æ ¼æ¥æ ¼å¼åŒ–ã€‚å…·ä½“è¡¨ç°å°±æ˜¯æä¾›çš„é€‰é¡¹å¾ˆå°‘ï¼Œæˆ‘æ•°äº†ä¸€ä¸‹æ€»å…±åˆšå¥½ 20 ä¸ªé€‰é¡¹ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬å¾—å®‰è£… <code>prettier</code>ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add prettier -D</span><br></pre></td></tr></table></figure><p>æ·»åŠ  .<code>prettierrc</code> åˆ°é¡¹ç›®æ ¹è·¯å¾„ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"trailingComma"</span>: <span class="string">"all"</span>,</span><br><span class="line">    <span class="string">"tabWidth"</span>: <span class="number">4</span>,</span><br><span class="line">    <span class="string">"semi"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="string">"singleQuote"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="string">"endOfLine"</span>: <span class="string">"auto"</span>,</span><br><span class="line">    <span class="string">"printWidth"</span>: <span class="number">100</span>,</span><br><span class="line">    <span class="string">"overrides"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"files"</span>: <span class="string">"*.md"</span>,</span><br><span class="line">            <span class="string">"options"</span>: &#123;</span><br><span class="line">                <span class="string">"tabWidth"</span>: <span class="number">2</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç®€å•è¯´æ˜ä¸‹ä¸€äº›é€‰é¡¹è¿™æ ·é…ç½®çš„åŸå› ï¼š</p><ul><li><p><code>&quot;trailingComma&quot;: &quot;all&quot;</code>ï¼Œæ”¯æŒåœ¨å‡½æ•°å‚æ•°ä¸­ä¹Ÿæ’å…¥é€—å·</p><p><img data-src="https://i.loli.net/2020/02/03/EXeHDFAjzxTS1mi.png" alt="prettier-trailing-comma.png"></p></li><li><p><code>&quot;semi&quot;: true</code>ï¼Œä¸ªäººä¹ æƒ¯</p></li><li><p><code>&quot;singleQuote&quot;: true,</code>ï¼Œä¸ªäººä¹ æƒ¯ï¼Œå°‘æ•²ä¸€ä¸‹ shift éš¾é“ä¸å¥½å—ï¼Ÿ</p></li><li><p><code>&quot;endOfLine&quot;: &quot;auto&quot;</code>ï¼Œå’Œ <code>editorconfig</code> ä¸€æ ·ï¼ŒæŒ‰ç…§æ“ä½œç³»ç»Ÿé»˜è®¤çš„æ¢è¡Œç¬¦æ¥å°±è¡Œäº†</p></li><li><p><code>&quot;printWidth&quot;: 100</code>ï¼Œæˆ‘è§‰å¾—é»˜è®¤çš„æœ€å¤§è¡Œå®½ 80 å¤ªçŸ­äº†ï¼Œæµªè´¹ç¼–è¾‘å™¨ç©ºé—´</p></li><li><p>ä¹‹æ‰€ä»¥è®¾ç½® markdown æ–‡ä»¶æ ¼å¼åŒ– <code>&quot;tabWidth&quot;: 2</code>ï¼Œæ˜¯ç›®å‰ prettier åœ¨æ ¼å¼åŒ– markdown æ–‡ä»¶æ—¶ï¼Œä¼šåœ¨æ— åºåˆ—è¡¨ä¸­æ’å…¥å¤šä½™çš„ç©ºæ ¼</p><p>æ­£å¸¸çš„æ— åºåˆ—è¡¨åº”è¯¥æ ¼å¼åŒ–æˆï¼š</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="bullet">- </span>1</span><br><span class="line"><span class="bullet">- </span>2</span><br><span class="line"><span class="bullet">- </span>3</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯ä¸é…ç½® tabWidth çš„è¯ï¼Œ prettier ä¼šæ ¼å¼åŒ–æˆï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-   1</span><br><span class="line">-   2</span><br><span class="line">-   3</span><br></pre></td></tr></table></figure><p>å·¨ä¸‘ ğŸ˜¤</p></li></ul><h2 id="linters-å’Œ-prettier-çš„å†²çª"><a href="#linters-å’Œ-prettier-çš„å†²çª" class="headerlink" title="linters å’Œ prettier çš„å†²çª"></a>linters å’Œ prettier çš„å†²çª</h2><p>è¿™éƒ¨åˆ†å†…å®¹å¼ºçƒˆå»ºè®®å…ˆé˜…è¯» <code>prettier</code> å®˜æ–¹æ–‡æ¡£ <span class="exturl" data-url="aHR0cHM6Ly9wcmV0dGllci5pby9kb2NzL2VuL2ludGVncmF0aW5nLXdpdGgtbGludGVycy5odG1s" title="https://prettier.io/docs/en/integrating-with-linters.html">Integrating with Linters<i class="fa fa-external-link"></i></span> éƒ¨åˆ†ï¼Œå®˜æ–¹æ–‡æ¡£å¾€å¾€æ˜¯æ›´æ–°æœ€åŠæ—¶ï¼Œä¹Ÿæ˜¯æœ€æƒå¨çš„ã€‚</p><p>æˆ‘ä»¬çŸ¥é“ lint å·¥å…·æ˜¯ç”¨æ¥æ£€æŸ¥ä»£ç é£æ ¼çš„ï¼Œ prettier æ˜¯ç”¨æ¥æ ¼å¼åŒ–ä»£ç çš„ã€‚æƒ³æƒ³çœ‹ï¼Œå¦‚æœ prettier è®¾ç½®ç¼©è¿›ä¸º 4 ä¸ªç©ºæ ¼ï¼Œè€Œæˆ‘ä»¬é…ç½®çš„ eslint æ˜¯è¦æ±‚ç¼©è¿›ä¸º 2 ä¸ªç©ºæ ¼ï¼Œè¿™è‚¯å®šä¼šå¯¼è‡´æˆ‘ä»¬æ ¼å¼åŒ–ä»£ç ä¹‹åï¼Œeslint ä¼šæŠ¥ç¼©è¿›é”™è¯¯ã€‚</p><p><img data-src="https://i.loli.net/2020/02/20/Tx3Z1CXS4BLHqmF.png" alt="conflict"></p><p>è¿™éƒ¨åˆ†å†…å®¹å°±æ˜¯ä¸ºäº†è§£å†³ linters è§„åˆ™å’Œ prettier çš„å†²çªé—®é¢˜ï¼Œå…¶å®ï¼ŒåŸç†å¾ˆç®€å•ï¼Œå°±æ˜¯ç¦ç”¨æ‰æ‰é‚£äº›ä¼šå’Œ prettier æ ¼å¼åŒ–èµ·å†²çªçš„è§„åˆ™ã€‚</p><p>å®‰è£… eslint æ’ä»¶ <code>eslint-config-prettier</code>ï¼Œè¿™ä¸ªæ’ä»¶ä¼šç¦ç”¨æ‰€æœ‰ä¼šå’Œ prettier èµ·å†²çªçš„è§„åˆ™ã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add eslint-config-prettier -D</span><br></pre></td></tr></table></figure><p>æ·»åŠ  <code>&#39;prettier&#39;</code>ï¼Œ<code>&#39;prettier/react&#39;</code>ï¼Œ<code>&#39;prettier/@typescript-eslint&#39;</code> åˆ°<code>extends</code> é…ç½®ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// .eslintrc.js</span></span><br><span class="line">&#123;</span><br><span class="line">    extends: [</span><br><span class="line">        <span class="string">'airbnb'</span>,</span><br><span class="line">        <span class="string">'airbnb/hooks'</span>,</span><br><span class="line">        <span class="string">'plugin:eslint-comments/recommended'</span>,</span><br><span class="line">        <span class="string">'plugin:import/typescript'</span>,</span><br><span class="line">        <span class="string">'plugin:react/recommended'</span>,</span><br><span class="line">        <span class="string">'plugin:@typescript-eslint/recommended'</span>,</span><br><span class="line">        <span class="string">'prettier'</span>,</span><br><span class="line">        <span class="comment">// ä¸“é—¨æ”¯æŒäº† eslint-plugin-react</span></span><br><span class="line">        <span class="string">'prettier/react'</span>,</span><br><span class="line">        <span class="comment">// ä¸“é—¨æ”¯æŒäº† @typescript-eslint/eslint-plugin</span></span><br><span class="line">        <span class="string">'prettier/@typescript-eslint'</span>,</span><br><span class="line">    ],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæ³¨æ„è¦æŠŠ <code>prettier</code> æ”¾æœ€åé¢ï¼Œå› ä¸ºè¿™æ ·æ‰èƒ½è®© <code>prettier</code> æœ‰æœºä¼šç¦ç”¨å‰é¢æ‰€æœ‰çš„ <code>extends</code> ä¸­é…ç½®çš„ä¼šèµ·å†²çªçš„è§„åˆ™ã€‚</p><p>stylelint ä¹Ÿæ˜¯ä¸€æ ·ï¼Œå…ˆå®‰è£…æ’ä»¶ <code>stylelint-config-prettier</code>ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add stylelint-config-prettier -D</span><br></pre></td></tr></table></figure><p>å†å°† <code>&quot;stylelint-config-prettier&quot;</code> æ·»åŠ åˆ° <code>extends</code> æ•°ç»„æœ€åé¢ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// .stylelintrc.json</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"extends"</span>: [<span class="string">"stylelint-config-standard"</span>, <span class="string">"stylelint-config-rational-order"</span>, <span class="string">"stylelint-config-prettier"</span>],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="lint-staged"><a href="#lint-staged" class="headerlink" title="lint-staged"></a>lint-staged</h2><blockquote><p>Run linters on git staged files</p></blockquote><p><img data-src="https://i.loli.net/2020/02/03/XKgBvifDF8Wch7R.png" alt="git-stage.png"></p><p>æˆ‘ä»¬æ¯æ¬¡æäº¤ä»£ç éƒ½è¦å¯¹ä»£ç å…ˆè¿›è¡Œ lint å’Œæ ¼å¼åŒ–ï¼Œç¡®ä¿å›¢é˜Ÿçš„ä»£ç é£æ ¼ç»Ÿä¸€ã€‚ä¸ºäº†è¾¾åˆ°æ¯æ¬¡ lint å’Œæ ¼å¼åŒ–æ—¶åªå¤„ç†æˆ‘ä»¬ä¿®æ”¹äº†çš„ä»£ç ï¼Œä¹Ÿå°±æ˜¯ä¿å­˜åœ¨ git stage åŒºï¼ˆæš‚å­˜åŒºï¼‰çš„ä»£ç ã€‚ç¤¾åŒºæ¯”è¾ƒæµè¡Œçš„æ–¹æ¡ˆæœ‰ä¿©ï¼š</p><ol><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2F6ei9wcmV0dHktcXVpY2s=" title="https://github.com/azz/pretty-quick">pretty-quick<i class="fa fa-external-link"></i></span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL29rb25ldC9saW50LXN0YWdlZA==" title="https://github.com/okonet/lint-staged">lint-staged<i class="fa fa-external-link"></i></span></li></ol><p>æˆ‘ä»¬é€‰æ‹©ä½¿ç”¨ <code>lint-staged</code>ï¼Œå› ä¸ºå‰è€…åŠŸèƒ½å•ä¸€ï¼Œåªæ˜¯æä¾›äº† prettier æ ¼å¼åŒ– stage åŒºä»£ç çš„åŠŸèƒ½ï¼Œæ²¡æ³•é… eslint å’Œ stylelintï¼Œåªæä¾›äº†ä¸€äº›å‘½ä»¤è¡Œå‚æ•°ï¼Œä¸èƒ½é€šè¿‡é…ç½®æ–‡ä»¶æ¥é…ç½®ã€‚lint-satged é…ç½®æ›´çµæ´»ï¼Œé€šè¿‡å®ƒæˆ‘ä»¬å¯ä»¥åŒæ—¶é…ç½® <code>eslint</code>ï¼Œ<code>stylelint</code>ï¼Œ<code>prettier</code>ã€‚</p><p>ä¸ºäº†è¾¾åˆ°åœ¨æˆ‘ä»¬æ¯æ¬¡ commit çš„æ—¶å€™ï¼Œéƒ½è‡ªåŠ¨ lint å’Œæ ¼å¼åŒ–ï¼Œæˆ‘ä»¬éœ€è¦ç»™ git commit æŒ‚ä¸ªé’©å­ï¼Œä½¿ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R5cGljb2RlL2h1c2t5" title="https://github.com/typicode/husky">husky<i class="fa fa-external-link"></i></span> å¯ä»¥å¾ˆè½»æ¾çš„ç»™ git é…ç½®é’©å­ã€‚</p><p>å…ˆå®‰è£… husky å’Œ lint-stagedï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add husky lint-staged -D</span><br></pre></td></tr></table></figure><p>åœ¨ package.json é…ç½® git commit æ—¶çš„é’©å­æ“ä½œ:</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// package.json</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"husky"</span>: &#123;</span><br><span class="line">        <span class="string">"hooks"</span>: &#123;</span><br><span class="line">            <span class="comment">// åœ¨æ‰§è¡Œ git commit è°ƒç”¨ lint-staged å‘½ä»¤ï¼Œlint-staged ä¼šè¯»å– package.json ä¸­ lint-staged çš„é…ç½®</span></span><br><span class="line">            <span class="string">"pre-commit"</span>: <span class="string">"lint-staged"</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†åœ¨ package.json ä¸­ <code>&quot;ling-staged&quot;</code> å­—æ®µé…ç½® lint-stagedï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// package.json</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"lint-staged"</span>: &#123;</span><br><span class="line">        <span class="comment">// å¯¹äº ts,tsx,js æ–‡ä»¶è°ƒç”¨ eslint</span></span><br><span class="line">        <span class="string">"*.&#123;ts,tsx,js&#125;"</span>: [</span><br><span class="line">            <span class="string">"eslint -c .eslintrc.js"</span></span><br><span class="line">        ],</span><br><span class="line">        <span class="comment">// å¯¹äº scss æ–‡ä»¶è°ƒç”¨ stylelint</span></span><br><span class="line">        <span class="string">"*.scss"</span>: [</span><br><span class="line">            <span class="string">"stylelint --config .stylelintrc.json"</span></span><br><span class="line">        ],</span><br><span class="line">        <span class="comment">// prettier æ”¯æŒå¾ˆå¤šç±»å‹æ–‡ä»¶çš„æ ¼å¼åŒ–</span></span><br><span class="line">        <span class="string">"*.&#123;ts,tsx,js,json,scss,md&#125;"</span>: [</span><br><span class="line">            <span class="string">"prettier --write"</span></span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>prettier çš„ â€“write å‚æ•°æ˜¯å¹²å˜›ç”¨çš„å‘¢ï¼Ÿä¸¾ä¸ª ğŸŒ° æ¥è¯´ï¼Œå‘½ä»¤è¡Œè°ƒç”¨ <code>prettier a.js</code> é»˜è®¤åªä¼šè¾“å‡ºæ ¼å¼åŒ–åçš„å†…å®¹åˆ°æ§åˆ¶å°ï¼Œä¸ä¼šä¿®æ”¹åŸæ–‡ä»¶ï¼ŒåŠ ä¸Š <code>--write</code> æ‰ä¼šç›´æ¥æ ¼å¼åŒ– <code>a.js</code>ã€‚éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œå¯èƒ½ä½ ä»¬çœ‹åˆ«äººçš„æ•™ç¨‹æˆ–è€…ä¸€äº›é¡¹ç›®ä¸­ä»–ä»¬é…ç½® <code>lint-staged</code> è¿˜åŠ äº†ä¸€ä¸ª <code>git add</code> æ­¥éª¤ï¼Œç„¶åæ§åˆ¶å°ä¼šæœ‰è­¦å‘Šï¼š</p><blockquote><p>âš  Some of your tasks use <code>git add</code> command.</p></blockquote><p>åŸå› å¾ˆç®€å•ï¼š<strong>lint-staged ä» V10 ç‰ˆæœ¬å¼€å§‹ï¼Œä»»ä½•è¢«ä¿®æ”¹äº†çš„åŸ staged åŒºçš„æ–‡ä»¶éƒ½ä¼šè¢«è‡ªåŠ¨ git add</strong>ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦è‡ªå·±æ·»åŠ  git add ã€‚</p><h2 id="commitlint"><a href="#commitlint" class="headerlink" title="commitlint"></a>commitlint</h2><blockquote><p><code>commitlint</code> helps your team adhering to a commit convention. By supporting npm-installed configurations it makes sharing of commit conventions easy.</p></blockquote><p><span class="exturl" data-url="aHR0cHM6Ly9jb21taXRsaW50LmpzLm9yZy8=" title="https://commitlint.js.org/">commitlint<i class="fa fa-external-link"></i></span> æ˜¯ä¸€ä¸ªç”¨æ¥ lint c<strong>ommit message</strong> çš„å·¥å…·ã€‚çœ‹å®˜ç½‘çš„ä¾‹å­ï¼š</p><p><img data-src="https://user-gold-cdn.xitu.io/2020/2/3/1700a62c2b0044e3?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="commitlint"></p><p>æˆ‘çŸ¥é“æœ‰äº›äººæäº¤ä»£ç å–œæ¬¢ç›´æ¥æ¥ä¸‰ä¸ªç‚¹ <code>...</code>ï¼Œè¿™æ˜¯å¾ˆä¸å¥½çš„ä¹ æƒ¯ï¼Œåˆ°æ—¶å€™ä½ æƒ³ç‰ˆæœ¬å›é€€çš„è¯å°±å‚»çœ¼äº†ï¼Œåªèƒ½çœ‹æäº¤çš„æ—¶é—´äº†å’Œ diff äº†ï¼Œå¾ˆä¸åˆ©äºé¡¹ç›®ç®¡ç†ã€‚è§„èŒƒåŒ–çš„ç¼–å†™ commit message æœ‰å¾ˆå¤šå¥½å¤„ï¼Œå¯ä»¥æ–¹ä¾¿æˆ‘ä»¬æ£€ç´¢æäº¤å†å²ï¼Œé…åˆ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2NvbnZlbnRpb25hbC1jaGFuZ2Vsb2cvY29udmVudGlvbmFsLWNoYW5nZWxvZw==" title="https://github.com/conventional-changelog/conventional-changelog">conventional-changelog<i class="fa fa-external-link"></i></span> ç›´æ¥ç”Ÿæˆ changelogï¼Œå…³è” github issue ç­‰ã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>husky</code> + <code>commlint</code> å®ç°åœ¨ commit çš„æ—¶å€™å…ˆæ£€æŸ¥ commit message çš„è§„èŒƒæ€§ï¼Œå¦‚æœä¸ç¬¦åˆè§„èŒƒç›´æ¥ç»ˆæ­¢ commitã€‚</p><p>å®‰è£…éœ€è¦çš„ä¾èµ–ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add @commitlint/cli @commitlint/config-conventional -D</span><br></pre></td></tr></table></figure><p><span class="exturl" data-url="aHR0cHM6Ly93d3cubnBtanMuY29tL3BhY2thZ2UvQGNvbW1pdGxpbnQvY29uZmlnLWNvbnZlbnRpb25hbA==" title="https://www.npmjs.com/package/@commitlint/config-conventional">@commitlint/config-conventional<i class="fa fa-external-link"></i></span> æ˜¯ commitlint å®˜æ–¹æ¨èçš„ä¸€ä¸ª angular é£æ ¼çš„ commitlint é…ç½®ï¼Œæä¾›äº†å°‘é‡çš„ lint è§„åˆ™ï¼Œç±»ä¼¼äº eslint çš„ extendã€‚</p><p>å®ƒé»˜è®¤æ”¯æŒçš„æäº¤ç±»å‹ä¸ºï¼š</p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line">[<span class="string">"build"</span>, <span class="string">"ci"</span>, <span class="string">"chore"</span>, <span class="string">"docs"</span>, <span class="string">"feat"</span>, <span class="string">"fix"</span>, <span class="string">"perf"</span>, <span class="string">"refactor"</span>, <span class="string">"revert"</span>, <span class="string">"style"</span>, <span class="string">"test"</span>]</span><br></pre></td></tr></table></figure><p>æ·»åŠ  commlint çš„é…ç½®åˆ°é¡¹ç›®æ ¹ç›®å½•çš„ <code>.commitlintrc.js</code>ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// .commitlintrc.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  extends: [<span class="string">'@commitlint/config-conventional'</span>],</span><br><span class="line">  rules: &#123;</span><br><span class="line">    <span class="string">'type-enum'</span>: [</span><br><span class="line">      <span class="number">2</span>,</span><br><span class="line">      <span class="string">'always'</span>,</span><br><span class="line">      <span class="comment">// æ¯”é»˜è®¤å€¼å¤šäº†ä¸ª depsï¼Œè¡¨ç¤ºä¾èµ–å‡çº§ï¼Œé™çº§ï¼Œæ–°å¢ç­‰</span></span><br><span class="line">      [<span class="string">'build'</span>, <span class="string">'ci'</span>, <span class="string">'chore'</span>, <span class="string">'deps'</span>, <span class="string">'docs'</span>, <span class="string">'feat'</span>, <span class="string">'fix'</span>, <span class="string">'perf'</span>, <span class="string">'refactor'</span>, <span class="string">'revert'</span>, <span class="string">'style'</span>, <span class="string">'test'</span>],</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ·»åŠ  git <code>commit-msg</code> é’©å­ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// package.json</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"husky"</span>: &#123;</span><br><span class="line">        <span class="string">"hooks"</span>: &#123;</span><br><span class="line">            <span class="string">"pre-commit"</span>: <span class="string">"lint-staged"</span>,</span><br><span class="line">            <span class="string">"commit-msg"</span>: <span class="string">"commitlint -c .commitlintrc.js -E HUSKY_GIT_PARAMS"</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“è°ƒç”¨ <code>commit-msg</code> é’©å­çš„æ—¶å€™ï¼Œç¯å¢ƒå˜é‡ <code>HUSKY_GIT_PARAMS</code> ä¼šè¢«ä¸´æ—¶è®¾ç½®ä¸ºä¿å­˜ commit messsge çš„æ–‡ä»¶çš„è·¯å¾„ï¼Œç„¶å <code>commitlint</code> å°±ä¼šå» lint è¿™ä¸ªæ–‡ä»¶ä¸­çš„ commit messageã€‚</p><p>å¦‚æœä½ æƒ³åœ¨å‘½ä»¤è¡Œä¸­äº¤äº’å¼çš„ç¼–è¾‘ commit messageï¼Œå¯ä»¥äº†è§£ä¸€ä¸‹ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2NvbW1pdGl6ZW4vY3otY2xp" title="https://github.com/commitizen/cz-cli">commitizen<i class="fa fa-external-link"></i></span> ï¼Œæˆ‘ä»¬è¿™ä¸ªé¡¹ç›®å°±ä¸é…äº†ï¼Œä¸»è¦è¿˜æ˜¯è§‰å¾—è¦é…ç½®çš„è¯å°±è¦æ ¹æ®å…·ä½“çš„ä¸šåŠ¡å»é…ï¼Œæˆ‘ä»¬è¿™ä¸ªé€šç”¨ç›®çš„çš„æ¨¡æ¿é¡¹ç›®å°±ç®—äº†ã€‚æˆ‘çœ‹äº†ä¸€ä¸‹ <code>angular</code> å’Œ <code>vue-next</code> lint commit message çš„åšæ³•ï¼Œå®ƒä»¬ commitlint å’Œ commitizen ä¿©éƒ½æ²¡é…ï¼Œåªæ˜¯åœ¨ git <code>commit-msg</code> æ—¶è°ƒç”¨äº†ä¸‹ node è„šæœ¬æ ¡éªŒ commit message ã€‚</p><p>æˆ‘ä»¬æ¥ç€å†é…ç½®è‡ªåŠ¨ç”Ÿæˆ changelogï¼Œæœ¬åœ°å®‰è£… <code>conventional-changelog-cli</code>ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yarn add conventional-changelog-cli -D</span><br></pre></td></tr></table></figure><p>æ·»åŠ ä¸€ä¸ª npm scriptï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// package.json</span></span><br><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"changelog"</span>: <span class="string">"conventional-changelog -p angular -i CHANGELOG.md -s"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ <code>npm run changelog</code> ç”Ÿæˆ angular é£æ ¼çš„ changelog äº†ï¼Œ<code>conventional-changelog</code> ä¼šè¯»å–æäº¤å†å²ä¸­ fix, feat ç­‰ type çš„ commit message è‡ªåŠ¨ç”Ÿæˆ changelogã€‚</p><p>æˆ‘ä»¬æ¥ç€è®¨è®ºä¸€ä¸ªä½¿ç”¨äº† commilint åå¦‚ä½•æ’å…¥ emoji çš„é—®é¢˜ï¼Œæˆ‘ä»¬çŸ¥é“ commit message çš„æ ¼å¼æ˜¯è¿™æ ·çš„ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ•´è¡Œå« header</span></span><br><span class="line">&lt;type&gt;(&lt;scope&gt;): &lt;subject&gt;</span><br><span class="line">// ç©ºä¸€è¡Œ</span><br><span class="line">&lt;body&gt;</span><br><span class="line">// ç©ºä¸€è¡Œ</span><br><span class="line">&lt;footer&gt;</span><br><span class="line"></span><br><span class="line">// ä¸¾ä¸ªä¾‹å­æŸæ¬¡æäº¤çš„ commit message æ˜¯ï¼šfeat(component): add component Navbar</span><br><span class="line">// feat æ˜¯ type</span><br><span class="line">// component æ˜¯ scope</span><br><span class="line">// 'add component Navbar' æ˜¯ subject</span><br><span class="line">// è¿™é‡Œæ²¡æœ‰ body å’Œ footer</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬çŸ¥é“ git emoji çš„æ ¼å¼æ˜¯ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">:emoji_string:</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ ä½¿ç”¨ä¸‹é¢çš„å¸¦ emoji çš„ commit message æäº¤ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git commit -m <span class="string">':bug: fix: xxx'</span></span><br></pre></td></tr></table></figure><p>commitlint ç­‰å·¥å…·åœ¨è§£æçš„æ—¶å€™åº”è¯¥æ˜¯å°†ç¬¬ä¸€ä¸ªå†’å·ä¹‹å‰çš„å†…å®¹è§£æä¸º typeï¼Œä¹Ÿå°±æ˜¯è¯´ä¼šæŠŠ emoji å·¦è¾¹å†’å·ä¹‹å‰çš„å†…å®¹è§£æä¸º typeï¼Œé‚£è¿™æ ·è§£æçš„è¯ type å°±æ˜¯ç©ºå­—ç¬¦ä¸²äº†ï¼Œæ‰€ä»¥ä½¿ç”¨ä¸Šé¢çš„ commit message æäº¤ä¼šæŠ¥é”™è¯´ä½ æ²¡æœ‰å¡«å†™ typeã€‚</p><p>å¦‚æœä¸ä¿®æ”¹ commilint çš„ type é…ç½®æ˜¯æ— æ³•é€šè¿‡ commitlint çš„ï¼Œè§£å†³åŠæ³•ä¹‹ä¸€æ˜¯æ·»åŠ ä¸€ä¸ª type <code>:bug: fix</code>ï¼Œä½†æ˜¯è¿™æ ·çš„è¯ <code>conventional-changelog-cli</code> ä¸ä¼šå°† commit mesage æå–åˆ° changelogï¼Œå®ƒåªè®¤ <code>fix: xxx</code> ä¸è®¤ <code>:bug: fix: xxx</code>ã€‚å› æ­¤ï¼Œåœ¨å½“å‰é…ç½®ä¸‹ï¼Œæˆ‘ä»¬å¦‚æœè¦æ’å…¥ emojiï¼Œå»ºè®®ä½¿ç”¨ä¸‹å›¾çš„æ–¹å¼ï¼Œè™½ç„¶æˆ‘è§‰å¾—è¿™æ ·ä¸å¥½çœ‹ï¼Œä½†ç›®å‰æ¥è¯´æ˜¯æ¯”è¾ƒæŠ˜ä¸­çš„æ–¹æ¡ˆã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git commit -m <span class="string">"chore: :memo: improve docs and config json"</span></span><br></pre></td></tr></table></figure><p><img data-src="https://i.loli.net/2020/02/14/OcsuXR5CMaxlo41.png" alt="commitlint git emoji"></p><h2 id="second-commit"><a href="#second-commit" class="headerlink" title="second commit"></a>second commit</h2><p>æ·»åŠ å‡ ä¸ªå¸¸ç”¨ç”¨äº lint çš„ npm scriptsï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"scripts"</span>: &#123;</span><br><span class="line">        <span class="string">"lint"</span>: <span class="string">"yarn run lint-eslint &amp;&amp; yarn run lint-stylelint"</span>,</span><br><span class="line">        <span class="string">"lint-eslint"</span>: <span class="string">"eslint -c .eslintrc.js --ext .ts,.tsx,.js &#123;src,scripts&#125;/**/*.&#123;ts,tsx,js&#125;"</span>,</span><br><span class="line">        <span class="string">"lint-stylelint"</span>: <span class="string">"stylelint --config .stylelintrc.json src/**/*.scss --syntax scss"</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æˆ‘é…ç½® eslint å’Œ stylelint çš„ script æ˜¯ç”¨ <code>å‰ç¼€-å‚æ•°</code> çš„å½¢å¼ï¼Œæœ‰äº›é¡¹ç›®é…ç½®å¸¦å‚æ•°çš„ script åæ˜¯ç”¨ <code>å‰ç¼€:å‚æ•°</code> çš„å½¢å¼ï¼Œä¹Ÿå°±æ˜¯ç”¨å†’å·åšåˆ†éš”ç¬¦ã€‚æˆ‘è§‰å¾—é‚£æ ·ä¸å¥½ï¼Œå› ä¸ºæœ‰äº›å·¥å…·æ”¯æŒ <code>yarn:scriptName</code> çš„å½¢å¼æ¥æ‰§è¡Œ npm scriptsï¼Œä¾‹å¦‚ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2tpbW1vYnJ1bmZlbGR0L2NvbmN1cnJlbnRseQ==" title="https://github.com/kimmobrunfeldt/concurrently">concurrently<i class="fa fa-external-link"></i></span>ã€‚</p><p>å‡è®¾ä½ æœ‰å¤šä¸ª npm scriptsï¼Œåˆ†åˆ«æ˜¯ï¼š<code>yarn:watch-node</code>ï¼Œ<code>yarn:watch-node</code>ï¼Œ<code>yarn:watch-css</code>ï¼Œè¿™ä¸ªå·¥å…·æ”¯æŒä¸€æ¡å‘½ä»¤æ¥å¹¶è¡Œæ‰§è¡Œå®ƒä»¬ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">concurrently yarn:watch-node yarn:watch-js yarn:watch-css</span><br></pre></td></tr></table></figure><p>é‚£ä½ è¯´å¦‚æœç”¨å†’å·æ¥åšåˆ†éš”ç¬¦ï¼Œé‚£è¦å†™å°±æ˜¯ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">concurrently yarn:watch:node yarn:watch:js yarn:watch:css</span><br></pre></td></tr></table></figure><p>çœ‹èµ·æ¥å°±å¾ˆè¿·ï¼Œä¸äº†è§£çš„äººå¯èƒ½è¿˜ä»¥ä¸ºåé¢çš„å†’å·ä¹Ÿæ˜¯ <code>concurrently</code> çš„å‚æ•°å‘¢ï¼Œ<strong>æ‰€ä»¥è¡¨ç¤ºå¸¦å‚æ•°çš„ npm script ä¸è¦ç”¨å†’å·åšåˆ†éš”ç¬¦</strong>ã€‚</p><p>æœ€åå†æ¥ä¸€å‘ <code>yarn upgarde --latest</code>ï¼Œå…»æˆæ¯å¤©å‡çº§ä¾èµ–çš„å¥½ä¹ æƒ¯ï¼Œé¿å…ä»¥ååŒæ—¶å‡çº§å¾ˆå¤šä¾èµ–å‡ºäº†éƒ½æä¸æ¸…æ¥šæ˜¯å“ªä¸ªä¾èµ–å‡çº§å¯¼è‡´çš„ã€‚ä¸è¿‡å…¬å¸çš„é¡¹ç›®åƒä¸‡åˆ«è¿™æ ·æï¼Œå®¹æ˜“å¯¼è‡´å‡º bug è¿ç»­åŠ ç­ã€‚</p><p>åˆ°è¿™é‡Œï¼Œ<strong>ä»é›¶å¼€å§‹é…ç½® react + typescript</strong> ç³»åˆ—ç¬¬äºŒç¯‡ç®—æ˜¯å·®ä¸å¤šäº†ï¼Œå†ä¸€æ¬¡æäº¤ä»£ç ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git add -A</span><br><span class="line">git commit -m <span class="string">'build: integrate eslint, stylelint, prettier, lint-staged, commi</span></span><br><span class="line"><span class="string">tlint'</span></span><br><span class="line"><span class="comment"># ä¸Šæ¬¡ push çš„æ—¶å€™ä½¿ç”¨ -u å‚æ•°å…³è”äº† master åˆ†æ”¯å’Œ github è¿œç¨‹ä»“åº“ï¼Œè¿™é‡Œå°±å¯ä»¥ç›´æ¥ push</span></span><br><span class="line">git push</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç¯‡åˆ°æ­¤ç»“æŸï¼Œ<a href="https://lyreal666.com/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E9%85%8D%E7%BD%AE-react-typescript%EF%BC%88%E4%B8%89%EF%BC%89%EF%BC%9Awebpack/">ç¬¬ä¸‰ç¯‡</a>å…³äº webpack é…ç½®çš„æ–‡ç« å°†æ˜¯å››ç¯‡ä¸­å¹²è´§æœ€å¤šï¼Œä¼°è®¡ä¹Ÿæ˜¯æœ€é•¿çš„ä¸€ç¯‡ã€‚å°†ä»‹ç»ä½¿ç”¨ <code>TypeScript</code> æ¥ç¼–å†™ <code>express + webpack devServer ä¸­é—´ä»¶</code> ä½œä¸º devServerï¼Œé›†æˆä¸€äº›å®ç”¨å’Œé…·ç‚«çš„ webpack æ’ä»¶ï¼Œä¼˜åŒ– babel é…ç½®ï¼Œç”Ÿäº§ç¯å¢ƒæ‰“åŒ…ä¼˜åŒ–ç­‰å†…å®¹ï¼Œæ•¬è¯·æœŸå¾…â€¦</p><p>è¦æƒ³äº†è§£æ›´å¤šç»†èŠ‚ï¼Œå»ºè®®ç›´æ¥çœ‹æºç ï¼Œé¡¹ç›®åœ°å€ï¼š<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RqeDY2Ni9yZWFjdC10eXBlc2NyaXB0LWJvaWxlcnBsYXRl" title="https://github.com/tjx666/react-typescript-boilerplate">react-typescript-boilerplate<i class="fa fa-external-link"></i></span>ã€‚å¦‚æœè§‰å¾—æœ¬æ–‡å¯¹ä½ æœ‰ç”¨ï¼Œä¸å¦¨èµé¢— star ğŸ˜ã€‚å¯¹æœ¬æ–‡å†…å®¹æœ‰ç–‘é—®æˆ–è€…æœ‰ä»€ä¹ˆæ”¹è¿›çš„åœ°æ–¹æ¬¢è¿é€šè¿‡è¯„è®ºå’Œé‚®ä»¶äº¤æµã€‚</p><p>æœ¬æ–‡ä¸ºåŸåˆ›å†…å®¹ï¼Œé¦–å‘äº<span class="exturl" data-url="aHR0cDovL3d3dy5seXJlYWw2NjYuY29tLw==" title="http://www.lyreal666.com/">ä¸ªäººåšå®¢<i class="fa fa-external-link"></i></span>ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>eslint</tag>
        <tag>stylelint</tag>
        <tag>lint-staged</tag>
        <tag>commitlint</tag>
        <tag>prettier</tag>
      </tags>
  </entry>
  <entry>
    <title>ä»é›¶å¼€å§‹é…ç½® react + typescriptï¼ˆä¸€ï¼‰ï¼šdotfiles</title>
    <url>/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E9%85%8D%E7%BD%AE-react-typescript%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9Adotfiles/</url>
    <content><![CDATA[<p>ä¹‹å‰æˆ‘å†™è¿‡ä¸€ç¯‡æ–‡ç«  <span class="exturl" data-url="aHR0cHM6Ly9qdWVqaW4uaW0vcG9zdC81Y2Q1OTZkNDUxODgyNTY4ODk3ZDg5Yzg=" title="https://juejin.im/post/5cd596d451882568897d89c8">æ­å»º react + typescript + ant design å¼€å‘ç¯å¢ƒ<i class="fa fa-external-link"></i></span>ï¼Œç°åœ¨çœ‹æ¥å¾ˆå¤šå†…å®¹éƒ½å·²ç»è¿‡æ—¶äº†ã€‚ä½†æ˜¯æˆ‘çœ‹åˆ°å‰ä¸ä¹…è¿˜æœ‰è¯»è€…ç»™æˆ‘è¿™ç¯‡æ–‡ç« ç‚¹èµï¼Œä¸æ›´æ–°çš„è¯æ€»æ„Ÿè§‰å‘äº†å®ƒä»¬ï¼Œæœ‰ç‚¹è¿‡æ„ä¸å»ã€‚ä½†æ˜¯ï¼Œå¦‚æœç°åœ¨è®©æˆ‘å†å»é…ç½®é‚£å¥—ç¯å¢ƒï¼Œæˆ‘è‚¯å®šä¸ä¼šå†åƒé‚£ç¯‡æ–‡ç« é‚£æ ·é…ç½®äº†ï¼Œæ¯•ç«Ÿè¿‡äº†è¿™ä¹ˆé•¿ä¸€æ®µæ—¶é—´ï¼Œå¾ˆå¤šå·¥å…·éƒ½åœ¨å‘å±•ï¼Œæˆ‘çš„æƒ³æ³•ä¹Ÿåœ¨æ”¹å˜ï¼Œé‚£ä¹ˆå¹²è„†æˆ‘å°±å†æ•´ä¸€ç¯‡æ–°çš„æ–‡ç« ï¼Œè¿™æ˜¯æˆ‘åˆ›ä½œè¿™ç¯‡æ–‡ç« çš„åŠ¨æœºä¹‹ä¸€ã€‚</p><p>æœ€è¿‘ä¸€æ®µæ—¶é—´ï¼Œæˆ‘å†™è¿‡ä¸å°‘ç±»å‹çš„é¡¹ç›®ï¼Œæœ‰ <code>chrome æ‰©å±•</code>ï¼Œ<code>VSCode æ‰©å±•</code>ï¼Œ <code>electron</code> ç­‰ï¼Œé…ç½®å¼€å‘ç¯å¢ƒéƒ½æ˜¯è£¸å†™çš„ï¼Œå¹¶æ²¡æœ‰ä½¿ç”¨ä¸€äº› cli å·¥å…·æˆ–è€…ç¬¬ä¸‰æ–¹çš„é¡¹ç›®æ¨¡æ¿ã€‚å› æ­¤ï¼Œæˆ‘è¸©è¿‡ä¸å°‘å‘ï¼Œä¹Ÿæ€»ç»“äº†ä¸å°‘çš„ç»éªŒã€‚æ‰€ä»¥å¦ä¸€ä¸ªåˆ›ä½œåŠ¨æœºå°±æƒ³æ€»ç»“å’Œåˆ†äº«ä¸€ä¸‹æˆ‘é…ç½®å¼€å‘ç¯å¢ƒçš„æœ€ä½³å®è·µã€‚</p><p>æˆ‘ä½¿ç”¨çš„å¼€å‘æœºå’Œç¼–è¾‘å™¨åˆ†åˆ«æ˜¯ <code>win10pro-1909</code> å’Œ <code>VSCode</code>ï¼Œä½¿ç”¨çš„æ‰€æœ‰ä¾èµ–éƒ½æ˜¯æœ€æ–°çš„ï¼Œå¹¶ä¸”æ–‡ç« ä¼šä¸å®šæ—¶æ›´æ–°ï¼Œç¡®ä¿å…·æœ‰æ—¶æ•ˆæ€§ã€‚</p><p>æ–‡ç« å°†æŒ‰ç…§å¼€å‘ä¸€ä¸ªæ¨¡æ¿é¡¹ç›®çš„æ—¶é—´é¡ºåºé¢„è®¡åˆ†æˆå››ç¯‡æ¥å†™ï¼š</p><ol><li>dotfiles</li><li>linters å’Œ formatter</li><li>webpack</li><li>ç¬¬ä¸‰æ–¹åº“é›†æˆå’Œä¼˜åŒ–</li></ol><p>é¡¹ç›®åœ°å€ï¼š<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RqeDY2Ni9yZWFjdC10eXBlc2NyaXB0LWJvaWxlcnBsYXRl" title="https://github.com/tjx666/react-typescript-boilerplate">react-typescript-boilerplate<i class="fa fa-external-link"></i></span></p><a id="more"></a><h2 id="init"><a href="#init" class="headerlink" title="init"></a>init</h2><p>æ­å»ºé¡¹ç›®çš„ç¬¬ä¸€æ­¥å°±æ˜¯æ–°å»ºé¡¹ç›®æ–‡ä»¶å¤¹ï¼Œç„¶ååˆå§‹åŒ–ä¸º git ä»“åº“ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ–°å»ºé¡¹ç›®æ–‡ä»¶å¤¹</span></span><br><span class="line">mkdir react-typescript-boilerplate</span><br><span class="line"><span class="comment"># åˆ‡æ¢å·¥ä½œè·¯å¾„åˆ°é¡¹ç›®æ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="built_in">cd</span> <span class="variable">$_</span></span><br><span class="line"><span class="comment"># åˆå§‹åŒ– git ä»“åº“</span></span><br><span class="line">git init</span><br></pre></td></tr></table></figure><p>ä½ å¯ä»¥å°† <code>react-typescript-boilerplate</code> æ›¿æ¢æˆä»»æ„ä½ éœ€è¦çš„é¡¹ç›®åï¼Œ<code>$_</code> è¡¨ç¤ºä¸Šä¸€æ¡å‘½ä»¤æœ€åçš„å‚æ•°ï¼Œè¿™é‡Œå°±è¡¨ç¤ºé¡¹ç›®æ–‡ä»¶å¤¹ã€‚</p><p>å¯¹äº<code>dotfiles</code> è¿™ä¸ªè¯ï¼Œ æˆ‘çš„ç†è§£æ˜¯æŒ‡é‚£äº›ä»¥ç‚¹ <code>.</code> å¼€å¤´çš„é…ç½®æ–‡ä»¶ã€‚åœ¨æˆ‘åˆšå¼€å§‹å­¦ä¹ å‰ç«¯æ¡†æ¶çš„æ—¶å€™ï¼Œçœ‹åˆ°è„šæ‰‹æ¶ç”Ÿæˆçš„ä¸€å † <code>dotfiles</code> æˆ‘ä¹Ÿæ˜¯å¾ˆæ‡µé€¼ï¼Œå¤´çš®å‘éº»ï¼Œå¿ƒæƒ³æ€ä¹ˆå†™ä¸ªé¡¹ç›®è¦è¿™ä¹ˆå¤šé…ç½®æ–‡ä»¶ï¼Œå†™ä¸ªå‰ç«¯é¡¹ç›®ä¹Ÿå¤ªéº»çƒ¦äº†ã€‚å…¶å®<strong>å­˜åœ¨å³åˆç†</strong>ï¼Œå½“æˆ‘äº†è§£äº†å®ƒä»¬çš„ç”¨é€”ä¹‹åï¼Œå°±èƒ½å¤Ÿç†è§£å®ƒä»¬çš„å¿…è¦æ€§äº†ï¼Œè€Œä¸”é…ç½®æ–‡ä»¶å¾ˆå¤šä»æŸç§ç¨‹åº¦ä¸Šä¹Ÿååº”äº†å‰ç«¯æ„å»ºå·¥å…·ç”Ÿæ€çš„æ´»è·ƒä¸æ˜¯ã€‚</p><h2 id="gitignore"><a href="#gitignore" class="headerlink" title=".gitignore"></a>.gitignore</h2><p>å»ºè®®åˆå§‹åŒ– git ä»“åº“åç¬¬ä¸€æ­¥å°±æ˜¯æ·»åŠ  <code>.gitignore</code>ã€‚å¦‚æœä½ ä¸æ·»åŠ ï¼Œé‚£ä¹ˆ VSCode çš„ç‰ˆæœ¬æ§åˆ¶ä¼šç›‘æ§ä½ é¡¹ç›®ä¸­çš„æ‰€æœ‰æ–‡ä»¶åŒ…æ‹¬ <code>node_modules</code>ä¸‹çš„ä¸€å †æ–‡ä»¶ï¼Œå¯¼è‡´ CPU å’Œå†…å­˜å ç”¨è¿‡é«˜ç­‰é—®é¢˜ï¼Œæ‰€ä»¥æœ€å¥½ä¸€å¼€å§‹å°±é…ç½®å¥½ <code>gitignore</code>ã€‚é…ç½® <code>gitignore</code> å»ºè®®ä½¿ç”¨ VSCode çš„ <span class="exturl" data-url="aHR0cHM6Ly9tYXJrZXRwbGFjZS52aXN1YWxzdHVkaW8uY29tL2l0ZW1zP2l0ZW1OYW1lPWNvZGV6b21iaWVjaC5naXRpZ25vcmU=" title="https://marketplace.visualstudio.com/items?itemName=codezombiech.gitignore">gitignore<i class="fa fa-external-link"></i></span> æ‰©å±•ã€‚ä½¿ç”¨æ–¹å¼å¾ˆç®€å•ï¼š<code>ctrl+shift+p</code> å”¤å‡ºå‘½ä»¤é¢æ¿ï¼Œè°ƒç”¨ <code>Add gitignore</code> å‘½ä»¤ï¼Œç„¶åé€‰æ‹©ä¸åŒç±»å‹é¡¹ç›®çš„ <code>ignore</code> é…ç½®ï¼Œå¯ä»¥å¤šæ¬¡è¿½åŠ ã€‚</p><p><img data-src="https://i.loli.net/2020/02/01/hl1P65K79jLcUMb.gif" alt="gitignore.gif"></p><p>æˆ‘ä¸€èˆ¬æ·»åŠ çš„é¡¹ç›®ç±»å‹åŒ…æ‹¬ï¼š<code>Node</code>, <code>VisualStudioCode</code>, <code>JetBrains</code>, <code>Windows</code>, <code>Linux</code>, <code>macOS</code>ï¼Œä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦æ·»åŠ å…¶å®ƒçš„é¡¹ç›®ç±»å‹ä¾‹å¦‚ <code>SublimeText</code>ï¼Œ<code>Vim</code>ã€‚è™½ç„¶æˆ‘æ˜¯ç”¨ VSCode åšå¼€å‘ï¼Œä½†æ˜¯è€ƒè™‘åˆ°åˆ«äººå¼€å‘è¿™ä¸ªé¡¹ç›®çš„æ—¶å€™å¯èƒ½ç”¨çš„å°±æ˜¯ <code>WebStorm</code> äº†ï¼Œæ‰€ä»¥å°±æ·»åŠ äº†å’Œ <code>JetBrains</code> IDE ç›¸å…³çš„ <code>ignore</code> é…ç½®ã€‚è¿™ä¸ªæ‰©å±•çš„åŸç†æ˜¯é€šè¿‡æ‹‰å–å¼€æºé¡¹ç›® <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2dpdGh1Yi9naXRpZ25vcmU=" title="https://github.com/github/gitignore">gitignore<i class="fa fa-external-link"></i></span> çš„ <code>gitignore</code> é…ç½®ï¼Œ<strong>éœ€è¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬è¦åˆ é™¤å…¶ä¸­ä¸¤ä¸ªé…ç½®é¡¹ <code>typings/</code> å’Œ <code>Icon</code></strong>ã€‚è¿™ä¸¤ä¸ªé…ç½®é¡¹æ˜æ˜¾æ˜¯éœ€è¦æ·»åŠ åˆ° git ç‰ˆæœ¬æ§åˆ¶çš„ï¼Œ<code>typings</code> æ–‡ä»¶å¤¹æˆ‘ä»¬ä¼šç”¨æ¥ä¿å­˜ ts çš„ç±»å‹å®šä¹‰æ–‡ä»¶ï¼Œ<code>icon</code> æ–‡ä»¶å¤¹æˆ‘ä»¬ä¸€èˆ¬ç”¨æ¥ä¿å­˜å›¾æ ‡ã€‚</p><h2 id="editorconfig"><a href="#editorconfig" class="headerlink" title=".editorconfig"></a>.editorconfig</h2><p>é€šè¿‡é…ç½® <code>editorconfig</code>ï¼Œæˆ‘ä»¬å¯ä»¥è®©å¤šä¸ªå¼€å‘äººå‘˜ï¼Œä½¿ç”¨ä¸åŒçš„ç¼–è¾‘å™¨æ—¶ï¼Œä»£ç æ ¼å¼åŒ–é£æ ¼ä»ç„¶ä¿æŒä¸€è‡´ã€‚æœ‰äº› IDE ä¾‹å¦‚ IDEA æ˜¯ç›´æ¥å†…ç½®äº† <code>editorconfig</code> è§„èŒƒï¼Œæœ‰äº›ç¼–è¾‘å™¨å¦‚ VSCode åˆ™éœ€è¦å®‰è£…<span class="exturl" data-url="aHR0cHM6Ly9tYXJrZXRwbGFjZS52aXN1YWxzdHVkaW8uY29tL2l0ZW1zP2l0ZW1OYW1lPUVkaXRvckNvbmZpZy5FZGl0b3JDb25maWc=" title="https://marketplace.visualstudio.com/items?itemName=EditorConfig.EditorConfig">å¯¹åº”çš„æ’ä»¶<i class="fa fa-external-link"></i></span>å»æ”¯æŒã€‚</p><p>æˆ‘ä»¬æ‹¿ VSCode å’Œ IDEA æ¥åšä¸ªæµ‹è¯•ï¼Œä¸‹é¢è¿™å¼ å›¾æ˜¯å·¦è¾¹æ˜¯æµ‹è¯•æ–‡ä»¶ <code>index.js</code>ï¼Œå³è¾¹æ˜¯ <code>editorcofig</code> é…ç½®ï¼Œæ³¨æ„åˆ°<strong>æˆ‘åˆ»æ„æŠŠç¼©è¿›è®¾ç½®æˆäº† 3 ä¸ªç©ºæ ¼</strong>ã€‚VSCode æ˜¯å¯ä»¥è®¾ç½®å®ƒæ ¼å¼åŒ–ä»£ç æ—¶ä½¿ç”¨çš„ formatter çš„ï¼Œå¦‚æœä½ ä¸è®¾ç½®ï¼Œé‚£å°±æ˜¯ç”¨å†…ç½®çš„ formatterï¼Œä¹Ÿå°±æ˜¯ï¼š</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line">"[javascript]": &#123;</span><br><span class="line">    "editor.defaultFormatter": "vscode.typescript-language-features"</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p><img data-src="https://i.loli.net/2020/02/01/y4Q9Xmqzv3K7kjs.png" alt="editorconfig-vscode.png"></p><p>åœ¨æˆ‘ <code>alt + shift + f</code> æ ¼å¼åŒ–ä¹‹åå¯ä»¥çœ‹åˆ°ï¼ŒVSCode éµå¾ªäº† <code>editorconfig</code> çš„é…ç½®å°†ä»£ç çš„ç¼©è¿›æ ¼å¼åŒ–æˆäº† 3 ä¸ªç©ºæ ¼ã€‚</p><p>æˆ‘ç»§ç»­åœ¨ IDEA ä¸­æ‰“å¼€è¿™ä¸ªé¡¹ç›®åé€šè¿‡ <code>ctrl + alt + l</code> æ ¼å¼åŒ–ï¼Œæ„æ–™ä¹‹ä¸­ä¹Ÿæ˜¯æ ¼å¼åŒ–æˆäº†ä¸‰ä¸ªç©ºæ ¼ï¼Œæˆ‘å°±ä¸è´´å›¾äº†ï¼Œå’Œä¸Šé¢ä¸€æ ·ã€‚</p><p>æœ‰äººå¯èƒ½ä¼šæƒ³ï¼Œ<code>prettier</code> ä¹Ÿæ˜¯æ ¼å¼åŒ–å·¥å…·ï¼Œä¸ºä»€ä¹ˆåŒä¸€ä¸ªé¡¹ç›®é…ç½®ä¿©æ ¼å¼åŒ–å·¥å…·ï¼ˆåé¢æˆ‘ä»¬è¿˜è¦é…ç½® <code>prettier</code>ï¼‰ï¼Ÿäº‹å®ä¸Šï¼Œå¯ä»¥çœ‹åˆ°æœ‰äº›è‘—åçš„å¼€æºé¡¹ç›®å¦‚ react, VSCode å°±æ˜¯ä¸¤ä¸ªéƒ½ç”¨äº†ã€‚å…¶å®æƒ³æƒ³çœ‹ï¼šåˆ°æœ€åä»£ç æ ¼å¼åŒ–åŠŸèƒ½è‚¯å®šæ˜¯è¦äº¤ç»™ <code>prettier</code> å»å¹²çš„ï¼Œä¸€èˆ¬éƒ½æ˜¯ç”¨ <code>lint-staged</code>ï¼Œæ¯æ¬¡åªæŠŠä¿®æ”¹è¿‡çš„ä»£ç æ ¼å¼åŒ–ã€‚é‚£æ˜¯å¦å°±æ˜¯è¯´ï¼Œ <code>editorconfig</code> æ˜¯æ²¡æœ‰ç”¨çš„é…ç½®å‘¢ï¼Ÿ</p><p>å½“ç„¶æ˜¯æœ‰ç”¨çš„ï¼Œæœ¬è´¨ä¸Š <code>editorconfig</code> å’Œ <code>prettier</code> çš„åŒºåˆ«åœ¨äºï¼š<code>editorconfig</code> æ˜¯ä¸»åŠ¨ä½œç”¨äºç¼–è¾‘å™¨çš„ï¼Œä½ æ·»åŠ äº† <code>.editoronfig</code> æ–‡ä»¶ï¼Œè°ƒç”¨ VSCode çš„æ ¼å¼åŒ–ï¼Œæ ¼å¼åŒ–ç»“æœå°±æ˜¯ <code>.editorconfig</code> é…ç½®çš„é£æ ¼ã€‚è€Œ <code>prettier</code> åªæ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œéœ€è¦æˆ‘ä»¬å»è°ƒç”¨å®ƒï¼Œå®ƒæ‰ä¼šæ ¼å¼åŒ–ä»£ç ï¼Œå®ƒæœ¬èº«æ˜¯è¢«åŠ¨çš„ã€‚å¦‚æœä½ ä¸é…ç½® <code>editorconfig</code>ï¼Œé‚£å½“ç”¨æˆ·ä¿®æ”¹äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œè°ƒç”¨ VSCode å¿«æ·é”®æ‰‹åŠ¨æ ¼å¼åŒ–ä»£ç ï¼Œæäº¤æ—¶åˆè¢« <code>prettier</code> æ ¼å¼åŒ–ä¸€éï¼Œå› ä¸º VScode å†…ç½®çš„ formatter å’Œ <code>prettier</code> é£æ ¼ä¸ä¸€æ ·ï¼Œå¯¼è‡´æˆ‘æ˜æ˜æ‰‹åŠ¨æ ¼å¼åŒ–äº†ï¼Œæ€ä¹ˆæäº¤åè¿˜è¢«ä¿®æ”¹äº†ã€‚é…ç½® <code>editorconfig</code> ï¼Œå¹¶ä¸”ä½¿å…¶å’Œ <code>prettier</code> çš„é£æ ¼ä¿æŒä¸€è‡´ï¼Œå°±å¯ä»¥è§£å†³å‰é¢æåˆ°çš„å¤šæ¬¡æ ¼å¼åŒ–ç»“æœä¸ä¸€æ ·çš„é—®é¢˜ã€‚äº‹å®ä¸Šï¼Œ react å°±æ˜¯è¿™æ ·å¹²çš„ã€‚</p><p>å…¶å®ï¼Œå½“ç”¨æˆ·é…ç½®äº† <code>prettier</code> ä½œä¸º VSCode çš„ <code>javascript</code> formatterï¼Œ <code>editorconfig</code> é…ç½®å°±æ²¡ä»€ä¹ˆç”¨äº†ã€‚</p><p><img data-src="https://i.loli.net/2020/02/01/lrV5nzXkGugMxfj.png" alt="edittorconfig-prettier.png"></p><p>è¯´äº†é‚£ä¹ˆå¤šï¼Œå…¶å®é…ç½®èµ·æ¥éå¸¸ç®€å•ï¼Œå»ºè®®å®‰è£… VSCode æ‰©å±• <span class="exturl" data-url="aHR0cHM6Ly9tYXJrZXRwbGFjZS52aXN1YWxzdHVkaW8uY29tL2l0ZW1zP2l0ZW1OYW1lPUVkaXRvckNvbmZpZy5FZGl0b3JDb25maWc=" title="https://marketplace.visualstudio.com/items?itemName=EditorConfig.EditorConfig">EditorConfig for VS Code<i class="fa fa-external-link"></i></span>ï¼Œå®‰è£…ä¹‹åå¯ä»¥é€šè¿‡å‘½ä»¤ <code>Generate .editorcofig</code> ç”Ÿæˆé»˜è®¤çš„é…ç½®ï¼Œä¸ªäººå»ºè®®æœ€ååŠ ä¸Šä¸€è¡Œ <code>end_of_line = unset</code>ï¼Œè®©è¡Œå°¾æ¢è¡Œç¬¦ç›´æ¥éµå®ˆæ“ä½œç³»ç»Ÿçš„æ¢è¡Œç¬¦ã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">[*]</span><br><span class="line">indent_style = space</span><br><span class="line">indent_size = 4</span><br><span class="line">charset = utf-8</span><br><span class="line">trim_trailing_whitespace = <span class="literal">false</span></span><br><span class="line">insert_final_newline = <span class="literal">false</span></span><br><span class="line"><span class="comment"># åŠ ä¸Šè¿™ä¸€è¡Œ</span></span><br><span class="line">end_of_line = <span class="built_in">unset</span></span><br></pre></td></tr></table></figure><h2 id="nvmrc"><a href="#nvmrc" class="headerlink" title=".nvmrc"></a>.nvmrc</h2><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL252bS1zaC9udm0=" title="https://github.com/nvm-sh/nvm">nvm<i class="fa fa-external-link"></i></span> (node version manager) æ˜¯ node çš„ç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼Œåœ¨ windows ä¸Šä½¿ç”¨ nvm è¦å®‰è£…å¦ä¸€ä¸ªå·¥å…· <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2NvcmV5YnV0bGVyL252bS13aW5kb3dz" title="https://github.com/coreybutler/nvm-windows">nvm-windows<i class="fa fa-external-link"></i></span>ã€‚</p><p><code>.nvmrc</code> æ˜¯ nvm çš„é…ç½®æ–‡ä»¶ï¼Œå¾ˆå¤šå·¥å…·åœ¨åˆ¤æ–­é¡¹ç›®çš„ node ç‰ˆæœ¬çš„æ—¶å€™ä¼šè¯»å–è¿™ä¸ªé…ç½®ï¼Œä¾‹å¦‚ travis CIã€‚å¦‚æœé¡¹ç›®æ ¹è·¯å¾„æœ‰ <code>.nvmrc</code> çš„è¯å°±ä¸ç”¨åœ¨ <code>.travis.yml</code> ä¸­æŒ‡å®š node çš„ç‰ˆæœ¬äº†ã€‚å»ºè®®å¹³æ—¶å¼€å‘ä½¿ç”¨æœ€æ–°çš„ LTS ç‰ˆæœ¬ï¼Œæ–°ç‰ˆæœ¬ä¸ä½†æ”¯æŒçš„ ES ç‰¹æ€§æ›´å¤šï¼Œæ€§èƒ½ä¸€èˆ¬ä¹Ÿæœ‰æå‡ï¼Œbug ä¸€èˆ¬ä¹Ÿæ›´å°‘ã€‚ä¸å»ºè®®å¼€å‘é¡¹ç›®æ—¶é€‰æ‹©æœ€æ–°çš„é LTS ç‰ˆï¼Œæœ‰äº›åŒ…ä¾‹å¦‚ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2tlbGVrdGl2L25vZGUuYmNyeXB0Lmpz" title="https://github.com/kelektiv/node.bcrypt.js">bcrypt<i class="fa fa-external-link"></i></span> åœ¨æœ€æ–°çš„é LTS ç‰ˆæ ¹æœ¬å°±ä¸æ”¯æŒã€‚ä¹‹å‰æˆ‘ä¸€ä¸ªæœ‹å‹å°±ç¢°åˆ°å®‰è£… bcrypt å®‰è£…ä¸äº†çš„é—®é¢˜ï¼Œç ”ç©¶åˆ°æœ€åå‘ç°æ˜¯å› ä¸º bcrypt åªæ˜¯åœ¨ LTS ç‰ˆæœ¬çš„ node ä¸Šæµ‹è¯•ï¼Œå¹¶ä¸ä¿è¯æ”¯æŒé LTS ç‰ˆæœ¬ã€‚</p><p>é€šè¿‡ä¸‹é¢çš„ shell å‘½ä»¤ç”Ÿæˆ <code>.nvmrc</code>ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">node --version &gt; ./.nvmrc</span><br></pre></td></tr></table></figure><h2 id="npmrc"><a href="#npmrc" class="headerlink" title=".npmrc"></a>.npmrc</h2><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œç”±äºä¸å¯æŠ—ä¹‹åŠ›ï¼Œå›½å†…æ— è®ºæ˜¯è®¿é—® github è¿˜æ˜¯ä¸‹è½½ npm åŒ…éƒ½æ˜¯èœ—é€Ÿã€‚å¯¹äºå›½å†…ç”¨æˆ·è€Œè¨€ï¼Œé¦–å…ˆæˆ‘ä»¬è¦åšçš„ä¸€ä»¶äº‹å°±æ˜¯å°† npm æºè®¾ç½®æ·˜å®æºã€‚é…ç½® npm æºå»ºè®®ä½¿ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL1BhbmEvbnJt" title="https://github.com/Pana/nrm">nrm<i class="fa fa-external-link"></i></span>ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å…¨å±€å®‰è£… nrmï¼Œ</span></span><br><span class="line">yarn global add nrm</span><br><span class="line"><span class="comment"># æˆ–è€…ä½¿ç”¨ npm å®‰è£…ï¼Œinstall å¯ä»¥ç®€å†™æˆ i</span></span><br><span class="line">npm i -g nrm</span><br><span class="line"><span class="comment"># è®¾ç½®ä½¿ç”¨æ·˜å®æº</span></span><br><span class="line">nrm use taobao</span><br></pre></td></tr></table></figure><p>é€šè¿‡ <code>nrm ls</code> æˆ‘ä»¬è¿˜å¯ä»¥çœ‹åˆ°å…¶å®ƒçš„ä¸€äº›æº:</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ nrm ls</span><br><span class="line"></span><br><span class="line">  npm -------- https://registry.npmjs.org/</span><br><span class="line">  yarn ------- https://registry.yarnpkg.com/</span><br><span class="line">  cnpm ------- http://r.cnpmjs.org/</span><br><span class="line">* taobao ----- https://registry.npm.taobao.org/</span><br><span class="line">  nj --------- https://registry.nodejitsu.com/</span><br><span class="line">  npmMirror -- https://skimdb.npmjs.com/registry/</span><br><span class="line">  edunpm ----- http://registry.enpmjs.org/</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ä¸€ä¸‹å…¶ä¸­å‡ ä¸ªå¸¸è§çš„æºçš„ä¸¢åŒ…ç‡ï¼Œæ·˜å®æºä¸€éª‘ç»å°˜å•Šï¼š</p><p><img data-src="https://i.loli.net/2020/02/01/bCpAYTVKENDqBmW.png" alt="taobao-cnpm-registry.png"></p><p><code>.npmrc</code> æ˜¯ç»™ npm ç”¨çš„é…ç½®æ–‡ä»¶ï¼Œå½“ç„¶ä½ å¦‚æœä½¿ç”¨ yarnï¼Œyarn ä¹Ÿä¼šéµå®ˆ <code>.npmrc</code> é…ç½®ï¼Œè™½ç„¶ yarn æœ‰ä¸“é—¨çš„é…ç½®æ–‡ä»¶ <code>.yarnrc</code>ã€‚</p><p>æˆ‘ä»¬çŸ¥é“æœ‰äº› npm åŒ…åœ¨å®‰è£…æ—¶æ˜¯éœ€è¦ä¸‹è½½ä¸€äº›äºŒè¿›åˆ¶ä¾èµ–æ–‡ä»¶ï¼Œå…¶ä¸­æœ‰å‡ ä¸ªå‘è´§åƒ <code>node-sass</code>ï¼Œ<code>electron</code>ï¼Œ<code>bcrypt</code> è¿˜éœ€è¦é…ç½®ä»£ç†æ‰èƒ½ä¸‹è½½ã€‚ä¸ºäº†è®©è®©åˆ«äººåˆä½œå¼€å‘é¡¹ç›®çš„æ—¶å€™èƒ½é¡ºåˆ©å®‰è£…å®ƒä»¬ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ <code>.npmrc</code> ä¸­ç›´æ¥è®¾ç½®å®ƒä»¬çš„é•œåƒåœ°å€ï¼Œæ·»åŠ  node-sass çš„é•œåƒåœ°å€ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># .npmrc</span></span><br><span class="line">SASS_BINARY_SITE=http://npm.taobao.org/mirrors/node-sass</span><br></pre></td></tr></table></figure><h2 id="LICENSE"><a href="#LICENSE" class="headerlink" title="LICENSE"></a>LICENSE</h2><p><img data-src="https://i.loli.net/2020/02/05/Fb7OUkWmYfIiHyX.png" alt="open source license"></p><p>æ ¹æ®ä½ çš„é¡¹ç›®æ€§è´¨ï¼Œå»ç½‘ç«™ <span class="exturl" data-url="aHR0cDovL2Nob29zZWFsaWNlbnNlLm9ubGluZS8=" title="http://choosealicense.online/">choose a license<i class="fa fa-external-link"></i></span> é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„ licenseï¼Œ å¤åˆ¶åç²˜è´´åˆ°é¡¹ç›®æ ¹è·¯å¾„çš„ <code>LICENSE</code> æˆ– <code>LICENSE.txt</code> æ–‡ä»¶é‡Œé¢ï¼Œä¿®æ”¹ä¸€äº›é…ç½®å³å¯ã€‚è¿™é‡Œæˆ‘é€‰æ‹©å®½æ¾çš„ MIT åè®®ï¼Œä¿®æ”¹å…¶ä¸­çš„å¹´ä»½å’Œä½œè€…åï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">MIT License</span><br><span class="line"></span><br><span class="line">Copyright (c) [2020] [YuTengjing]</span><br><span class="line"></span><br><span class="line">Permission is hereby granted, free of charge, to any person obtaining a copy</span><br><span class="line">of this software and associated documentation files (the &quot;Software&quot;), to deal</span><br><span class="line">in the Software without restriction, including without limitation the rights</span><br><span class="line">to use, copy, modify, merge, publish, distribute, sublicense, and&#x2F;or sell</span><br><span class="line">copies of the Software, and to permit persons to whom the Software is</span><br><span class="line">furnished to do so, subject to the following conditions:</span><br><span class="line"></span><br><span class="line">The above copyright notice and this permission notice shall be included in all</span><br><span class="line">copies or substantial portions of the Software.</span><br><span class="line"></span><br><span class="line">THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span><br><span class="line">IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span><br><span class="line">FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span><br><span class="line">AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span><br><span class="line">LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span><br><span class="line">OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</span><br><span class="line">SOFTWARE.</span><br></pre></td></tr></table></figure><h2 id="package-json"><a href="#package-json" class="headerlink" title="package.json"></a>package.json</h2><p>ç”Ÿæˆ package.json çš„æ—¶å€™éœ€è¦è€ƒè™‘ä¸€ä¸ªé—®é¢˜ï¼Œä½ æ˜¯æ‰“ç®—ä½¿ç”¨ yarnï¼Œnpmï¼Œè¿˜æ˜¯ cnpmï¼Ÿ</p><p>æœ€è¿‘è²Œä¼¼è¿˜å‘å¸ƒäº† yarn2 ï¼Œä¸è¿‡æˆ‘è‚¯å®šä¸ä¼šè€ƒè™‘ yarn2 çš„ï¼Œå…ˆä¸è¯´æœ‰å¾ˆå¤š bug ï¼Œè¿˜ä¸å¤Ÿæˆç†Ÿï¼Œç¤¾åŒºçš„æ¥å—åº¦è¿˜æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œyarn2 å’Œ yarn1 å·®åˆ«å¾ˆå¤§ã€‚</p><p>è®²çœŸæˆ‘è§‰å¾— npm æ˜¯çœŸçš„è®¾è®¡çš„å¾ˆå±ï¼Œä¸çŸ¥é“æœ€å¼€å§‹ä¸ºä»€ä¹ˆä¼šè®¾è®¡æˆå®‰è£…åŒ…é»˜è®¤ä¸ä¼šæ·»åŠ åˆ° <code>dependencies</code>ï¼Œä½¿ç”¨ç¼“å­˜è¿™ä¹ˆå®¹æ˜“æƒ³åˆ°çš„è®¾è®¡è¿˜æ˜¯ yarn é¦–åˆ›çš„ï¼Œé”å®šç‰ˆæœ¬ä¹Ÿæ˜¯æŠ„ yarn çš„ã€‚</p><p>yarn ç”¨èµ·æ¥èˆ’æœå¤šäº†ã€‚ä½†æ˜¯ yarn åœ¨ windows ç»å¸¸æœ‰ hash å€¼å¯¹ä¸ä¸Šç„¶åå®‰è£…ä¸äº†çš„ bugï¼Œæå¾—æˆ‘å¾ˆçƒ¦ï¼Œçœ‹äº†ä¸€ä¸‹ github ä»“åº“ï¼Œå°†è¿‘ 2000 ä¸ª issuesã€‚</p><p>æœ€è¿‘æˆ‘é‡æ–°è¯•ç”¨äº†ä¸€ä¸‹ cnpmï¼Œè®©æˆ‘æ„å¤–çš„æ˜¯ä¸‹è½½é€Ÿåº¦æ˜¯çœŸçš„å¿«ï¼ŒåŒæ ·çš„ä½¿ç”¨æ·˜å®æºï¼Œcnpm æ¯” yarn è¿˜è¦å¿«å¾ˆå¤šã€‚ä½†æ˜¯æˆ‘è§‰å¾— cnpm å®‰è£…ä¹‹åï¼Œnode_modules çœ‹èµ·æ¥å¾ˆä¹±ï¼Œå¤šäº†å¾ˆå¤šä¹±ä¸ƒå…«æ§½çš„ä¾èµ–ã€‚</p><p>å› ä¸ºæˆ‘æœ‰ç‚¹æ´ç™–ï¼Œæ‰€ä»¥ yarn å’Œ cnpm æˆ‘ç«™ yarnã€‚</p><p>package.json æ˜¯ç”¨æ¥ç®¡ç† npm åŒ…çš„é…ç½®æ–‡ä»¶ï¼Œç”Ÿæˆ package.json æœ€ç®€å•çš„æ–¹å¼å°±æ˜¯æ¥ä¸€å¥ <code>yarn init -y</code>ï¼Œç›´æ¥å°±ç”Ÿæˆä¸€ä¸ªé»˜è®¤çš„ package.jsonã€‚</p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"name"</span>: <span class="string">"react-typescript-boilerplate"</span>,</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"1.0.0"</span>,</span><br><span class="line">  <span class="attr">"main"</span>: <span class="string">"index.js"</span>,</span><br><span class="line">  <span class="attr">"author"</span>: <span class="string">"YuTengjing &lt;ytj2713151713@gmail.com&gt;"</span>,</span><br><span class="line">  <span class="attr">"license"</span>: <span class="string">"MIT"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æ¥ä¿®æ”¹ä¸‹è¿™ä¸ªé»˜è®¤çš„é…ç½®ï¼š</p><p>å› ä¸ºæˆ‘ä»¬è¿™ä¸ªé¡¹ç›®ä¸æ‰“ç®—å‘å¸ƒåˆ° npmï¼Œæ‰€ä»¥ private è®¾ç½®ä¸º trueã€‚</p><p>è¿™ä¸ª main å…¥å£å¯¹äºæˆ‘ä»¬è¿™ä¸ªæ¨¡æ¿é¡¹ç›®æ¥è¯´æ²¡ä»€ä¹ˆæ„ä¹‰ï¼Œç›´æ¥åˆ äº†ã€‚</p><p>ä¿®æ”¹ä¸€ä¸‹ author å’Œ repository çš„æ ¼å¼å°±æ˜¯ä¸‹é¢è¿™æ ·äº†ï¼š</p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"name"</span>: <span class="string">"react-typescript-boilerplate"</span>,</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"1.0.0"</span>,</span><br><span class="line">  <span class="attr">"description"</span>: <span class="string">"A boilerplate for react + typescript development"</span>,</span><br><span class="line">  <span class="attr">"private"</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">"author"</span>: &#123;</span><br><span class="line">    <span class="attr">"name"</span>: <span class="string">"YuTengjing"</span>,</span><br><span class="line">    <span class="attr">"url"</span>: <span class="string">"https://github.com/tjx666"</span>,</span><br><span class="line">    <span class="attr">"email"</span>: <span class="string">"ytj2713151713@gmail.com"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"repository"</span>: &#123;</span><br><span class="line">    <span class="attr">"type"</span>: <span class="string">"git"</span>,</span><br><span class="line">    <span class="attr">"url"</span>: <span class="string">"git@github.com:tjx666/react-typescript-boilerplate.git"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"license"</span>: <span class="string">"MIT"</span>,</span><br><span class="line">  <span class="attr">"scripts"</span>: &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="settings-json"><a href="#settings-json" class="headerlink" title="settings.json"></a>settings.json</h2><p>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ VSCodeï¼Œé‚£ä¹ˆå¯ä»¥æ·»åŠ  VSCode çš„é¡¹ç›®é…ç½®æ–‡ä»¶ <code>.vscode/settings.json</code>ã€‚æ–°å»º <code>.vscode</code> æ–‡ä»¶å¤¹å¹¶åœ¨å…¶ä¸­åˆ›å»º <code>settings.json</code>æ–‡ä»¶ã€‚<code>settings.json</code> è™½ç„¶åç¼€åæ˜¯ <code>.json</code>ï¼Œå…¶å®æ˜¯ <code>jsonc</code> æ ¼å¼çš„æ–‡ä»¶ï¼Œ<code>jsonc</code> å’Œ <code>json</code> æ–‡ä»¶çš„åŒºåˆ«å°±åœ¨äº <code>jsonc</code> å…è®¸æ·»åŠ æ³¨é‡Šï¼Œ<code>jsonc</code> çš„è¿™ä¸ª<code>c</code> å°±æ˜¯ <code>comment</code>ï¼ˆæ³¨é‡Šï¼‰çš„æ„æ€å˜›ã€‚æš‚æ—¶æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨æœ¬åœ°å®‰è£…çš„ TypeScript æ›¿ä»£ VSCode å†…ç½®çš„æ¥æä¾›æ™ºèƒ½æç¤º</span></span><br><span class="line">    <span class="string">"typescript.tsdk"</span>: <span class="string">"./node_modules/typescript/lib"</span>,</span><br><span class="line">    <span class="comment">// æŒ‡å®šå“ªäº›æ–‡ä»¶ä¸å‚ä¸æœç´¢</span></span><br><span class="line">    <span class="string">"search.exclude"</span>: &#123;</span><br><span class="line">        <span class="string">"**/node_modules"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"dist"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"yarn.lock"</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// æŒ‡å®šå“ªäº›æ–‡ä»¶ä¸è¢« VSCode ç›‘å¬ï¼Œé¢„é˜²å¯åŠ¨ VSCode æ—¶æ‰«æçš„æ–‡ä»¶å¤ªå¤šï¼Œå¯¼è‡´ CPU å ç”¨è¿‡é«˜</span></span><br><span class="line">    <span class="string">"files.watcherExclude"</span>: &#123;</span><br><span class="line">        <span class="string">"**/.git/objects/**"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"**/.git/subtree-cache/**"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"**/node_modules/*/**"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"dist"</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="string">"yarn.lock"</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// é…ç½® VScode ä½¿ç”¨ prettier çš„ formatter</span></span><br><span class="line">    <span class="string">"[javascript]"</span>: &#123;</span><br><span class="line">        <span class="string">"editor.defaultFormatter"</span>: <span class="string">"esbenp.prettier-vscode"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"[javascriptreact]"</span>: &#123;</span><br><span class="line">        <span class="string">"editor.defaultFormatter"</span>: <span class="string">"esbenp.prettier-vscode"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"[typescript]"</span>: &#123;</span><br><span class="line">        <span class="string">"editor.defaultFormatter"</span>: <span class="string">"esbenp.prettier-vscode"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"[typescriptreact]"</span>: &#123;</span><br><span class="line">        <span class="string">"editor.defaultFormatter"</span>: <span class="string">"esbenp.prettier-vscode"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"[json]"</span>: &#123;</span><br><span class="line">        <span class="string">"editor.defaultFormatter"</span>: <span class="string">"esbenp.prettier-vscode"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"[jsonc]"</span>: &#123;</span><br><span class="line">        <span class="string">"editor.defaultFormatter"</span>: <span class="string">"esbenp.prettier-vscode"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"[html]"</span>: &#123;</span><br><span class="line">        <span class="string">"editor.defaultFormatter"</span>: <span class="string">"esbenp.prettier-vscode"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"[css]"</span>: &#123;</span><br><span class="line">        <span class="string">"editor.defaultFormatter"</span>: <span class="string">"esbenp.prettier-vscode"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"[less]"</span>: &#123;</span><br><span class="line">        <span class="string">"editor.defaultFormatter"</span>: <span class="string">"esbenp.prettier-vscode"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"[scss]"</span>: &#123;</span><br><span class="line">        <span class="string">"editor.defaultFormatter"</span>: <span class="string">"esbenp.prettier-vscode"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"[markdown]"</span>: &#123;</span><br><span class="line">        <span class="string">"editor.defaultFormatter"</span>: <span class="string">"esbenp.prettier-vscode"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="travis-yml"><a href="#travis-yml" class="headerlink" title=".travis.yml"></a>.travis.yml</h2><p>æˆ‘é€‰æ‹©ä½¿ç”¨æœ€æµè¡Œçš„å¼€æº CI å·¥å…· travis CIï¼Œåœ¨ github ä¸Šæ–°å»ºå®Œä»“åº“åå°±å¯ä»¥å» travis CI å®˜ç½‘ï¼Œå…ˆåŒæ­¥ github è´¦å·ä¿¡æ¯ï¼Œç„¶åæœç´¢æ¿€æ´»æ–°å»ºçš„ä»“åº“ã€‚</p><p><img data-src="https://i.loli.net/2020/02/02/iGjOa4fZo2Dpu3q.png" alt="travis-ci.png"></p><p>åœ¨é¡¹ç›®æ ¹ç›®å½•æ–°å»º <code>.travis.yml</code> æ–‡ä»¶ï¼ŒåŠ å…¥ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">language:</span> <span class="string">node_js</span></span><br><span class="line"><span class="attr">cache:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">yarn</span></span><br><span class="line"><span class="attr">install:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">yarn</span></span><br><span class="line"><span class="attr">script:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">yarn</span> <span class="string">test</span></span><br></pre></td></tr></table></figure><p>éå¸¸ç®€å•çš„é…ç½®ï¼Œåªæ˜¯è´Ÿè´£è‡ªåŠ¨åŒ–æµ‹è¯•ã€‚å› ä¸ºç›®å‰æ²¡æœ‰æµ‹è¯•ï¼Œæˆ‘ä»¬æ·»åŠ ä¸€ä¸ª <code>echo</code> è¯­å¥åˆ° npm scripts é‡Œé¢ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// package.json</span></span><br><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"test"</span>: <span class="string">"echo 'skip test...'"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="README-md"><a href="#README-md" class="headerlink" title="README.md"></a>README.md</h2><p>README.md å°±æ˜¯é¡¹ç›®çš„è¯´æ˜ä¹¦ï¼Œæ¯ä¸ªæ–‡ä»¶å¤¹ä¸­çš„ README.md åœ¨ github ä¸Šéƒ½ä¼šè¢«æ¸²æŸ“åˆ°é¡µé¢ä¸Šã€‚æˆ‘ä»¬åœ¨é¡¹ç›®æ ¹ç›®å½•æ·»åŠ çš„ README.md è‡ªç„¶å°±ä¼šè¢«æ¸²æŸ“åˆ°ä»“åº“çš„é¦–é¡µã€‚</p><p>æˆ‘ä»¬æ·»åŠ ä¸€äº›å®ç”¨çš„ badgesï¼ˆå¾½ç« ï¼‰ï¼Œä¾‹å¦‚ travis CI çš„ build çŠ¶æ€ï¼Œdependencies ç‰ˆæœ¬æ˜¯å¦è¿‡æœŸç­‰ ã€‚badge æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªé“¾æ¥ï¼Œåªä¸è¿‡æ–‡å­—éƒ¨åˆ†æ¢æˆäº† svg æ¸²æŸ“çš„å›¾ç‰‡ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç½‘ç«™ <span class="exturl" data-url="aHR0cHM6Ly9zaGllbGRzLmlvLw==" title="https://shields.io/">shields.io<i class="fa fa-external-link"></i></span> ä¸Šæ‰¾åˆ°å„ç§å„æ ·çš„ badgeï¼Œå¹³æ—¶é€› github é¡¹ç›®çš„æ—¶å€™çœ‹åˆ°å–œæ¬¢çš„ badge å¯ç”¨æ³¨æ„æ”¶è—ä¸€ä¸‹ã€‚</p><p><img data-src="https://i.loli.net/2020/02/02/yw7oPEIR59zC2hr.png" alt="badge-format.png"></p><p>æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">align</span>=<span class="string">"center"</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="section"># react-typescript-boilerplate</span></span><br><span class="line"></span><br><span class="line">[<span class="string">![Build Status</span>](<span class="link">https://travis-ci.org/tjx666/react-typescript-boilerplate.svg?branch=master</span>)](<span class="link">https://travis-ci.org/tjx666/react-typescript-boilerplate</span>) [<span class="string">![dependencies Status</span>](<span class="link">https://david-dm.org/tjx666/react-typescript-boilerplate/status.svg</span>)](<span class="link">https://david-dm.org/tjx666/react-typescript-boilerplate</span>) [<span class="string">![devDependencies Status</span>](<span class="link">https://david-dm.org/tjx666/react-typescript-boilerplate/dev-status.svg</span>)](<span class="link">https://david-dm.org/tjx666/react-typescript-boilerplate?type=dev</span>) [<span class="string">![Known Vulnerabilities</span>](<span class="link">https://snyk.io/test/github/tjx666/react-typescript-boilerplate/badge.svg?targetFile=package.json</span>)](<span class="link">https://snyk.io/test/github/tjx666/react-typescript-boilerplate?targetFile=package.json</span>) [<span class="string">![Percentage of issues still open</span>](<span class="link">https://isitmaintained.com/badge/open/tjx666/react-typescript-boilerplate.svg</span>)](<span class="link">http://isitmaintained.com/project/tjx666/react-typescript-boilerplate'</span>)</span><br><span class="line"></span><br><span class="line">A boilerplate for react + typescript development</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ div çš„ align å±æ€§å°†æ ‡é¢˜ï¼Œå¾½ç« å’Œæè¿°å±…ä¸­ã€‚</p><h2 id="first-commit"><a href="#first-commit" class="headerlink" title="first commit"></a>first commit</h2><p>åˆ°è¿™æ„Ÿè§‰å°±å¯ä»¥åšç¬¬ä¸€æ¬¡æäº¤äº†ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ·»åŠ è¿œç¨‹ä»“åº“åœ°å€</span></span><br><span class="line">git remote add github git@github.com:tjx666/react-typescript-boilerplate.git</span><br><span class="line"><span class="comment"># æ·»åŠ æ‰€æœ‰ä¿®æ”¹åˆ°æš‚å­˜åŒº</span></span><br><span class="line">git add -A</span><br><span class="line"><span class="comment"># æäº¤ï¼Œä½¿ç”¨ :tada: emoji</span></span><br><span class="line">git commit -m <span class="string">":tada: first commit, add some dotfiles"</span></span><br><span class="line"><span class="comment"># æ¨é€åˆ° githubï¼Œå…³è” github è¿œç¨‹ä»“åº“å’Œ master åˆ†æ”¯ï¼Œä¸‹æ¬¡è¿˜æ˜¯ master åˆ†æ”¯å°±å¯ä»¥ç›´æ¥ git push äº†</span></span><br><span class="line">git push github -u master</span><br></pre></td></tr></table></figure><p>æ¨èä½¿ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2Nhcmxvc2N1ZXN0YS9naXRtb2ppLWNsaQ==" title="https://github.com/carloscuesta/gitmoji-cli">gitmoji-cli<i class="fa fa-external-link"></i></span> æˆ–è€…ç›´æ¥ä½¿ç”¨ VSCode æ‰©å±• <span class="exturl" data-url="aHR0cHM6Ly9tYXJrZXRwbGFjZS52aXN1YWxzdHVkaW8uY29tL2l0ZW1zP2l0ZW1OYW1lPWJlbmphbWluYWRrLmVtb2ppczRnaXQ=" title="https://marketplace.visualstudio.com/items?itemName=benjaminadk.emojis4git">Gitmoji Commit<i class="fa fa-external-link"></i></span> ç”Ÿæˆ git emojiã€‚</p><p><a href="https://lyreal666.com/ä»é›¶å¼€å§‹é…ç½®-react-typescriptï¼ˆäºŒï¼‰ï¼šlinters-å’Œ-formatter/">ä¸‹ä¸€ç¯‡</a> å°†ç»§ç»­ä»‹ç» linters å’Œ formatter çš„é…ç½®ã€‚</p><p>è¦æƒ³äº†è§£æ›´å¤šç»†èŠ‚ï¼Œå»ºè®®ç›´æ¥çœ‹æºç ï¼Œé¡¹ç›®åœ°å€ï¼š<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RqeDY2Ni9yZWFjdC10eXBlc2NyaXB0LWJvaWxlcnBsYXRl" title="https://github.com/tjx666/react-typescript-boilerplate">react-typescript-boilerplate<i class="fa fa-external-link"></i></span>ã€‚å¦‚æœè§‰å¾—æœ¬æ–‡å¯¹ä½ æœ‰ç”¨ï¼Œä¸å¦¨èµé¢— star ğŸ˜ã€‚å¯¹æœ¬æ–‡å†…å®¹æœ‰ç–‘é—®æˆ–è€…æœ‰ä»€ä¹ˆæ”¹è¿›çš„åœ°æ–¹æ¬¢è¿é€šè¿‡ github issues å’Œå‘å¸ƒå¹³å°çš„è¯„è®ºåŒºäº¤æµã€‚</p><p>æœ¬æ–‡ä¸ºåŸåˆ›å†…å®¹ï¼Œé¦–å‘äº<span class="exturl" data-url="aHR0cDovL3d3dy5seXJlYWw2NjYuY29tLw==" title="http://www.lyreal666.com/">ä¸ªäººåšå®¢<i class="fa fa-external-link"></i></span>ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>react</tag>
        <tag>typescript</tag>
        <tag>dotfile</tag>
      </tags>
  </entry>
  <entry>
    <title>è®²æ¸…æ¥š JavaScript åŸå‹</title>
    <url>/%E8%AE%B2%E6%B8%85%E6%A5%9A-JavaScript-%E5%8E%9F%E5%9E%8B/</url>
    <content><![CDATA[<p>è®°å¾—ä»¥å‰çŸ¥ä¹ä¸Šçœ‹åˆ°è¿‡ä¸€ä¸ªé—®é¢˜ï¼š<a href="https://www.zhihu.com/question/60165921" target="_blank" rel="noopener">é¢è¯•ä¸€ä¸ª 5 å¹´çš„å‰ç«¯ï¼Œå´è¿<strong>åŸå‹é“¾</strong>ä¹Ÿæä¸æ¸…æ¥šï¼Œæ»¡å£éƒ½æ˜¯ Vueï¼ŒReact ä¹‹ç±»çš„å®ç°ï¼Œè¿™æ ·çš„äººè¯¥ç”¨å—ï¼Ÿ</a> ã€‚å†™æ–‡ç« çš„æ—¶å€™åˆå›å»çœ‹äº†ä¸‹è¿™ä¸ªé—®é¢˜ï¼Œ300 å¤šä¸ªå›ç­”ï¼Œæœ‰å¾ˆå¤šå¤§ä½¬éƒ½å›ç­”äº†è¿™ä¸ªé—®é¢˜ï¼Œè¯´æ˜è¿™ä¸ªé—®é¢˜è¿˜æ˜¯æŒºå—å…³æ³¨çš„ã€‚æœ€è¿‘å‡ å¹´ï¼Œéšç€ ES6 ï¼ŒTypeScript åŠç±»ä¼¼çš„ä¸­é—´è¯­è¨€çš„æµè¡Œï¼Œæˆ‘ä»¬å¹³æ—¶åšä¸šåŠ¡å¼€å‘å¾ˆå°‘èƒ½æ¥è§¦åˆ°åŸå‹ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯ç”¨ ES6 class æ¥å»æ›´ç®€å•çš„ï¼Œæ›´ç›´è§‚çš„å®ç°ä»¥å‰æ„é€ å™¨åŠ åŸå‹åšçš„äº‹æƒ…ã€‚</p><p>å…¶å®åœ¨æˆ‘çœ‹æ¥ï¼Œæˆ‘è§‰å¾—åŸå‹é“¾æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„åŸºç¡€çŸ¥è¯†ã€‚å¦‚æœä¸€ä¸ªäººè¯´ä»– C è¯­è¨€å¾ˆç²¾é€šï¼Œä½†æ˜¯ä»–æ±‡ç¼–ä¸ç†Ÿï¼Œä½ ä¿¡å—ï¼Ÿæˆ‘è§‰å¾— winter è¯´çš„æŒºç®€æ´åˆ°ä½çš„ï¼š</p><blockquote><p>è¿™åˆæ¶‰åŠåˆ°æˆ‘ä¹‹å‰è®²è¿‡çš„é¢è¯•å®˜æŠ€å·§ï¼Œé¢è¯•ï¼Œæ˜¯å¯¹ä¸€ä¸ªäººçš„èƒ½åŠ›ç³»ç»Ÿæ€§è¯„ä»·ï¼Œææ¸…æ¥šä¸€ä¸ªäººæ“…é•¿ä»€ä¹ˆä¸ä¼šä»€ä¹ˆï¼Œæ‰€ä»¥é—®çŸ¥è¯†æ€§é—®é¢˜ï¼Œä¸ºäº†é¿å…è¯¯åˆ¤ï¼Œä¸€å®šè¦å¤§é‡é—®ã€ç³»ç»ŸåŒ–åœ°é—®ã€‚</p><p>ä¸ä¼šåŸå‹å¾ˆèƒ½è¯´æ˜é—®é¢˜ï¼Œè‡³å°‘ä»–åœ¨åº“çš„è®¾è®¡æ–¹é¢ä¼šæœ‰æå¤§åŠ£åŠ¿ï¼Œè€Œä¸”å¯èƒ½å­¦ä¹ ä¹ æƒ¯ä¸Šæ˜¯æœ‰é—®é¢˜çš„ï¼Œä¹Ÿæœ‰å¯èƒ½ä»–æ ¹æœ¬å°±ä¸å¤ªä¼š JS è¯­è¨€ï¼Œä½†æ˜¯è¿™ä¸æ„å‘³ç€å‡­å€Ÿä¸€ä¸ªé—®é¢˜å°±å¯ä»¥åˆ¤å®šè¿™ä¸ªäººä¸èƒ½ç”¨ã€‚</p></blockquote><p>æœ¬æ–‡åŒ…æ‹¬ä»¥ä¸‹å†…å®¹ï¼š</p><ol><li>JavaScript åŸå‹</li><li>æ„é€ å™¨å’Œ <code>prototype</code></li><li>åŸå‹é“¾</li><li>åŸå‹çš„ç”¨é€”</li><li>ES6 class å’Œæ„é€ å™¨çš„å…³ç³»</li><li>åŸå‹ç»§æ‰¿</li><li>JavaScript å’ŒåŸå‹ç›¸å…³è¯­æ³•ç‰¹æ€§</li><li>åŸå‹æ±¡æŸ“</li></ol><a id="more"></a><h2 id="JavaScript-åŸå‹"><a href="#JavaScript-åŸå‹" class="headerlink" title="JavaScript åŸå‹"></a>JavaScript åŸå‹</h2><p>åŸå‹çš„è‹±æ–‡åº”è¯¥å«åš <code>prototype</code>ï¼Œä»»ä½•ä¸€ä¸ªå¯¹è±¡éƒ½æœ‰åŸå‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡éæ ‡å‡†å±æ€§ <code>__proto__</code> æ¥è®¿é—®ä¸€ä¸ªå¯¹è±¡çš„åŸå‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// çº¯å¯¹è±¡çš„åŸå‹</span></span><br><span class="line"><span class="built_in">console</span>.log(&#123;&#125;.__proto__); <span class="comment">// =&gt; &#123;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params">name, grade</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.grade = grade;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> stu = <span class="keyword">new</span> Student(<span class="string">'xiaoMing'</span>, <span class="number">6</span>);</span><br><span class="line"><span class="comment">// Student ç±»å‹å®ä¾‹çš„åŸå‹ï¼Œé»˜è®¤ä¹Ÿæ˜¯ä¸€ä¸ªç©ºå¯¹è±¡</span></span><br><span class="line"><span class="built_in">console</span>.log(stu.__proto__); <span class="comment">// =&gt; Student &#123;&#125;</span></span><br></pre></td></tr></table></figure><p><code>__proto__</code> æ˜¯éæ ‡å‡†å±æ€§ï¼Œå¦‚æœè¦è®¿é—®ä¸€ä¸ªå¯¹è±¡çš„åŸå‹ï¼Œå»ºè®®ä½¿ç”¨ ES6 æ–°å¢çš„ <code>Object.getPrototypeOf()</code> æ–¹æ³•ã€‚éæ ‡å‡†å±æ€§æ„å‘³ç€æœªæ¥å¯èƒ½ç›´æ¥ä¼šä¿®æ”¹æˆ–è€…ç§»é™¤è¯¥å±æ€§ï¼Œè¯´ä¸å®šä»¥åå‡ºäº†ä¸ªæ–°æ ‡å‡†ç”¨ <code>Symbol.proto</code> ä½œä¸º key æ¥è®¿é—®å¯¹è±¡çš„åŸå‹ï¼Œé‚£è¿™ä¸ªéæ ‡å‡†å±æ€§å¯èƒ½å°±è¦è¢«ç§»é™¤äº†ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(&#123;&#125;.__proto__ === <span class="built_in">Object</span>.getPrototypeOf(&#123;&#125;)); <span class="comment">// =&gt; true</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥ç›´æ¥ä¿®æ”¹å¯¹è±¡çš„åŸå‹ï¼Œä¸è¿‡è¢«è®¾ç½®çš„å€¼çš„ç±»å‹åªèƒ½æ˜¯å¯¹è±¡æˆ–è€… nullï¼Œå…¶å®ƒç±»å‹ä¸èµ·ä½œç”¨ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123; <span class="attr">name</span>: <span class="string">'xiaoMing'</span> &#125;;</span><br><span class="line"><span class="comment">// åŸå‹ä¸ºç©ºå¯¹è±¡</span></span><br><span class="line"><span class="built_in">console</span>.log(obj.__proto__); <span class="comment">// =&gt; &#123;&#125;</span></span><br><span class="line"></span><br><span class="line">obj.__proto__ = <span class="number">666</span>;</span><br><span class="line"><span class="comment">// éå¯¹è±¡å’Œ null ä¸ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="built_in">console</span>.log(obj.__proto__); <span class="comment">// =&gt; &#123;&#125;</span></span><br><span class="line"></span><br><span class="line">obj.__proto__ = <span class="literal">null</span>;</span><br><span class="line"><span class="comment">// è®¾ç½®ä¸º null è¿”å› undefined</span></span><br><span class="line"><span class="built_in">console</span>.log(obj.__proto__); <span class="comment">// undefined</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®åŸå‹ä¸ºå¯¹è±¡</span></span><br><span class="line">obj.__proto__ = &#123; <span class="attr">constructor</span>: <span class="string">'Function Student'</span> &#125;;</span><br><span class="line"><span class="built_in">console</span>.log(obj.__proto__); <span class="comment">// =&gt; &#123; constructor: 'Function Student' &#125;</span></span><br></pre></td></tr></table></figure><p>å¦‚æœè¢«è®¾ç½®çš„å€¼æ˜¯ä¸å¯æ‰©å±•çš„ï¼Œå°†æŠ›å‡º TypeErrorï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> frozenObj = <span class="built_in">Object</span>.freeze(&#123;&#125;);</span><br><span class="line"><span class="comment">// Object.isExtensible(obj) å¯ä»¥åˆ¤æ–­ obj æ˜¯ä¸æ˜¯å¯æ‰©å±•çš„</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.isExtensible(frozenObj)); <span class="comment">// =&gt; false</span></span><br><span class="line">frozenObj.__proto__ = <span class="literal">null</span>; <span class="comment">// =&gt; TypeError: #&lt;Object&gt; is not extensible</span></span><br></pre></td></tr></table></figure><p>åŸå‹ä¸Šçš„å±æ€§éƒ½æ˜¯ä¸å¯æšä¸¾çš„ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;&#125;;</span><br><span class="line">obj.__proto__.xxx = <span class="number">666</span>;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.keys(obj)); <span class="comment">// =&gt; []</span></span><br></pre></td></tr></table></figure><p>å…¶å® <code>__proto__</code> æ˜¯ä¸ªè®¿é—®å™¨å±æ€§ï¼ˆgetter å’Œ setter éƒ½æœ‰ï¼‰ï¼Œé€šè¿‡ <code>__proto__</code> è®¿é—®å™¨æˆ‘ä»¬å¯ä»¥è®¿é—®å¯¹è±¡çš„<code>[[Prototype]]</code>ï¼Œ ä¹Ÿå°±æ˜¯åŸå‹ã€‚ç®€å•å®ç°ä¸€ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Object</span>.prototype = &#123;</span><br><span class="line">  <span class="keyword">get</span> __proto__() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>[<span class="string">'[[prototype]]'</span>];</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="keyword">set</span> __proto__(newPrototype) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">Object</span>.isExtensible(newPrototype)) <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">`<span class="subst">$&#123;newPrototype&#125;</span> is not extensible`</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (newPrototype === <span class="literal">null</span>) &#123;</span><br><span class="line">      <span class="keyword">this</span>[<span class="string">'[[prototype]]'</span>] = <span class="literal">undefined</span>;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> isObject = <span class="keyword">typeof</span> newPrototype === <span class="string">'object'</span> || <span class="keyword">typeof</span> newPrototype === <span class="string">'function'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (isObject) &#123;</span><br><span class="line">      <span class="keyword">this</span>[<span class="string">'[[prototype]]'</span>] = newPrototype;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// ... å…¶å®ƒå±æ€§å¦‚ toStringï¼ŒhasOwnProperty ç­‰</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="æ„é€ å™¨å’Œ-prototype"><a href="#æ„é€ å™¨å’Œ-prototype" class="headerlink" title="æ„é€ å™¨å’Œ prototype"></a>æ„é€ å™¨å’Œ prototype</h2><p>æ„é€ å™¨çš„è‹±æ–‡å°±æ˜¯ <code>constructor</code>ï¼Œåœ¨ JavaScript ä¸­ï¼Œ<strong>å‡½æ•°éƒ½å¯ä»¥ç”¨ä½œæ„é€ å™¨</strong>ã€‚æ„é€ å™¨æˆ‘ä»¬ä¹Ÿå¯ä»¥ç§°ä¹‹ä¸ºç±»ï¼ŒStudent æ„é€ å™¨ä¸å°±å¯ä»¥ç§°ä¹‹ä¸º Student ç±»å˜›ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ new æ„é€ å™¨æ¥æ„é€ ä¸€ä¸ªå®ä¾‹ã€‚ä¹ æƒ¯ä¸Šæˆ‘ä»¬å¯¹ç”¨ä½œæ„é€ å™¨çš„å‡½æ•°ä½¿ç”¨å¤§é©¼å³°å‘½åï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Apple</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="keyword">const</span> apple = <span class="keyword">new</span> Apple();</span><br><span class="line"><span class="built_in">console</span>.log(apple <span class="keyword">instanceof</span> Apple); <span class="comment">// =&gt; true</span></span><br></pre></td></tr></table></figure><p><strong>ä»»ä½•æ„é€ å™¨éƒ½æœ‰ä¸€ä¸ª prototype å±æ€§ï¼Œé»˜è®¤æ˜¯ä¸€ä¸ªç©ºçš„çº¯å¯¹è±¡ï¼Œæ‰€æœ‰ç”±æ„é€ å™¨æ„é€ çš„å®ä¾‹çš„åŸå‹éƒ½æ˜¯æŒ‡å‘å®ƒã€‚</strong></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å®ä¾‹çš„åŸå‹å³ apple1.__proto__</span></span><br><span class="line"><span class="built_in">console</span>.log(apple1.__proto__ === Apple.prototype); <span class="comment">// =&gt; true</span></span><br><span class="line"><span class="built_in">console</span>.log(apple2.__proto__ === Apple.prototype); <span class="comment">// =&gt; true</span></span><br></pre></td></tr></table></figure><p>ä¸‹é¢çš„æµ‹è¯•ç»“æœå¯ä»¥è¯æ˜æ„é€ å™¨çš„ prototype å±æ€§é»˜è®¤æ˜¯ä¸ªç©ºå¯¹è±¡ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(Apple.prototype); <span class="comment">// =&gt; Apple &#123;&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.keys(Apple.prototype)); <span class="comment">// =&gt; []</span></span><br><span class="line"><span class="built_in">console</span>.log(Apple.prototype.__proto__ === &#123;&#125;.__proto__); <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>æ„é€ å™¨çš„ prototype æœ‰ä¸€ä¸ª constructor å±æ€§ï¼ŒæŒ‡å‘æ„é€ å™¨æœ¬èº«ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(Apple.prototype.constructor === Apple); <span class="comment">// =&gt; true</span></span><br></pre></td></tr></table></figure><p><code>__proto__</code> ï¼Œ<code>prototype</code>ï¼Œ<code>constructor</code>ï¼Œ<code>Apple</code>å‡½æ•°ï¼Œå®ä¾‹ <code>apple</code> å’ŒåŸå‹å¯¹è±¡ <code>[[prototype]]</code> ä¹‹é—´çš„å…³ç³»ï¼š</p><p><img data-src="https://i.loli.net/2020/01/28/Ax7FsXQne84PNkg.png" alt="relationship.png"></p><p>æœ‰äº›äººå¯èƒ½ä¼šæŠŠ <code>__proto__</code> å’Œ <code>prototype</code> ææ··æ·†ã€‚ä»ç¿»è¯‘çš„è§’åº¦æ¥è¯´ï¼Œå®ƒä»¬éƒ½å¯ä»¥å«åŸå‹ï¼Œä½†æ˜¯å…¶å®æ˜¯å®Œå…¨ä¸åŒçš„ä¸¤ä¸ªä¸œè¥¿ã€‚</p><p><code>__proto__</code> å­˜åœ¨äºæ‰€æœ‰çš„å¯¹è±¡ä¸Šï¼Œ<code>prototype</code> å­˜åœ¨äºæ‰€æœ‰çš„å‡½æ•°ä¸Šï¼Œä»–ä¿©çš„å…³ç³»å°±æ˜¯ï¼šå‡½æ•°çš„ <code>prototype</code> æ˜¯æ‰€æœ‰ä½¿ç”¨ new è¿™ä¸ªå‡½æ•°æ„é€ çš„å®ä¾‹çš„ <code>__proto__</code>ã€‚å‡½æ•°ä¹Ÿæ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥å‡½æ•°åŒæ—¶æœ‰ <code>__proto__</code> å’Œ<code>prototype</code>ã€‚</p><p><strong>æ³¨æ„</strong>ï¼šå¦‚æœæˆ‘æ–‡ç« ä¸­æåˆ°äº†æ„é€ å™¨çš„åŸå‹ï¼ŒæŒ‡çš„æ˜¯æ„é€ å™¨çš„ <code>__proto__</code>ï¼Œè€Œä¸æ˜¯æ„é€ å™¨çš„ prototype å±æ€§ã€‚</p><h2 id="åŸå‹é“¾"><a href="#åŸå‹é“¾" class="headerlink" title="åŸå‹é“¾"></a>åŸå‹é“¾</h2><p>é‚£ä¹ˆ<strong>å¯¹è±¡çš„åŸå‹</strong>æœ‰ä»€ä¹ˆç‰¹ç‚¹å‘¢ï¼Ÿ</p><blockquote><p>å½“åœ¨ä¸€ä¸ªå¯¹è±¡ obj ä¸Šè®¿é—®æŸä¸ªå±æ€§æ—¶ï¼Œå¦‚æœä¸å­˜åœ¨äº objï¼Œé‚£ä¹ˆä¾¿ä¼šå»å¯¹è±¡çš„åŸå‹ä¹Ÿå°±æ˜¯ <code>obj.__proto__</code> ä¸Šå»æ‰¾è¿™ä¸ªå±æ€§ã€‚å¦‚æœæœ‰åˆ™è¿”å›è¿™ä¸ªå±æ€§ï¼Œæ²¡æœ‰åˆ™å»å¯¹è±¡ obj çš„åŸå‹çš„åŸå‹ä¹Ÿå°±æ˜¯ <code>obj.__proto__.__proto__</code>å»æ‰¾ï¼Œé‡å¤ä»¥ä¸Šæ­¥éª¤ã€‚ä¸€ç›´åˆ°è®¿é—®<strong>çº¯å¯¹è±¡</strong>çš„åŸå‹çš„åŸå‹<code>{}.__proto.__proto__</code>ï¼Œä¹Ÿå°±æ˜¯ nullï¼Œç›´æ¥è¿”å› undefinedã€‚</p></blockquote><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params">name, grade</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.grade = grade;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> stu = <span class="keyword">new</span> Student();</span><br><span class="line"><span class="built_in">console</span>.log(stu.notExists); <span class="comment">// =&gt; undefined</span></span><br></pre></td></tr></table></figure><p>è®¿é—® <code>stu.notExists</code> çš„æ•´ä¸ªè¿‡ç¨‹æ˜¯ï¼š</p><ol><li>å…ˆçœ‹ <code>stu</code> ä¸Šæ˜¯å¦å­˜åœ¨ <code>notExists</code>ï¼Œä¸å­˜åœ¨ï¼Œæ‰€ä»¥çœ‹ <code>stu.__proto__</code></li><li><code>stu.__proto__</code> ä¸Šä¹Ÿä¸å­˜åœ¨ <code>notExists</code> å±æ€§ï¼Œå†çœ‹ <code>stu.__proto__.__proto__</code>ï¼Œå…¶å®å°±æ˜¯<strong>çº¯å¯¹è±¡</strong>çš„åŸå‹ï¼š<code>{}.__proto__</code></li><li><strong>çº¯å¯¹è±¡</strong>çš„åŸå‹ä¸Šä¹Ÿä¸å­˜åœ¨ <code>notExists</code> å±æ€§ï¼Œå†å¾€ä¸Šï¼Œåˆ° <code>stu.__proto__.__proto__.__proto__</code> ä¸Šå»æ‰¾ï¼Œå…¶å®å°±æ˜¯ null</li><li>null ä¸å­˜åœ¨ <code>notExists</code> å±æ€§ï¼Œè¿”å› undefined</li></ol><p>å¯èƒ½æœ‰è¯»è€…çœ‹äº†ä¸Šé¢ä¼šæœ‰ç–‘é—®ï¼Œå¯¹è±¡çš„åŸå‹ä¸€ç›´æŸ¥æ‰¾æœ€åä¼šæ‰¾åˆ°<strong>çº¯å¯¹è±¡</strong>çš„åŸå‹ï¼Ÿæµ‹è¯•ä¸€ä¸‹å°±çŸ¥é“äº†ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(stu.__proto__.__proto__ === &#123;&#125;.__proto__); <span class="comment">// =&gt; true</span></span><br></pre></td></tr></table></figure><p><strong>çº¯å¯¹è±¡</strong>çš„åŸå‹çš„åŸå‹æ˜¯ nullï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="keyword">new</span> <span class="built_in">Object</span>().__proto__.__proto__); <span class="comment">// =&gt; null</span></span><br></pre></td></tr></table></figure><blockquote><p>å„ä¸ªåŸå‹ä¹‹é—´æ„æˆçš„é“¾ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºåŸå‹é“¾ã€‚</p></blockquote><p><img data-src="https://i.loli.net/2020/01/28/pdbT1nxw57lDijS.png" alt="prototypeChain1.png"></p><p>æƒ³æƒ³çœ‹ï¼Œå‡½æ•° <code>Student</code> çš„åŸå‹é“¾åº”è¯¥æ˜¯æ€æ ·çš„ï¼Ÿ</p><p><img data-src="https://i.loli.net/2020/01/28/hNn4dPgkiAI2pML.png" alt="functionPrototypeChain.png"></p><h2 id="åŸå‹çš„ç”¨é€”"><a href="#åŸå‹çš„ç”¨é€”" class="headerlink" title="åŸå‹çš„ç”¨é€”"></a>åŸå‹çš„ç”¨é€”</h2><p>åœ¨ä½¿ç”¨æ„é€ å™¨å®šä¹‰ä¸€ä¸ªç±»å‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šå°†ç±»çš„æ–¹æ³•å®šä¹‰åœ¨åŸå‹ä¸Šï¼Œå’Œ this çš„æŒ‡å‘ç‰¹æ€§ç®€ç›´æ˜¯ç»é…ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Engineer</span>(<span class="params">workingYears</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.workingYears = workingYears;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸èƒ½ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Œç®­å¤´å‡½æ•°çš„ this åœ¨å£°æ˜çš„æ—¶å€™å°±æ ¹æ®ä¸Šä¸‹æ–‡ç¡®å®šäº†</span></span><br><span class="line">Engineer.prototype.built = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`æˆ‘å·²ç»å·¥ä½œ <span class="subst">$&#123;<span class="keyword">this</span>.workingYears&#125;</span> å¹´äº†, æˆ‘çš„å·¥ä½œæ˜¯æ‹§èºä¸...`</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> engineer = <span class="keyword">new</span> Engineer(<span class="number">5</span>);</span><br><span class="line"><span class="comment">// this ä¼šæ­£ç¡®æŒ‡å‘å®ä¾‹ï¼Œæ‰€ä»¥ this.workingYears æ˜¯ 5</span></span><br><span class="line">engineer.built(); <span class="comment">// =&gt; æˆ‘å·²ç»å·¥ä½œ 5 å¹´äº†, æˆ‘çš„å·¥ä½œæ˜¯æ‹§èºä¸...</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.keys(engineer)); <span class="comment">// =&gt; [ 'workingYears' ]</span></span><br></pre></td></tr></table></figure><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæ‰€æœ‰çš„å®ä¾‹éƒ½å¯ä»¥è®¿é—®åˆ°è¿™ä¸ªæ–¹æ³•ï¼Œå¹¶ä¸”è¿™ä¸ªæ–¹æ³•åªéœ€è¦å ç”¨ä¸€ä»½å†…å­˜ï¼ŒèŠ‚çœå†…å­˜ï¼Œthis çš„æŒ‡å‘è¿˜èƒ½æ­£ç¡®æŒ‡å‘ç±»çš„å®ä¾‹ã€‚</p><p>ä¸è¿‡è¿™ç§æ–¹å¼å®šä¹‰çš„æ–¹æ³•éƒ½æ˜¯ä¸å¯æšä¸¾çš„ï¼Œæ¯•ç«Ÿä¸æ˜¯è‡ªèº«çš„å±æ€§ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  func() &#123;&#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.keys(obj)); <span class="comment">// =&gt; [ 'func' ]</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Func</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">Func.prototype.func = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line"><span class="comment">// ç©ºæ•°ç»„ï¼Œè¯´æ˜ func ä¸å¯æšä¸¾</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.keys(<span class="keyword">new</span> Func())); <span class="comment">// =&gt; []</span></span><br></pre></td></tr></table></figure><p>å¦‚æœä½ å°±æ˜¯è¦å®šä¹‰å®ä¾‹å±æ€§çš„è¯è¿˜æ˜¯åªèƒ½é€šè¿‡ <code>this.xxx = xxx</code> çš„æ–¹å¼å®šä¹‰å®ä¾‹æ–¹æ³•äº†ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Engineer</span>(<span class="params">workingYears</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.workingYears = workingYears;</span><br><span class="line">  <span class="keyword">this</span>.built = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`æˆ‘å·²ç»å·¥ä½œ <span class="subst">$&#123;<span class="keyword">this</span>.workingYears&#125;</span> å¹´äº†, æˆ‘çš„å·¥ä½œæ˜¯æ‹§èºä¸...`</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> engineer = <span class="keyword">new</span> Engineer(<span class="number">5</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.keys(engineer)); <span class="comment">// =&gt; [ 'workingYears', 'built' ]</span></span><br></pre></td></tr></table></figure><p>å…¶å® JavaScript ä¸­å¾ˆå¤šæ–¹æ³•éƒ½å®šä¹‰åœ¨æ„é€ å™¨çš„åŸå‹ä¸Šï¼Œä¾‹å¦‚ Array.prototype.sliceï¼ŒObject.prototype.toString ç­‰ã€‚</p><h2 id="ES6-class-å’Œæ„é€ å™¨çš„å…³ç³»"><a href="#ES6-class-å’Œæ„é€ å™¨çš„å…³ç³»" class="headerlink" title="ES6 class å’Œæ„é€ å™¨çš„å…³ç³»"></a>ES6 class å’Œæ„é€ å™¨çš„å…³ç³»</h2><p>å¾ˆå¤šè¯­è¨€éƒ½æœ‰æ‹¥æœ‰é¢å‘å¯¹è±¡ç¼–ç¨‹èŒƒå¼ï¼Œä¾‹å¦‚ java, c#, python ç­‰ã€‚ES6 class è®©ä»å®ƒä»¬è½¬åˆ° JavaScript çš„å¼€å‘è€…æ›´å®¹æ˜“è¿›è¡Œé¢å‘å¯¹è±¡ç¼–ç¨‹ã€‚</p><h3 id="ES6-class"><a href="#ES6-class" class="headerlink" title="ES6 class"></a>ES6 class</h3><p>å…¶å®ï¼Œ<strong>ES6 class å°±æ˜¯æ„é€ å™¨çš„è¯­æ³•ç³–</strong>ã€‚ æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ babel å°† ES6 class ç¼–è¯‘æˆäº†å•¥ï¼š</p><p>åŸä»£ç ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Circle</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(x, y, r) &#123;</span><br><span class="line">    <span class="keyword">this</span>.x = x;</span><br><span class="line">    <span class="keyword">this</span>.y = y;</span><br><span class="line">    <span class="keyword">this</span>.r = r;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  draw() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`ç”»ä¸ªåæ ‡ä¸º (<span class="subst">$&#123;<span class="keyword">this</span>.x&#125;</span>, <span class="subst">$&#123;<span class="keyword">this</span>.y&#125;</span>)ï¼ŒåŠå¾„ä¸º <span class="subst">$&#123;<span class="keyword">this</span>.r&#125;</span> çš„åœ†`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>babel + babel-preset-es2015-loose</code> ç¼–è¯‘å‡ºçš„ç»“æœï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="meta">'use strict'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Circle class å¯ä»¥ç†è§£ä¸ºå°±æ˜¯ä¸€ä¸ªæ„é€ å™¨å‡½æ•°</span></span><br><span class="line"><span class="keyword">var</span> Circle = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">Circle</span>(<span class="params">x, y, r</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.x = x;</span><br><span class="line">    <span class="keyword">this</span>.y = y;</span><br><span class="line">    <span class="keyword">this</span>.r = r;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> _proto = Circle.prototype;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// class æ–¹æ³•å®šä¹‰åœ¨ prototype ä¸Š</span></span><br><span class="line">  _proto.draw = <span class="function"><span class="keyword">function</span> <span class="title">draw</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(</span><br><span class="line">      <span class="string">'\u753B\u4E2A\u5750\u6807\u4E3A ('</span> +</span><br><span class="line">        <span class="keyword">this</span>.x +</span><br><span class="line">        <span class="string">', '</span> +</span><br><span class="line">        <span class="keyword">this</span>.y +</span><br><span class="line">        <span class="string">')\uFF0C\u534A\u5F84\u4E3A '</span> +</span><br><span class="line">        <span class="keyword">this</span>.r +</span><br><span class="line">        <span class="string">' \u7684\u5706'</span></span><br><span class="line">    );</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> Circle;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><p>ä¸€çœ‹å°±æ˜ç™½äº†ï¼Œ ES6 çš„ class å°±æ˜¯æ„é€ å™¨ï¼Œclass ä¸Šçš„æ–¹æ³•å®šä¹‰åœ¨æ„é€ å™¨çš„ prototype ä¸Šï¼Œå› æ­¤ä½ ä¹Ÿå¯ä»¥ç†è§£ä¸ºä»€ä¹ˆ class çš„æ–¹æ³•æ˜¯ä¸å¯æšä¸¾çš„ã€‚</p><h3 id="extends-ç»§æ‰¿"><a href="#extends-ç»§æ‰¿" class="headerlink" title="extends ç»§æ‰¿"></a>extends ç»§æ‰¿</h3><p>æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹ä½¿ç”¨ <code>extends</code> ç»§æ‰¿æ—¶æ˜¯æ€æ ·è½¬æ¢çš„ã€‚</p><p>åŸä»£ç :</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Shape</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(x, y) &#123;</span><br><span class="line">    <span class="keyword">this</span>.x = x;</span><br><span class="line">    <span class="keyword">this</span>.y = y;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Circle</span> <span class="keyword">extends</span> <span class="title">Shape</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(x, y, r) &#123;</span><br><span class="line">    <span class="keyword">super</span>(x, y);</span><br><span class="line">    <span class="keyword">this</span>.r = r;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  draw() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`ç”»ä¸ªåæ ‡ä¸º (<span class="subst">$&#123;<span class="keyword">this</span>.x&#125;</span>, <span class="subst">$&#123;<span class="keyword">this</span>.y&#125;</span>)ï¼ŒåŠå¾„ä¸º <span class="subst">$&#123;<span class="keyword">this</span>.r&#125;</span> çš„åœ†`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>babel + babel-preset-es2015-loose</code> ç¼–è¯‘å‡ºçš„ç»“æœï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="meta">'use strict'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŸå‹ç»§æ‰¿</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_inheritsLoose</span>(<span class="params">subClass, superClass</span>) </span>&#123;</span><br><span class="line">  subClass.prototype = <span class="built_in">Object</span>.create(superClass.prototype);</span><br><span class="line">  subClass.prototype.constructor = subClass;</span><br><span class="line">  subClass.__proto__ = superClass;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Shape = <span class="function"><span class="keyword">function</span> <span class="title">Shape</span>(<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.x = x;</span><br><span class="line">  <span class="keyword">this</span>.y = y;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Circle = (<span class="function"><span class="keyword">function</span>(<span class="params">_Shape</span>) </span>&#123;</span><br><span class="line">  _inheritsLoose(Circle, _Shape);</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">Circle</span>(<span class="params">x, y, r</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> _this;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç»„åˆç»§æ‰¿</span></span><br><span class="line">    _this = _Shape.call(<span class="keyword">this</span>, x, y) || <span class="keyword">this</span>;</span><br><span class="line">    _this.r = r;</span><br><span class="line">    <span class="keyword">return</span> _this;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> _proto = Circle.prototype;</span><br><span class="line"></span><br><span class="line">  _proto.draw = <span class="function"><span class="keyword">function</span> <span class="title">draw</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(</span><br><span class="line">      <span class="string">'\u753B\u4E2A\u5750\u6807\u4E3A ('</span> +</span><br><span class="line">        <span class="keyword">this</span>.x +</span><br><span class="line">        <span class="string">', '</span> +</span><br><span class="line">        <span class="keyword">this</span>.y +</span><br><span class="line">        <span class="string">')\uFF0C\u534A\u5F84\u4E3A '</span> +</span><br><span class="line">        <span class="keyword">this</span>.r +</span><br><span class="line">        <span class="string">' \u7684\u5706'</span></span><br><span class="line">    );</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> Circle;</span><br><span class="line">&#125;)(Shape);</span><br></pre></td></tr></table></figure><p>æ•´ä¸ª ES6 çš„ extends å®ç°çš„æ˜¯åŸå‹ç»§æ‰¿ + ç»„åˆç»§æ‰¿ã€‚</p><p>å­ç±»æ„é€ å™¨ä¸­è°ƒç”¨äº†çˆ¶ç±»æ„é€ å™¨å¹¶å°† this æŒ‡å‘å­ç±»å®ä¾‹è¾¾åˆ°<strong>å°†çˆ¶ç±»çš„å®ä¾‹å±æ€§ç»„åˆåˆ°å­ç±»å®ä¾‹ä¸Š</strong>ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç»„åˆç»§æ‰¿</span></span><br><span class="line">_this = _Shape.call(<span class="keyword">this</span>, x, y) || <span class="keyword">this</span>;</span><br></pre></td></tr></table></figure><p><code>_inheritsLoose</code> è¿™ä¸ªå‡½æ•°å°±æ˜¯å®ç°äº†ä¸‹ä¸€èŠ‚è¦è®²çš„åŸå‹ç»§æ‰¿ã€‚</p><h2 id="åŸå‹ç»§æ‰¿"><a href="#åŸå‹ç»§æ‰¿" class="headerlink" title="åŸå‹ç»§æ‰¿"></a>åŸå‹ç»§æ‰¿</h2><p>åœ¨è®²<code>åŸå‹ç»§æ‰¿</code> ä¹‹å‰æˆ‘ä»¬å…ˆè®²è®²<code>ç»§æ‰¿</code>è¿™ä¸ªè¯ã€‚æˆ‘è§‰å¾—ï¼Œé€šä¿—æ„ä¹‰ä¸Šçš„<code>ç»§æ‰¿</code>æ˜¯è¯´ï¼š<strong>å¦‚æœç±» A ç»§æ‰¿è‡ªç±» Bï¼Œé‚£ä¹ˆ A çš„å®ä¾‹ç»§æ‰¿äº† B çš„å®ä¾‹å±æ€§</strong>ã€‚</p><p><code>åŸå‹ç»§æ‰¿</code>çš„è¿™ä¸ª<code>ç»§æ‰¿</code>å’Œé€šä¿—æ„ä¹‰ä¸Šçš„<code>ç»§æ‰¿</code>è¿˜ä¸å¤ªä¸€æ ·ï¼Œå®ƒæ˜¯è¦ï¼š<strong>A çš„å®ä¾‹èƒ½å¤Ÿç»§æ‰¿ B çš„åŸå‹ä¸Šçš„å±æ€§</strong>ã€‚</p><p>ç»™åŸå‹ç»§æ‰¿ä¸‹ä¸ªå®šä¹‰ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">å¯¹äºç±» A å’Œç±» Bï¼Œå¦‚æœæ»¡è¶³ A.prototype.__proto__ === B.prototypeï¼Œé‚£ä¹ˆ A åŸå‹ç»§æ‰¿ B</span><br></pre></td></tr></table></figure><p><img data-src="https://i.loli.net/2020/01/28/QitjOq1NJWzYcVl.png" alt="prototypeExtends.png"></p><p>å¦‚ä½•å®ç°åŸå‹ç»§æ‰¿å‘¢ï¼Ÿæœ€ç®€å•çš„æ–¹å¼å°±æ˜¯ç›´æ¥è®¾ç½® <code>A.prototype === new B()</code>ï¼Œè®© A çš„ prototype æ˜¯ B çš„å®ä¾‹å³å¯ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">A</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">B</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.xxx = <span class="string">'æ±¡æŸ“ A çš„åŸå‹'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">A.prototype = <span class="keyword">new</span> B();</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(A.prototype.__proto__ === B.prototype); <span class="comment">// =&gt; true</span></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™ç§æ–¹å¼ä¼šå¯¼è‡´ B çš„å®ä¾‹å±æ€§æ±¡æŸ“ A çš„åŸå‹ã€‚è§£å†³åŠæ³•å°±æ˜¯é€šè¿‡ä¸€ä¸ªç©ºçš„å‡½æ•°æ¡¥æ¥ä¸€ä¸‹ï¼Œç©ºçš„å‡½æ•°æ€»ä¸ä¼šæœ‰å®ä¾‹å±æ€§æ±¡æŸ“åŸå‹é“¾å–½ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">A</span>(<span class="params">p</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.p = p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">B</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.xxx = <span class="string">'æ±¡æŸ“åŸå‹'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç©ºå‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Empty</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">Empty.prototype = B.prototype;</span><br><span class="line">A.prototype = <span class="keyword">new</span> Empty();</span><br><span class="line"><span class="comment">// ä¿®æ­£ constructor æŒ‡å‘</span></span><br><span class="line">A.prototype.constructor = A;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ»¡è¶³åŸå‹ç»§æ‰¿çš„å®šä¹‰</span></span><br><span class="line"><span class="built_in">console</span>.log(A.prototype.__proto__ === B.prototype); <span class="comment">// =&gt; true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> a = <span class="keyword">new</span> A(<span class="string">'p'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(a <span class="keyword">instanceof</span> A); <span class="comment">// =&gt; true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> b = <span class="keyword">new</span> B();</span><br><span class="line"><span class="built_in">console</span>.log(b <span class="keyword">instanceof</span> B); <span class="comment">// =&gt; true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// a ä¹Ÿæ˜¯ B çš„å®ä¾‹</span></span><br><span class="line"><span class="built_in">console</span>.log(a <span class="keyword">instanceof</span> B); <span class="comment">// =&gt; true</span></span><br><span class="line"><span class="built_in">console</span>.log(a.__proto__.__proto__ === B.prototype); <span class="comment">// =&gt; true</span></span><br></pre></td></tr></table></figure><p>ç”¨ Windows è‡ªå¸¦çš„ç”»å›¾è½¯ä»¶ç”»çš„åŸå‹é“¾_ã€†(Â´Ğ” ï½€ )ï¼š</p><p><img data-src="https://i.loli.net/2020/01/28/A6YISmxrLuVNfyP.png" alt="prototypeChain.png"></p><p>åˆ©ç”¨ <code>Object.create</code>ï¼Œæˆ‘ä»¬å¯ä»¥æ›´ç®€å•çš„å®ç°åŸå‹ç»§æ‰¿ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢çš„ babel ç”¨åˆ°çš„å·¥å…·å‡½æ•° <code>_inheritsLoose</code>ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_inheritsLoose</span>(<span class="params">subClass, superClass</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Object.create(prototype) è¿”å›ä¸€ä¸ªä»¥ prototype ä¸ºåŸå‹çš„å¯¹è±¡</span></span><br><span class="line">  subClass.prototype = <span class="built_in">Object</span>.create(superClass.prototype);</span><br><span class="line">  subClass.prototype.constructor = subClass;</span><br><span class="line">  <span class="comment">// æˆ‘ä»¬ä¸Šé¢å®ç°çš„åŸå‹ç»§æ‰¿æ²¡æœ‰è®¾ç½®è¿™ä¸ªï¼Œä½†æ˜¯ class çš„ç»§æ‰¿ä¼šè®¾ç½®å­ç±»çš„åŸå‹ä¸ºçˆ¶ç±»</span></span><br><span class="line">  subClass.__proto__ = superClass;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="JavaScript-å’ŒåŸå‹ç›¸å…³è¯­æ³•ç‰¹æ€§"><a href="#JavaScript-å’ŒåŸå‹ç›¸å…³è¯­æ³•ç‰¹æ€§" class="headerlink" title="JavaScript å’ŒåŸå‹ç›¸å…³è¯­æ³•ç‰¹æ€§"></a>JavaScript å’ŒåŸå‹ç›¸å…³è¯­æ³•ç‰¹æ€§</h2><p>å…¶å®ç”±å¾ˆå¤šè¯­æ³•ç‰¹æ€§æ˜¯å’ŒåŸå‹æœ‰å…³ç³»çš„ï¼Œè®²åˆ°åŸå‹é‚£ä¹ˆæˆ‘ä»¬å°±å†ç»§ç»­è®²è®² JavaScrip è¯­æ³•ç‰¹æ€§ä¸­æ¶‰åŠåˆ°åŸå‹çš„ä¸€äº›çŸ¥è¯†ç‚¹ã€‚</p><h3 id="new-è¿ç®—ç¬¦åŸç†"><a href="#new-è¿ç®—ç¬¦åŸç†" class="headerlink" title="new è¿ç®—ç¬¦åŸç†"></a>new è¿ç®—ç¬¦åŸç†</h3><p>å½“æˆ‘ä»¬å¯¹å‡½æ•°ä½¿ç”¨ new çš„æ—¶å€™å‘ç”Ÿäº†ä»€ä¹ˆã€‚</p><p>ä½¿ç”¨ä»£ç æ¥æè¿°å°±æ˜¯ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isObject</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> type = <span class="keyword">typeof</span> value;</span><br><span class="line">  <span class="keyword">return</span> value !== <span class="literal">null</span> &amp;&amp; (type === <span class="string">'object'</span> || type === <span class="string">'function'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * constructor è¡¨ç¤º new çš„æ„é€ å™¨</span></span><br><span class="line"><span class="comment"> * args è¡¨ç¤ºä¼ ç»™æ„é€ å™¨çš„å‚æ•°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">New</span>(<span class="params">constructor, ...args</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// new çš„å¯¹è±¡ä¸æ˜¯å‡½æ•°å°±æŠ› TypeError</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="keyword">constructor</span> !== 'function') throw new TypeError(`$&#123;<span class="keyword">constructor</span>&#125; is not a <span class="keyword">constructor</span>`);</span><br><span class="line"></span><br><span class="line">  // åˆ›å»ºä¸€ä¸ªåŸå‹ä¸ºæ„é€ å™¨çš„ prototype çš„ç©ºå¯¹è±¡ target</span><br><span class="line">  const target = Object.create(<span class="keyword">constructor</span>.prototype);</span><br><span class="line">  // å°†æ„é€ å™¨çš„ this æŒ‡å‘ä¸Šä¸€æ­¥åˆ›å»ºçš„ç©ºå¯¹è±¡ï¼Œå¹¶æ‰§è¡Œï¼Œä¸ºäº†ç»™ this æ·»åŠ å®ä¾‹å±æ€§</span><br><span class="line">  const result = <span class="keyword">constructor</span>.apply(target, args);</span><br><span class="line"></span><br><span class="line">  // ä¸Šä¸€æ­¥çš„è¿”å›å¦‚æœæ˜¯å¯¹è±¡å°±ç›´æ¥è¿”å›ï¼Œå¦åˆ™è¿”å› target</span><br><span class="line">  return isObject(result) ? result : target;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç®€å•æµ‹è¯•ä¸€ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Computer</span>(<span class="params">brand</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.brand = brand;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> c = New(Computer, <span class="string">'Apple'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(c); <span class="comment">// =&gt; Computer &#123; brand: 'Apple' &#125;</span></span><br></pre></td></tr></table></figure><h3 id="instanceof-è¿ç®—ç¬¦åŸç†"><a href="#instanceof-è¿ç®—ç¬¦åŸç†" class="headerlink" title="instanceof è¿ç®—ç¬¦åŸç†"></a>instanceof è¿ç®—ç¬¦åŸç†</h3><p>instanceof ç”¨äºåˆ¤æ–­å¯¹è±¡æ˜¯å¦æ˜¯æŸä¸ªç±»çš„å®ä¾‹ï¼Œå¦‚æœ obj instance Aï¼Œæˆ‘ä»¬å°±è¯´ obj æ˜¯ A çš„å®ä¾‹ã€‚</p><p>å®ƒçš„åŸç†å¾ˆç®€å•ï¼Œä¸€å¥è¯æ¦‚æ‹¬å°±æ˜¯ï¼š<strong>obj instanceof æ„é€ å™¨ Aï¼Œç­‰åŒäºåˆ¤æ–­ A çš„ prototype æ˜¯ä¸æ˜¯ obj çš„åŸå‹ï¼ˆä¹Ÿå¯èƒ½æ˜¯äºŒçº§åŸå‹ï¼‰</strong>ã€‚</p><p>ä»£ç å®ç°ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">instanceOf</span>(<span class="params">obj, constructor</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!isObject(<span class="keyword">constructor</span>)) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">`Right-hand side of 'instanceof' is not an object`</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="keyword">constructor</span> !== 'function') &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">`Right-hand side of 'instanceof' is not callable`</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä¸»è¦å°±è¿™ä¸€å¥</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">constructor</span>.prototype.isPrototypeOf(obj);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç®€å•æµ‹è¯•ä¸€ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">A</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="keyword">const</span> a = <span class="keyword">new</span> A();</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(a <span class="keyword">instanceof</span> A); <span class="comment">// =&gt; true</span></span><br><span class="line"><span class="built_in">console</span>.log(instanceOf(a, A)); <span class="comment">// =&gt; true</span></span><br></pre></td></tr></table></figure><h2 id="åŸå‹æ±¡æŸ“"><a href="#åŸå‹æ±¡æŸ“" class="headerlink" title="åŸå‹æ±¡æŸ“"></a>åŸå‹æ±¡æŸ“</h2><p>åœ¨å»å¹´ 2019 å¹´ç§‹å¤©æˆ‘è¿˜åœ¨å›½å†…æŸå¤§å‚å®ä¹ çš„æ—¶å€™ï¼Œlodash çˆ†å‡ºäº†ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼š<span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvdGZacTJQWnlsR2ZNak9wOGg4ZWVUdw==" title="https://mp.weixin.qq.com/s/tfZq2PZylGfMjOp8h8eeTw">Lodash åº“çˆ†å‡ºä¸¥é‡å®‰å…¨æ¼æ´ï¼Œæ³¢åŠ 400 ä¸‡+é¡¹ç›®<i class="fa fa-external-link"></i></span>ã€‚è¿™ä¸ªå®‰å…¨æ¼æ´å°±æ˜¯ç”±äº<strong>åŸå‹æ±¡æŸ“</strong>å¯¼è‡´çš„ã€‚</p><p>åŸå‹æ±¡æŸ“æŒ‡çš„æ˜¯ï¼š</p><blockquote><p>æ”»å‡»è€…é€šè¿‡æŸç§æ‰‹æ®µä¿®æ”¹ JavaScript å¯¹è±¡çš„åŸå‹</p></blockquote><p>è™½ç„¶è¯´ä»»ä½•ä¸€ä¸ªåŸå‹è¢«æ±¡æŸ“äº†éƒ½æœ‰å¯èƒ½å¯¼è‡´é—®é¢˜ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸€èˆ¬æåŸå‹æ±¡æŸ“è¯´çš„å°±æ˜¯ <code>Object.prototype</code> è¢«æ±¡æŸ“ã€‚</p><h3 id="åŸå‹æ±¡æŸ“çš„å±å®³"><a href="#åŸå‹æ±¡æŸ“çš„å±å®³" class="headerlink" title="åŸå‹æ±¡æŸ“çš„å±å®³"></a>åŸå‹æ±¡æŸ“çš„å±å®³</h3><h4 id="æ€§èƒ½é—®é¢˜"><a href="#æ€§èƒ½é—®é¢˜" class="headerlink" title="æ€§èƒ½é—®é¢˜"></a>æ€§èƒ½é—®é¢˜</h4><p>ä¸¾ä¸ªæœ€ç®€å•çš„ä¾‹å­ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Object</span>.prototype.hack = <span class="string">'æ±¡æŸ“åŸå‹çš„å±æ€§'</span>;</span><br><span class="line"><span class="keyword">const</span> obj = &#123; <span class="attr">name</span>: <span class="string">'xiaoHong'</span>, <span class="attr">age</span>: <span class="number">18</span> &#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">  <span class="keyword">if</span> (obj.hasOwnProperty(key)) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(obj[key]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* =&gt;</span></span><br><span class="line"><span class="comment">xiaoHong</span></span><br><span class="line"><span class="comment">18</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p>åŸå‹è¢«æ±¡æŸ“ä¼šå¢åŠ éå†çš„æ¬¡æ•°ï¼Œæ¯æ¬¡è®¿é—®å¯¹è±¡è‡ªèº«ä¸å­˜åœ¨çš„å±æ€§æ—¶ä¹Ÿè¦è®¿é—®ä¸‹åŸå‹ä¸Šè¢«æ±¡æŸ“çš„å±æ€§ã€‚</p><h4 id="å¯¼è‡´æ„å¤–çš„é€»è¾‘-bug"><a href="#å¯¼è‡´æ„å¤–çš„é€»è¾‘-bug" class="headerlink" title="å¯¼è‡´æ„å¤–çš„é€»è¾‘ bug"></a>å¯¼è‡´æ„å¤–çš„é€»è¾‘ bug</h4><p>çœ‹ä¸€ä¸ªå…·ä½“çš„ node å®‰å…¨æ¼æ´æ¡ˆä¾‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="meta">'use strict'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">'body-parser'</span>);</span><br><span class="line"><span class="keyword">const</span> cookieParser = <span class="built_in">require</span>(<span class="string">'cookie-parser'</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> isObject = <span class="function"><span class="params">obj</span> =&gt;</span> obj &amp;&amp; obj.constructor &amp;&amp; obj.constructor === <span class="built_in">Object</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">merge</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> attr <span class="keyword">in</span> b) &#123;</span><br><span class="line">    <span class="keyword">if</span> (isObject(a[attr]) &amp;&amp; isObject(b[attr])) &#123;</span><br><span class="line">      merge(a[attr], b[attr]);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      a[attr] = b[attr];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clone</span>(<span class="params">a</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> merge(&#123;&#125;, a);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Constants</span></span><br><span class="line"><span class="keyword">const</span> PORT = <span class="number">8080</span>;</span><br><span class="line"><span class="keyword">const</span> HOST = <span class="string">'127.0.0.1'</span>;</span><br><span class="line"><span class="keyword">const</span> admin = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// App</span></span><br><span class="line"><span class="keyword">const</span> app = express();</span><br><span class="line">app.use(bodyParser.json());</span><br><span class="line">app.use(cookieParser());</span><br><span class="line"></span><br><span class="line">app.use(<span class="string">'/'</span>, express.static(path.join(__dirname, <span class="string">'views'</span>)));</span><br><span class="line">app.post(<span class="string">'/signup'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">var</span> body = <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(req.body));</span><br><span class="line">  <span class="keyword">var</span> copybody = clone(body);</span><br><span class="line">  <span class="keyword">if</span> (copybody.name) &#123;</span><br><span class="line">    res.cookie(<span class="string">'name'</span>, copybody.name).json(&#123;</span><br><span class="line">      done: <span class="string">'cookie set'</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    res.json(&#123;</span><br><span class="line">      error: <span class="string">'cookie not set'</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line">app.get(<span class="string">'/getFlag'</span>, (req, res) =&gt; &#123;</span><br><span class="line">  <span class="keyword">var</span> Ğ°dmin = <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(req.cookies));</span><br><span class="line">  <span class="keyword">if</span> (admin.Ğ°dmin == <span class="number">1</span>) &#123;</span><br><span class="line">    res.send(<span class="string">'hackim19&#123;&#125;'</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    res.send(<span class="string">'You are not authorized'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line">app.listen(PORT, HOST);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`Running on http://<span class="subst">$&#123;HOST&#125;</span>:<span class="subst">$&#123;PORT&#125;</span>`</span>);</span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç çš„æ¼æ´å°±åœ¨äº merge å‡½æ•°ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·æ”»å‡»ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl -vv --header <span class="string">'Content-type: application/json'</span> -d <span class="string">'&#123;"__proto__": &#123;"admin": 1&#125;&#125;'</span> <span class="string">'http://127.0.0.1:4000/signup'</span>;</span><br><span class="line"></span><br><span class="line">curl -vv <span class="string">'http://127.0.0.1/getFlag'</span></span><br></pre></td></tr></table></figure><p>é¦–å…ˆè¯·æ±‚ <code>/signup</code> æ¥å£ï¼Œåœ¨ NodeJS æœåŠ¡ä¸­ï¼Œæˆ‘ä»¬è°ƒç”¨äº†æœ‰æ¼æ´çš„ <code>merge</code> æ–¹æ³•ï¼Œå¹¶é€šè¿‡ <code>__proto__</code> ä¸º <code>Object.prototype</code>ï¼ˆå› ä¸º <code>{}.__proto__ === Object.prototype</code>ï¼‰ æ·»åŠ ä¸Šä¸€ä¸ªæ–°çš„å±æ€§ <code>admin</code>ï¼Œä¸”å€¼ä¸º 1ã€‚</p><p>å†æ¬¡è¯·æ±‚ <code>getFlag</code> æ¥å£ï¼Œè®¿é—®äº† Object åŸå‹ä¸Šçš„<code>admin</code>ï¼Œæ¡ä»¶è¯­å¥ <code>admin.Ğ°dmin == 1</code> ä¸º <code>true</code>ï¼ŒæœåŠ¡è¢«æ”»å‡»ã€‚</p><h3 id="é¢„é˜²åŸå‹æ±¡æŸ“"><a href="#é¢„é˜²åŸå‹æ±¡æŸ“" class="headerlink" title="é¢„é˜²åŸå‹æ±¡æŸ“"></a>é¢„é˜²åŸå‹æ±¡æŸ“</h3><p>å…¶å®åŸå‹æ±¡æŸ“å¤§å¤šå‘ç”Ÿåœ¨è°ƒç”¨ä¼šä¿®æ”¹æˆ–è€…æ‰©å±•å¯¹è±¡å±æ€§çš„å‡½æ•°æ—¶ï¼Œä¾‹å¦‚ lodash çš„ defaultsï¼Œjquery çš„ extendã€‚é¢„é˜²åŸå‹æ±¡æŸ“æœ€ä¸»è¦è¿˜æ˜¯è¦æœ‰é˜²æ‚£æ„è¯†ï¼Œå…»æˆè‰¯å¥½çš„ç¼–ç ä¹ æƒ¯ã€‚</p><h4 id="Object-create-null"><a href="#Object-create-null" class="headerlink" title="Object.create(null)"></a>Object.create(null)</h4><p>ç¬”è€…çœ‹è¿‡ä¸€äº›ç±»åº“çš„æºç æ—¶ï¼Œç»å¸¸èƒ½çœ‹åˆ°è¿™ç§æ“ä½œï¼Œä¾‹å¦‚ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3ByaW11cy9ldmVudGVtaXR0ZXIzL2Jsb2IvbWFzdGVyL2luZGV4LmpzI0wyMw==" title="https://github.com/primus/eventemitter3/blob/master/index.js#L23">EventEmitter3<i class="fa fa-external-link"></i></span>ã€‚é€šè¿‡ Object.create(null) åˆ›å»ºæ²¡æœ‰åŸå‹çš„å¯¹è±¡ï¼Œå³ä¾¿ä½ å¯¹å®ƒè®¾ç½®<code>__proto__</code> ä¹Ÿæ²¡æœ‰ç”¨ï¼Œå› ä¸ºå®ƒçš„åŸå‹ä¸€å¼€å§‹å°±æ˜¯ nullï¼Œæ²¡æœ‰ <code>__proro__</code> çš„ <code>setter</code>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = <span class="built_in">Object</span>.create(<span class="literal">null</span>);</span><br><span class="line">obj.__proto__ = &#123; <span class="attr">hack</span>: <span class="string">'æ±¡æŸ“åŸå‹çš„å±æ€§'</span> &#125;;</span><br><span class="line"><span class="keyword">const</span> obj1 = &#123;&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(obj1.__proto__); <span class="comment">// =&gt; &#123;&#125;</span></span><br></pre></td></tr></table></figure><h4 id="Object-freeze-obj"><a href="#Object-freeze-obj" class="headerlink" title="Object.freeze(obj)"></a>Object.freeze(obj)</h4><p>å¯ä»¥é€šè¿‡ Object.freeze(obj) å†»ç»“å¯¹è±¡ objï¼Œè¢«å†»ç»“çš„å¯¹è±¡ä¸èƒ½è¢«ä¿®æ”¹å±æ€§ï¼Œæˆä¸ºä¸å¯æ‰©å±•å¯¹è±¡ã€‚å‰é¢ä¹Ÿè¯´è¿‡ä¸èƒ½ä¿®æ”¹ä¸å¯æ‰©å±•å¯¹è±¡çš„åŸå‹ï¼Œä¼šæŠ› TypeErrorï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = <span class="built_in">Object</span>.freeze(&#123; <span class="attr">name</span>: <span class="string">'xiaoHong'</span> &#125;);</span><br><span class="line">obj.xxx = <span class="number">666</span>;</span><br><span class="line"><span class="built_in">console</span>.log(obj); <span class="comment">// =&gt; &#123; name: 'xiaoHong' &#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.isExtensible(obj)); <span class="comment">// =&gt; false</span></span><br><span class="line">obj.__proto__ = <span class="literal">null</span>; <span class="comment">// =&gt; TypeError: #&lt;Object&gt; is not extensible</span></span><br></pre></td></tr></table></figure><p>è·ç¦»æˆ‘ä»ä¹‹å‰å®ä¹ çš„å…¬å¸ç¦»èŒä¹Ÿæœ‰å°†è¿‘ä¸‰ä¸ªæœˆäº†ï¼Œæˆ‘è®°å¾—é‚£æ—¶å€™æ¯æ¬¡ <code>npm install</code> éƒ½æ˜¾ç¤ºæ£€æŸ¥å‡ºå‡ åä¸ªä¾èµ–æ¼æ´ã€‚è‚¯å®šæ˜¯å¥½ä¹…éƒ½æ²¡å‡çº§æ‰ä¼šç§¯ç´¯é‚£ä¹ˆå¤šæ¼æ´ï¼Œåæ­£æˆ‘æ˜¯ä¸æ•¢éšä¾¿å‡çº§ï¼Œä¹‹å‰ä¸€ä¸ª bug æŸ¥äº†å¥½åŠå¤©ç»“æœæ˜¯å› ä¸º axios çš„å‡çº§å¯¼è‡´çš„ã€‚ä¹Ÿä¸çŸ¥é“åˆ°ç°åœ¨æœ‰æ²¡æœ‰å‡çº§è¿‡ ğŸ˜„ã€‚</p><p>å‚è€ƒèµ„æ–™ï¼š</p><ol><li><span class="exturl" data-url="aHR0cHM6Ly9qdWVqaW4uaW0vcG9zdC81ZDI3MTMzMmYyNjVkYTFiOTM0ZTJkNDg=" title="https://juejin.im/post/5d271332f265da1b934e2d48">æœ€æ–°ï¼šLodash ä¸¥é‡å®‰å…¨æ¼æ´èƒŒåä½ ä¸å¾—ä¸çŸ¥é“çš„ JavaScript çŸ¥è¯†<i class="fa fa-external-link"></i></span></li></ol><p>æœ¬æ–‡ä¸ºåŸåˆ›å†…å®¹ï¼Œé¦–å‘äº<span class="exturl" data-url="aHR0cDovL3d3dy5seXJlYWw2NjYuY29t" title="http://www.lyreal666.com">ä¸ªäººåšå®¢<i class="fa fa-external-link"></i></span>ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>prototype</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨ webpack æ„å»º chrome æ‰©å±•çš„çƒ­æ›´æ–°é—®é¢˜</title>
    <url>/%E4%BD%BF%E7%94%A8-webpack-%E6%9E%84%E5%BB%BA-chrome-%E6%89%A9%E5%B1%95%E7%9A%84%E7%83%AD%E6%9B%B4%E6%96%B0%E9%97%AE%E9%A2%98/</url>
    <content><![CDATA[<p>å‰ä¸ä¹…æˆ‘å†™äº†ä¸€ä¸ª chrome æ‰©å±•ï¼Œä½œä¸ºä¸€ä¸ªå‰ç«¯å¼„æ½®å„¿ï¼Œæˆ‘å½“ç„¶æƒ³ç”¨ä¸Šå„ç§å‰ç«¯ç•Œæœ€ fashion çš„å¼€å‘å·¥å…·ã€‚äºæ˜¯ä¹ï¼ŒæŠ˜è…¾åˆ°æœ€åä½¿ç”¨äº† webpack + TypeScript + react è¿™ä¹ˆä¸€å¥—æŠ€æœ¯æ ˆã€‚åœ¨ github ä¸Šç ”ç©¶äº†å‡ ä¸ªæ¨¡æ¿é¡¹ç›®ä¹‹åï¼Œå‘ç°å¤§å¤šæ•°éƒ½å¤ªåˆçº§äº†ï¼ŒåŠŸèƒ½å¤ªç®€å•ï¼Œè€Œä¸”æœ‰ä¸€ä¸ªæˆ‘è§‰åº”å½“æä¾›çš„å¾ˆåŸºç¡€çš„åŠŸèƒ½å§‹ç»ˆæ²¡å‘ç°æœ‰å“ªä¸ªé¡¹ç›®æ”¯æŒï¼Œä¹Ÿå°±æ˜¯å½“ä¿®æ”¹äº† content script ä¹‹åè‡ªåŠ¨ reload æ‰©å±•å’Œåˆ·æ–°æ³¨å…¥äº† content script çš„é¡µé¢è¿™ä¸ªé—®é¢˜ã€‚è¿™ä¸ªé—®é¢˜å¦‚æœè§£å†³äº†ï¼Œä½ å°±ä¸éœ€è¦æ¯æ¬¡ä¿®æ”¹äº†æ‰©å±•ä»£ç è¿˜å» chrome æ‰©å±•åˆ—è¡¨é¡µé¢ç‚¹ä¸‹åˆ·æ–°æŒ‰é’®åˆ·æ–°æ‰©å±•ã€‚æœ€ååœ¨ç ”ç©¶äº† webpack çš„çƒ­æ›´æ–°æœºåˆ¶å’ŒæŸ¥é˜…äº† webpack å’Œ chome æ‰©å±•å®˜æ–¹æ–‡æ¡£ä¹‹åè§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚åœ¨å¼€å‘å®Œæˆ‘é‚£ä¸ªæ‰©å±•ä¹‹åï¼Œæˆ‘ä¾¿å°†å…¶æå–æˆäº†ä¸€ä¸ªæ¨¡æ¿é¡¹ç›® <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RqeDY2Ni9hd2Vzb21lLWNocm9tZS1leHRlbnNpb24tYm9pbGVycGxhdGU=" title="https://github.com/tjx666/awesome-chrome-extension-boilerplate">awesome-chrome-extension-boilerplate<i class="fa fa-external-link"></i></span>ã€‚</p><p>å…¶å®æˆ‘åœ¨ä½¿ç”¨ webpack + TypeScript + react è¿™å¥—æŠ€æœ¯æ ˆå¼€å‘ chrome æ‰©å±•æ—¶ç¢°åˆ°çš„é—®é¢˜çœŸä¸å°‘ï¼Œå¦‚æœå…¨æ‹¿å‡ºæ¥è®²æ²¡ä¸ªä¸¤ä¸‡å­—æˆ‘ä¼°è®¡æ˜¯å†™ä¸å®Œã€‚è¿™ç¯‡æ–‡ç« ä¸»è¦èŠèŠ webpack å¼€å‘ chrome æ‰©å±•çš„çƒ­æ›´æ–°é—®é¢˜ï¼Œå¹¶é‡ç‚¹è®²è§£æˆ‘æ˜¯å¦‚ä½•å®ç°ä¿®æ”¹äº† content script ä¹‹åè‡ªåŠ¨ reload æ‰©å±•å’Œåˆ·æ–°æ³¨å…¥äº† content script çš„é¡µé¢çš„ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘é‚£ä¸ªæ¨¡æ¿çš„æœ€å¤§ç‰¹è‰²ï¼Œä¹Ÿç®—æ˜¯ç»™å®ƒçš„ README åšä¸ªè¡¥å……ã€‚</p><p>åœ¨é˜…è¯»æ–‡ç« ä¹‹å‰ï¼Œå¸Œæœ›è¯»è€…å¯¹ webpack å’Œ chrome æ‰©å±•å¼€å‘æœ‰åŸºæœ¬çš„äº†è§£ã€‚æœ¬æ–‡çš„ä¸»è¦å†…å®¹åˆ†ä¸ºï¼š</p><ol><li>æˆ‘å¯¹ chrome æ‰©å±•çš„ç†è§£</li><li>å„ç§é¡µé¢çš„çƒ­æ›´æ–°é—®é¢˜åˆ†æ</li><li>å¦‚ä½•å®ç°ä¿®æ”¹äº† content script ä¹‹åè‡ªåŠ¨ reload æ‰©å±•å’Œåˆ·æ–°æ³¨å…¥äº† content script çš„é¡µé¢</li></ol><a id="more"></a><h2 id="æˆ‘å¯¹-chrome-æ‰©å±•çš„ç†è§£"><a href="#æˆ‘å¯¹-chrome-æ‰©å±•çš„ç†è§£" class="headerlink" title="æˆ‘å¯¹ chrome æ‰©å±•çš„ç†è§£"></a>æˆ‘å¯¹ chrome æ‰©å±•çš„ç†è§£</h2><blockquote><p>chrome æ‰©å±•å…¶å®æœ¬è´¨å°±æ˜¯ä¸€ä¸ªåŒ…å«äº† manifest.json æ–‡ä»¶çš„æ–‡ä»¶å¤¹ã€‚</p></blockquote><p>å…¶å®å°±åƒ npm åŒ…ä¸€æ ·ï¼ŒåŒ…å« package.json æ–‡ä»¶çš„æ–‡ä»¶å¤¹æˆ‘ä»¬å°±å¯ä»¥å°†å…¶è§†ä¸ºä¸€ä¸ª npm åŒ…ã€‚è¿™æ˜¯ä»é™æ€çš„è§’åº¦ä¹Ÿå°±ä»æ–‡ä»¶çš„è§’åº¦æ¥è¯´çš„ã€‚</p><p>ä»æ‰©å±•è¿è¡Œæ—¶æ¥çœ‹ï¼Œchrome æ‰©å±•æ˜¯ä¸€ä¸ªè¢« chrome ä»¥ <code>chrome://</code> åè®®æ‰˜ç®¡çš„ä¸€ä¸ªé™æ€æœåŠ¡å™¨ã€‚å½“æˆ‘ä»¬è®¿é—®äº† chrome æ‰©å±•ç§çš„å„ç§èµ„æºï¼Œå…¶å®å°±æ˜¯å‘è¿™ä¸ªæœåŠ¡å™¨è¯·æ±‚äº†ä»¥ <code>chrome://</code> åè®®å¤´å¼€å§‹çš„æŸä¸ª URL ã€‚ä¾‹å¦‚è¯·æ±‚ background é¡µé¢å…¶å®å°±æ˜¯è®¿é—®äº†ä¸‹å›¾ä¸­ URL å¯¹åº”çš„ HTML æ–‡ä»¶ï¼š</p><p><img data-src="https://i.loli.net/2020/01/16/yZc17nGaDwLsKqU.png" alt="background"></p><p>æ‰©å±•ä¸­æœ‰å„ç§å„æ ·çš„é¡µé¢ï¼Œæœ€å¸¸è§çš„ä¾‹å¦‚ background é¡µé¢ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢è¿™å¼ å›¾ä¸­çš„é¡µé¢ï¼Œoptions é¡µé¢ä¹Ÿå°±æ˜¯é€‰é¡¹é¡µé¢ï¼Œpopup é¡µé¢ä¹Ÿå°±æ˜¯ç‚¹å‡»å›¾æ ‡åçš„å¼¹çª—é¡µé¢ï¼Œå…¶å®è¿˜æœ‰å¾ˆå¤šå…¶å®ƒçš„å¦‚ä¹¦ç­¾é¡µé¢ï¼Œæµè§ˆå†å²é¡µé¢ï¼Œæ–°æ ‡ç­¾é¡µé¢ç­‰è¿™äº›é¡µé¢æœ¬è´¨ä¸Šå°±æ˜¯ chrome æ‰©å±•ä¸­çš„ä¸€ä¸ª HTML æ–‡ä»¶ï¼Œå½“ç„¶æœ‰äº›é¡µé¢ä½ ä¸æŒ‡å®šä¸€ä¸ªè‡ªå®šä¹‰çš„ HTML æ–‡ä»¶ï¼Œchrome æ‰©å±•ä¼šä¸ºä½ è‡ªåŠ¨ç”Ÿæˆã€‚æ—¢ç„¶å®ƒä»¬éƒ½æ˜¯ç”± HTML æ–‡ä»¶æ¸²æŸ“çš„ï¼Œé‚£æˆ‘ä»¬å…¶å®å¯ä»¥ç›´æ¥ç”¨å¼€å‘ SPA çš„æ–¹å¼æ¥æ¸²æŸ“å®ƒä»¬ã€‚</p><p>SPA ä¹Ÿå°±æ˜¯ Single Page Application å•é¡µé¢åº”ç”¨ï¼Œç°åœ¨çš„å‰ç«¯ä¸‰å¤§æ¡†æ¶å…¶å®éƒ½æ˜¯ä¸»è¦ç”¨äºå¼€å‘ SPAã€‚é€šè¿‡å‰ç«¯è·¯ç”±ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ª HTML æ–‡ä»¶ä¸Šå°±èƒ½åƒ App ä¸€æ ·è®¿é—®ä¸åŒçš„é¡µé¢ï¼Œå€ŸåŠ©äºç»„ä»¶åŒ–å’Œæ¡†æ¶çš„èƒ½åŠ›å®ç°åˆ‡æ¢ä¸åŒçš„é¡µé¢ï¼Œå¹¶ä¸”åªä¼šå±€éƒ¨åˆ·æ–°ï¼Œä¸åƒä»¥å‰ jspï¼Œasp çš„æ—¶å€™åˆ‡ä¸ªé¡µé¢æ•´ä¸ªç½‘é¡µéƒ½åˆ·æ–°ä¸€éï¼Œä»æ€§èƒ½å’Œä½“éªŒä¸Šéƒ½æ˜¯è¿›æ­¥ã€‚è€Œç†Ÿæ‚‰å‰ç«¯è·¯ç”±çš„äººéƒ½çŸ¥é“ï¼Œå‰ç«¯è·¯ç”±ä¹Ÿæœ‰å¥½å¤šç§ï¼Œæœ€å¸¸ç”¨ä¹Ÿå°±æ˜¯ BrowserRouter å’Œ HashRouterã€‚è€Œ BrowserRouter å®ƒæ˜¯éœ€è¦æœåŠ¡å™¨é…åˆçš„ï¼Œå°†æ‰€æœ‰çš„ HTML URL é‡å®šå‘åˆ°ä¸€ä¸ª HTML æ–‡ä»¶ã€‚æˆ‘ä»¬ä½¿ç”¨ webpack å¼€å‘çš„æ—¶å€™è®¿é—®çš„æ˜¯ webpack-dev-serverï¼Œå¦‚æœä½ éœ€è¦ä½¿ç”¨ BrowserRouterï¼Œé‚£ä¹ˆå°±è¦ä¿®æ”¹ webpack é…ç½®ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  devServer: &#123;</span><br><span class="line">    historyApiFallback: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯ï¼Œchrome æ‰©å±•è¿™ä¸ªé™æ€æœåŠ¡å™¨æˆ‘ä»¬æ²¡æ³•ç»™å®ƒè®¾ç½®é‡å®šå‘å•Šï¼Œchrome æœ¬èº«æˆ‘ä»¬æ˜¯æ²¡æ³•ç¼–ç¨‹çš„ã€‚å¥½åœ¨æˆ‘ä»¬è¿˜æœ‰å…¶å®ƒçš„ Router æ–¹æ¡ˆï¼Œä½¿ç”¨ HashRouter å°±åˆšåˆšå¥½ï¼Œæ—¢ä¸ä¼šå› ä¸º URL å¸¦ hash å€¼æ¯”è¾ƒä¸‘ï¼ˆå› ä¸ºçœ‹ä¸åˆ°ï¼‰ï¼Œåˆå®ç°äº†å‰ç«¯è·¯ç”±çš„åŠŸèƒ½ã€‚</p><p>å…·ä½“åœ¨ä½¿ç”¨ webpack å°† backgroundï¼Œoptionsï¼Œpopup é¡µé¢å½“ä½œ SPA å¼€å‘çš„æ—¶å€™è¿˜ä¼šæœ‰ä¸€äº›å°é—®é¢˜ã€‚æˆ‘ä»¬åœ¨ä»¥å¼€å‘è€…æ¨¡å¼åŠ è½½æµ‹è¯•çš„æ‰©å±•æ—¶æ˜¯è¦åŠ è½½ç£ç›˜ä¸Šçš„æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é…ç½® webpack devServer å°† bundle å†™åˆ°ç£ç›˜ä¸Šã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜è¦é…ç½® CORS è·¨åŸŸï¼Œå› ä¸ºæˆ‘ä»¬è®¿é—®çš„ chrome æ‰©å±•é¡µé¢åè®®æ—¶æ˜¯ï¼š <code>chrome://</code> å’Œæˆ‘ä»¬ devServer <code>HTTP</code> åè®®ä¸åŒï¼Œä¼šæœ‰è·¨åŸŸé—®é¢˜ï¼š</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Express &#125; <span class="keyword">from</span> <span class="string">'express'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Compiler &#125; <span class="keyword">from</span> <span class="string">'webpack'</span>;</span><br><span class="line"><span class="keyword">import</span> webpackDevMiddleware <span class="keyword">from</span> <span class="string">'webpack-dev-middleware'</span>;</span><br><span class="line"><span class="keyword">import</span> webpackHotMiddleware <span class="keyword">from</span> <span class="string">'webpack-hot-middleware'</span>;</span><br><span class="line"><span class="keyword">import</span> devConfig <span class="keyword">from</span> <span class="string">'../configs/webpack.dev'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (app: Express, compiler: Compiler): <span class="function"><span class="params">void</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> devMiddlewareOptions: webpackDevMiddleware.Options = &#123;</span><br><span class="line">    publicPath: devConfig!.output!.publicPath!,</span><br><span class="line">    headers: &#123;</span><br><span class="line">      <span class="comment">// é…ç½® cors è·¨åŸŸ</span></span><br><span class="line">      <span class="string">'Access-Control-Allow-Origin'</span>: <span class="string">'*'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    lazy: <span class="literal">false</span>,</span><br><span class="line">    stats: <span class="string">'minimal'</span>,</span><br><span class="line">    <span class="comment">// å°† bundle å†™åˆ°ç£ç›˜è€Œä¸æ˜¯å†…å­˜</span></span><br><span class="line">    writeToDisk: <span class="literal">true</span>,</span><br><span class="line">  &#125;;</span><br><span class="line">  app.use(webpackDevMiddleware(compiler, devMiddlewareOptions));</span><br><span class="line">  app.use(webpackHotMiddleware(compiler, &#123; path: <span class="string">'/__webpack_HMR__'</span> &#125;));</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢æ˜¯æˆ‘æ¨¡æ¿é¡¹ç›®ä¸­ä½¿ç”¨åˆ°çš„ devServer ä¸­é—´ä»¶é…ç½®ï¼Œé…ç½® webpack devServer æˆ‘æ€»ç»“æœ‰å››ç§æ–¹å¼ï¼š</p><ol><li>webpack-dev-server å‘½ä»¤è¡Œå·¥å…·</li><li>webpack-dev-server node API</li><li>express + webpack devServer ä¸­é—´ä»¶</li><li>koa + webpack devServer ä¸­é—´ä»¶</li></ol><p>æˆ‘æœ€ç»ˆé‡‡ç”¨çš„æ˜¯ç¬¬ä¸‰ç§ï¼Œä¸é€‰å‰ä¸¤è€…æ˜¯å› ä¸ºçµæ´»åº¦ä¸å¤Ÿï¼Œå› ä¸ºæˆ‘éœ€è¦é…ç½® content scripts çš„ webpack entry ä¸åŠ è½½ hot reload è„šæœ¬ä»¥åŠä¿®æ”¹é»˜è®¤æ‹‰å–çƒ­æ›´æ–°è¡¥ä¸çš„ pathï¼Œåªæœ‰é€šè¿‡ webpack devServer ä¸­é—´ä»¶æ‰èƒ½é…ç½®ã€‚åˆå› ä¸º koa é…ç½® devServer èµ„æ–™ä¸å¤šï¼Œæ„Ÿè§‰ä¸å¦‚ express æˆç†Ÿç¨³å®šï¼Œæ‰€ä»¥ä¸é€‰æ‹©ç¬¬å››ç§ã€‚è‡³äºä¸ºä»€ä¹ˆéœ€è¦é…ç½® content scripts çš„ webpack entry ä¸åŠ è½½ hot reload è„šæœ¬ä»¥åŠä¿®æ”¹é»˜è®¤æ‹‰å–çƒ­æ›´æ–°è¡¥ä¸çš„ pathï¼Œåé¢ä¼šæåˆ°ã€‚</p><h2 id="å„ç§é¡µé¢çš„çƒ­æ›´æ–°é—®é¢˜åˆ†æ"><a href="#å„ç§é¡µé¢çš„çƒ­æ›´æ–°é—®é¢˜åˆ†æ" class="headerlink" title="å„ç§é¡µé¢çš„çƒ­æ›´æ–°é—®é¢˜åˆ†æ"></a>å„ç§é¡µé¢çš„çƒ­æ›´æ–°é—®é¢˜åˆ†æ</h2><p>æˆ‘ä»¬ä»<code>écontent scripts</code> å’Œ <code>content scripts</code> è¿™ä¸¤ç±»è„šæœ¬æ¥è®¨è®ºã€‚</p><h3 id="é-content-scripts-çš„çƒ­æ›´æ–°é—®é¢˜"><a href="#é-content-scripts-çš„çƒ­æ›´æ–°é—®é¢˜" class="headerlink" title="é content scripts çš„çƒ­æ›´æ–°é—®é¢˜"></a>é content scripts çš„çƒ­æ›´æ–°é—®é¢˜</h3><p>å‰é¢ä¸€éƒ¨åˆ†å†…å®¹æˆ‘å°±è®²äº†ï¼Œbacngound, options, popup ç­‰é¡µé¢å…¶å®æˆ‘ä»¬å¯ä»¥ç›´æ¥å½“ä½œæ™®é€šçš„ SPA é¡µé¢æ¥å¼€å‘ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥ç›´æ¥ä½¿ç”¨ webpack devServer è‡ªèº«æä¾›çš„çƒ­æ›´æ–°èƒ½åŠ›ã€‚å› æ­¤æˆ‘ä»¬è¿˜å¯ä»¥é…ç½® react çš„ hot reload ç­‰ã€‚ä»é…ç½® webpack çš„è§’åº¦æ¥è¯´ï¼Œç›¸å¯¹ä¸æ™®é€šçš„å‰ç«¯é¡¹ç›®çš„åŒºåˆ«å°±æ˜¯é…ç½®å¤šå…¥å£ï¼Œè·¨åŸŸï¼ŒdevServer bundle å†™åˆ°ç£ç›˜ç­‰ï¼Œæœ‰ä¸€å®šçš„å¤æ‚åº¦ã€‚ä¸å–œæ¬¢æŠ˜è…¾çš„å¯ä»¥è€ƒè™‘ç›´æ¥ç”¨æˆ‘é‚£ä¸ªæ¨¡æ¿ï¼Œè€Œä¸”æˆ‘é‚£ä¸ªæ¨¡æ¿é¡¹ç›®è¿˜åšäº†å„æ–¹é¢çš„ä¼˜åŒ–ã€‚</p><p>å‰é¢æåˆ°éœ€è¦ä¿®æ”¹é»˜è®¤æ‹‰å–çƒ­æ›´æ–°è¡¥ä¸çš„ pathï¼Œè¿™æ˜¯å› ä¸ºï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œåœ¨å‘ webpack devServer æ‹‰å–çƒ­æ›´æ–°è¡¥ä¸çš„ path æ˜¯ <code>/__webpack_hmr</code>ã€‚</p><p><img data-src="https://i.loli.net/2020/01/16/TCtFHdwlDZ8Uz46.png" alt="webpack-hot-middleware.png"></p><p>å¦‚æœä½ ä¸è®¾ç½® path ä¸ºä½ çš„ devServser åœ°å€å°±ä¼šå‡ºç°ä¸‹é¢çš„é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯ç›´æ¥å‘ chrome æ‰©å±•è¯·æ±‚çƒ­æ›´æ–°æ•°æ®äº†ï¼š</p><p><img data-src="https://i.loli.net/2020/01/16/MnwvBASWHskTY76.png" alt="webpack-hmr.png"></p><p>æ‰€ä»¥è¿˜æ˜¯è¦ä½¿ç”¨ node API é…ç½® devServer çš„ <code>webpack-hot-middleware</code> ä¸­é—´ä»¶æ‰è¡Œï¼š</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// éƒ¨åˆ† webpack entry é…ç½®</span></span><br><span class="line"><span class="keyword">import</span> &#123; resolve &#125; <span class="keyword">from</span> <span class="string">'path'</span>;</span><br><span class="line"><span class="keyword">import</span> serverConfig <span class="keyword">from</span> <span class="string">'../configs/server.config'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; isProd &#125; <span class="keyword">from</span> <span class="string">'./env'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> src = resolve(__dirname, <span class="string">'../../src'</span>);</span><br><span class="line"><span class="keyword">const</span> HMRSSEPath = <span class="built_in">encodeURIComponent</span>(<span class="string">`http://<span class="subst">$&#123;serverConfig.HOST&#125;</span>:<span class="subst">$&#123;serverConfig.PORT&#125;</span>/__webpack_HMR__`</span>);</span><br><span class="line"><span class="comment">// æŒ‡å®š path ä¸ºæˆ‘ä»¬çš„ devServer çš„åœ°å€</span></span><br><span class="line"><span class="keyword">const</span> HMRClientScript = <span class="string">`webpack-hot-middleware/client?path=<span class="subst">$&#123;HMRSSEPath&#125;</span>&amp;reload=true`</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> devEntry: Record&lt;<span class="built_in">string</span>, <span class="built_in">string</span>[]&gt; = &#123;</span><br><span class="line">  background: [HMRClientScript, resolve(src, <span class="string">'./background/index.ts'</span>)],</span><br><span class="line">  options: [HMRClientScript, <span class="string">'react-hot-loader/patch'</span>, resolve(src, <span class="string">'./options/index.tsx'</span>)],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="content-scripts-çš„çƒ­æ›´æ–°é—®é¢˜"><a href="#content-scripts-çš„çƒ­æ›´æ–°é—®é¢˜" class="headerlink" title="content scripts çš„çƒ­æ›´æ–°é—®é¢˜"></a>content scripts çš„çƒ­æ›´æ–°é—®é¢˜</h3><p>é¦–å…ˆæˆ‘ä¸‹ä¸ªç»“è®ºï¼š<strong>ä½¿ç”¨ webpack devServer è‡ªå¸¦çš„çƒ­æ›´æ–°æœºåˆ¶æ˜¯ä¸å¯èƒ½å¯¹ content scripts èµ·ä½œç”¨çš„ã€‚</strong></p><p>æ ¹æœ¬åŸå› æ˜¯å› ä¸ºï¼šç”±äº chrome é™åˆ¶äº† content script å†…æ— æ³•è®¿é—®å…¶å®ƒ content scriptï¼Œinject scriptï¼Œä»¥åŠç½‘é¡µæœ¬èº«çš„ js è„šæœ¬å†…çš„å˜é‡ã€‚åˆå› ä¸º webpack devServer çƒ­æ›´æ–°æ˜¯ä»¥ jsonp çš„æ–¹å¼æ¥æ‹‰å–æ›´æ–°è¡¥ä¸çš„ï¼Œæ³¨å…¥ç½‘é¡µçš„ content scrpit ä¸­åŒ…å«çš„å®ç°çƒ­æ›´æ–°æœºåˆ¶çš„ä»£ç ä¼šè°ƒç”¨ jsonp æ’å…¥é¡µé¢çš„çƒ­æ›´æ–°è¡¥ä¸ä¸­çš„æ›´æ–°å‡½æ•°ï¼Œä½†æ˜¯ç”±äº chrome é™åˆ¶ï¼Œæ— æ³•è°ƒç”¨ï¼Œä¹Ÿå°±æ— æ³•åº”ç”¨çƒ­æ›´æ–°è¡¥ä¸ã€‚</p><p>æŸ¥çœ‹ wbpack æºç ï¼Œå¯ä»¥çœ‹åˆ° webpack devServer ç”¨çš„å°±æ˜¯ jsonp è¿›è¡Œçƒ­æ›´æ–°çš„ï¼š</p><p><img data-src="https://i.loli.net/2020/01/16/argztvoCY7bBTNh.png" alt="webpack-json.png"></p><h2 id="å¦‚ä½•å®ç°ä¿®æ”¹äº†-content-script-ä¹‹åè‡ªåŠ¨-reload-æ‰©å±•å’Œåˆ·æ–°æ³¨å…¥äº†-content-script-çš„é¡µé¢"><a href="#å¦‚ä½•å®ç°ä¿®æ”¹äº†-content-script-ä¹‹åè‡ªåŠ¨-reload-æ‰©å±•å’Œåˆ·æ–°æ³¨å…¥äº†-content-script-çš„é¡µé¢" class="headerlink" title="å¦‚ä½•å®ç°ä¿®æ”¹äº† content script ä¹‹åè‡ªåŠ¨ reload æ‰©å±•å’Œåˆ·æ–°æ³¨å…¥äº† content script çš„é¡µé¢"></a>å¦‚ä½•å®ç°ä¿®æ”¹äº† content script ä¹‹åè‡ªåŠ¨ reload æ‰©å±•å’Œåˆ·æ–°æ³¨å…¥äº† content script çš„é¡µé¢</h2><p>è¿™æ˜¯æœ¬æ–‡çš„é‡ç‚¹ï¼Œå…¶å®æ€è·¯è¿˜æ˜¯å¾ˆæ¸…æ™°çš„ï¼š</p><ol><li>ç›‘å¬ webpack ä¿®æ”¹ content script äº‹ä»¶</li><li>devServer é€šè¿‡ SSE ä¸»åŠ¨æ¨é€äº‹ä»¶ç»™ background</li><li>background ç›‘å¬æ¨é€äº‹ä»¶</li><li>è°ƒç”¨æ‰©å±• API reload æ‰©å±•ï¼Œå¹¶å‘é€æ¶ˆæ¯ç»™æ‰€æœ‰æ³¨å…¥äº† content script çš„é¡µé¢è®©å®ƒä»¬åˆ·æ–°é¡µé¢</li></ol><p>ä¸‹é¢æˆ‘ä»¬æ¥ä¸€æ­¥ä¸€æ­¥å®ç°;</p><h3 id="ç›‘å¬-webpack-ä¿®æ”¹-content-script-äº‹ä»¶"><a href="#ç›‘å¬-webpack-ä¿®æ”¹-content-script-äº‹ä»¶" class="headerlink" title="ç›‘å¬ webpack ä¿®æ”¹ content script äº‹ä»¶"></a>ç›‘å¬ webpack ä¿®æ”¹ content script äº‹ä»¶</h3><p>æŸ¥é˜… webpack å®˜æ–¹æ–‡æ¡£å‘ç°åœ¨ä½¿ç”¨ node API çš„æ—¶å€™å¯ä»¥é€šè¿‡ compiler.hooks.done è¿™ä¸ªé’©å­åœ¨ webpack æ¯æ¬¡ç¼–è¯‘ç»“æŸæ—¶æ‰§è¡Œä¸€äº›æ“ä½œã€‚æœ¬è´¨ä¸Š webpack æ’ä»¶ä¹Ÿæ˜¯é€šè¿‡ç»™ webpack å„ç§äº‹ä»¶æŒ‚é’©å­æ¥å®ç°å„ç§åŠŸèƒ½ã€‚</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// plugin åŒ…å«æˆ‘ä»¬çš„å¤„ç†ç¼–è¯‘å®Œæˆè¿™ä¸€äº‹ä»¶çš„é€»è¾‘</span></span><br><span class="line">compiler.hooks.done.tap(<span class="string">'extension-auto-reload-plugin'</span>, plugin);</span><br></pre></td></tr></table></figure><p>ç›‘å¬åˆ°ç¼–è¯‘æˆåŠŸè¿˜ä¸å¤Ÿï¼Œæˆ‘ä»¬è¿˜éœ€è¦åˆ¤æ–­æ˜¯å¦ç¼–è¯‘æˆåŠŸï¼Œä»¥åŠé€šè¿‡æ­¤æ¬¡ç¼–è¯‘çš„ç»Ÿè®¡ä¿¡æ¯ stats æ‹¿åˆ°æ­¤æ¬¡ç¼–è¯‘æ¶‰åŠåˆ°çš„ chunks æ¥åˆ¤æ–­æ˜¯å¦ä¿®æ”¹äº† content scripts çš„ chunksï¼š</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> contentScriptsChunks = fs.readdirSync(resolve(__dirname, <span class="string">'../../src/contents'</span>));</span><br><span class="line"><span class="keyword">const</span> plugin = <span class="function">(<span class="params">stats: Stats</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; modules &#125; = stats.toJson(&#123; all: <span class="literal">false</span>, modules: <span class="literal">true</span> &#125;);</span><br><span class="line">  <span class="keyword">const</span> shouldReload =</span><br><span class="line">    !stats.hasErrors() &amp;&amp;</span><br><span class="line">    modules &amp;&amp;</span><br><span class="line">    modules.length === <span class="number">1</span> &amp;&amp;</span><br><span class="line">    contentScriptsChunks.includes(modules[<span class="number">0</span>].chunks[<span class="number">0</span>] <span class="keyword">as</span> <span class="built_in">string</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (shouldReload) &#123;</span><br><span class="line">    <span class="comment">// å‘é€æ¶ˆæ¯ç»™ background</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="devServer-é€šè¿‡-SSE-ä¸»åŠ¨æ¨é€äº‹ä»¶ç»™-background"><a href="#devServer-é€šè¿‡-SSE-ä¸»åŠ¨æ¨é€äº‹ä»¶ç»™-background" class="headerlink" title="devServer é€šè¿‡ SSE ä¸»åŠ¨æ¨é€äº‹ä»¶ç»™ background"></a>devServer é€šè¿‡ SSE ä¸»åŠ¨æ¨é€äº‹ä»¶ç»™ background</h3><p>æœåŠ¡å™¨ç«¯å®æ—¶ä¸»åŠ¨æ¨é€ç°åœ¨æœ€å¸¸ç”¨åº”è¯¥æ˜¯ WebSocket åè®®äº†ã€‚ä¸è¿‡æ—¢ç„¶æˆ‘ä»¬å·²ç»æœ‰äº†ä¸€ä¸ª express æœåŠ¡å™¨ï¼Œå°±æ²¡å¿…è¦å†å¯åŠ¨ä¸€ä¸ª WebSocket æœåŠ¡å™¨ï¼Œåˆ©ç”¨ SSEï¼ˆServer Side Event) çš„è¯åªéœ€è¦ç»™ express åŠ ä¸ªè·¯ç”±å³å¯ã€‚æ•´åˆä¸Šä¸€èŠ‚å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°ä¸€ä¸ª express ä¸­é—´ä»¶åœ¨ç›‘å¬åˆ°ä¿®æ”¹äº† content script æ—¶æ¨é€ <code>compiled-successfully</code> äº‹ä»¶ç»™ backgroundï¼š</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> fs <span class="keyword">from</span> <span class="string">'fs'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; resolve &#125; <span class="keyword">from</span> <span class="string">'path'</span>;</span><br><span class="line"><span class="keyword">import</span> chalk <span class="keyword">from</span> <span class="string">'chalk'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; debounce &#125; <span class="keyword">from</span> <span class="string">'lodash'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; RequestHandler &#125; <span class="keyword">from</span> <span class="string">'express'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Compiler, Stats &#125; <span class="keyword">from</span> <span class="string">'webpack'</span>;</span><br><span class="line"><span class="keyword">import</span> SSEStream <span class="keyword">from</span> <span class="string">'ssestream'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span>(<span class="params">compiler: Compiler</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> extAutoReload: RequestHandler = <span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(chalk.yellow(<span class="string">'Received a SSE client connection!'</span>));</span><br><span class="line"></span><br><span class="line">    res.header(<span class="string">'Access-Control-Allow-Origin'</span>, <span class="string">'*'</span>);</span><br><span class="line">    <span class="keyword">const</span> sseStream = <span class="keyword">new</span> SSEStream(req);</span><br><span class="line">    sseStream.pipe(res);</span><br><span class="line">    <span class="keyword">let</span> closed = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> contentScriptsModules = fs.readdirSync(resolve(__dirname, <span class="string">'../../src/contents'</span>));</span><br><span class="line">    <span class="keyword">const</span> compileDoneHook = debounce(<span class="function">(<span class="params">stats: Stats</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> &#123; modules &#125; = stats.toJson(&#123; all: <span class="literal">false</span>, modules: <span class="literal">true</span> &#125;);</span><br><span class="line">      <span class="keyword">const</span> shouldReload =</span><br><span class="line">        !stats.hasErrors() &amp;&amp;</span><br><span class="line">        modules &amp;&amp;</span><br><span class="line">        modules.length === <span class="number">1</span> &amp;&amp;</span><br><span class="line">        contentScriptsModules.includes(modules[<span class="number">0</span>].chunks[<span class="number">0</span>] <span class="keyword">as</span> <span class="built_in">string</span>);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (shouldReload) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(chalk.yellow(<span class="string">'Send extension reload signal!'</span>));</span><br><span class="line"></span><br><span class="line">        sseStream.write(</span><br><span class="line">          &#123;</span><br><span class="line">            event: <span class="string">'compiled-successfully'</span>,</span><br><span class="line">            data: &#123;</span><br><span class="line">              action: <span class="string">'reload-extension-and-refresh-current-page'</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="string">'UTF-8'</span>,</span><br><span class="line">          error =&gt; &#123;</span><br><span class="line">            <span class="keyword">if</span> (error) &#123;</span><br><span class="line">              <span class="built_in">console</span>.error(error);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        );</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ–­å¼€é“¾æ¥åä¹‹å‰çš„ hook å°±ä¸è¦æ‰§è¡Œäº†</span></span><br><span class="line">    <span class="keyword">const</span> plugin = <span class="function">(<span class="params">stats: Stats</span>) =&gt;</span> !closed &amp;&amp; compileDoneHook(stats);</span><br><span class="line">    compiler.hooks.done.tap(<span class="string">'extension-auto-reload-plugin'</span>, plugin);</span><br><span class="line"></span><br><span class="line">    res.on(<span class="string">'close'</span>, <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      closed = <span class="literal">true</span>;</span><br><span class="line">      <span class="built_in">console</span>.log(chalk.yellow(<span class="string">'SSE connection closed!'</span>));</span><br><span class="line">      sseStream.unpipe(res);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    next();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> extAutoReload;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="background-ç›‘å¬æ¨é€äº‹ä»¶"><a href="#background-ç›‘å¬æ¨é€äº‹ä»¶" class="headerlink" title="background ç›‘å¬æ¨é€äº‹ä»¶"></a>background ç›‘å¬æ¨é€äº‹ä»¶</h4><p>ç›‘å¬ devServer æ¨é€çš„ <code>compiled-successfully</code> äº‹ä»¶å¾ˆç®€å•ï¼Œä½¿ç”¨ SSE å®¢æˆ·ç«¯å¯¹ express æœåŠ¡å™¨ä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„ devServer ä¸ŠæŒ‡å®šçš„ SSE è·¯ç”±å»ºç«‹ SSE é“¾æ¥å³å¯ï¼š</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> source = <span class="keyword">new</span> EventSource(<span class="string">'http://127.0.0.1:3000/__extension_auto_reload__'</span>);</span><br><span class="line"></span><br><span class="line">source.addEventListener(<span class="string">'compiled-successfully'</span>, <span class="function">(<span class="params">event: EventSourceEvent</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> shouldReload = <span class="built_in">JSON</span>.parse(event.data).action === <span class="string">'reload-extension-and-refresh-current-page'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (shouldReload) &#123;</span><br><span class="line">    	<span class="comment">// åˆ·æ–°æ‰©å±•ç­‰åç»­æ­¥éª¤</span></span><br><span class="line">    &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h4 id="è°ƒç”¨æ‰©å±•-API-reload-æ‰©å±•ï¼Œå¹¶å‘é€æ¶ˆæ¯ç»™æ‰€æœ‰æ³¨å…¥äº†-content-script-çš„é¡µé¢è®©å®ƒä»¬åˆ·æ–°é¡µé¢"><a href="#è°ƒç”¨æ‰©å±•-API-reload-æ‰©å±•ï¼Œå¹¶å‘é€æ¶ˆæ¯ç»™æ‰€æœ‰æ³¨å…¥äº†-content-script-çš„é¡µé¢è®©å®ƒä»¬åˆ·æ–°é¡µé¢" class="headerlink" title="è°ƒç”¨æ‰©å±• API reload æ‰©å±•ï¼Œå¹¶å‘é€æ¶ˆæ¯ç»™æ‰€æœ‰æ³¨å…¥äº† content script çš„é¡µé¢è®©å®ƒä»¬åˆ·æ–°é¡µé¢"></a>è°ƒç”¨æ‰©å±• API reload æ‰©å±•ï¼Œå¹¶å‘é€æ¶ˆæ¯ç»™æ‰€æœ‰æ³¨å…¥äº† content script çš„é¡µé¢è®©å®ƒä»¬åˆ·æ–°é¡µé¢</h4><p>æŸ¥é˜… chrome extension å®˜æ–¹æ–‡æ¡£ï¼Œå‘ç°å®˜æ–¹æä¾›äº†ä¸€ä¸ª <span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIuY2hyb21lLmNvbS9leHRlbnNpb25zL3J1bnRpbWUjbWV0aG9kLXJlbG9hZA==" title="https://developer.chrome.com/extensions/runtime#method-reload">reload API<i class="fa fa-external-link"></i></span> å¯ä»¥åœ¨æ‰©å±•ä¸­ç›´æ¥è®©æ‰©å±•é‡è½½ã€‚åœ¨ background çš„ webpack entry æ•°ç»„æ·»åŠ  autoReloadPatch.ts ï¼š</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (!isProd) &#123;</span><br><span class="line">  entry.background.unshift(resolve(__dirname, <span class="string">'./autoReloadPatch.ts'</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>autoReloadPatch.ts è¿™ä¸ªè„šæœ¬åœ¨ç›‘å¬åˆ°æœåŠ¡å™¨æ¨é€çš„æŒ‡å®šæ¶ˆæ¯æ—¶ä¼šå…ˆå‘é€åˆ·æ–°é¡µé¢çš„æ¶ˆæ¯ç»™æ‰€æœ‰ tab é¡µé¢ï¼Œåœ¨æ¥æ”¶åˆ°ä»»æ„ä¸€ä¸ªæ¥è‡ª content script çš„å“åº”åå† reload æ‰©å±•ï¼ˆå¦‚æœæˆ‘ä»¬çš„æ‰©å±•éƒ½æ²¡æœ‰ content script å°±æ²¡å¿…è¦åˆ·æ–°äº†ï¼‰ã€‚</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> tiza <span class="keyword">from</span> <span class="string">'tiza'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> source = <span class="keyword">new</span> EventSource(<span class="string">'http://127.0.0.1:3000/__extension_auto_reload__'</span>);</span><br><span class="line"></span><br><span class="line">source.addEventListener(</span><br><span class="line">  <span class="string">'compiled-successfully'</span>,</span><br><span class="line">  (event: EventSourceEvent) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> shouldReload = <span class="built_in">JSON</span>.parse(event.data).action === <span class="string">'reload-extension-and-refresh-current-page'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (shouldReload) &#123;</span><br><span class="line">      tiza</span><br><span class="line">        .color(<span class="string">'green'</span>)</span><br><span class="line">        .bold()</span><br><span class="line">        .text(<span class="string">`Receive the signal to reload chrome extension as modify the content script!`</span>)</span><br><span class="line">        .info();</span><br><span class="line">      chrome.tabs.query(&#123;&#125;, <span class="function"><span class="params">tabs</span> =&gt;</span> &#123;</span><br><span class="line">        tabs.forEach(<span class="function"><span class="params">tab</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (tab.id) &#123;</span><br><span class="line">            <span class="keyword">let</span> received = <span class="literal">false</span>;</span><br><span class="line">            chrome.tabs.sendMessage(</span><br><span class="line">              tab.id,</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="keyword">from</span>: <span class="string">'background'</span>,</span><br><span class="line">                action: <span class="string">'refresh-current-page'</span>,</span><br><span class="line">              &#125;,</span><br><span class="line">              (&#123; <span class="keyword">from</span>, action &#125;) =&gt; &#123;</span><br><span class="line">                <span class="keyword">if</span> (!received &amp;&amp; <span class="keyword">from</span> === <span class="string">'content script'</span> &amp;&amp; action === <span class="string">'reload extension'</span>) &#123;</span><br><span class="line">                  source.close();</span><br><span class="line">                  tiza</span><br><span class="line">                    .color(<span class="string">'green'</span>)</span><br><span class="line">                    .bold()</span><br><span class="line">                    .text(<span class="string">`Reload extension`</span>)</span><br><span class="line">                    .info();</span><br><span class="line">                  chrome.runtime.reload();</span><br><span class="line">                  received = <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            );</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="literal">false</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç ä¼šå‘é€åˆ·æ–°é¡µé¢çš„æ¶ˆæ¯ç»™æ‰€æœ‰é¡µé¢ï¼Œä¸ºäº†å®ç°è‡ªåŠ¨åˆ·æ–°é¡µé¢ï¼Œæˆ‘ä»¬å¿…é¡»æƒ³åŠæ³•æ³¨å…¥ä¸€æ®µç›‘å¬åˆ·æ–°é¡µé¢çš„ä»£ç åˆ°æ‰€æœ‰æ³¨å…¥äº† content script çš„é¡µé¢ã€‚æˆ‘é‡‡å–çš„åšæ³•æ˜¯ï¼šé»˜è®¤æ·»åŠ ä¸€ä¸ª content script ä¹Ÿå°±æ˜¯ all.tsï¼Œè¿™ä¸ª all.ts çš„ä»£ç å¿…é¡»æ³¨å…¥åˆ°æ‰€æœ‰çš„å…¶ä»– content script æ³¨å…¥åˆ°çš„é¡µé¢ã€‚æ‰€ä»¥éœ€è¦æˆ‘ä»¬åœ¨é…ç½® manifest.json çš„æ—¶å€™æ³¨æ„ä¸€ä¸‹ï¼Œå°† all.ts çš„ matches è®¾ç½®ä¸ºå…¶å®ƒæ‰€æœ‰ content scripts çš„ matches çš„çˆ¶é›†ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line"> "content_scripts": [</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">"matches"</span>: [<span class="string">"https://github.com/*"</span>],</span><br><span class="line">        <span class="attr">"css"</span>: [<span class="string">"css/all.css"</span>],</span><br><span class="line">        <span class="attr">"js"</span>: [<span class="string">"js/all.js"</span>]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">"matches"</span>: [<span class="string">"https://github.com/pulls"</span>],</span><br><span class="line">        <span class="attr">"css"</span>: [<span class="string">"css/pulls.css"</span>],</span><br><span class="line">        <span class="attr">"js"</span>: [<span class="string">"js/pulls.js"</span>]</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>all.ts ä¸­çš„ä»£ç å¾ˆç®€å•ï¼Œå°±æ˜¯ç›‘å¬ background å‘é€çš„åˆ·æ–°é¡µé¢çš„æ¶ˆæ¯åˆ·æ–°å½“å‰é¡µé¢ï¼š</p><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> tiza <span class="keyword">from</span> <span class="string">'tiza'</span>;</span><br><span class="line"></span><br><span class="line">chrome.runtime.onMessage.addListener(<span class="function">(<span class="params">request, sender, sendResp</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> shouldRefresh = request.from === <span class="string">'background'</span> &amp;&amp; request.action === <span class="string">'refresh-current-page'</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (shouldRefresh) &#123;</span><br><span class="line">    tiza</span><br><span class="line">      .color(<span class="string">'green'</span>)</span><br><span class="line">      .bold()</span><br><span class="line">      .text(<span class="string">'Receive signal to refresh current page as modify the content script!'</span>)</span><br><span class="line">      .info();</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">window</span>.location.reload();</span><br><span class="line">    &#125;, <span class="number">500</span>);</span><br><span class="line">    sendResp(&#123;</span><br><span class="line">      <span class="keyword">from</span>: <span class="string">'content script'</span>,</span><br><span class="line">      action: <span class="string">'reload extension'</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>æˆ‘æœ¬äººå¹³æ—¶å¾ˆå–œæ¬¢æ”¶é›†å„ç§å®ç”¨çš„æ‰©å±•ï¼Œä¹Ÿçœ‹è¿‡ä¸å°‘æ‰©å±•çš„æºç ã€‚å‘ç°å…¶å®å®ƒä»¬å¤§å¤šæ˜¯è¿˜æ˜¯ä½¿ç”¨æœ€åŸå§‹çš„å¼€å‘æ–¹å¼ã€‚æ²¡æœ‰æ¨¡å—åŒ–ï¼Œå¾ˆå®¹æ˜“å¯¼è‡´åæœŸç»´æŠ¤æ€§éå¸¸å·®ï¼Œè€Œä¸”è¿˜ä¸èƒ½æ–¹ä¾¿å¾—è°ƒç”¨ npm åŒ…ã€‚äººç”Ÿè‹¦çŸ­ï¼Œç›´æ¥ç”¨è½®å­ä¸å¥½å—ï¼Ÿå½“ç„¶å…¶å®æˆ‘æ˜¯çŸ¥é“æœ‰ä¸€äº›å·¥å…·ä¾‹å¦‚ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3hwbC9jcngtaG90cmVsb2Fk" title="https://github.com/xpl/crx-hotreload">crx-hotreload<i class="fa fa-external-link"></i></span> å¯ä»¥å®ç°è‡ªåŠ¨åˆ·æ–°æ‰©å±•ï¼Œä¸è¿‡ç›¸æ¯”äºæˆ‘çš„æ¨¡æ¿æ¥è¯´åŠŸèƒ½ä¸Šå¤ªç®€é™‹äº†ã€‚</p><p>å®é™…ä¸Šä½¿ç”¨ webpack + react + TypeScript å¼€å‘ chrome æ‰©å±•ï¼Œä½ å¯èƒ½è¿˜ä¼šé‡åˆ°å„ç§é—®é¢˜ã€‚è¿™ä¸ªæ—¶å€™ä¸å¦¨æ‰“å¼€æˆ‘çš„è¿™ä¸ª<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RqeDY2Ni9hd2Vzb21lLWNocm9tZS1leHRlbnNpb24tYm9pbGVycGxhdGU=" title="https://github.com/tjx666/awesome-chrome-extension-boilerplate">æ¨¡æ¿é¡¹ç›®<i class="fa fa-external-link"></i></span>ï¼Œå»çœ‹çœ‹æˆ‘æ˜¯æ€ä¹ˆé…ç½®é¡¹ç›®å»è§£å†³è¿™äº›é—®é¢˜çš„ã€‚å…¶å®æˆ‘å­¦ä¹ ç¼–ç¨‹ä»æ¥å°±æ²¡äººå¸¦è¿‡ï¼Œéƒ½æ˜¯é è‡ªå·±æ…¢æ…¢æ‘¸ç´¢ã€‚æˆ‘ç¢°åˆ°é—®é¢˜ä¹Ÿç»å¸¸å» github å»æœç´¢æŠ€æœ¯æ ˆç±»ä¼¼çš„é¡¹ç›®ï¼Œç›´æ¥åˆ†ææºç æ¥æ‰¾åˆ°è§£å†³åŠæ³•ã€‚æˆ–è€…ä½ ä¹Ÿå¯ä»¥åœ¨è¯„è®ºåŒºæé—®ï¼Œä¸€èˆ¬æ¥è¯´æˆ‘éƒ½ä¼šç§¯æå›å¤ã€‚å¦‚æœæœ¬æ–‡å†…å®¹å¯¹ä½ æœ‰æ‰€å¸®åŠ©æˆ–è€…è§‰å¾—è¿™ä¸ªæ¨¡æ¿é¡¹ç›®å¯èƒ½ç”¨å¾—ä¸Šï¼Œè¯·ä¸è¦åå•¬ä½ çš„ star ğŸ˜‚ã€‚</p><p>æœ€åï¼Œå¿«è¿‡å¹´äº†ï¼Œç¥å¤§å®¶æ–°å¹´å¿«ä¹ï¼Œ2020 äº‹ä¸šæ›´ä¸Šä¸€å±‚æ¥¼ã€‚</p><p>æœ¬æ–‡ä¸ºåŸåˆ›å†…å®¹ï¼Œé¦–å‘äº<a href="https://lyreal666.com/">ä¸ªäººåšå®¢</a>ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>typescript</tag>
        <tag>webpack</tag>
        <tag>express</tag>
        <tag>chrome extension</tag>
      </tags>
  </entry>
  <entry>
    <title>å…¨é¢æ€»ç»“ JavaScript ç±»å‹ç›¸å…³çŸ¥è¯†ç‚¹</title>
    <url>/%E5%85%A8%E9%9D%A2%E6%80%BB%E7%BB%93-JavaScript-%E7%B1%BB%E5%9E%8B%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E7%82%B9/</url>
    <content><![CDATA[<p>ç›¸ä¿¡åˆ°äº†å¹´åº•ï¼Œä¸å°‘å‰ç«¯éƒ½å‡†å¤‡æ‰¾å·¥ä½œè·³æ§½äº†ã€‚è€Œä½œä¸ºæ˜¥æ‹›å¤§å†›çš„ä¸€å‘˜ï¼Œä¼°è®¡å¾ˆå¤šå‡†å¤‡æ˜¥æ‹›çš„åº”å±Šç”Ÿå’Œæˆ‘ä¸€æ ·è¿™ä¸ªå¹´è¿‡å¾—å¾ˆç„¦è™‘ã€‚JavaScript ç±»å‹æ˜¯å‰ç«¯é¢è¯•ä¸­è€ƒå¯Ÿ JavaScript åŸºç¡€çš„å¸¸è€ƒçŸ¥è¯†ç‚¹ï¼Œç»å¸¸æ€§ç¬¬ä¸€ä¸ªé—®é¢˜å°±æ˜¯ JavaScript ä¸­æœ‰å“ªäº›ç±»å‹ã€‚</p><p>ç¬”è€…ä»Šå¹´ä»æ˜¥æ‹›å®ä¹ åˆ°ç§‹æ‹›ç»å†äº†æŒºå¤šçš„é¢è¯•ï¼Œä¹Ÿæ€»ç»“äº†ä¸€äº›è§„å¾‹ï¼šä¸€èˆ¬æ¥è®²ç¬¬ä¸€è½®é¢è¯•å¾€å¾€å°±æ˜¯è€ƒå¯ŸåŸºç¡€ï¼Œå°±ç®—ä½ ç®€å†å¾ˆç‰›é€¼é‚£ä¹Ÿå¾—èµ°ä¸ªæµç¨‹å•Šã€‚è€Œè€ƒå¯ŸåŸºç¡€ä¸€èˆ¬å°±æŒ‰ç…§ HTMLï¼ŒCSSï¼ŒJavaScriptï¼Œè®¡ç®—æœºç½‘ç»œï¼Œå¸¸è§çš„ web å®‰å…¨ï¼Œåç«¯çŸ¥è¯†å¦‚æ•°æ®åº“ï¼Œé‰´æƒï¼Œå†å°±æ˜¯æœ€åæ¥ä¸¤é“ç®—æ³•é¢˜æˆ–æ™ºåŠ›é¢˜æˆ–æ•°å­¦é¢˜ã€‚</p><p>æœ€è¿‘å‡ ä¸ªæœˆæˆ‘éƒ½å¾ˆå°‘åƒä»¥å‰é‚£æ ·ä¸€å¤©åˆ°æ™šåˆ·æ˜é‡‘å’ŒçŸ¥ä¹çš„æ–‡ç« ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯åœ¨å¼€æºé¡¹ç›®ä¸­å®æˆ˜å­¦ä¹ ï¼Œæˆ‘è§‰å¾—åˆšå…¥é—¨å‰ç«¯çš„äººç¡®å®éœ€è¦å¤šçœ‹ä¸€äº›ä¼˜è´¨çš„åšå®¢ã€‚<strong>åˆšå…¥é—¨æ›´éœ€è¦å¹¿åº¦ï¼Œéšåæ˜¯å¹¿åº¦å’Œæ·±åº¦å¹¶è¡Œï¼Œæœ€åæ‰æ˜¯æ·±åº¦</strong>ã€‚å…¶å®è¯´äººè¯å°±æ˜¯ï¼šåˆšå¼€å§‹å…¥é—¨æ—¶å› ä¸ºæ²¡æ€ä¹ˆå†™è¿‡é¡¹ç›®ï¼Œæ‡‚å¾—å¤ªå°‘ï¼Œæ‰€ä»¥éœ€è¦å¤šçœ‹ï¼Œè¢«åŠ¨å¸æ”¶ã€‚åˆ°åæ¥æœ‰ä¸€å®šå¹¿åº¦äº†ï¼Œä½ ä¼šå‘ç°å…¶å®ä½ åœ¨å†™ä¸€ä¸ªé¡¹ç›®çš„æ—¶å€™å¾€å¾€ç¢°åˆ°çš„é—®é¢˜å°±æ˜¯å› ä¸ºä½ çš„æ·±åº¦ä¸å¤Ÿï¼Œè¿™ä¸ªæ—¶å€™ä½ ä¼šæ›´æ³¨é‡æ·±åº¦ã€‚æœ€åå½“ä½ å¹¿åº¦æ…¢æ…¢åˆ°äº†ä¸€å®šç¨‹åº¦åï¼Œç”±äºç½‘ç»œä¸Š 99% çš„æ–‡ç« éƒ½æ˜¯å°ç™½æ–‡ï¼Œä½ çœ‹äº†æ ‡é¢˜ä¹‹åå°±å¤§æ¦‚é—»çš„å‡ºæ–‡ç« æ˜¯å•¥å†…å®¹ï¼Œçœ‹äº†å¯¹ä½ ä¹Ÿæ²¡å•¥ç”¨ï¼Œè¿™ä¸ªæ—¶å€™ä½ æ›´å› è¯¥æŠŠæ—¶é—´èŠ±åœ¨ä¸€ä¸ªå°çš„é¢†åŸŸï¼Œæ³¨é‡æ·±åº¦ï¼Œæ·±åº¦æ‰æ˜¯æœ€èƒ½ä½“ç°ä¸€ä¸ªç¨‹åºå‘˜<strong>æŠ€æœ¯ä»·å€¼</strong>çš„åœ°æ–¹ã€‚</p><p>å‰é¢å” å¨äº†ä¸€å †åºŸè¯ï¼Œä¸‹é¢æ­£å¼å¼€å§‹æœ¬æ–‡å†…å®¹ã€‚æœ¬æ–‡å†…å®¹ä¸»è¦åˆ†ä¸¤éƒ¨åˆ†ï¼š</p><ol><li>æ€»ç»“ JavaScript ä¸­å„ç§ç±»å‹ä¸€äº›å€¼å¾—æ³¨æ„çš„åœ°æ–¹ï¼Œå°æŠ€å·§å’Œä¸ªäººå¿ƒå¾—</li><li>JavaScript å¦‚ä½•è¿›è¡Œç±»å‹åˆ¤æ–­</li></ol><a id="more"></a><h2 id="JavaScript-ä¸­çš„å„ç§ç±»å‹"><a href="#JavaScript-ä¸­çš„å„ç§ç±»å‹" class="headerlink" title="JavaScript ä¸­çš„å„ç§ç±»å‹"></a>JavaScript ä¸­çš„å„ç§ç±»å‹</h2><p>JavaScript ä¸­ç±»å‹ä¸»è¦åˆ†ä¸¤å¤§ç±»ï¼š<strong>åŸºæœ¬ç±»å‹</strong> å’Œ <strong>å¯¹è±¡ç±»å‹</strong>ã€‚</p><p>åŸºæœ¬ç±»å‹åˆåˆ† stringï¼Œnumberï¼Œbooleanï¼Œundefinedï¼Œnullï¼Œsymbolï¼ŒbigInt ä¸ƒç§ï¼ŒES ä»¥å‰åªæœ‰å‰ 5 ç§åŸºæœ¬ç±»å‹ï¼Œ ES6 å¾€åæ–°å¢äº† symbol å’Œ bigIntã€‚</p><p>å¯¹è±¡ç±»å‹åˆå«å¼•ç”¨ç±»å‹ï¼Œé™¤äº†åŸºæœ¬ç±»å‹å°±æ˜¯å¯¹è±¡ç±»å‹ï¼Œçº¯å¯¹è±¡ï¼Œæ ‡å‡†å¯¹è±¡å®ä¾‹ï¼Œå‡½æ•°ç­‰éƒ½æ˜¯å¯¹è±¡ç±»å‹ã€‚</p><p>å‰é¢è¯´äº†é‚£ä¹ˆå¤šç§ç±»å‹ï¼Œé‚£ä¹ˆå®ƒä»¬å„è‡ªæœ‰ä»€ä¹ˆç‰¹ç‚¹å‘¢ï¼Ÿ</p><h3 id="string"><a href="#string" class="headerlink" title="string"></a>string</h3><p>åœ¨ js é‡Œé¢è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ä¸²å­—é¢é‡æœ‰ä¸‰ç§æ–¹å¼ï¼Œå•å¼•å·ï¼ŒåŒå¼•å·ï¼Œæˆ–è€…åå¼•å·ï¼Œåå¼•å·è¡¨ç¤ºæ³•åˆå«æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œæ˜¯ ES6 çš„æ–°è¯­æ³•ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">'ä½¿ç”¨å•å¼•å·è¡¨ç¤ºå­—ç¬¦ä¸²'</span>;</span><br><span class="line"><span class="comment">// prettier-ignore</span></span><br><span class="line"><span class="string">"ä½¿ç”¨åŒå¼•å·è¡¨ç¤ºå­—ç¬¦ä¸²"</span>;;</span><br><span class="line"><span class="string">`ä½¿ç”¨æ¨¡æ¿å­—ç¬¦ä¸²è¡¨ç¤ºå­—ç¬¦ä¸²`</span>;</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ è¦åœ¨å­—ç¬¦ä¸²é‡Œé¢æ’å…¥å•å¼•å·æˆ–è€…åŒå¼•å·å¯ä»¥ä½¿ç”¨åå¼•å·ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">`I'm a programer, "_"!`</span>;</span><br><span class="line"><span class="comment">// prettier-ignore</span></span><br><span class="line"><span class="string">'å•å¼•å·å­—ç¬¦ä¸²å¯ä»¥æ’å…¥åå¼•å·`'</span>;</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ å’Œæˆ‘ä¸€æ ·å–œæ¬¢ç”¨å•å¼•å·è¡¨ç¤ºå­—ç¬¦ä¸²ï¼Œä½ ä¼šå‘ç°ï¼ŒåŸºæœ¬ä¸Šæ²¡æœ‰ä»€ä¹ˆåœºæ™¯éœ€è¦ä½¿ç”¨åŒå¼•å·ï¼Œä½¿ç”¨åŒå¼•å·çš„æ—¶å€™ä¾‹å¦‚è¦åœ¨å­—ç¬¦ä¸²ä¸­æ’å•å¼•å·é‚£å¯ä»¥ä½¿ç”¨æ¨¡æ¿å­—ç¬¦ä¸²ä»£æ›¿ã€‚</p><p>ä½¿ç”¨æ¨¡æ¿å­—ç¬¦ä¸²æœ‰ä¸€äº›è¦æ³¨æ„çš„åœ°æ–¹ï¼Œä¸€ä¸ªæ˜¯ä¸¤ä¸ªåå¼•å·å†…ä»»æ„å­—ç¬¦ä¸²éƒ½æœ‰æ•ˆï¼Œä¸‹é¢çš„å­—ç¬¦ä¸²è¾“å‡ºçš„æ˜¯ 4ï¼Œæœ€å‰é¢ä¸€ä¸ªç©ºæ ¼ï¼Œaï¼Œæ¢è¡Œç¬¦ï¼Œæœ€åçš„ç©ºæ ¼ï¼Œæ‰€ä»¥æ€»å…±é•¿åº¦ä¸º 4ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// prettier-ignore</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">` a</span></span><br><span class="line"><span class="string"> `</span>.length); <span class="comment">// =&gt; 4</span></span><br></pre></td></tr></table></figure><p>å¦ä¸€ä¸ªé—®é¢˜æ˜¯å½“æ¨¡æ¿å­—ç¬¦ä¸²æ’å…¥å¯¹è±¡æ—¶å¹¶ä¸ä¼šè¢«è½¬æ¢æˆ JSON å­—ç¬¦ä¸²ï¼Œä¸‹é¢ä¸¤æ¡è¯­å¥è¾“å‡ºçš„ç»“æœæ˜¯ä¸ä¸€æ ·çš„ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123; <span class="attr">author</span>: <span class="string">'YuTengjing'</span> &#125;;</span><br><span class="line"><span class="built_in">console</span>.log(obj); <span class="comment">// =&gt; &#123; author: 'YuTengjing' &#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;obj&#125;</span>`</span>); <span class="comment">// =&gt; [object Object]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åº”è¯¥ä½¿ç”¨</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(obj)&#125;</span>`</span>); <span class="comment">// =&gt; &#123;"author":"YuTengjing"&#125;</span></span><br></pre></td></tr></table></figure><p>æ¨¡æ¿å­—ç¬¦ä¸²å‰é¢è¿˜å¯ä»¥å¸¦æ ‡ç­¾ï¼Œä¾‹å¦‚ä½¿ç”¨ String.row æ¥è·å–åŸå§‹å­—ç¬¦ä¸²ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">String</span>.raw<span class="string">`aaa\n\\`</span>); <span class="comment">// =&gt; aaa\n\\</span></span><br></pre></td></tr></table></figure><p>å¸¦æ ‡ç­¾çš„æ¨¡æ¿å­—ç¬¦ä¸²æœ¬è´¨ä¸Šå°±æ˜¯å‡½æ•°è°ƒç”¨ï¼Œçœ‹ MDN ä¸Šçš„ä¸€ä¸ªä¾‹å­å°±æ‡‚äº†ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> person = <span class="string">'Mike'</span>;</span><br><span class="line"><span class="keyword">var</span> age = <span class="number">28</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myTag</span>(<span class="params">strings, personExp, ageExp</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> str0 = strings[<span class="number">0</span>]; <span class="comment">// "that "</span></span><br><span class="line">  <span class="keyword">var</span> str1 = strings[<span class="number">1</span>]; <span class="comment">// " is a "</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// There is technically a string after</span></span><br><span class="line">  <span class="comment">// the final expression (in our example),</span></span><br><span class="line">  <span class="comment">// but it is empty (""), so disregard.</span></span><br><span class="line">  <span class="comment">// var str2 = strings[2];</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> ageStr;</span><br><span class="line">  <span class="keyword">if</span> (ageExp &gt; <span class="number">99</span>) &#123;</span><br><span class="line">    ageStr = <span class="string">'centenarian'</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    ageStr = <span class="string">'youngster'</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> str0 + personExp + str1 + ageStr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> output = myTag<span class="string">`that <span class="subst">$&#123;person&#125;</span> is a <span class="subst">$&#123;age&#125;</span>`</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(output);</span><br><span class="line"><span class="comment">// that Mike is a youngster</span></span><br></pre></td></tr></table></figure><p>å…¶å®æœ‰ä¸€äº›å¼€æºçš„æ¨¡æ¿å¼•æ“å°±åˆ©ç”¨åˆ°äº†æ ‡ç­¾æ¨¡æ¿å­—ç¬¦ä¸²çš„ï¼Œä¾‹å¦‚ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2Nob29qcy9oeXBlcng=" title="https://github.com/choojs/hyperx">hyperx<i class="fa fa-external-link"></i></span>ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> vdom = <span class="built_in">require</span>(<span class="string">'virtual-dom'</span>);</span><br><span class="line"><span class="keyword">var</span> hyperx = <span class="built_in">require</span>(<span class="string">'hyperx'</span>);</span><br><span class="line"><span class="keyword">var</span> hx = hyperx(vdom.h);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> title = <span class="string">'world'</span>;</span><br><span class="line"><span class="keyword">var</span> wow = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">var</span> tree = hx<span class="string">`&lt;div&gt;</span></span><br><span class="line"><span class="string">  &lt;h1 y="ab<span class="subst">$&#123;<span class="number">1</span> + <span class="number">2</span>&#125;</span>cd"&gt;hello <span class="subst">$&#123;title&#125;</span>!&lt;/h1&gt;</span></span><br><span class="line"><span class="string">  <span class="subst">$&#123;hx<span class="string">`&lt;i&gt;cool&lt;/i&gt;`</span>&#125;</span></span></span><br><span class="line"><span class="string">  wow</span></span><br><span class="line"><span class="string">  <span class="subst">$&#123;wow.map(<span class="keyword">function</span>(w, i) &#123;</span></span></span><br><span class="line"><span class="string"><span class="subst">    <span class="keyword">return</span> hx<span class="string">`&lt;b&gt;<span class="subst">$&#123;w&#125;</span>&lt;/b&gt;\n`</span>;</span></span></span><br><span class="line"><span class="string"><span class="subst">  &#125;</span>)&#125;</span></span><br><span class="line"><span class="string">&lt;/div&gt;`</span>;</span><br><span class="line"><span class="built_in">console</span>.log(vdom.create(tree).toString());</span><br><span class="line"></span><br><span class="line"><span class="comment">/* =&gt;</span></span><br><span class="line"><span class="comment">&lt;div&gt;</span></span><br><span class="line"><span class="comment">  &lt;h1 y="ab3cd"&gt;hello world!&lt;/h1&gt;</span></span><br><span class="line"><span class="comment">  &lt;i&gt;cool&lt;/i&gt;</span></span><br><span class="line"><span class="comment">  wow</span></span><br><span class="line"><span class="comment">  &lt;b&gt;1&lt;/b&gt;&lt;b&gt;2&lt;/b&gt;&lt;b&gt;3&lt;/b&gt;</span></span><br><span class="line"><span class="comment">&lt;/div&gt;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p>æ¨¡æ¿å­—ç¬¦ä¸²è¯´äº†è¿™ä¹ˆå¤šï¼Œé‚£ä¹ˆä»€ä¹ˆæ—¶å€™åº”è¯¥ä½¿ç”¨æ¨¡æ¿å­—ç¬¦ä¸²ä»€ä¹ˆæ—¶å€™ä½¿ç”¨å•å¼•å·å‘¢ï¼Ÿå…¶å®æ€»ç»“ä¸€ä¸‹å°±æ˜¯ä»¥ä¸‹æƒ…å†µä½¿ç”¨æ¨¡æ¿å­—ç¬¦ä¸²ï¼š</p><ol><li>éœ€è¦æ‹¼æ¥è¡¨è¾¾å¼</li><li>å†™å¤šè¡Œå­—ç¬¦ä¸²å­—é¢é‡</li><li>éœ€è¦åœ¨å­—ç¬¦ä¸²ä¸­æ’å…¥å•å¼•å·å’ŒåŒå¼•å·çš„æ—¶å€™</li></ol><p>å…¶å®ƒæƒ…å†µä½¿ç”¨å•å¼•å·å³å¯ã€‚</p><h3 id="number"><a href="#number" class="headerlink" title="number"></a>number</h3><p>ä¹‹å‰å’Œä¸€ä¸ªåŒå­¦èŠå‰ç«¯çš„æ—¶å€™ï¼Œæˆ‘è€ƒäº†ä¸‹ä»– NaN æ˜¯ä»€ä¹ˆç±»å‹ï¼Œå®ƒå±…ç„¶è·Ÿæˆ‘è¯´ä¸çŸ¥é“â€¦</p><p>NaN å…¶å®å±äº number ç±»å‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="literal">NaN</span>); <span class="comment">// =&gt; number</span></span><br></pre></td></tr></table></figure><p>JavaScript ä¸­æ²¡æœ‰æ•´æ•°å’Œå°æ•°ä¹‹åˆ†ï¼Œç»Ÿä¸€å«åš number ç±»å‹ï¼Œæ‰€ä»¥ <code>5 / 2</code> ä¸ä¼šåƒå¾ˆå¤šå…¶å®ƒè¯­è¨€ä¸€æ ·ç­‰äº 2ã€‚å¦å¤– JavaScript çš„æ•°å­—ç±»å‹æ˜¯éµå¾ª IEEEï¼ˆè·Ÿæˆ‘ä¸€èµ·è¯»ï¼šI triple Eï¼‰754 64 ä½æµ®ç‚¹æ ‡å‡†çš„ï¼Œå› æ­¤å®ƒä¹Ÿæœ‰æµ®ç‚¹æ•°ç²¾åº¦é—®é¢˜ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="number">0.1</span> + <span class="number">0.2</span> === <span class="number">0.3</span>); <span class="comment">// =&gt; false</span></span><br></pre></td></tr></table></figure><p>å¯¹äºç²¾åº¦é—®é¢˜æˆ‘ä»¬ä¸€èˆ¬ç®€å•å¤„ç†å°±æ˜¯åˆ¤æ–­è¯¯å·®èŒƒå›´æ˜¯å¦å°äºç²¾åº¦è¦æ±‚ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> result = <span class="number">0.1</span> + <span class="number">0.2</span>;</span><br><span class="line"><span class="built_in">console</span>.log(result); <span class="comment">// =&gt; 0.30000000000000004</span></span><br><span class="line"><span class="comment">// ç²¾åº¦è¦æ±‚è¯¯å·®å°äº1äº¿åˆ†ä¹‹ä¸€</span></span><br><span class="line"><span class="keyword">const</span> isEqual = result - <span class="number">0.3</span> &lt; <span class="number">1e-8</span>;</span><br><span class="line"><span class="built_in">console</span>.log(isEqual); <span class="comment">// =&gt; true</span></span><br></pre></td></tr></table></figure><p>å¦‚æœé¢‘ç¹å¤„ç†ç²¾åº¦é—®é¢˜æˆ–è€…è¦æ±‚ç²¾åº¦è¦æ±‚æ¯”è¾ƒé«˜è¿™ä¸ªæ—¶å€™å°±è¦è€ƒè™‘ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“å¦‚ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2pvc2Rlam9uZy9tYXRoanM=" title="https://github.com/josdejong/mathjs">math.js<i class="fa fa-external-link"></i></span> æˆ–è€…å¯ä»¥ä½¿ç”¨ bigIntã€‚</p><p>é¢è¯•å¸¸è€ƒä¸‹é¢è¿™ä¸ªé—®é¢˜ï¼š</p><h4 id="å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯ä¸æ˜¯-NaNï¼Ÿå¯ä¸å¯ä»¥ç”¨ç­‰äºå·åˆ¤æ–­ï¼Ÿ"><a href="#å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯ä¸æ˜¯-NaNï¼Ÿå¯ä¸å¯ä»¥ç”¨ç­‰äºå·åˆ¤æ–­ï¼Ÿ" class="headerlink" title="å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯ä¸æ˜¯ NaNï¼Ÿå¯ä¸å¯ä»¥ç”¨ç­‰äºå·åˆ¤æ–­ï¼Ÿ"></a>å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯ä¸æ˜¯ NaNï¼Ÿå¯ä¸å¯ä»¥ç”¨ç­‰äºå·åˆ¤æ–­ï¼Ÿ</h4><p>å…¶å®é¢è¯•å®˜é—®ä½ å¯ä¸å¯ä»¥å°±æ˜¯å‘Šè¯‰ä½ ä¸å¯ä»¥ï¼Œé¢è¯•é»‘è¯ä¹‹ä¸€ã„Ÿ( â–”, â–” )ã„ã€‚</p><p>ä½¿ç”¨ç­‰å·åˆ¤æ–­æ˜¯ä¸è¡Œæ»´ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> value = <span class="number">1</span> / <span class="string">'a'</span>;</span><br><span class="line"><span class="built_in">console</span>.log(value); <span class="comment">// =&gt; NaN</span></span><br><span class="line"><span class="built_in">console</span>.log(value === <span class="literal">NaN</span>); <span class="comment">// =&gt; false</span></span><br></pre></td></tr></table></figure><p>åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯ä¸æ˜¯ NaNï¼Œä¸€èˆ¬æ¥è¯´ç”¨ isNaN å³å¯ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">isNaN</span>(<span class="literal">NaN</span>)); <span class="comment">// =&gt; true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">isNaN</span>(<span class="literal">true</span>)); <span class="comment">// =&gt; false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">isNaN</span>(<span class="string">'123'</span>)); <span class="comment">// =&gt; false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">isNaN</span>(<span class="string">'aaa'</span>)); <span class="comment">// =&gt; true</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„æœ€åè¿™ä¸ªåˆ¤æ–­ï¼Œè¿™ä¸ªç»“æœå…¶å®æœ‰ç‚¹åç›´è§‰çš„ï¼šâ€™aaaâ€™ å¹¶ä¸æ˜¯ NaNï¼Œåº”è¯¥è¿”å› false å•Šã€‚å…¶å® isNaN ä¹Ÿå°±æ˜¯ window.isNaN åœ¨åˆ¤æ–­ä¼ å…¥çš„å€¼æ˜¯ä¸æ˜¯ NaN æ˜¯ä¼šå…ˆå°†å…¶è½¬æ¢æˆæ•°å­—ï¼Œå†åˆ¤æ–­ç»“æœæ˜¯ä¸æ˜¯ NaNï¼Œä¹Ÿå°±æ˜¯è¯´ isNaN(â€˜aaaâ€™) ç­‰ä»·äº isNaN(Number(â€˜aaaâ€™));</p><p>é™¤äº†ä½¿ç”¨ window.isNaNï¼ŒES6 åœ¨æ•°å­—ç±»å‹æ„é€ å‡½æ•° Number ä¸Šæ–°å¢äº†ä¸€ä¸ªæ–¹æ³• Number.isNaNï¼Œå®ƒå’Œ window.isNaN çš„åŒºåˆ«åœ¨äºï¼š Number.isNaN åªæœ‰åœ¨ä¼ é€’çš„å€¼å°±æ˜¯ NaN æ—¶æ‰è¿”å› trueï¼Œä¸ä¼šå…ˆè½¬æ¢æˆæ•°å­—å†æ¯”è¾ƒï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ª API å°±æ˜¯ç”¨æ¥è®¡ç®—ä¸€ä¸ªå€¼æ˜¯ä¸æ˜¯å°±æ˜¯ NaNã€‚æ‹¿ä¸€ä¸ªéæ•°å­—ç¬¦ä¸²ä¸€æ¯”è¾ƒåŒºåˆ«å°±å¾ˆæ˜æ˜¾äº†ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> value = <span class="string">'aaa'</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">isNaN</span>(value)); <span class="comment">// =&gt; true</span></span><br><span class="line"><span class="comment">// ç­‰åŒäº</span></span><br><span class="line"><span class="keyword">const</span> transformedNumber = <span class="built_in">Number</span>(value);</span><br><span class="line"><span class="comment">// è½¬æ¢åå°±ç­‰äº NaN äº†</span></span><br><span class="line"><span class="built_in">console</span>.log(transformedNumber); <span class="comment">// =&gt; NaN</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Number</span>.isNaN(transformedNumber)); <span class="comment">// =&gt; true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åªæœ‰ value å°±æ˜¯ NaN æ‰ä¼šè¿”å› true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Number</span>.isNaN(value)); <span class="comment">// =&gt; false</span></span><br></pre></td></tr></table></figure><h4 id="å–æ•´"><a href="#å–æ•´" class="headerlink" title="å–æ•´"></a>å–æ•´</h4><p>å–æ•´æ˜¯å¹³æ—¶å¼€å‘æ—¶ç»å¸¸ä¼šç¢°åˆ°çš„é—®é¢˜ä¹‹ä¸€ï¼Œå…¶å® js é‡Œé¢å–æ•´æ–¹æ³•æœ‰å¾ˆå¤šï¼Œæ ‡å‡†å¯¹è±¡ Math å°±è‡ªå¸¦äº†ä¸€å †å–æ•´å‡½æ•°ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å‘ä¸‹å–æ•´</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.floor(<span class="number">2.6</span>)); <span class="comment">// =&gt; 2</span></span><br><span class="line"><span class="comment">// å‘ä¸Šå–æ•´</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.ceil(<span class="number">6.1</span>)); <span class="comment">// =&gt; 7</span></span><br><span class="line"><span class="comment">// å››èˆäº”å…¥</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.round(<span class="number">0.4</span>)); <span class="comment">// =&gt; 0</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.round(<span class="number">0.5</span>)); <span class="comment">// =&gt; 1</span></span><br><span class="line"><span class="comment">// çº¯ç²¹çš„å–æ•´ï¼Œä¸è¦å°æ•°éƒ¨åˆ†</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.trunc(<span class="number">0.6</span>)); <span class="comment">// =&gt; 0</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.trunc(<span class="number">0.4</span>)); <span class="comment">// =&gt; 0</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.trunc(<span class="number">-0.8</span>)); <span class="comment">// =&gt; 0</span></span><br></pre></td></tr></table></figure><p>å› ä¸º JavaScript è¿™é—¨è¯­è¨€éå¸¸å¥‡è‘©å’Œçµæ´»ï¼Œæ‰€ä»¥å¸¸å¸¸èƒ½çœ‹åˆ°å„ç§é—»æ‰€æœªé—»çš„å¥‡æ·«æŠ€å·§ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="number">1.5</span> &gt;&gt; <span class="number">0</span>); <span class="comment">// =&gt; 0</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">1.5</span> &gt;&gt;&gt; <span class="number">0</span>); <span class="comment">// =&gt; 0</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">1.5</span> &lt;&lt; <span class="number">0</span>); <span class="comment">// =&gt; 0</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">1.5</span> ^ <span class="number">0</span>); <span class="comment">// =&gt; 0</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">1.5</span> | <span class="number">0</span>); <span class="comment">// =&gt; 0</span></span><br><span class="line"><span class="built_in">console</span>.log(~~<span class="number">1.5</span>); <span class="comment">// =&gt; 0</span></span><br></pre></td></tr></table></figure><p>å…¶å®è¿˜æ˜¯ä¸å»ºè®®å¤§å®¶ä½¿ç”¨ä¸Šé¢çš„è¿™äº›æŠ€å·§ï¼Œä¸»è¦è¿˜æ˜¯å¯è¯»æ€§ä¸å¥½ï¼Œè¡¨è¾¾å¼ä¸€å¤æ‚å‡ å¤©åå†çœ‹ä»£ç ä¸€çœ¼æ‡µé€¼ã€‚ä¸è¿‡äº‹å®æƒ…å†µæ˜¯å¤§å®¶å¼€ä¼šæ—¶è¯´ä¸èƒ½å†™è¿™äº›ä¹±ä¸ƒå…«ç³Ÿçš„éªšæ“ä½œï¼Œä½†æ˜¯ç§åº•ä¸‹éƒ½å·å·çš„ç”¨â€¦.</p><p>æˆ‘ç”¨çš„æ¯”è¾ƒå¤šçš„è¿˜æ˜¯ <code>~~</code> å’Œ <code>|</code> æ¥å–æ•´ï¼Œæ ¹æ®ä½ è¡¨è¾¾å¼çš„æ‰§è¡Œé¡ºåºå’Œå®ƒä»¬çš„ä¼˜å…ˆçº§åˆç†é€‰æ‹©ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ~~ é€‚åˆç«‹å³å–æ•´</span></span><br><span class="line"><span class="built_in">console</span>.log(~~<span class="number">1.4</span>);</span><br><span class="line"><span class="comment">// | ä¼˜å…ˆçº§æ¯”è¾ƒä½ï¼Œå¦‚æœä½ å–æ•´ä¹‹å‰æœ‰è¡¨è¾¾å¼å»ºè®®ä½¿ç”¨è¿™ç§æ–¹å¼</span></span><br><span class="line"><span class="built_in">console</span>.log((<span class="number">1.4</span> + <span class="number">2.8</span>) | <span class="number">0</span>);</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹ä¸€ä¸‹ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3Zpc2lvbm1lZGlhL3N1cGVyYWdlbnQ=" title="https://github.com/visionmedia/superagent">superagent<i class="fa fa-external-link"></i></span> è¿™ä¸ªè‘—åçš„è¯·æ±‚åº“å¦‚ä½•å¤„ç† status å’Œä¸€äº›æ ‡è®°çš„ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> type = (status / <span class="number">100</span>) | <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// status / class</span></span><br><span class="line">res.status = status;</span><br><span class="line">res.statusType = type;</span><br><span class="line"></span><br><span class="line"><span class="comment">// basics</span></span><br><span class="line">res.info = <span class="number">1</span> == type;</span><br><span class="line">res.ok = <span class="number">2</span> == type;</span><br><span class="line">res.clientError = <span class="number">4</span> == type;</span><br><span class="line">res.serverError = <span class="number">5</span> == type;</span><br><span class="line">res.error = <span class="number">4</span> == type || <span class="number">5</span> == type;</span><br></pre></td></tr></table></figure><h4 id="åƒåˆ†ä½é—®é¢˜"><a href="#åƒåˆ†ä½é—®é¢˜" class="headerlink" title="åƒåˆ†ä½é—®é¢˜"></a>åƒåˆ†ä½é—®é¢˜</h4><h5 id="ä½¿ç”¨-Number-prototypo-toLocaleSctring"><a href="#ä½¿ç”¨-Number-prototypo-toLocaleSctring" class="headerlink" title="ä½¿ç”¨ Number.prototypo.toLocaleSctring"></a>ä½¿ç”¨ Number.prototypo.toLocaleSctring</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log((<span class="number">123456.123456</span>).toLocaleString()); <span class="comment">// =&gt; 123,456.123</span></span><br></pre></td></tr></table></figure><h5 id="ä½¿ç”¨å›½é™…åŒ–-API"><a href="#ä½¿ç”¨å›½é™…åŒ–-API" class="headerlink" title="ä½¿ç”¨å›½é™…åŒ– API"></a>ä½¿ç”¨å›½é™…åŒ– API</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">console.log(<span class="keyword">new</span> Intl.NumberFormat(<span class="string">'en-US'</span>).format(<span class="number">123456.123456</span>)); <span class="comment">// =&gt; 123,456.123</span></span><br></pre></td></tr></table></figure><h5 id="ä½¿ç”¨æ­£åˆ™"><a href="#ä½¿ç”¨æ­£åˆ™" class="headerlink" title="ä½¿ç”¨æ­£åˆ™"></a>ä½¿ç”¨æ­£åˆ™</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å…ˆè¡Œæ–­è¨€</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">formatRegExp1</span>(<span class="params">number</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> pattern = <span class="regexp">/(?=(\B\d&#123;3&#125;)+\.)/g</span>;</span><br><span class="line">  <span class="keyword">return</span> number</span><br><span class="line">    .toFixed(<span class="number">2</span>)</span><br><span class="line">    .toString()</span><br><span class="line">    .replace(pattern, <span class="string">','</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="è¡¨ç¤ºä¸ç­‰äº-1"><a href="#è¡¨ç¤ºä¸ç­‰äº-1" class="headerlink" title="è¡¨ç¤ºä¸ç­‰äº -1"></a>è¡¨ç¤ºä¸ç­‰äº -1</h4><p>åœ¨ koa çš„æºç é‡Œé¢æœ‰è¿™ä¹ˆä¸ªå‡½æ•°ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Check if the request is idempotent.</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return <span class="type">&#123;Boolean&#125;</span></span></span></span><br><span class="line"><span class="comment">   * <span class="doctag">@api <span class="variable">public</span></span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">get</span> idempotent() &#123;</span><br><span class="line">    <span class="keyword">const</span> methods = [<span class="string">'GET'</span>, <span class="string">'HEAD'</span>, <span class="string">'PUT'</span>, <span class="string">'DELETE'</span>, <span class="string">'OPTIONS'</span>, <span class="string">'TRACE'</span>];</span><br><span class="line">    <span class="keyword">return</span> !!~methods.indexOf(<span class="keyword">this</span>.method);</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure><p>ææ‡‚è¿™ä¸ªåˆ¤æ–­å¹‚ç­‰æ€§çš„å‡½æ•°ä¹‹å‰æˆ‘ä»¬å…ˆæ¥ç ”ç©¶ä¸‹ ~num ä¹Ÿå°±æ˜¯ä½éæ“ä½œç¬¦æœ‰ä»€ä¹ˆè§„å¾‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(~<span class="number">2</span>); <span class="comment">// -3</span></span><br><span class="line"><span class="built_in">console</span>.log(~<span class="number">1</span>); <span class="comment">// =&gt; -2</span></span><br><span class="line"><span class="built_in">console</span>.log(~<span class="number">0</span>); <span class="comment">// =&gt; -1</span></span><br><span class="line"><span class="built_in">console</span>.log(~<span class="number">-1</span>); <span class="comment">// =&gt; 0</span></span><br><span class="line"><span class="built_in">console</span>.log(~<span class="number">-2</span>); <span class="comment">// =&gt; 1</span></span><br><span class="line"><span class="built_in">console</span>.log(~<span class="number">-3</span>); <span class="comment">// =&gt; 2</span></span><br></pre></td></tr></table></figure><p>çœ‹å®Œä¸Šé¢çš„æµ‹è¯•æˆ‘ä»¬å‘ç°è§„å¾‹å°±æ˜¯ï¼š å¯¹äº ~numï¼Œå¦‚æœ num æ—¶æ­£æ•´æ•°ï¼Œç»“æœå°±æ˜¯ç­‰äº -(num + 1)ï¼Œä¹Ÿå°±æ˜¯æŠŠåŠ ä¸€åçš„ç»“æœå–è´Ÿã€‚å¦‚æœæ˜¯è´Ÿæ•´æ•°ï¼Œç»“æœå°±æ˜¯ num + 1ï¼Œä¹Ÿå°±æ˜¯åŠ ä¸€ã€‚å¹¶ä¸”åªæœ‰å½“ num ç­‰äº -1ï¼Œ ~num ç»“æœç­‰äº 0ã€‚ è¿™æ˜¯å­˜ç²¹ä»è®¡ç®—çš„è§’åº¦å‘ç°çš„è§„å¾‹ã€‚</p><p>ç°åœ¨æˆ‘ä»¬å°è¯•æŠŠå®ƒä»¬çš„ç»“æœè½¬æ¢æˆ boolean ç±»å‹å†æ¥åº·åº·ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>(~<span class="number">2</span>)); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>(~<span class="number">1</span>)); <span class="comment">// =&gt; true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>(~<span class="number">0</span>)); <span class="comment">// =&gt; true</span></span><br><span class="line"><span class="comment">// ~1 å– boolean ä¸º false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>(~<span class="number">-1</span>)); <span class="comment">// =&gt; false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>(~<span class="number">-2</span>)); <span class="comment">// =&gt; true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>(~<span class="number">-3</span>)); <span class="comment">// =&gt; true</span></span><br></pre></td></tr></table></figure><p>å‘ç°äº†æ²¡ï¼Œå› ä¸ºåªæœ‰å½“ num ç­‰äº -1 çš„æ—¶å€™ï¼Œ ~num çš„å€¼æ‰ç­‰äº 0ï¼Œè€Œå¯¹äº Boolean(value) å‡½æ•°è€Œè¨€ï¼Œåªæœ‰ value æ˜¯ 0 æ‰è¿”å› falseï¼Œå…¶å®ƒå€¼å³ä¾¿æ˜¯è´Ÿæ•°ä¹Ÿè¿”å› trueã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡ ~num è¡¨ç¤º num ä¸ç­‰äº-1ã€‚</p><p>è‡³äºå‰é¢çš„ <code>!!</code> å…¶å®å°±æ˜¯ä¸¤æ¬¡ boolean å–åä¹Ÿå°±æ˜¯å– boolean å€¼ï¼Œç­‰åŒäº Boolean(~methods.indexOf(this.method))ã€‚</p><h3 id="boolean"><a href="#boolean" class="headerlink" title="boolean"></a>boolean</h3><p>å¸ƒå°”ç±»å‹åªæœ‰ä¸¤ä¸ªå€¼ true/falseã€‚JavaScript çš„ç±»å‹è½¬æ¢å……åˆ†ä½“ç° JavaScript <code>çµæ´»æ€§</code>ï¼ˆè‰¹è›‹ï¼‰ï¼Œè™½ç„¶ js åº•å±‚å¯èƒ½åšäº†å¾ˆå¤šå±‚è½¬æ¢ï¼Œä½†æ˜¯å¯¹äºæˆ‘ä»¬å¹³æ—¶çš„å¼€å‘è€Œè¨€ï¼Œä¸éœ€è¦å»äº†è§£çš„é‚£ä¹ˆç²¾ç»†ï¼Œäº†è§£å…¶å¤§è‡´è½¬æ¢è§„å¾‹å³å¯ã€‚ä¸¾ä¸ªä¾‹å­æ¥è¯´ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="number">0</span> == []; <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>çœ‹èµ·æ¥å¾ˆç®€å•çš„ä¸€ä¸ªéä¸¥æ ¼ç›¸ç­‰æ¯”è¾ƒï¼Œå…¶å®è¦è·å¾—æœ€ç»ˆç»“æœæ˜¯è¦ç»å†å¾ˆå¤šæ­¥ï¼š</p><ol><li>å› ä¸ºå’Œ number æ¯”è¾ƒï¼Œéœ€è¦å°† [] è½¬æ¢æˆåŸå§‹å€¼ï¼Œè°ƒç”¨ [].valueOf(), è¿”å› []ï¼Œä¸æ˜¯åŸå§‹å€¼</li><li>å°è¯•ä½¿ç”¨ [].toString() è·å–åŸå§‹å€¼ï¼Œè¿”å›ç©ºå­—ç¬¦ä¸² <code>&#39;&#39;</code>ï¼Œæ­¤æ—¶ï¼Œå˜æˆ number ç±»å‹å’Œ string ç±»å‹æ¯”è¾ƒ</li><li>å°† <code>&#39;&#39;</code> è½¬æ¢æˆ number ç±»å‹ï¼ŒNumber(â€˜â€™) è¿”å› 0</li><li>æœ€å 0 å’Œ 0 æ¯”è¾ƒç›¸ç­‰</li></ol><p>å…¶å®å¹³æ—¶ä¸ç”¨åƒä¸Šé¢é‚£æ ·ä¸€æ­¥ä¸€æ­¥åˆ¤æ–­ï¼Œéæ•°å­—ç±»å‹å’Œæ•°å­—ç±»å‹æ¯”è¾ƒåŸºæœ¬ä¸Šå°±æ˜¯å°†éæ•°å­—ç±»å‹è½¬æ¢æˆæ•°å­—åå†æ¯”è¾ƒï¼Œä¸­é—´æ­¥éª¤ä¸ç”¨å»æƒ³ï¼Œç”¨ Number([]) è½¬æ¢ä¸€ä¸‹ï¼Œç»“æœè¿”å› 0ï¼Œæ¯”è¾ƒä¸€ä¸‹ä¸å°±æ˜¯äº†ã€‚</p><p>ä¸‹é¢æ¥çœ‹çœ‹å…¶å®ƒç±»å‹è½¬æ¢æˆ boolean ç±»å‹æ˜¯ä¸Šé¢ç»“æœï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>(<span class="number">0</span>)); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>(<span class="number">1</span>)); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>(<span class="number">-1</span>)); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>(<span class="literal">NaN</span>)); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>([])); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>(&#123;&#125;)); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>()); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>(<span class="string">''</span>)); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>(<span class="string">' '</span>)); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>(<span class="literal">undefined</span>)); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>(<span class="literal">null</span>)); <span class="comment">// false</span></span><br></pre></td></tr></table></figure><p>åœ¨è€ƒè™‘è½¬æ¢æˆ boolean ç±»å‹æ—¶ä¸éœ€è¦å»è€ƒè™‘å†…éƒ¨çš„æ¯ä¸€æ­¥è½¬æ¢ï¼Œåªè¦è®°ä½ä¸€ä¸ªè§„å¾‹å³å¯ï¼šé‚£äº›æ¶ˆæçš„å€¼ä¸€èˆ¬ä¼šè½¬æ¢æˆ falseï¼Œç§¯æçš„å€¼ä¸€èˆ¬è½¬æ¢æˆ true, å¯¹è±¡ä¸€å®šä¼šè½¬æ¢æˆ trueï¼Œè´Ÿæ•°ä¹Ÿä¼šè½¬æ¢æˆ trueã€‚</p><blockquote><p>å¦‚æœä¸€ä¸ªå€¼åœ¨è½¬æ¢æˆ boolean ç±»å‹æ—¶å€¼ä¸º falseï¼Œé‚£ä¹ˆæˆ‘ä»¬ç§°è¿™ä¸ªå€¼æ˜¯ <strong>falsy</strong> çš„ã€‚</p></blockquote><p>æ—¢ç„¶èŠ boolean ç±»å‹ï¼Œé‚£ä¹ˆé¡ºä¾¿è¯´è¯´ JavaScript ä¸­çš„ç›¸ç­‰æ€§åˆ¤æ–­ã€‚</p><h4 id="ç›¸ç­‰æ€§åˆ¤æ–­"><a href="#ç›¸ç­‰æ€§åˆ¤æ–­" class="headerlink" title="ç›¸ç­‰æ€§åˆ¤æ–­"></a>ç›¸ç­‰æ€§åˆ¤æ–­</h4><p>ä¹‹å‰é¢è¯•çš„æ—¶å€™ç¢°åˆ°è¿‡è¿™æ ·ä¸€é“é¢˜ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="number">666</span> == <span class="keyword">new</span> <span class="built_in">Number</span>(<span class="number">666</span>));</span><br></pre></td></tr></table></figure><p>è¿™é“é¢˜çš„ç»“æœæ˜¯ trueï¼Œæ¯”è¾ƒè¿‡ç¨‹å…¶å®æ˜¯ï¼š</p><ol><li>å³ä¾§æ˜¯ number å¯¹è±¡ï¼Œæ•°å­—ç±»å‹å’Œå¯¹è±¡ç±»å‹æ¯”è¾ƒå…ˆæŠŠå¯¹è±¡è½¬æˆæ•°å­—ï¼Œè°ƒç”¨ valueOf æ–¹æ³•ï¼Œè¿”å› 666</li><li>666 å’Œ 666 ç›¸ç­‰</li></ol><p>å…¶å®åœ¨ js é‡Œç›¸ç­‰æ€§åˆ¤æ–­å…¶å®æœ‰ä¸‰ç§ä¸åŒçš„å€¼æ¯”è¾ƒæ“ä½œï¼š</p><ul><li>ä¸¥æ ¼ç›¸ç­‰ (â€œtriple equalsâ€ æˆ– â€œidentityâ€)ï¼Œä½¿ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvT3BlcmF0b3JzL0NvbXBhcmlzb25fT3BlcmF0b3JzI0lkZW50aXR5" title="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Comparison_Operators#Identity">===<i class="fa fa-external-link"></i></span> ,</li><li>å®½æ¾ç›¸ç­‰ (â€œdouble equalsâ€) ï¼Œä½¿ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvT3BlcmF0b3JzL0NvbXBhcmlzb25fT3BlcmF0b3JzI0VxdWFsaXR5" title="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Comparison_Operators#Equality">==<i class="fa fa-external-link"></i></span></li><li>ä»¥åŠ <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is" target="_blank" rel="noopener"><code>Object.is</code></a> ï¼ˆECMAScript 2015/ ES6 æ–°ç‰¹æ€§ï¼‰</li></ul><p>æˆ‘ä»¬å¹³æ—¶å¼€å‘åº”è¯¥å°½é‡ä½¿ç”¨ === è€Œä¸æ˜¯ ==ï¼Œå› ä¸º === ç»“æœæ›´åŠ ç›´è§‚ï¼Œæ›´ç¬¦åˆé¢„æœŸï¼Œåªæœ‰ä¸¥æ ¼ç›¸ç­‰æ‰ä¼šè¿”å› trueã€‚è€Œä½¿ç”¨ ==ï¼Œä½ è¿˜è¦æ€è€ƒä¸€ä¸‹å„ç§ç±»å‹è½¬æ¢çš„æƒ…å†µã€‚</p><p>å‰é¢ä¸¤ä¸ªæˆ‘å°±ä¸å¤šè¯´äº†ï¼Œç›¸ä¿¡å¤§å®¶éƒ½éå¸¸æ¸…æ¥šå®ƒä»¬çš„åŒºåˆ«äº†ï¼Œå°±æ˜¯ == ä¼šåœ¨æ¯”è¾ƒæ—¶åšç±»å‹è½¬æ¢ï¼Œè€Œ === ä¸ä¼šã€‚è‡³äºç¬¬ä¸‰ä¸ª Object.isï¼Œæˆ‘ä»¬çœ‹å‡ ä¸ªæµ‹è¯•å°±çŸ¥é“å®ƒçš„ç‰¹ç‚¹äº†ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="number">0</span> === <span class="number">-0</span>); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="literal">NaN</span> === <span class="literal">NaN</span>); <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.is(<span class="number">0</span>, <span class="number">-0</span>)); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.is(<span class="literal">NaN</span>, <span class="literal">NaN</span>)); <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>å®ƒå’Œ === ä¹Ÿå°±æ˜¯ä¸¥æ ¼ç­‰çš„åŒºåˆ«å°±åœ¨äº 0 ä¸ç­‰äº -0ï¼ŒNaN å’Œ NaN æ˜¯ç›¸ç­‰çš„ã€‚å¦‚æœä½ é—®æˆ‘ Object.is æœ‰ä»€ä¹ˆç”¨ï¼Œåæ­£æˆ‘è§‰å¾—æ²¡ä»€ä¹ˆåµç”¨ã€‚</p><h4 id="æ˜¯ä»€ä¹ˆé¬¼"><a href="#æ˜¯ä»€ä¹ˆé¬¼" class="headerlink" title="!! æ˜¯ä»€ä¹ˆé¬¼"></a>!! æ˜¯ä»€ä¹ˆé¬¼</h4><p>åœ¨ææ¸…æ¥š !! ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¢ç©¶ä¸‹ <code>!</code>ï¼Œå­¦è¿‡ç¼–ç¨‹çš„éƒ½çŸ¥é“ï¼Œ! æ˜¯é€»è¾‘è¿ç®—ç¬¦ï¼ŒåŠŸèƒ½æ˜¯å–åã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(!<span class="literal">true</span>); <span class="comment">//=&gt; false</span></span><br><span class="line"><span class="built_in">console</span>.log(!<span class="literal">false</span>); <span class="comment">// =&gt; true</span></span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆå½“ ! åé¢è·Ÿç€çš„æ“ä½œæ•°ä¸æ˜¯ boolean ç±»å‹ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿç¨å¾®æœ‰ç‚¹çµæ€§å°±èƒ½çŒœå‡ºæ¥æ˜¯å…ˆå°†å…¶è½¬æ¢æˆ boolean å€¼ï¼Œå†å–åã€‚çœ‹æµ‹è¯•ç»“æœï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>(<span class="number">0</span>)); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(!<span class="number">0</span>); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>(<span class="number">1</span>)); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(!<span class="number">1</span>); <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>(<span class="number">-1</span>)); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(!<span class="number">-1</span>); <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>(<span class="literal">NaN</span>)); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(!<span class="literal">NaN</span>); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>([])); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(![]); <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>(&#123;&#125;)); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(!&#123;&#125;); <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>(<span class="string">''</span>)); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(!<span class="string">''</span>); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>(<span class="string">' '</span>)); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(!<span class="string">' '</span>); <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>(<span class="literal">undefined</span>)); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(!<span class="literal">undefined</span>); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>(<span class="literal">null</span>)); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(!<span class="literal">null</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>æµ‹è¯•ç»“æœè¯æ˜äº†æˆ‘ä»¬çš„çŒœæƒ³æ˜¯å¯¹çš„ã€‚æ—¢ç„¶ä¸€æ¬¡ ! æ˜¯å°†æ“ä½œæ•°è½¬æ¢æˆ boolean å†å–åï¼Œé‚£ä¹ˆå†æ¥ä¸€æ¬¡å–åï¼Œå°±æ˜¯è´Ÿè´Ÿå¾—æ­£ï¼Œå…¶å®å°±æ˜¯è½¬æ¢æˆ boolean å€¼å˜›ã€‚ä½¿ç”¨ <code>!!var</code> æ¯”èµ· <code>Boolean(var)</code> æ–¹ä¾¿å¤šäº†ã€‚</p><h3 id="undefined-å’Œ-null"><a href="#undefined-å’Œ-null" class="headerlink" title="undefined å’Œ null"></a>undefined å’Œ null</h3><p><strong>undefined ç±»å‹åªæœ‰ undefined ä¸€ä¸ªå€¼ï¼Œnull ç±»å‹åŒæ ·ä¹Ÿåªæœ‰ null ä¸€ä¸ªå€¼</strong>ã€‚è¿™ä¿©æ”¾ä¸€èµ·è¯´æ˜¯å› ä¸ºå®ƒä¿©å®åœ¨æ˜¯å¤ªåƒäº†ï¼Œæˆ‘æ„Ÿè§‰å¾ˆå¤šäººç”šè‡³è®¤ä¸ºä»–ä¿©æ²¡åŒºåˆ«ã€‚</p><p>ä¸ªäººè®¤ä¸ºå®ƒä»¬è¿˜æ˜¯æœ‰åŒºåˆ«çš„ï¼Œä»è¯­ä¹‰çš„è§’åº¦æ¥è¯´ï¼šundefined è¡¨ç¤ºä¸€ä¸ªå˜é‡è¢«å£°æ˜äº†ä½†æ˜¯æ²¡è¢«èµ‹å€¼ï¼Œè€Œ null è¡¨ç¤ºè·å–ä¸åˆ°å€¼ï¼Œä¸€èˆ¬æ˜¯ä½ åˆ»æ„è®¾ç½®çš„ç©ºå€¼ï¼Œå…·ä½“è¡¨ç°å°±æ˜¯è®¾ç½®å‡½æ•°è¿”å›å€¼æ—¶å¦‚æœè·å–ä¸åˆ°å€¼çš„æ—¶å€™æˆ‘ä»¬å¾€å¾€æ˜¯è¿”å› nullï¼Œè€Œä¸ä¼šè¿”å› undefinedã€‚</p><p>æœ‰äº›äººå¯èƒ½ä¼šä¸‹æ„è¯†è®¤ä¸º <code>false == null</code>ï¼Œäº‹å®å´æ˜¯ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="literal">false</span> == <span class="literal">null</span>); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="literal">undefined</span> == <span class="literal">null</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>äº‹å®ä¸Šåªæœ‰ undefined å’Œ null æ‰ä¼šå’Œ null éä¸¥æ ¼ç­‰ï¼Œfalse ä¹Ÿä¸è¡Œï¼Œæ‰€ä»¥å½“ä½ çœ‹åˆ°æœ‰äººä½¿ç”¨ if (val == null) æ—¶åº”è¯¥è¦çŸ¥é“å®ƒæ˜¯åœ¨åˆ¤æ–­ val æ˜¯ä¸æ˜¯ç­‰äº undefined æˆ–è€… nullï¼Œè€Œä¸æ˜¯åˆ¤æ–­æ˜¯ä¸æ˜¯ falsyã€‚</p><h3 id="symbol"><a href="#symbol" class="headerlink" title="symbol"></a>symbol</h3><p>symbol æˆ‘æ„Ÿè§‰å¹³æ—¶å†™é¡¹ç›®å¯èƒ½ä¸å¤ªç”¨å¾—ä¸Šï¼Œä½†æ˜¯åœ¨å†™åº“æˆ–è€…è®¾è®¡æ¡†æ¶çš„æ—¶å€™è¿˜æ˜¯èƒ½æ´¾ä¸Šç”¨åœºçš„ï¼Œä¾‹å¦‚æˆ‘åœ¨å®ç°å®Œå…¨ç¬¦åˆ A+ è§„èŒƒçš„ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RqeDY2Ni9kZWVwLWluLWZl" title="https://github.com/tjx666/deep-in-fe">MyPromise<i class="fa fa-external-link"></i></span> çš„æ—¶å€™å°±ç”¨ Symbol æ¥è¡¨ç¤ºçŠ¶æ€æšä¸¾å€¼ã€‚</p><p>symbol å’Œåé¢è¦è¯´çš„ bigInt ä¸€æ ·ï¼Œ<strong>ä¸èƒ½ä½¿ç”¨ new æ¥æ„é€ å€¼</strong>ã€‚è·å–ä¸€ä¸ª symbol å€¼åªèƒ½é€šè¿‡ Symbol(description) æˆ–è€… Symbol.for(key)ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> s1 = <span class="built_in">Symbol</span>(<span class="string">'mark'</span>);</span><br><span class="line"><span class="keyword">const</span> s2 = <span class="built_in">Symbol</span>(<span class="string">'mark'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> s1); <span class="comment">// =&gt; symbol</span></span><br><span class="line"><span class="built_in">console</span>.log(s1); <span class="comment">// =&gt; Symbol(mark)</span></span><br><span class="line"><span class="built_in">console</span>.log(s1 === s2); <span class="comment">// =&gt; false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Symbol</span>.for(<span class="string">'key'</span>) === <span class="built_in">Symbol</span>.for(<span class="string">'key'</span>)); <span class="comment">// =&gt; true</span></span><br></pre></td></tr></table></figure><p>symbol æœ€å¤§çš„ç‰¹ç‚¹ä¾¿æ˜¯å”¯ä¸€æ€§ï¼Œæ¯æ¬¡é€šè¿‡ Symbol è¿”å›çš„éƒ½æ˜¯ js å†…éƒ¨è®¡ç®—å¥½çš„ä¸€ä¸ª å”¯ä¸€çš„ symbol å€¼ã€‚é™¤äº†å”¯ä¸€æ€§ï¼Œsymbol ç±»å‹çš„å€¼è¿˜èƒ½ä½œä¸ºå¯¹è±¡çš„é”®ï¼Œè¿™åœ¨ ES5 æ—¶ä»£æ˜¯åªæœ‰å­—ç¬¦ä¸²ç±»å‹ã€‚æœ‰äº›äººå¯èƒ½è®¤ä¸º number ä¹Ÿèƒ½ä½œä¸ºå¯¹è±¡çš„é”®ï¼Œä¸€ä¸ªæ˜¾è€Œæ˜“è§çš„ä¾‹å­ä¾¿æ˜¯æ•°ç»„ï¼Œäº‹å®çœŸçš„æ˜¯è¿™æ ·å—ï¼Ÿ</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="built_in">Object</span>.keys(arr)[<span class="number">0</span>]); <span class="comment">// =&gt; string</span></span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆ symbol æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿæœ€å¤§çš„ç”¨é€”å…¶å®è¿˜æ˜¯ä½œä¸ºå¯¹è±¡çš„å±æ€§ä½¿ç”¨ã€‚ä½¿ç”¨ symbol å€¼å®šä¹‰å±æ€§ï¼Œå¥½å¤„å°±æ˜¯ï¼š<strong>é˜²æ­¢ç”¨æˆ·ä¿®æ”¹å†…éƒ¨å±æ€§</strong>ã€‚äº‹å®ä¸Š js å†…éƒ¨æœ‰å¾ˆå¤šå±æ€§éƒ½æ˜¯ä½¿ç”¨ symbol å€¼å®šä¹‰çš„ï¼Œè¿™äº›å±æ€§å¤§å¤šç›´æ¥ç»‘å®šåˆ° Symbol å‡½æ•°ä¸Šï¼Œä¾‹å¦‚ <code>Symbol.toPrimitive</code>ï¼Œå¯¹è±¡çš„<code>Symbol.toPrimitive</code>å±æ€§ï¼ŒæŒ‡å‘ä¸€ä¸ªæ–¹æ³•ã€‚è¯¥å¯¹è±¡è¢«è½¬ä¸ºåŸå§‹ç±»å‹çš„å€¼æ—¶ï¼Œä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œè¿”å›è¯¥å¯¹è±¡å¯¹åº”çš„åŸå§‹ç±»å‹å€¼ã€‚</p><p><code>Symbol.toPrimitive</code>è¢«è°ƒç”¨æ—¶ï¼Œä¼šæ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼Œè¡¨ç¤ºå½“å‰è¿ç®—çš„æ¨¡å¼ï¼Œä¸€å…±æœ‰ä¸‰ç§æ¨¡å¼ã€‚</p><ul><li>Numberï¼šè¯¥åœºåˆéœ€è¦è½¬æˆæ•°å€¼</li><li>Stringï¼šè¯¥åœºåˆéœ€è¦è½¬æˆå­—ç¬¦ä¸²</li><li>Defaultï¼šè¯¥åœºåˆå¯ä»¥è½¬æˆæ•°å€¼ï¼Œä¹Ÿå¯ä»¥è½¬æˆå­—ç¬¦ä¸²</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">  [<span class="built_in">Symbol</span>.toPrimitive](hint) &#123;</span><br><span class="line">    <span class="keyword">switch</span> (hint) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'number'</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">123</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'string'</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'str'</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'default'</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'default'</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="number">2</span> * obj; <span class="comment">// 246</span></span><br><span class="line"><span class="number">3</span> + obj; <span class="comment">// '3default'</span></span><br><span class="line">obj == <span class="string">'default'</span>; <span class="comment">// true</span></span><br><span class="line"><span class="built_in">String</span>(obj); <span class="comment">// 'str'</span></span><br></pre></td></tr></table></figure><p>é™¤äº†å®šä¹‰å±æ€§ï¼Œæˆ‘è§‰å¾—è¿˜å¯ä»¥ç”¨äºæ­é…å¯¹è±¡å®ç°æšä¸¾ã€‚å› ä¸º js æ²¡æœ‰æšä¸¾è¿™ç§ç±»å‹ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½æ¨¡æ‹Ÿäº†ï¼Œä½¿ç”¨ symbol å¯ä»¥æ¨¡æ‹Ÿä¸€ä¸ªæ›´ perfect çš„æšä¸¾ï¼Œè®©æšä¸¾å€¼ä¸å¯èƒ½ä¼šé‡å¤ï¼Œè¿˜èƒ½é¿å…ä½¿ç”¨ switch/case çš„æ—¶å€™ç”±äºæšä¸¾å€¼ç›¸ç­‰é€ æˆé€»è¾‘ bugã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æšä¸¾çš„ç‰¹ç‚¹ï¼šä¸èƒ½é‡å¤ï¼Œä¸èƒ½è¢«ä¿®æ”¹</span></span><br><span class="line"><span class="comment">// è¿™ä¸ªç‰ˆæœ¬æ›´å¥½ç†è§£</span></span><br><span class="line"><span class="keyword">const</span> Season = <span class="built_in">Object</span>.freeze(&#123;</span><br><span class="line">  SPRING: <span class="built_in">Symbol</span>(<span class="string">'season-spring'</span>),</span><br><span class="line">  SUMMER: <span class="built_in">Symbol</span>(<span class="string">'season-summer'</span>),</span><br><span class="line">  AUTUMN: <span class="built_in">Symbol</span>(<span class="string">'season-autumn'</span>),</span><br><span class="line">  WINTER: <span class="built_in">Symbol</span>(<span class="string">'season-winter'</span>),</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">Season.SPRING = <span class="number">666</span>;</span><br><span class="line"><span class="built_in">console</span>.log(Season.SPRING); <span class="comment">// =&gt; Symbol(season-spring)</span></span><br><span class="line"><span class="comment">// æšä¸¾å€¼ä¸èƒ½é‡å¤</span></span><br><span class="line"><span class="built_in">console</span>.log(Season.SPRING === Season.SUMMER); <span class="comment">// =&gt; false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ›´å®Œå–„çš„å®ç°ï¼Œæšä¸¾åº”è¯¥æ˜¯ä¸èƒ½è¢«ä¿®æ”¹çš„ï¼Œè¿™é‡Œä½¿ç”¨äº† ES6 çš„ proxy</span></span><br><span class="line"><span class="keyword">const</span> Season = <span class="keyword">new</span> <span class="built_in">Proxy</span>(</span><br><span class="line">  &#123;</span><br><span class="line">    SPRING: <span class="built_in">Symbol</span>(<span class="string">'season-spring'</span>),</span><br><span class="line">    SUMMER: <span class="built_in">Symbol</span>(<span class="string">'season-summer'</span>),</span><br><span class="line">    AUTUMN: <span class="built_in">Symbol</span>(<span class="string">'season-autumn'</span>),</span><br><span class="line">    WINTER: <span class="built_in">Symbol</span>(<span class="string">'season-winter'</span>),</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">set</span>() &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">`can't modify enumeration Season`</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Season.SPRING = 666; // =&gt; can't modify enumeration Season</span></span><br><span class="line"><span class="built_in">console</span>.log(Season.SPRING); <span class="comment">// =&gt; Symbol(season-spring)</span></span><br><span class="line"><span class="built_in">console</span>.log(Season.SPRING === Season.SUMMER); <span class="comment">// =&gt; false</span></span><br></pre></td></tr></table></figure><h3 id="bigInt"><a href="#bigInt" class="headerlink" title="bigInt"></a>bigInt</h3><p>çœ‹ä¸€é“ leetcode é¢˜ï¼š</p><p><img data-src="https://i.loli.net/2020/01/15/LpExMSo5rPtOR2s.png" alt="leetcode-question"></p><p>è¿™é“é¢˜æˆ‘ä¸å‡æ€ç´¢çš„å°±å†™ä¸‹äº†ä¸‹è¾¹çš„ç­”æ¡ˆï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number[]&#125;</span> <span class="variable">digits</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;number[]&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">plusOne</span>(<span class="params">digits</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;<span class="built_in">Number</span>(digits.join(<span class="string">''</span>)) + <span class="number">1</span>&#125;</span>`</span>.split(<span class="string">''</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœæäº¤çš„æ—¶å€™å‡ºé”™äº†ï¼š</p><p><img data-src="https://i.loli.net/2020/01/15/7P4X31eEacMkL6v.png" alt="leetcode-record"></p><p>å‡ºé”™çš„åŸå› å¾ˆç®€å•ï¼Œå› ä¸ºæµ‹è¯•çš„æ•°æ®å¤§äº js æœ€å¤§å®‰å…¨æ•´æ•°äº†ï¼Œå‡ºç°äº†ç²¾åº¦ä¸¢å¤±ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> num = <span class="built_in">Number</span>([<span class="number">6</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>].join(<span class="string">''</span>));</span><br><span class="line"><span class="built_in">console</span>.log(num); <span class="comment">// =&gt; 614 5390 1951 8670 5000</span></span><br><span class="line"><span class="built_in">console</span>.log(num &gt; <span class="built_in">Number</span>.MAX_SAFE_INTEGER); <span class="comment">// =&gt; true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Number</span>.MAX_SAFE_INTEGER); <span class="comment">// =&gt; 9007 1992 5474 0991</span></span><br></pre></td></tr></table></figure><p>æ¢æˆ BigInt æ¥è¯•è¯•ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number[]&#125;</span> <span class="variable">digits</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return <span class="type">&#123;number[]&#125;</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">plusOne</span>(<span class="params">digits</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;BigInt(digits.join(<span class="string">''</span>)) + <span class="number">1n</span>&#125;</span>`</span>.split(<span class="string">''</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ¬¡å°±é¡ºåˆ©é€šè¿‡äº†æ‰€æœ‰æµ‹è¯•ï¼š</p><p><img data-src="https://i.loli.net/2020/01/15/vpHTwQet7ZugAYc.png" alt="leetcode-test-pass"></p><p>è¿™é‡Œæ¥è¯´ç‚¹é¢˜å¤–è¯ï¼Œç¬”è€…æœ€è¿‘åœ¨åˆ· leetcodeï¼Œå› ä¸ºå¾ˆå¤šé¢˜å…¶å®æœ‰å¾ˆå¤šè§£æ³•ï¼Œæœ‰æ—¶æˆ‘å°±ä¼šæ‹¿ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2Jlc3RpZWpzL2JlbmNobWFyay5qcw==" title="https://github.com/bestiejs/benchmark.js">benchmark.js<i class="fa fa-external-link"></i></span> æ¥å»æµ‹è¯•ä¸åŒè§£æ³•çš„æ•ˆç‡ã€‚ä¸è¿‡ï¼Œæµ‹ç€æµ‹ç€ã€‚æˆ‘å°±å‘ç°ï¼š<strong>ä½¿ç”¨ JavaScript æµ‹è¯•ä¸åŒçš„ç®—æ³•æ•ˆç‡å¾ˆæ‰¯æ·¡</strong>ã€‚æ¥çœ‹ä¸€ä¸ªå…·ä½“çš„ä¾‹å­ï¼Œleetcode 26 é¢˜ï¼Œåˆ é™¤é‡å¤å…ƒç´ ã€‚</p><p>è§£æ³•ä¸€ï¼šä¸¤å±‚å¾ªç¯ï¼Œç®—æ³•å¤æ‚åº¦ï¼š O(nÂ²)</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// removeDuplicates1</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">removeDuplicates</span>(<span class="params">nums</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (nums.length &lt; <span class="number">2</span>) <span class="keyword">return</span> nums.length;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> i = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span> (i &lt; nums.length) &#123;</span><br><span class="line">    <span class="keyword">if</span> (nums[i] === nums[i - <span class="number">1</span>]) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> j = i; j &lt; nums.length; j++) &#123;</span><br><span class="line">        nums[j - <span class="number">1</span>] = nums[j];</span><br><span class="line">      &#125;</span><br><span class="line">      nums.length--;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      i++;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> nums.length;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è§£æ³•äºŒï¼šå¿«æ…¢åŒæŒ‡é’ˆï¼Œä¸€æ¬¡éå†å³å¯ï¼Œç®—æ³•å¤æ‚åº¦ O(n)</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// removeDuplicates2</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">removeDuplicates</span>(<span class="params">nums</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; length &#125; = nums;</span><br><span class="line">  <span class="keyword">if</span> (length === <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> head = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> tail = <span class="number">1</span>; tail &lt; length; tail++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (nums[tail] !== nums[head]) &#123;</span><br><span class="line">      head++;</span><br><span class="line">      nums[head] = nums[tail];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> resultLength = head + <span class="number">1</span>;</span><br><span class="line">  nums.length = resultLength;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> resultLength;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘æ‹¿æœ€èƒ½å‘æŒ¥åŒæŒ‡é’ˆä¼˜åŠ¿çš„æƒ…å†µï¼Œä¹Ÿå³æ˜¯å¤§é‡é‡å¤å…ƒç´ çš„æƒ…å†µæ¥æµ‹è¯•æµ‹è¯•ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; Suite &#125; = <span class="built_in">require</span>(<span class="string">'benchmark'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> removeDuplicates1 = <span class="built_in">require</span>(<span class="string">'../src/0026-Remove Duplicates from Sorted Array/removeDuplicates1'</span>);</span><br><span class="line"><span class="keyword">const</span> removeDuplicates2 = <span class="built_in">require</span>(<span class="string">'../src/0026-Remove Duplicates from Sorted Array/removeDuplicates2'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> testArr = [...Array(<span class="number">1e5</span>)].map(<span class="function"><span class="params">()</span> =&gt;</span> <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Suite()</span><br><span class="line">  .add(<span class="string">'removeDuplicates1'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    removeDuplicates1(testArr);</span><br><span class="line">  &#125;)</span><br><span class="line">  .add(<span class="string">'removeDuplicates2'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    removeDuplicates2(testArr);</span><br><span class="line">  &#125;)</span><br><span class="line">  .on(<span class="string">'cycle'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">String</span>(event.target));</span><br><span class="line">  &#125;)</span><br><span class="line">  .on(<span class="string">'complete'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`Fastest is <span class="subst">$&#123;<span class="keyword">this</span>.filter(<span class="string">'fastest'</span>).map(<span class="string">'name'</span>)&#125;</span>`</span>);</span><br><span class="line">  &#125;)</span><br><span class="line">  .run(&#123; <span class="attr">async</span>: <span class="literal">true</span> &#125;);</span><br></pre></td></tr></table></figure><p>ç»“æœå‡ºäººæ„æ–™ï¼Œè¿˜ç‰¹ä¹ˆæ˜¯ç®—æ³•ä¸€æ•ˆç‡é«˜</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;* &#x3D;&gt;</span><br><span class="line">removeDuplicates1 x 94,495,506 ops&#x2F;sec Â±1.94% (83 runs sampled)</span><br><span class="line">removeDuplicates2 x 11,855,308 ops&#x2F;sec Â±3.34% (84 runs sampled)</span><br><span class="line">Fastest is removeDuplicates1</span><br><span class="line"> *&#x2F;</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥æˆ‘è§‰å¾—å§ï¼Œåœ¨å†™ JS çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸€èˆ¬æƒ…å†µéƒ½ä¸éœ€è¦å»è€ƒè™‘ç®—æ³•æ•ˆç‡ï¼Œå»é‡æˆ‘ç”¨ Set éš¾é“ä¸é¦™å—ï¼Ÿè™½ç„¶è¿™ä¸ªè§£æ³•ä¸ç¬¦åˆ leetcode çš„é¢˜ç›®è¦æ±‚ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> removeDuplicates = <span class="function"><span class="params">nums</span> =&gt;</span> [...new <span class="built_in">Set</span>(nums)];</span><br></pre></td></tr></table></figure><p>å…¶æ˜¯ä¹Ÿå°±æ˜¯å¸¸è¯´çš„ä¸è¦è¿‡æ—©çš„ä¼˜åŒ–ï¼Œå³ä¾¿æ˜¯çœŸéœ€è¦ç®—æ³•è¿›è¡Œä¼˜åŒ–çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¹Ÿåº”è¯¥éœ€è¦å¯¹å®é™…æ•ˆæœæµ‹è¯•ä¹‹åå†å†³å®šæ˜¯å¦ä¼˜åŒ–ï¼Œç†è®ºå’Œå®é™…è¿˜æ˜¯æœ‰å¾ˆå¤§åŒºåˆ«çš„ï¼Œç°å®æƒ…å†µå¾€å¾€æƒ³åƒçš„è¦å¤æ‚çš„å¤šã€‚</p><h2 id="JavaScript-ç±»å‹åˆ¤æ–­"><a href="#JavaScript-ç±»å‹åˆ¤æ–­" class="headerlink" title="JavaScript ç±»å‹åˆ¤æ–­"></a>JavaScript ç±»å‹åˆ¤æ–­</h2><p>å…ˆå½’çº³ä¸€ä¸‹å¸¸è§çš„åˆ¤æ–­æ–¹æ³•ï¼š</p><ol><li>typeof</li><li>instanceof</li><li>Object.prototype.toString</li><li>æ¯”è¾ƒæ„é€ å™¨</li><li>æ¯”è¾ƒå¯¹è±¡çš„å±æ€§</li><li>åŸç”Ÿ API</li><li>ç›´æ¥æ¯”è¾ƒå€¼æ˜¯å¦ç­‰äºä½ è¦åˆ¤æ–­çš„å€¼</li></ol><p>ä¸‹é¢ä¸€ä¸ªä¸€ä¸ªæ¥è¯´è¯´å®ƒä»¬çš„å„è‡ªé€‚åˆçš„ä½¿ç”¨åœºæ™¯å’Œä¼˜ç¼ºç‚¹ã€‚</p><h3 id="typeof"><a href="#typeof" class="headerlink" title="typeof"></a>typeof</h3><p>å½“ä½ éœ€è¦åˆ¤æ–­ä¸€ä¸ªå˜é‡çš„ç±»å‹çš„æ—¶å€™ï¼Œé¦–å…ˆåº”è¯¥æƒ³åˆ°çš„æ˜¯å°±æ˜¯èƒ½ä¸èƒ½ç”¨ typeof æ¥åˆ¤æ–­ã€‚ä¸ºä»€ä¹ˆï¼Ÿå› ä¸º typeof æ¯”å…¶å®ƒçš„æ–¹å¼æ›´å®‰å…¨ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> abc); <span class="comment">// =&gt; undefined</span></span><br><span class="line"><span class="built_in">console</span>.log(def <span class="keyword">instanceof</span> <span class="built_in">Object</span>); <span class="comment">// æŠ¥é”™ï¼šReferenceError: def is not defined</span></span><br></pre></td></tr></table></figure><p>å½“ä½ å¯¹ä¸€ä¸ªæ²¡æœ‰å£°æ˜è¿‡çš„å˜é‡è¿›è¡Œåˆ¤æ–­æ—¶ï¼Œä½¿ç”¨ typeof ç›¸æ¯”ä¸ instanceof ç­‰å…¶å®ƒæ–¹æ³•æ›´å®‰å…¨ï¼Œä½¿ç”¨ typeof åªä¼šè¿”å› undefinedï¼Œè€Œå…¶å®ƒæ–¹å¼ç›´æ¥æŠ¥é”™äº†ã€‚</p><p>ä½†æ˜¯ typeof ç»å¯¹å®‰å…¨å—ï¼ŸNoï¼Œç¢°åˆ°æš‚æ—¶æ€§æ­»åŒºç…§æ ·æ­‡èœï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">typeof</span> a); <span class="comment">// ReferenceError: Cannot access 'a' before initialization</span></span><br><span class="line">  <span class="keyword">const</span> a = <span class="number">666</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test();</span><br></pre></td></tr></table></figure><p>å†ç»™ typeof é€‚åˆå“ªäº›æƒ…å†µä¸‹ç»“è®ºä¹‹å‰æˆ‘ä»¬å…ˆæ¥æµ‹è¯•ä¸€ä¸‹ typeof çš„ç‰¹æ€§:</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="number">6</span>); <span class="comment">// =&gt; number</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="string">'6'</span>); <span class="comment">// =&gt; string</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="literal">true</span>); <span class="comment">// =&gt; boolean</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="literal">undefined</span>); <span class="comment">// =&gt; undefined</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="built_in">Symbol</span>(<span class="string">'6'</span>)); <span class="comment">// =&gt; symbol</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> BigInt(<span class="number">6</span>)); <span class="comment">// =&gt; bigint</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> &#123;&#125;); <span class="comment">// =&gt; object</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> []); <span class="comment">// =&gt; object</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="literal">null</span>); <span class="comment">// =&gt; object</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;); <span class="comment">// =&gt; function</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="built_in">Number</span>(<span class="number">6</span>)); <span class="comment">// =&gt; number</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="keyword">new</span> <span class="built_in">Number</span>()); <span class="comment">// =&gt; object</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="keyword">new</span> <span class="built_in">Boolean</span>(<span class="literal">false</span>)); <span class="comment">// =&gt; object</span></span><br></pre></td></tr></table></figure><p>å€¼å¾—æ³¨æ„çš„æ˜¯æœ€åä¸¤ç»„æµ‹è¯•ï¼Œå‰é¢çš„æµ‹è¯•éƒ½æ¯”è¾ƒç¬¦åˆé¢„æœŸï¼Œä¹Ÿå°±æ˜¯è¯´ typeof å¯¹åŸºæœ¬ç±»å‹ä½¿ç”¨æ—¶ä¼šè¿”å›å®ƒçš„ç±»å‹å­—ç¬¦ä¸²ã€‚å‡ºä¹æ„æ–™çš„æ˜¯ typeof null å±…ç„¶ä¹Ÿè¿”å› objectï¼Œè¿˜æœ‰ typeof å‡½æ•°æ—¶è¿”å›çš„æ˜¯ functionï¼Œè®²é“ç†åº”è¯¥è¿”å› null å’Œ object æ‰å¯¹ã€‚</p><p>æœ€åä¸€ç»„æµ‹è¯•çš„ç»“æœè¡¨é¢å½“æˆ‘ä»¬ new åŸºæœ¬ç±»å‹çš„æ„é€ å‡½æ•°çš„æ—¶å€™è¿”å›çš„æ˜¯å®ƒä»¬çš„åŒ…è£…ç±»å®ä¾‹ï¼Œä¹Ÿå°±æ˜¯å¯¹è±¡ç±»å‹ã€‚</p><p>æ ¹æ®æµ‹è¯•ç»“æœæˆ‘ä»¬å¯ä»¥ä¸‹ç»“è®ºï¼š<strong>typeof é€‚åˆåˆ¤æ–­é™¤äº† null ä»¥å¤–çš„åŸºæœ¬ç±»å‹å’Œå‡½æ•°ç±»å‹ï¼Œä¹Ÿå¯ä»¥ç”¨äºåˆ¤æ–­æ˜¯å¦ä¸ºå¯¹è±¡ç±»å‹ï¼Œä¸é€‚åˆåˆ¤æ–­æ˜¯å¦ä¸ºæŸç§ç±»çš„å®ä¾‹ã€‚</strong></p><p>å…¶å® typeof è¿˜æ˜¯æ¯”è¾ƒä¸‡èƒ½çš„ï¼Œå½“æˆ‘ä»¬åœ¨å¼€å‘æ—¶éœ€è¦ç±»å‹åˆ¤æ–­æ—¶ï¼Œå¯ä»¥å…ˆè€ƒè™‘ä¸‹èƒ½ä¸èƒ½ä½¿ç”¨ typeof æ¥åˆ¤æ–­ã€‚æˆ‘ä»¬æ¥å®ç°ä¸€ä¸ªåˆ¤æ–­æ˜¯å¦ä¸º number çš„å·¥å…·å‡½æ•°ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isNumber</span>(<span class="params">val</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">typeof</span> val === <span class="string">'number'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¥½åƒæŒºç®€å•çš„ï¼Œå®æµ‹ä¸€ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(isNumber(<span class="number">6</span>)); <span class="comment">// =&gt; true</span></span><br><span class="line"><span class="built_in">console</span>.log(isNumber(<span class="keyword">new</span> <span class="built_in">Number</span>(<span class="number">6</span>))); <span class="comment">// =&gt; false</span></span><br></pre></td></tr></table></figure><p>ä½ ä¼šå‘ç°å½“ val æ˜¯æ•°å­—å¯¹è±¡çš„æ—¶å€™å°±è¿”å› false äº†ï¼Œå› ä¸º typeof new Number(6) è¿”å›çš„æ˜¯ â€˜objectâ€™ï¼Œå¦‚æœè¦æ±‚ isNumber å…¼å®¹æ•°å­—å¯¹è±¡æ€ä¹ˆåŠï¼Ÿ</p><h3 id="instanceof"><a href="#instanceof" class="headerlink" title="instanceof"></a>instanceof</h3><p>æˆ‘ä»¬çŸ¥é“åœ¨ js ä¸­å¾ˆå¤šç±»å‹çš„å¯¹è±¡å¯ä»¥é€šè¿‡ new constructor() çš„æ–¹å¼æ¥æ„é€ å¯¹è±¡ï¼Œ<strong>å¦‚æœä½ éœ€è¦åˆ¤æ–­ä¸€ä¸ªå˜é‡æ˜¯å¦æ˜¯æŸä¸ªç±»çš„å®ä¾‹ï¼Œå°±å¯ä»¥ç”¨ instanceof æ¥åˆ¤æ–­</strong>ï¼š</p><p>instanceof çš„åŸç†å¾ˆç®€å•ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> isObject = <span class="built_in">require</span>(<span class="string">'../is/isObject'</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">instanceOf</span>(<span class="params">obj, constructor</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!isObject(<span class="keyword">constructor</span>)) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">`Right-hand side of 'instanceof' is not an object`</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="keyword">constructor</span> !== 'function') &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">`Right-hand side of 'instanceof' is not callable`</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">constructor</span>.prototype.isPrototypeOf(obj);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¶‰åŠåˆ°çš„å…¶å®ƒä»£ç ä¿å­˜åœ¨<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RqeDY2Ni9kZWVwLWluLWZlL2Jsb2IvbWFzdGVyL3NyYy9pbnN0YW5jZW9m" title="https://github.com/tjx666/deep-in-fe/blob/master/src/instanceof">instanceof è¿ç®—ç¬¦åŸç†<i class="fa fa-external-link"></i></span>ã€‚ä¸»è¦æ˜¯æœ€åä¸€å¥ <code>constructor.prototype.isPrototypeOf(obj)</code>ï¼Œä¹Ÿå°±æ˜¯å¯¹äº obj instanceof constructorï¼Œè¿”å›çš„å°±æ˜¯ constructor çš„åŸå‹æ˜¯å¦åœ¨ obj çš„åŸå‹é“¾ä¸Šã€‚</p><p>ä¸‹é¢çš„æµ‹è¯•ç»“æœè¡¨æ˜ instanceof ä¸èƒ½ç”¨äºåˆ¤æ–­åŸºæœ¬ç±»å‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="number">1</span> <span class="keyword">instanceof</span> <span class="built_in">Number</span>); <span class="comment">// =&gt; false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Symbol</span>() <span class="keyword">instanceof</span> <span class="built_in">Symbol</span>); <span class="comment">// =&gt; false</span></span><br><span class="line"><span class="built_in">console</span>.log(BigInt(<span class="number">5</span>) <span class="keyword">instanceof</span> BigInt); <span class="comment">// =&gt; false</span></span><br></pre></td></tr></table></figure><p>ç°åœ¨æˆ‘ä»¬æ¥å®Œå–„ä¸€ä¸‹ä¹‹å‰çš„ isNumber å‡½æ•°:</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isNumber</span>(<span class="params">val</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">typeof</span> val === <span class="string">'number'</span> || val <span class="keyword">instanceof</span> <span class="built_in">Number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(isNumber(<span class="string">'123'</span>)); <span class="comment">// =&gt; false</span></span><br><span class="line"><span class="built_in">console</span>.log(isNumber(<span class="literal">true</span>)); <span class="comment">// =&gt; false</span></span><br><span class="line"><span class="built_in">console</span>.log(isNumber(<span class="literal">null</span>)); <span class="comment">// =&gt; false</span></span><br><span class="line"><span class="built_in">console</span>.log(isNumber(&#123;&#125;)); <span class="comment">// =&gt; false</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(isNumber(<span class="number">1</span>)); <span class="comment">// =&gt; true</span></span><br><span class="line"><span class="built_in">console</span>.log(isNumber(<span class="built_in">Object</span>(<span class="number">1</span>))); <span class="comment">// =&gt; true</span></span><br><span class="line"><span class="built_in">console</span>.log(isNumber(<span class="keyword">new</span> <span class="built_in">Number</span>(<span class="number">555</span>))); <span class="comment">// =&gt; true</span></span><br></pre></td></tr></table></figure><p>æµ‹è¯•æˆåŠŸã€‚</p><h3 id="Object-prototype-toString"><a href="#Object-prototype-toString" class="headerlink" title="Object.prototype.toString"></a>Object.prototype.toString</h3><p>æˆ‘ä»¬çœ‹çœ‹ lodash å®ƒçš„ isNumber æ˜¯æ€ä¹ˆå®ç°çš„ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isNumber</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">typeof</span> value === <span class="string">'number'</span> || (isObjectLike(value) &amp;&amp; getTag(value) == <span class="string">'[object Number]'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†è´´ä¸€ä¸‹ isObjectLike å’Œ getTag çš„æºç ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isObjectLike</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">typeof</span> value === <span class="string">'object'</span> &amp;&amp; value !== <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> toString = <span class="built_in">Object</span>.prototype.toString;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getTag</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (value == <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> value === <span class="literal">undefined</span> ? <span class="string">'[object Undefined]'</span> : <span class="string">'[object Null]'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> toString.call(value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾ˆå¥½ç†è§£ï¼Œ isObjectLike å°±æ˜¯åˆ¤æ–­ä¸€ä¸ªå˜é‡æ˜¯å¦æ˜¯éå‡½æ•°å¯¹è±¡ï¼ŒgetTag å°±æ˜¯å°è£…äº†ä¸€ä¸‹ Object.prototype.toStringï¼Œè®©å®ƒä¹Ÿèƒ½å¤„ç† value ç­‰äº undefined æˆ–è€… null çš„æ—¶å€™ã€‚</p><p>é‚£ä¹ˆ Object.prototype.toString æ˜¯å¹²å˜›ç”¨çš„å‘¢ï¼Œçœ‹å‡ ä¸ªæµ‹è¯•ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> toString = <span class="built_in">Object</span>.prototype.toString;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(toString.call(<span class="number">1</span>)); <span class="comment">// =&gt; [object Number]</span></span><br><span class="line"><span class="built_in">console</span>.log(toString.call(<span class="literal">true</span>)); <span class="comment">// =&gt; [object Boolean]</span></span><br><span class="line"><span class="built_in">console</span>.log(toString.call(<span class="literal">null</span>)); <span class="comment">// =&gt; [object Null]</span></span><br><span class="line"><span class="built_in">console</span>.log(toString.call(<span class="literal">undefined</span>)); <span class="comment">// =&gt; [object Undefined]</span></span><br><span class="line"><span class="built_in">console</span>.log(toString.call(&#123;&#125;)); <span class="comment">// =&gt; [object Object]</span></span><br><span class="line"><span class="built_in">console</span>.log(toString.call(<span class="keyword">new</span> <span class="built_in">Date</span>())); <span class="comment">// =&gt; [object Date]</span></span><br><span class="line"><span class="built_in">console</span>.log(toString.call(<span class="regexp">/e/</span>)); <span class="comment">// =&gt; [object RegExp]</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Foo</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="built_in">console</span>.log(toString.call(<span class="keyword">new</span> Foo())); <span class="comment">// =&gt; [object Object]</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Bar</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>[<span class="built_in">Symbol</span>.toStringTag] = <span class="string">'è‡ªå®šä¹‰çš„ tag'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(toString.call(<span class="keyword">new</span> Bar())); <span class="comment">// =&gt; [object è‡ªå®šä¹‰çš„ tag]</span></span><br></pre></td></tr></table></figure><p>ä¸€èˆ¬æ¥è¯´æ‰€æœ‰çš„å¯¹è±¡çš„åŸå‹é“¾å¾€ä¸Šè¿½æº¯æœ€åéƒ½ä¼šåˆ° Object.prototypeï¼Œæ‰€ä»¥ä½ å¯ä»¥åœ¨ä»»æ„å¯¹è±¡ä¸Šè°ƒç”¨ toString æ–¹æ³•ã€‚ä¸ºä»€ä¹ˆ lodash åœ¨ getTage ä¸­è¿˜ç‰¹æ„å¤„ç†äº†ä¸‹ value æ˜¯ null æˆ–è€… undefined çš„æƒ…å†µå‘¢ï¼Ÿå‚è€ƒ <span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvT2JqZWN0L3RvU3RyaW5n" title="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/toString">MDN<i class="fa fa-external-link"></i></span> çš„è¯´æ˜ï¼š</p><blockquote><p><strong>Note:</strong> Starting in JavaScript 1.8.5, <code>toString()</code> called on <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/null" target="_blank" rel="noopener"><code>null</code></a> returns <code>[object Null]</code>, and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/undefined" target="_blank" rel="noopener"><code>undefined</code></a> returns <code>[object Undefined]</code>, as defined in the 5th Edition of ECMAScript and subsequent Errata.</p><p>See <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/toString#Using_toString_to_detect_object_class" target="_blank" rel="noopener">Using <code>toString()</code> to detect object class</a>.</p></blockquote><p>ä¹Ÿå°±æ˜¯è¯´åœ¨æ—©æœŸç‰ˆæœ¬çš„ js ä¸­ toString.call(null) ä¸ä¼šè¿”å› <code>[object Null]</code>ã€‚æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ Symbol.toStringTag å±æ€§æ¥å®šä¹‰å¯¹è±¡çš„ stringTagã€‚ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸ç›´æ¥æ‹¿å˜é‡çš„ toString å‡½æ•°è¿”å›å€¼å»æ¯”è¾ƒè€Œæ˜¯è¦ç”¨ Object.prototype.toString.call(value) å»ç»‘å®šå¯¹è±¡åŸå‹çš„ toString å‡½æ•°çš„ this åˆ°å˜é‡ä¸Šï¼Œè¿™æ ·æ¥è·å– stringTag å‘¢ï¼ŸåŸå› å…¶å®å¾ˆç®€å•ï¼Œä¸€æ–¹é¢å¤§å¤šæ•°ç±»å‹éƒ½é‡å†™äº†è‡ªå·±çš„ tostring å‡½æ•°ï¼Œä¾‹å¦‚ Date è¿”å›çš„å°±æ˜¯æœ¬åœ°æ—¶é—´å­—ç¬¦ä¸²è€Œä¸æ˜¯ [object Date]ï¼Œå¦ä¸€æ–¹é¢æ˜¯å› ä¸ºç›´æ¥å¯¹ null æˆ– undefined è°ƒç”¨ toString ä¼šæŠ¥é”™ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(&#123;&#125;.toString()); <span class="comment">// =&gt; [object Object]</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">new</span> <span class="built_in">Date</span>().toString()); <span class="comment">// =&gt; Wed Jan 15 2020 16:03:59 GMT+0800 (GMT+08:00)</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="regexp">/e/</span>).toString()); <span class="comment">// =&gt; /e/</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="literal">null</span>.toString()); <span class="comment">// Cannot read property 'toString' of null</span></span><br></pre></td></tr></table></figure><p>ç°åœ¨å†æ¥çœ‹ lodash å®ç°çš„ isNumber å°±å¾ˆå¥½ç†è§£äº†ï¼Œå°±æ˜¯å…ˆç”¨ typeof æ¥åˆ¤æ–­æ˜¯ä¸æ˜¯ number ç±»å‹ï¼Œå†ç”¨ isObjectLike å’Œ getTag åˆ¤æ–­æ˜¯ä¸æ˜¯ number å¯¹è±¡ã€‚</p><h3 id="æ¯”è¾ƒæ„é€ å™¨"><a href="#æ¯”è¾ƒæ„é€ å™¨" class="headerlink" title="æ¯”è¾ƒæ„é€ å™¨"></a>æ¯”è¾ƒæ„é€ å™¨</h3><p><strong>é€šè¿‡ç›´æ¥æ¯”è¾ƒå¯¹è±¡å¾—æ„é€ å™¨æ˜¯ä¸æ˜¯ç­‰äºæŸä¸ªæ„é€ å™¨ä¹Ÿå¯ä»¥ç”¨æ¥åšç±»å‹åˆ¤æ–­ï¼Œ</strong>ç¬”è€…å‰ä¸ä¹…åœ¨çœ‹ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RqL2NvL2Jsb2IvbWFzdGVyL2luZGV4Lmpz" title="https://github.com/tj/co/blob/master/index.js">co<i class="fa fa-external-link"></i></span> æºç çš„æ—¶å€™çœ‹åˆ°å®ƒå®šä¹‰äº†å¥½å‡ ä¸ªç±»å‹åˆ¤æ–­å‡½æ•°ï¼Œå…ˆæ¥çœ‹ä¸€ä¸ªç®€å•ç‚¹çš„ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isObject</span>(<span class="params">val</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Object</span> == val.constructor;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå…¶å®æ˜¯ç”¨æ¥åˆ¤æ–­ val æ˜¯ä¸æ˜¯çº¯å¯¹è±¡çš„ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨å¯¹è±¡å­—é¢é‡å’Œ new Object() æ„é€ çš„å®ä¾‹ã€‚å…¶å®å•ç‹¬å•ç‹¬çœ‹è¿™ä¸ªå‡½æ•°æ˜¯è®¾è®¡çš„æœ‰é—®é¢˜çš„ï¼Œå½“ val æ˜¯ undefined æˆ– null å°±ä¼šå‡ºé”™ã€‚ä½†æ˜¯è¿™åªæ˜¯æˆ‘æ‘˜å¾—éƒ¨åˆ†ä»£ç ï¼ŒçœŸæ­£æºç ä¸Šä¸‹æ–‡ï¼Œè¿™ä¸ª val æ˜¯ä¸ä¼šç­‰äº null æˆ– undefined çš„ï¼Œå¸Œæœ›è¯»è€…ä¸è¦è¯¯è§£ã€‚</p><h3 id="æ¯”è¾ƒå¯¹è±¡çš„å±æ€§"><a href="#æ¯”è¾ƒå¯¹è±¡çš„å±æ€§" class="headerlink" title="æ¯”è¾ƒå¯¹è±¡çš„å±æ€§"></a>æ¯”è¾ƒå¯¹è±¡çš„å±æ€§</h3><p>å†æ¥çœ‹ co æºç ä¸­å¦å¤–ä¸¤ä¸ªä¸ªç¨å¾®å¤æ‚çš„ç±»å‹åˆ¤æ–­ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isGenerator</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'function'</span> == <span class="keyword">typeof</span> obj.next &amp;&amp; <span class="string">'function'</span> == <span class="keyword">typeof</span> obj.throw;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isGeneratorFunction</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> <span class="keyword">constructor</span> = obj.<span class="keyword">constructor</span>;</span><br><span class="line">  if (!<span class="keyword">constructor</span>) return false;</span><br><span class="line">  if ('GeneratorFunction' === <span class="keyword">constructor</span>.name || 'GeneratorFunction' === <span class="keyword">constructor</span>.displayName) return true;</span><br><span class="line">  return isGenerator(<span class="keyword">constructor</span>.prototype);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…ˆçœ‹ç¬¬ä¸€ä¸ªå‡½æ•°ï¼Œåˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯ç”Ÿæˆå™¨å¯¹è±¡ï¼Œç”Ÿæˆå™¨æˆ‘ä»¬çŸ¥é“ï¼Œç”Ÿæˆå™¨å‡½æ•°è¿”å›çš„å¯¹è±¡å°±æ˜¯ç”Ÿæˆå™¨å¯¹è±¡ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">gen</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> genObj = gen();</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> genObj.next); <span class="comment">// =&gt; function</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> genObj.throw); <span class="comment">// =&gt; function</span></span><br></pre></td></tr></table></figure><p>ç”±äºç”Ÿæˆå™¨å¯¹è±¡éƒ½æœ‰ next å’Œ throw å‡½æ•°ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ ¹æ®è¿™ç‚¹æ¥åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯ä¸æ˜¯ç”Ÿæˆå™¨å¯¹è±¡ã€‚ç±»ä¼¼çš„åº”ç”¨åƒæ˜¯åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯ä¸æ˜¯ promiseï¼Œå¯ä»¥ç®€å•ä½¿ç”¨æœ‰æ²¡æœ‰ then å‡½æ•°æ¥åˆ¤æ–­ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isPromise</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'function'</span> == <span class="keyword">typeof</span> obj.then;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ç€å†çœ‹çœ‹ç¬¬äºŒä¸ªå‡½æ•° isGeneratorFunctionï¼Œçœ‹åå­—å°±çŸ¥é“æ˜¯ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯ä¸æ˜¯ç”Ÿæˆå™¨å‡½æ•°ï¼Œå…¶å®ä¹Ÿæ˜¯<strong>åˆ©ç”¨å¯¹è±¡ç‰¹æœ‰å±æ€§æ¥åˆ¤æ–­ç±»å‹</strong>ã€‚æˆ‘ä»¬çŸ¥é“æ„é€ å™¨éƒ½æ˜¯å‡½æ•°ï¼Œç„¶åå‡½æ•°æœ‰ name å±æ€§å’Œ displayName å±æ€§ï¼Œå¯¹äºç”Ÿæˆå™¨å‡½æ•°æ¥è¯´ï¼Œç”Ÿæˆå™¨å‡½æ•°çš„ name å›ºå®šæ˜¯ <code>GeneratorFunction</code>ã€‚displayName æ˜¯ä¸€ä¸ªéæ ‡å‡†å±æ€§ï¼Œè¿™ä¸ªå±æ€§è¡¨ç¤ºè®¾è®¡è€…å¯¹äºå‡½æ•°åçš„å®šä¹‰ã€‚æ‰€ä»¥è¿™é‡Œå°±æ˜¯ç®€å•åˆ¤æ–­äº†ä¼ å…¥çš„å¯¹è±¡çš„æ„é€ å™¨çš„åç§°æ˜¯å¦æ˜¯ <code>GeneratorFunction</code>ï¼Œå¦‚æœä¸æ˜¯å†åˆ¤æ–­å®ƒçš„åŸå‹æ˜¯ä¸æ˜¯ç”Ÿæˆå™¨å¯¹è±¡ï¼Œä¸è¿‡æˆ‘ä¹Ÿæ²¡ææ˜ç™½æœ€åä¸ºä»€ä¹ˆè¦æœ‰æœ€åè¿™ä¸ªåˆ¤æ–­ã€‚</p><p><img data-src="https://i.loli.net/2020/01/15/iyn6XPecHkhBOzJ.png" alt="isGeneratorFunction"></p><h3 id="åŸç”Ÿ-API"><a href="#åŸç”Ÿ-API" class="headerlink" title="åŸç”Ÿ API"></a>åŸç”Ÿ API</h3><p>å…³äºç±»å‹åˆ¤æ–­ï¼Œé¢è¯•å¸¸é—®çš„é™¤äº† NaNï¼Œè¿˜æœ‰å°±æ˜¯æ•°ç»„å¦‚ä½•åˆ¤æ–­ã€‚å…¶å® JS æœ¬èº«å°±è‡ªå¸¦äº†ä¸€äº›ç±»å‹åˆ¤æ–­ APIï¼Œåˆ¤æ–­æ•°ç»„å¯ä»¥ç›´æ¥ç”¨ Array.isArrayï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Array</span>.isArray(&#123; <span class="attr">length</span>: <span class="number">6</span> &#125;)); <span class="comment">// false</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">Array</span>.isArray(<span class="built_in">arguments</span>)); <span class="comment">// false</span></span><br><span class="line">&#125;</span><br><span class="line">test(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Array</span>.isArray([])); <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p>ç›¸å¯¹äºæµè§ˆå™¨ç¯å¢ƒï¼Œnode çš„ <code>util</code> æ¨¡å—çœŸçš„æ˜¯è´´å¿ƒå¤šäº†ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; types &#125; = <span class="built_in">require</span>(<span class="string">"util"</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(types.isPromise(<span class="built_in">Promise</span>.resolve()));</span><br><span class="line"><span class="built_in">console</span>.log(types.isProxy(<span class="keyword">new</span> <span class="built_in">Proxy</span>(&#123;&#125;, &#123;&#125;)));</span><br><span class="line"><span class="built_in">console</span>.log(types.isGeneratorFunction(<span class="function"><span class="keyword">function</span>*(<span class="params"></span>)</span>&#123;&#125;));</span><br><span class="line"><span class="built_in">console</span>.log(types.isGeneratorObject(<span class="function"><span class="keyword">function</span>*(<span class="params"></span>)</span>&#123;&#125;()));</span><br><span class="line"><span class="built_in">console</span>.log(types.isDate(<span class="keyword">new</span> <span class="built_in">Date</span>()));</span><br><span class="line"><span class="built_in">console</span>.log(types.isSet(<span class="keyword">new</span> <span class="built_in">Set</span>()));</span><br><span class="line"><span class="built_in">console</span>.log(types.isMap(<span class="keyword">new</span> <span class="built_in">Map</span>()));</span><br><span class="line"><span class="built_in">console</span>.log(types.isRegExp(<span class="regexp">/exp/</span>));</span><br><span class="line">...</span><br><span class="line"><span class="comment">// ä»¥ä¸Šå…¨éƒ¨è¿”å› trueï¼Œå¹¶ä¸”éƒ½æ˜¯ node V10 æ–°å¢çš„</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œæä¸€ä¸‹æˆ‘ä¹‹å‰åœ¨ä½¿ç”¨ babel è½¬ç  node ä»£ç å‘ç°çš„ä¸€ä¸ª bugï¼Œå°±æ˜¯ <code>util.types.isGeneratorFunction</code> æ–¹æ³•åœ¨ babel è½¬ç ä¹‹ååˆ¤æ–­æœ‰é—®é¢˜ï¼š</p><p><img data-src="https://i.loli.net/2020/01/15/VbPUtD4epTl2arK.png" alt="babel-node-bug"></p><p>å¯ä»¥çœ‹åˆ° bebug æ§åˆ¶å°è¾“å‡ºçš„æ˜¯ falseã€‚</p><h3 id="ç›´æ¥æ¯”è¾ƒå€¼æ˜¯å¦ç­‰äºä½ è¦åˆ¤æ–­çš„å€¼"><a href="#ç›´æ¥æ¯”è¾ƒå€¼æ˜¯å¦ç­‰äºä½ è¦åˆ¤æ–­çš„å€¼" class="headerlink" title="ç›´æ¥æ¯”è¾ƒå€¼æ˜¯å¦ç­‰äºä½ è¦åˆ¤æ–­çš„å€¼"></a>ç›´æ¥æ¯”è¾ƒå€¼æ˜¯å¦ç­‰äºä½ è¦åˆ¤æ–­çš„å€¼</h3><p>è¿™ä¸ªå¾ˆå¥½ç†è§£ï¼Œä¾‹å¦‚åˆ¤æ–­ null å’Œ undefinedï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨è¿™ç§æ–¹å¼ï¼Œçœ‹ä¸€ä¸‹ lodash çš„ isObjectï¼Œå°±æ˜¯åˆ¤æ–­ä¸ç­‰äº null ä¸” typeof è¿”å›çš„æ˜¯<code>&#39;object&#39;</code> æˆ–è€… <code>â€˜functionâ€™</code>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isObject</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> type = <span class="keyword">typeof</span> value;</span><br><span class="line">  <span class="keyword">return</span> value != <span class="literal">null</span> &amp;&amp; (type === <span class="string">'object'</span> || type === <span class="string">'function'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ¬æ–‡çš„å†…å®¹å°±è¿™ä¹ˆå¤šï¼Œæœ€è¿‘å†™äº†ä¸¤ä¸ª VSCode æ’ä»¶ï¼š[<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RqeDY2Ni92aWV3LWdpdGh1Yi1yZXBvc2l0b3J5" title="https://github.com/tjx666/view-github-repository">view-github-repository<i class="fa fa-external-link"></i></span>] å’Œ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RqeDY2Ni9vcGVuLWluLWV4dGVybmFsLWFwcA==" title="https://github.com/tjx666/open-in-external-app">open-in-external-app<i class="fa fa-external-link"></i></span>ï¼Œä»¥åŠå‡ ä¸ªæ¨¡æ¿é¡¹ç›®ï¼š<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RqeDY2Ni9hd2Vzb21lLWNocm9tZS1leHRlbnNpb24tYm9pbGVycGxhdGU=" title="https://github.com/tjx666/awesome-chrome-extension-boilerplate">awesome-chrome-extension-boilerplate<i class="fa fa-external-link"></i></span>, <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RqeDY2Ni92c2NvZGUtZXh0ZW5zaW9uLWJvaWxlcnBsYXRl" title="https://github.com/tjx666/vscode-extension-boilerplate">vscode-extension-boilerplate<i class="fa fa-external-link"></i></span> å’Œ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RqeDY2Ni9rb2EtcmVzdGZ1bC1ib2lsZXJwbGF0ZQ==" title="https://github.com/tjx666/koa-restful-boilerplate">koa-restful-boilerplate<i class="fa fa-external-link"></i></span>ã€‚æ„Ÿå…´è¶£ä¸å¦¨å»<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RqeDY2Ng==" title="https://github.com/tjx666">æˆ‘çš„ github ä¸»é¡µ<i class="fa fa-external-link"></i></span>é€›é€›ã€‚</p><p>æœ€åï¼Œå¿«è¿‡å¹´äº†ï¼Œç¥å¤§å®¶æ–°å¹´å¿«ä¹ï¼Œ2020 äº‹ä¸šæ›´ä¸Šä¸€å±‚æ¥¼ã€‚</p><p>æœ¬æ–‡ä¸ºåŸåˆ›å†…å®¹ï¼Œé¦–å‘äº<span class="exturl" data-url="aHR0cDovL3d3dy5seXJlYWw2NjYuY29t" title="http://www.lyreal666.com">ä¸ªäººåšå®¢<i class="fa fa-external-link"></i></span>ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>javascript</tag>
      </tags>
  </entry>
  <entry>
    <title>javascript åŸºç¡€ä¹‹ call, apply, bind</title>
    <url>/javascript-%E5%9F%BA%E7%A1%80%E4%B9%8B-call-apply-bind/</url>
    <content><![CDATA[<p>ç³»ç»Ÿï¼Œæ‰å®çš„ javascript è¯­è¨€åŸºç¡€æ˜¯ä¸€ä¸ªä¼˜ç§€çš„å‰ç«¯å·¥ç¨‹å¸ˆå¿…é¡»å…·å¤‡çš„ã€‚åœ¨çœ‹äº†ä¸€äº›å…³äº callï¼Œapplyï¼Œbind çš„æ–‡ç« åï¼Œæˆ‘è¿˜æ˜¯æ‰“ç®—å†™ä¸‹è¿™ç¯‡æ€»ç»“ï¼ŒåŸå› æœ‰å‡ ä¸ªã€‚é¦–å…ˆï¼Œåœ¨å¦‚ä»Š ES6 å¤§è¡Œå…¶é“çš„ä»Šå¤©ï¼Œå¾ˆå¤šæ–‡ç« ä¸­è®²è¿°çš„å®ƒä»¬çš„åº”ç”¨åœºæ™¯å…¶å®ç”¨ ES6 å¯ä»¥æ›´ä¼˜é›…çš„è§£å†³ï¼Œä½†æ˜¯åŸºæœ¬ä¸ŠÂ·æ²¡æœ‰æ–‡ç« ä¼šå»æ ES6 çš„è§£æ³•ã€‚å†åˆ™ï¼Œè®²å®ƒä»¬çš„å®ç°åŸç†çš„æ–‡ç« å…¶å®ä¸å°‘ï¼Œä½†æ˜¯æˆ–å¤šæˆ–å°‘å®ç°çš„æœ‰äº›ä¸å¤Ÿå®Œç¾ï¼Œæœ¬æ–‡å°†æŠŠå®ƒä»¬é€šè¿‡ä»£ç ä¸€ä¸€æ¯”è¾ƒå®Œç¾çš„å®ç°ï¼Œè®©å®ƒä»¬ä¸å†ç¥ç§˜ã€‚ä¸è°¦è™šçš„è¯´ï¼Œå…³äº callï¼Œapplyï¼Œbind çš„çŸ¥è¯†ï¼Œçœ‹è¿™ä¸€ç¯‡æ–‡ç« å°±å¤Ÿäº†ã€‚</p><a id="more"></a><h2 id="æ”¹å˜å‡½æ•°ä¸­-this-æŒ‡å‘çš„ä¸‰å…„å¼Ÿ"><a href="#æ”¹å˜å‡½æ•°ä¸­-this-æŒ‡å‘çš„ä¸‰å…„å¼Ÿ" class="headerlink" title="æ”¹å˜å‡½æ•°ä¸­ this æŒ‡å‘çš„ä¸‰å…„å¼Ÿ"></a>æ”¹å˜å‡½æ•°ä¸­ this æŒ‡å‘çš„ä¸‰å…„å¼Ÿ</h2><p>æˆ‘ä»¬çŸ¥é“åœ¨ javascript çš„ function ä¸­æœ‰ <code>this</code>ï¼Œ<code>arguments</code> ç­‰å…³é”®å­—ã€‚æœ¬æ–‡ä¸è®¨è®º this æŒ‡å‘é—®é¢˜ï¼Œé‚£ä¸ªéƒ½å¯ä»¥å•ç‹¬æ•´ä¸€ç¯‡æ–‡ç« äº†ã€‚ä¸€ä¸ªå¸¸è§çš„ä½¿ç”¨åœºæ™¯æ˜¯å½“ä½ ä½¿ç”¨ <code>.</code> æ¥è°ƒç”¨ä¸€ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œæ­¤æ—¶å‡½æ•°ä¸­ this æŒ‡å‘ <code>.</code> å‰é¢çš„è°ƒç”¨è€…ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> person = &#123;</span><br><span class="line">  name: <span class="string">'YuTengjing'</span>,</span><br><span class="line">  age: <span class="number">22</span>,</span><br><span class="line">  introduce() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`Hello everyone! My name is <span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span>. I'm <span class="subst">$&#123;<span class="keyword">this</span>.age&#125;</span> years old.`</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// this æ­¤æ—¶æŒ‡å‘ person</span></span><br><span class="line"><span class="built_in">console</span>.log(person.introduce()); <span class="comment">// =&gt; Hello everyone! My name is YuTengjing. I'm 22 years old.</span></span><br></pre></td></tr></table></figure><p>é€šè¿‡ callï¼Œapplyï¼Œbind è¿™ä¸‰å…„å¼Ÿå¯ä»¥æ”¹å˜ <code>introduce</code> ä¸­ this çš„æŒ‡å‘ã€‚</p><h3 id="call"><a href="#call" class="headerlink" title="call"></a><span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvRnVuY3Rpb24vY2FsbA==" title="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/call">call<i class="fa fa-external-link"></i></span></h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> myFriend = &#123;</span><br><span class="line">  name: <span class="string">'dongdong'</span>,</span><br><span class="line">  age: <span class="number">21</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(person.introduce.call(myFriend)); <span class="comment">// =&gt; Hello everyone! My name is dongdong. I'm 21 years old.</span></span><br></pre></td></tr></table></figure><p>é€šè¿‡ä¸Šé¢ä»£ç æˆ‘ä»¬å¯ä»¥çœ‹å‡º <code>introduce</code> è¿™ä¸ªå‡½æ•°ä¸­çš„ this æŒ‡å‘è¢«æ”¹æˆäº† myFriendã€‚Function.prototype.call çš„å‡½æ•°ç­¾åæ˜¯ <code>fun.call(thisArg, arg1, arg2, ...)</code>ã€‚ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºè°ƒç”¨å‡½æ•°æ—¶ this çš„æŒ‡å‘ï¼Œéšåçš„å‚æ•°åˆ™ä½œä¸ºå‡½æ•°çš„å‚æ•°å¹¶è°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯ fn(arg1, arg2, â€¦)ã€‚</p><h3 id="apply"><a href="#apply" class="headerlink" title="apply"></a><span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvRnVuY3Rpb24vYXBwbHk=" title="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/apply">apply<i class="fa fa-external-link"></i></span></h3><p>apply å’Œ call çš„åŒºåˆ«åªæœ‰ä¸€ä¸ªï¼Œå°±æ˜¯å®ƒåªæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œè€Œä¸”ç¬¬äºŒä¸ªå‚æ•°ä¸ºè°ƒç”¨å‡½æ•°æ—¶çš„å‚æ•°æ„æˆçš„æ•°ç»„ã€‚å‡½æ•°ç­¾åï¼š<code>func.apply(thisArg, [argsArray])</code>ã€‚å¦‚æœä¸ç”¨ç»™å‡½æ•°ä¼ å‚æ•°ï¼Œé‚£ä¹ˆä»–ä¿©å°±å…¶å®æ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œéœ€è¦ä¼ å‚æ•°çš„æ—¶å€™æ³¨æ„å®ƒçš„åº”è¯¥å°†å‚æ•°è½¬æ¢æˆæ•°ç»„å½¢å¼ã€‚</p><p>ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">displayHobbies</span>(<span class="params">...hobbies</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span> likes <span class="subst">$&#123;hobbies.join(<span class="string">', '</span>)&#125;</span>.`</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸‹é¢ä¸¤ä¸ªç­‰ä»·</span></span><br><span class="line">displayHobbies.call(&#123; <span class="attr">name</span>: <span class="string">'Bob'</span> &#125;, <span class="string">'swimming'</span>, <span class="string">'basketball'</span>, <span class="string">'anime'</span>); <span class="comment">// =&gt; // =&gt; Bob likes swimming, basketball, anime.</span></span><br><span class="line">displayHobbies.apply(&#123; <span class="attr">name</span>: <span class="string">'Bob'</span> &#125;, [<span class="string">'swimming'</span>, <span class="string">'basketball'</span>, <span class="string">'anime'</span>]); <span class="comment">// =&gt; Bob likes swimming, basketball, anime.</span></span><br></pre></td></tr></table></figure><p>æœ‰äº› API æ¯”å¦‚ Math.max å®ƒçš„å‚æ•°ä¸ºå¤šå‚æ•°ï¼Œå½“æˆ‘ä»¬æœ‰å¤šå‚æ•°æ„æˆçš„æ•°ç»„ä½¿æˆ–è€…è¯´å‚æ•°å¾ˆå¤šæ—¶è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Math.max å‚æ•°ä¸ºå¤šå‚æ•°</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.max(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)); <span class="comment">// =&gt; 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç°åœ¨å·²çŸ¥ä¸€ä¸ªå¾ˆå¤§çš„å…ƒç´ ä¸ºéšæœºå¤§å°çš„æ•´æ•°æ•°ç»„</span></span><br><span class="line"><span class="keyword">const</span> bigRandomArray = [...Array(<span class="number">10000</span>).keys()].map(<span class="function"><span class="params">num</span> =&gt;</span> <span class="built_in">Math</span>.trunc(num * <span class="built_in">Math</span>.random()));</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ€æ ·ä½¿ç”¨ Math.max è·å– bigRandomArray ä¸­çš„æœ€å¤§å€¼å‘¢ï¼ŸMath.max æ¥å—çš„æ˜¯å¤šå‚æ•°è€Œä¸æ˜¯æ•°ç»„å‚æ•°å•Š!</span></span><br><span class="line"><span class="comment">// æ€è€ƒä¸‹é¢çš„å†™æ³•</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.max.apply(<span class="literal">null</span>, bigRandomArray)); <span class="comment">// =&gt; 9936</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥ä¸Š ES6 çš„è¯å°±ç®€å•äº†ï¼Œä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦å³å¯ï¼Œä¼˜é›…ç®€æ´ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Math</span>.max(...bigRandomArray));</span><br></pre></td></tr></table></figure><h3 id="bind"><a href="#bind" class="headerlink" title="bind"></a><span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvRnVuY3Rpb24vYmluZA==" title="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/bind">bind<i class="fa fa-external-link"></i></span></h3><p>bind å’Œä¸Šé¢ä¸¤ä¸ªç”¨é€”å·®åˆ«è¿˜æ˜¯æ¯”è¾ƒå¤§ï¼Œå¦‚åŒå­—é¢æ„æ€ï¼ˆç»‘å®šï¼‰ï¼Œæ˜¯ç”¨æ¥ç»‘å®š this æŒ‡å‘çš„ï¼Œè¿”å›ä¸€ä¸ªåŸå‡½æ•°è¢«ç»‘å®š this åçš„æ–°å‡½æ•°ã€‚ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> person = &#123;</span><br><span class="line">  name: <span class="string">'YuTengjing'</span>,</span><br><span class="line">  age: <span class="number">22</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">introduce</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`Hello everyone! My name is <span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span>. I'm <span class="subst">$&#123;<span class="keyword">this</span>.age&#125;</span> years old.`</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> myFriend = &#123; <span class="attr">name</span>: <span class="string">'dongdong'</span>, <span class="attr">age</span>: <span class="number">21</span> &#125;;</span><br><span class="line">person.introduce = introduce.bind(myFriend);</span><br><span class="line"></span><br><span class="line"><span class="comment">// person.introduce çš„ this å·²ç»è¢«ç»‘å®šåˆ° myFriend ä¸Šäº†</span></span><br><span class="line"><span class="built_in">console</span>.log(person.introduce()); <span class="comment">// =&gt; Hello everyone! My name is dongdong. I'm 21 years old.</span></span><br><span class="line"><span class="built_in">console</span>.log(person.introduce.call(person)); <span class="comment">// =&gt; Hello everyone! My name is dongdong. I'm 21 years old.</span></span><br></pre></td></tr></table></figure><p>bind çš„å‡½æ•°ç­¾åæ˜¯ <code>func.bind(thisArg, arg1, arg2, ...)</code>ã€‚æ˜¥æ‹›çš„æ—¶å€™è¢«é—®è¿‡ bind çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯å¹²å˜›ç”¨çš„ï¼Œå› ä¸ºæˆ‘ä¹‹å‰å†™ä»£ç æœ¬èº«ä¸æ€ä¹ˆç”¨è¿™å‡ ä¸ª APIï¼Œç”¨çš„æ—¶å€™æˆ‘ä¹Ÿåªç”¨ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œæ‰€ä»¥å½“æ—¶é¢è¯•çš„æ—¶å€™è¢«é—®è¿™ä¸ªé—®é¢˜çš„æ—¶å€™æˆ‘è¿˜æ˜¯æ„£äº†ä¸€ä¸‹ã€‚ä¸è¿‡å…¶å®å¦‚æœå¯ä»¥ä¼ å¤šä¸ªå‚æ•°çš„è¯ï¼ŒçŒœä¹Ÿèƒ½çŒœå¾—å‡ºæ¥æ˜¯å¹²å˜›ç”¨çš„ï¼Œæˆ‘å½“æ—¶å°±çŒœå¯¹äº† Ï†(*ï¿£ 0 ï¿£)ã€‚</p><h2 id="å­¦ä»¥è‡´ç”¨"><a href="#å­¦ä»¥è‡´ç”¨" class="headerlink" title="å­¦ä»¥è‡´ç”¨"></a>å­¦ä»¥è‡´ç”¨</h2><p>æˆ‘ä»¬å­¦ä¹ çŸ¥è¯†çš„æ—¶å€™ä¸èƒ½åªæ˜¯åœç•™åœ¨ç†è§£å±‚é¢ï¼Œéœ€è¦å»æ€è€ƒå®ƒä»¬æœ‰ä»€ä¹ˆç”¨ï¼Œåº”ç”¨åœºæ™¯æœ‰å“ªäº›ã€‚è¿™æ ·çš„è¯ï¼Œå½“ä½ å¤„åœ¨è¿™ç§åœºæ™¯ä¸­ï¼Œä½ å°±èƒ½å¾ˆè‡ªç„¶çš„æƒ³å‡ºè§£å†³æ–¹æ¡ˆã€‚</p><h3 id="å¤šå‚å‡½æ•°è½¬æ¢ä¸ºå•ä¸ªæ•°ç»„å‚æ•°è°ƒç”¨"><a href="#å¤šå‚å‡½æ•°è½¬æ¢ä¸ºå•ä¸ªæ•°ç»„å‚æ•°è°ƒç”¨" class="headerlink" title="å¤šå‚å‡½æ•°è½¬æ¢ä¸ºå•ä¸ªæ•°ç»„å‚æ•°è°ƒç”¨"></a>å¤šå‚å‡½æ•°è½¬æ¢ä¸ºå•ä¸ªæ•°ç»„å‚æ•°è°ƒç”¨</h3><p>javascript ä¸­æœ‰å¾ˆå¤š API æ˜¯æ¥å—å¤šä¸ªå‚æ•°çš„æ¯”å¦‚ä¹‹å‰æè¿‡çš„ Math.maxï¼Œè¿˜æœ‰å¾ˆå¤šä¾‹å¦‚ Math.minï¼ŒArray.prototype.push ç­‰å®ƒä»¬éƒ½æ˜¯æ¥å—å¤šä¸ªå‚æ•°çš„ APIï¼Œä½†æ˜¯æœ‰æ—¶å€™æˆ‘ä»¬åªæœ‰å¤šä¸ªå‚æ•°æ„æˆçš„æ•°ç»„ï¼Œè€Œä¸”å¯èƒ½è¿˜ç‰¹åˆ«å¤§ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥åˆ©ç”¨ apply å·§å¦™çš„æ¥è½¬æ¢ã€‚</p><p>ä¸‹é¢æ˜¯åˆ©ç”¨ apply æ¥å·§å¦™çš„åˆå¹¶æ•°ç»„ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> arr1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> arr2 = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">Array</span>.prototype.push.apply(arr1, arr2);</span><br><span class="line"><span class="built_in">console</span>.log(arr1); <span class="comment">// [1, 2, 3, 4, 5, 6]</span></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯ï¼Œå…¶å®ç”¨ ES6 å¯ä»¥éå¸¸çš„ç®€æ´ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">arr1.push(...arr2);</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥ï¼Œå¿˜äº†è¿™ç§ç”¨æ³•å§ï¼ˆï¿£ï¸¶ï¿£ï¼‰â†— ã€€ã€‚</p><h3 id="å°†ç±»æ•°ç»„è½¬æ¢ä¸ºæ•°ç»„"><a href="#å°†ç±»æ•°ç»„è½¬æ¢ä¸ºæ•°ç»„" class="headerlink" title="å°†ç±»æ•°ç»„è½¬æ¢ä¸ºæ•°ç»„"></a>å°†<span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9XZWIvSmF2YVNjcmlwdC9UeXBlZF9hcnJheXM=" title="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Typed_arrays">ç±»æ•°ç»„<i class="fa fa-external-link"></i></span>è½¬æ¢ä¸ºæ•°ç»„</h3><p>JavaScript ç±»å‹åŒ–æ•°ç»„æ˜¯ä¸€ç§ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œå®ƒä»¬æœ‰æ•°ç»„çš„ä¸€äº›å±æ€§ï¼Œä½†æ˜¯å¦‚æœä½ ç”¨ Array.isArray() å»æµ‹è¯•ä¼šè¿”å› falseï¼Œå¸¸è§çš„åƒ argumentsï¼ŒNodeList ç­‰ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">testArrayLike</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// æœ‰ length å±æ€§æ²¡æœ‰ slice å±æ€§</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">arguments</span>.length); <span class="comment">// =&gt; 3</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">arguments</span>.slice); <span class="comment">// =&gt; undefined</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// ç±»æ•°ç»„ä¸æ˜¯æ•°ç»„</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">Array</span>.isArray(<span class="built_in">arguments</span>)); <span class="comment">// =&gt; false</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">arguments</span>); <span class="comment">// =&gt; &#123; [Iterator]  0: 'a', 1: 'b', 2: 'c', [Symbol(Symbol.iterator)]: [Î»: values] &#125;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> array = <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">Array</span>.isArray(array)); <span class="comment">// =&gt; true</span></span><br><span class="line">  <span class="built_in">console</span>.log(array); <span class="comment">// =&gt; [ 'a', 'b', 'c' ]</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">testArrayLike(<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>);</span><br></pre></td></tr></table></figure><p>å…¶å® æŠŠ slice æ¢æˆ concatï¼Œsplice ç­‰å…¶å®ƒ API ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚æ€è€ƒï¼š<strong>ä¸ºä»€ä¹ˆé€šè¿‡ Array.prototype.slice.call(arrayLike) å¯ä»¥è½¬æ¢ç±»æ•°ç»„ä¸ºæ•°ç»„ï¼Ÿ</strong></p><p>æˆ‘æ²¡æœ‰ç ”ç©¶è¿‡ slice çš„å…·ä½“å®ç°ï¼ŒçŒœæµ‹æ˜¯ä¸‹é¢è¿™æ ·çš„ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Array</span>.prototype.mySlice = <span class="function"><span class="keyword">function</span>(<span class="params">start = <span class="number">0</span>, end</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> array = <span class="keyword">this</span>;</span><br><span class="line">  <span class="keyword">const</span> end = end === <span class="literal">undefined</span> ? array.length : end;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> resultArray = [];</span><br><span class="line">  <span class="keyword">if</span> (array.length === <span class="number">0</span>) <span class="keyword">return</span> resultArray;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> index = start; index &lt; end; index++) &#123;</span><br><span class="line">    resultArray.push(array[index]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> resultArray;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æˆ‘æƒ³ slice å†…éƒ¨å®ç°å¯èƒ½å°±æ˜¯ä¼šåƒæˆ‘ä¸Šé¢çš„ä»£ç ä¸€æ ·åªéœ€è¦ä¸€ä¸ª length å±æ€§ï¼Œéå†å…ƒç´ è¿”å›æ–°æ•°ç»„ï¼Œæ‰€ä»¥è°ƒç”¨ slice æ—¶å°†å…¶ this æŒ‡å‘ç±»æ•°ç»„èƒ½æ­£å¸¸å·¥ä½œã€‚</p><p>å…¶å®ï¼Œè¿™ä¸ªç”¨æ³•ä¹Ÿå¯ä»¥å¿˜äº†ï¼Œç”¨ ES6 æ¥è½¬æ¢ä¸é€ å¤šç®€å•ï¼ŒES6 å¤§æ³•å¥½ ğŸ˜‚ã€‚</p><p>å¯ä»¥ä½¿ç”¨ Array.from(arrayLike)ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> array = <span class="built_in">Array</span>.from(<span class="built_in">arguments</span>);</span><br></pre></td></tr></table></figure><p>è¿˜å¯ä»¥ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> array = [...arguments];</span><br></pre></td></tr></table></figure><h3 id="ç»„åˆç»§æ‰¿"><a href="#ç»„åˆç»§æ‰¿" class="headerlink" title="ç»„åˆç»§æ‰¿"></a>ç»„åˆç»§æ‰¿</h3><p>ES6 class å‡ºç°ä¹‹å‰ï¼Œä¸ªäººè®¤ä¸ºæ¯”è¾ƒå®Œç¾çš„ç»§æ‰¿æ˜¯ä½¿ç”¨åŸå‹é“¾åŠ ç»„åˆçš„ç»§æ‰¿æ–¹å¼ï¼Œä»¥å‰ç ”ç©¶åŸå‹ç»§æ‰¿å†™çš„ä»£ç åœ¨è¿™ï¼š<a href="https://github.com/tjx666/javascript-code-lab/tree/master/src/prototypeExtends" target="_blank" rel="noopener"><strong>prototypeExtends</strong></a>ã€‚è¿™é‡Œä¸å±•å¼€è®² javascript çš„ç»§æ‰¿ï¼Œé‚£ä¼šåˆæ˜¯ä¸€ä¸ªå·¨å‘ã€‚</p><p>ç»„åˆç»§æ‰¿å…¶å®å¾ˆå¥½ç†è§£ï¼Œè¿™ä¸ªç»„åˆæŒ‡çš„æ˜¯å­ç±»çš„å®ä¾‹å±æ€§ç»„åˆäº†çˆ¶ç±»çš„å®ä¾‹å±æ€§ï¼Œçœ‹ä»£ç ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Animal</span>(<span class="params">type</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.type = type;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Bird</span>(<span class="params">type, color</span>) </span>&#123;</span><br><span class="line">  Animal.call(<span class="keyword">this</span>, type);</span><br><span class="line">  <span class="keyword">this</span>.color = color;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> bird = <span class="keyword">new</span> Bird(<span class="string">'bird'</span>, <span class="string">'green'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(bird); <span class="comment">// =&gt; Bird &#123; type: 'bird', color: 'green' &#125;</span></span><br></pre></td></tr></table></figure><p>ç»„åˆç»§æ‰¿æ ¸å¿ƒä»£ç å°±æ˜¯é‚£å¥ Animal.call(this, type)ï¼Œé€šè¿‡è°ƒç”¨çˆ¶ç±»æ„é€ å™¨å¹¶ä¿®æ”¹å…¶ this æŒ‡å‘ä¸ºå­ç±»å®ä¾‹æ¥è¾¾åˆ°å­ç±»å®ä¾‹ä¸Šç»„åˆçˆ¶ç±»çš„å®ä¾‹å±æ€§ç›®çš„ã€‚</p><h2 id="è‡ªå·±å®ç°-callï¼Œapplyï¼Œbind"><a href="#è‡ªå·±å®ç°-callï¼Œapplyï¼Œbind" class="headerlink" title="è‡ªå·±å®ç° callï¼Œapplyï¼Œbind"></a>è‡ªå·±å®ç° callï¼Œapplyï¼Œbind</h2><h3 id="call-1"><a href="#call-1" class="headerlink" title="call"></a>call</h3><p>å®ç° call ä¸»è¦æœ‰ä¸¤ç§æ€è·¯ï¼Œä¸€ç§æ˜¯é€šè¿‡åœ¨ thisArg ä¸Šä¸´æ—¶æ·»åŠ  funcï¼Œç„¶åç›´æ¥è°ƒç”¨ thisArg.func()ã€‚å¦å¤–ä¸€ç§æ˜¯åˆ©ç”¨ func.toString() æ›¿æ¢ this ä¸º thisArgï¼Œå† eval æ¥å®ç°ã€‚</p><h4 id="æ–¹å¼ä¸€"><a href="#æ–¹å¼ä¸€" class="headerlink" title="æ–¹å¼ä¸€"></a>æ–¹å¼ä¸€</h4><p>ä¸‹é¢è¿™ä¸ªç‰ˆæœ¬ä¸»è¦ä¸ºäº†è¯´æ˜æ€è·¯ï¼Œå…¶å®æ˜¯æœ‰å¾ˆå¤šç¼ºé™·çš„ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.myCall = <span class="function"><span class="keyword">function</span>(<span class="params">thisArg, ...args</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// è¿™é‡Œçš„ this å…¶å®å°±æ˜¯ func.myCall(thisArg, ...args) ä¸­çš„ funcï¼Œå› ä¸º myCall æ˜¯é€šè¿‡ func è°ƒç”¨çš„å˜›</span></span><br><span class="line">  <span class="keyword">const</span> func = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åœ¨ thisArg ä¸Šä¸´æ—¶ç»‘å®š func</span></span><br><span class="line">  thisArg.tempFunc = func;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// é€šè¿‡ thisArg è°ƒç”¨ func æ¥è¾¾åˆ°æ”¹å˜ this æŒ‡å‘çš„ä½œç”¨</span></span><br><span class="line">  <span class="keyword">const</span> result = thisArg.tempFunc(...args);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆ é™¤ä¸´æ—¶å±æ€§</span></span><br><span class="line">  <span class="keyword">delete</span> thisArg.tempFunc;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printName</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(printName.myCall(&#123; <span class="attr">name</span>: <span class="string">'ly'</span> &#125;)); <span class="comment">// =&gt; ly</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç ä¸­æœ‰ä¸€äº›ç¼ºé™·ï¼š</p><ol><li><p>myCall çš„ç¬¬ä¸€ä¸ªå‚æ•°å¯èƒ½è¢«ä¼ å…¥éå¯¹è±¡å‚æ•°ï¼Œè¦å¯¹ä¸åŒç±»å‹çš„ thisArg åˆ†åˆ«å¤„ç†ã€‚<span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvRnVuY3Rpb24vY2FsbA==" title="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/call">MDN ä¸­å¯¹ thisArg çš„æè¿°<i class="fa fa-external-link"></i></span>ï¼š</p><blockquote><p>åœ¨ <em>fun</em> å‡½æ•°è¿è¡Œæ—¶æŒ‡å®šçš„ <code>this</code> å€¼<em>ã€‚</em>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒæŒ‡å®šçš„ <code>this</code> å€¼å¹¶ä¸ä¸€å®šæ˜¯è¯¥å‡½æ•°æ‰§è¡Œæ—¶çœŸæ­£çš„ <code>this</code> å€¼ï¼Œå¦‚æœè¿™ä¸ªå‡½æ•°åœ¨<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Strict_mode" target="_blank" rel="noopener"><code>éä¸¥æ ¼æ¨¡å¼</code></a>ä¸‹è¿è¡Œï¼Œåˆ™æŒ‡å®šä¸º <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/null" target="_blank" rel="noopener"><code>null</code></a> å’Œ <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/undefined" target="_blank" rel="noopener"><code>undefined</code></a> çš„ <code>this</code> å€¼ä¼šè‡ªåŠ¨æŒ‡å‘å…¨å±€å¯¹è±¡ï¼ˆæµè§ˆå™¨ä¸­å°±æ˜¯ window å¯¹è±¡ï¼‰ï¼ŒåŒæ—¶å€¼ä¸ºåŸå§‹å€¼ï¼ˆæ•°å­—ï¼Œå­—ç¬¦ä¸²ï¼Œå¸ƒå°”å€¼ï¼‰çš„ <code>this</code> ä¼šæŒ‡å‘è¯¥åŸå§‹å€¼çš„è‡ªåŠ¨åŒ…è£…å¯¹è±¡ã€‚</p></blockquote></li><li><p>å¯èƒ½ thisArg åŸæœ¬å°±æœ‰ä¸€ä¸ªå±æ€§å« tempFuncï¼Œè¿™æ˜¯å®Œå…¨æœ‰å¯èƒ½çš„ï¼ŒæŒ‰ç…§ä¸Šé¢çš„ä»£ç æ¥å®ç° myCall å°±æŠŠåŸæœ‰çš„ tempFunc å±æ€§æ¶ˆé™¤äº†ã€‚å¯ä»¥ä½¿ç”¨ ES6 Symbol æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p></li></ol><p>æ‰€ä»¥å®Œå–„åçš„ myCall æ˜¯é…±ç´«ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.myCall = <span class="function"><span class="keyword">function</span>(<span class="params">thisArg, ...args</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (thisArg === <span class="literal">undefined</span> || thisArg === <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœ thisArg æ˜¯ undefined æˆ–åˆ™ nullï¼Œthis æŒ‡å‘å…¨å±€å¯¹è±¡ï¼Œç›´æ¥è°ƒç”¨å°±å¯ä»¥è¾¾åˆ°æŒ‡å‘å…¨å±€å¯¹è±¡çš„ç›®çš„äº†</span></span><br><span class="line">    <span class="keyword">return</span> tempFunc(...args);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è¿™é‡Œçš„ this å…¶å®å°±æ˜¯ func.myCall(thisArg, ...args) ä¸­çš„ funcï¼Œå› ä¸º myCall æ˜¯é€šè¿‡ func è°ƒç”¨çš„å˜›</span></span><br><span class="line">  <span class="keyword">const</span> func = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> tempFunc = <span class="built_in">Symbol</span>(<span class="string">'Temp property'</span>);</span><br><span class="line">  <span class="comment">// åœ¨ thisArg ä¸Šä¸´æ—¶ç»‘å®š func</span></span><br><span class="line">  thisArg[tempFunc] = func;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// é€šè¿‡ thisArg è°ƒç”¨ func æ¥è¾¾åˆ°æ”¹å˜ this æŒ‡å‘çš„ä½œç”¨</span></span><br><span class="line">  <span class="keyword">const</span> result = thisArg[tempFunc](...args);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆ é™¤ä¸´æ—¶å±æ€§</span></span><br><span class="line">  <span class="built_in">Reflect</span>.deleteProperty(thisArg, tempFunc);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printName</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(printName.myCall(&#123; <span class="attr">name</span>: <span class="string">'ly'</span> &#125;)); <span class="comment">// =&gt; ly</span></span><br></pre></td></tr></table></figure><h4 id="æ–¹å¼äºŒ"><a href="#æ–¹å¼äºŒ" class="headerlink" title="æ–¹å¼äºŒ"></a>æ–¹å¼äºŒ</h4><p>è®²ç¬¬äºŒä¸­æ–¹å¼ä¹‹å‰ï¼Œå…ˆæ¥èŠèŠå…¶å®ƒçš„ä¸€äº›ç›¸å…³çš„ä¸œè¥¿ã€‚</p><h5 id="Function-prototype-toString"><a href="#Function-prototype-toString" class="headerlink" title="Function.prototype.toString"></a>Function.prototype.toString</h5><p>è°ƒç”¨ä¸€ä¸ªå‡½æ•°çš„ toString æ–¹æ³•è¿”å›çš„æ˜¯è¿™ä¸ªå‡½æ•°å®šä¹‰æ—¶ä»£ç å­—ç¬¦ï¼š</p><p><img data-src="https://i.loli.net/2019/06/29/5d16c5b48ef8590170.png" alt="function toString"></p><p>æˆ‘æ•…æ„åœ¨ <code>console.log(&#39;hello world&#39;);</code> ä¸Šä¸‹æ’äº†ä¸€ä¸ªç©ºè¡Œï¼Œfunc å·¦å³å¤šæ‰“äº†å‡ ä¸ªç©ºæ ¼ï¼Œå¯ä»¥çœ‹åˆ° func.toString() è¿”å›çš„å­—ç¬¦ä¸²å®Œå…¨æ˜¯æˆ‘å®šä¹‰ func æ—¶çš„æ ·å­ï¼Œå¤šä½™çš„ç©ºè¡Œå’Œç©ºæ ¼ä¾ç„¶å­˜åœ¨ï¼Œæ²¡æœ‰æ ¼å¼åŒ–ã€‚</p><h5 id="eval"><a href="#eval" class="headerlink" title="eval"></a>eval</h5><p>eval å‡½æ•°å¯ä»¥è®©æˆ‘ä»¬å°†ä¸€ä¸ªå­—ç¬¦ä¸²å½“ä½œä»£ç æ¥è¿è¡Œï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> ctx = &#123; <span class="attr">name</span>: <span class="string">'Bob'</span> &#125;;</span><br><span class="line"><span class="built_in">eval</span>(<span class="string">'console.log(ctx.name)'</span>); <span class="comment">// Bob</span></span><br></pre></td></tr></table></figure><h5 id="åŠ¨æ‰‹å®ç°"><a href="#åŠ¨æ‰‹å®ç°" class="headerlink" title="åŠ¨æ‰‹å®ç°"></a>åŠ¨æ‰‹å®ç°</h5><p>æ‰€ä»¥çœ‹åˆ°è¿™é‡Œæ€è·¯å·²ç»å¾ˆæ¸…æ™°äº†ï¼šå…ˆé€šè¿‡ func.toString æ‹¿åˆ° func çš„ä»£ç å­—ç¬¦ä¸²ï¼Œå†æ›¿æ¢å…¶ä¸­çš„ this ä¸º thisArgï¼Œå†ä½¿ç”¨ eval è·å–æ›¿æ¢ this åçš„ä¸´æ—¶å‡½æ•°ï¼ˆå‡½æ•°åæ˜¾ç„¶å’Œ func ä¸€æ ·ï¼‰å¹¶æ‰§è¡Œã€‚ä»£ç å®ç°å°±æ˜¯é…±ç´«ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.myCall = <span class="function"><span class="keyword">function</span>(<span class="params">thisArg, ...args</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (thisArg === <span class="literal">undefined</span> || thisArg === <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœ thisArg æ˜¯ undefined æˆ–åˆ™ nullï¼Œthis æŒ‡å‘å…¨å±€å¯¹è±¡ï¼Œç›´æ¥è°ƒç”¨å°±å¯ä»¥è¾¾åˆ°æŒ‡å‘å…¨å±€å¯¹è±¡çš„ç›®çš„äº†</span></span><br><span class="line">    <span class="keyword">return</span> tempFunc();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è¿™é‡Œçš„ this å…¶å®å°±æ˜¯ func.myCall(thisArg, ...args) ä¸­çš„ funcï¼Œå› ä¸º myCall æ˜¯é€šè¿‡ func è°ƒç”¨çš„å˜›</span></span><br><span class="line">  <span class="keyword">const</span> func = <span class="keyword">this</span>;</span><br><span class="line">  <span class="keyword">const</span> funcString = func.toString();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ›¿æ¢ this ä¸º thisArg</span></span><br><span class="line">  <span class="keyword">const</span> tempFuncString = funcString.replace(<span class="regexp">/this/g</span>, <span class="string">'thisArg'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// é€šè¿‡ eval æ„é€ ä¸€ä¸ªä¸´æ—¶å‡½æ•°å¹¶æ‰§è¡Œ</span></span><br><span class="line">  <span class="keyword">const</span> tempFunc = <span class="built_in">eval</span>(<span class="string">`(<span class="subst">$&#123;tempFuncString&#125;</span>)`</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è°ƒç”¨ tempFunc å¹¶ä¼ å…¥å‚æ•°</span></span><br><span class="line">  <span class="keyword">return</span> tempFunc(...args);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printName</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(printName.myCall(&#123; <span class="attr">name</span>: <span class="string">'ly'</span> &#125;)); <span class="comment">// =&gt; ly</span></span><br></pre></td></tr></table></figure><p>æ·»åŠ ä¸€äº›æ‰“å°è¯­å¥ååœ¨ chrome ä¸­çš„æ‰§è¡Œæƒ…å†µï¼š<br><img data-src="https://i.loli.net/2019/06/29/5d16d5a0b97eb35960.png" alt="eval-call"></p><p>ä½†æ˜¯ï¼Œ<strong>è¿™ç§å®ç°æ–¹å¼å…¶å®æ˜¯å¾ˆæ‰¯æ·¡çš„</strong>ã€‚å®ƒæœ‰å¾ˆå¤šä¸èƒ½å®¹å¿è€Œä¸”æ— è§£çš„ç¼ºé™·ï¼š</p><ol><li>ä¸´æ—¶å‡½æ•°çš„ä½œç”¨åŸŸå’Œ func çš„ä½œç”¨åŸŸä¸ä¸€æ ·ã€‚ä½¿ç”¨ eval(<code>(${tempFuncString})</code>) æ—¶å£°æ˜äº†ä¸€ä¸ªå’Œ func åŒåçš„ä¸´æ—¶å‡½æ•°ï¼Œå®ƒçš„ä½œç”¨åŸŸæ˜¯ myCall è¿™ä¸ªå‡½æ•°ä½œç”¨åŸŸï¼Œè€Œ func çš„ä½œç”¨åŸŸæ˜¾ç„¶åœ¨ myCall å¤–ã€‚</li><li>æ›¿æ¢ â€˜thisâ€™ æ—¶æœ‰å¯èƒ½ func å‡½æ•°å…¶ä¸­æœ‰å­—ç¬¦ä¸²æˆ–è€…æ ‡è¯†ç¬¦æœ¬èº«åŒ…å«äº† â€˜thisâ€™ï¼Œæ¯”å¦‚ func å‡½æ•°ä¸­æœ‰ console.log(â€˜thisâ€™) è¿™ä¹ˆä¸€æ¡è¾“å‡ºè¯­å¥ï¼Œé‚£è¿™ä¸ª this ä¹Ÿè¢«æ›¿æ¢äº†ï¼Œæˆ–è€…å®šä¹‰äº†ä¸ªå˜é‡å« xxthisxxã€‚</li></ol><p>æ‰€ä»¥ï¼Œç›¸å¯¹è€Œè¨€ï¼Œç¬¬ä¸€ç§å®ç°æ›´é è°±ã€‚</p><h3 id="apply-1"><a href="#apply-1" class="headerlink" title="apply"></a>apply</h3><p>call å’Œ apply é™¤äº†å‚æ•°ä¸ä¸€æ ·ä¹‹å¤–æ²¡ä»€ä¹ˆåŒºåˆ«ã€‚æ‰€ä»¥ç¨å¾®è°ƒæ•´ myCall ä¸­çš„å‚æ•°å’Œè°ƒç”¨ func æ—¶çš„è°ƒç”¨å½¢å¼å³å¯ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.myApply = <span class="function"><span class="keyword">function</span>(<span class="params">thisArg, args</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (thisArg === <span class="literal">undefined</span> || thisArg === <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœ thisArg æ˜¯ undefined æˆ–åˆ™ nullï¼Œthis æŒ‡å‘å…¨å±€å¯¹è±¡ï¼Œç›´æ¥è°ƒç”¨å°±å¯ä»¥è¾¾åˆ°æŒ‡å‘å…¨å±€å¯¹è±¡çš„ç›®çš„äº†</span></span><br><span class="line">    <span class="keyword">return</span> tempFunc(args);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è¿™é‡Œçš„ this å…¶å®å°±æ˜¯ func.myCall(thisArg, ...args) ä¸­çš„ funcï¼Œå› ä¸º myCall æ˜¯é€šè¿‡ func è°ƒç”¨çš„å˜›</span></span><br><span class="line">  <span class="keyword">const</span> func = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> tempFunc = <span class="built_in">Symbol</span>(<span class="string">'Temp property'</span>);</span><br><span class="line">  <span class="comment">// åœ¨ thisArg ä¸Šä¸´æ—¶ç»‘å®š func</span></span><br><span class="line">  thisArg[tempFunc] = func;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// é€šè¿‡ thisArg è°ƒç”¨ func æ¥è¾¾åˆ°æ”¹å˜ this æŒ‡å‘çš„ä½œç”¨</span></span><br><span class="line">  <span class="keyword">const</span> result = thisArg[tempFunc](args);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆ é™¤ä¸´æ—¶å±æ€§</span></span><br><span class="line">  <span class="keyword">delete</span> thisArg[tempFunc];</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printName</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(printName.myCall(&#123; <span class="attr">name</span>: <span class="string">'ly'</span> &#125;)); <span class="comment">// =&gt; ly</span></span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹å¼å°±ä¸å†™äº†ï¼Œå…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œä¸å†™ä¸»è¦æ—¶å› ä¸ºç¬¬äºŒç§å®ç°æ²¡ä»€ä¹ˆå®ç”¨æ€§ï¼Œä»‹ç»å®ƒçš„å°±æ˜¯ä¸ºäº†æ‰©å±•ä¸€ä¸‹æ€è·¯ã€‚</p><h3 id="bind-1"><a href="#bind-1" class="headerlink" title="bind"></a>bind</h3><p>ä½¿ç”¨ call æ¥å®ç° bind æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¸¸è§çš„é¢è¯•é¢˜ï¼Œç±»ä¼¼äºä½¿ç”¨ map å®ç° reduceï¼Œå…¶å®è¿˜æ˜¯è€ƒå¯Ÿä½  javascript æŒæ¡çš„æ€ä¹ˆæ ·ã€‚å¦‚æœé¢è¯•è¢«é—®åˆ°é—­åŒ…æœ‰å“ªäº›å®é™…åº”ç”¨ä½ å…¶å®ä¹Ÿå¯ä»¥è¯´å¯ä»¥ä½¿ç”¨é—­åŒ…æ¥å®ç° bindï¼Œå¯¹å§ï¼Œé¢è¯•è¿˜æ˜¯æœ‰äº›æŠ€å·§çš„ã€‚</p><p>æ€è·¯æˆ‘ä¸Šé¢å…¶å®å·²ç»è¯´äº†ï¼Œå°±æ˜¯åˆ©ç”¨é—­åŒ…å’Œ call å°±å¯ä»¥äº†ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.myBind = <span class="function"><span class="keyword">function</span>(<span class="params">thisArg, ...args</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> func = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// bind è¿”å›çš„æ˜¯ä¸€ä¸ªæ–°å‡½æ•°</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">...otherArgs</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// æ‰§è¡Œå‡½æ•°æ—¶ this å§‹ç»ˆä¸ºå¤–å±‚å‡½æ•°ä¸­çš„ thisArgï¼Œå‰é¢çš„è°ƒç”¨å‚æ•°ä¹Ÿè¢«ç»‘å®šä¸º args</span></span><br><span class="line">    <span class="keyword">return</span> func.call(thisArg, ...args, ...otherArgs);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printThisAndAndArgs</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`This is <span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(<span class="keyword">this</span>)&#125;</span>, arguments is <span class="subst">$&#123;[...<span class="built_in">arguments</span>].join(<span class="string">', '</span>)&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> boundFunc = printThisAndAndArgs.myBind(&#123; <span class="attr">name</span>: <span class="string">'Lily'</span> &#125;, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line">boundFunc(<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>); <span class="comment">// =&gt; This is &#123;"name":"Lily"&#125;, arguments is 1, 2, 3, 4, 5, 6</span></span><br></pre></td></tr></table></figure><p>æŒ‰ç…§æƒ¯ä¾‹ï¼Œä¸Šé¢å®ç°çš„ç‰ˆæœ¬è‚¯å®šæ˜¯æœ‰äº›é—®é¢˜çš„ã„Ÿ( â–”, â–” )ã„ã€‚</p><h4 id="new-çš„å®ç°åŸç†"><a href="#new-çš„å®ç°åŸç†" class="headerlink" title="new çš„å®ç°åŸç†"></a>new çš„å®ç°åŸç†</h4><p>ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯æ²¡å¤„ç†å½“ä½¿ç”¨ new è°ƒç”¨çš„æƒ…å†µï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.age = age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> BoundStudent1 = Student.bind(&#123; <span class="attr">name</span>: <span class="string">'Taylor'</span> &#125;, <span class="string">'ly'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">new</span> BoundStudent1(<span class="number">22</span>)); <span class="comment">// =&gt; Student &#123; name: 'ly', age: 22 &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> BoundStudent2 = Student.myBind(&#123; <span class="attr">name</span>: <span class="string">'Taylor'</span> &#125;, <span class="string">'ly'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">new</span> BoundStudent2(<span class="number">22</span>)); <span class="comment">// =&gt; &#123;&#125;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ° bind å½“è¿”å›çš„å‡½æ•°è¢«ä½¿ç”¨ new è°ƒç”¨æ—¶ï¼Œ thisArg è¢«å¿½ç•¥ï¼Œæ­¤æ—¶ bind å‡½æ•°çš„ä½œç”¨åªæ˜¯èµ·åˆ°äº†ç»‘å®šæ„é€ å‡½æ•°å‚æ•°çš„ä½œç”¨ã€‚å½“å‰ç‰ˆæœ¬çš„ myBind åªæ˜¯è¿”å›äº†ä¸€ä¸ªç©ºå¯¹è±¡ï¼Œæ²¡æœ‰åœ¨è¿”å›çš„å®ä¾‹å¯¹è±¡ä¸Šç»‘å®šå±æ€§ã€‚</p><p>è¿™é‡Œè¡¥å……ä¸€ä¸‹ new æ“ä½œç¬¦çš„å®ç°åŸç†ã€‚æˆ‘æœ‰ä¸€ä¸ªé¡¹ç›®<a href="https://github.com/tjx666/javascript-code-lab" target="_blank" rel="noopener"><strong>javascript-code-lab</strong></a>ä¸Šä¿å­˜æˆ‘æ¢ç´¢åŸç”Ÿ js å¥¥ç§˜çš„ä¸€äº›ä»£ç ï¼Œæœ‰å…´è¶£å¯ä»¥çœ‹çœ‹ã€‚å…¶ä¸­æˆ‘ new æ“ä½œç¬¦çš„å®ç°æ˜¯è¿™æ ·çš„ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> _new = <span class="function">(<span class="params">fn, ...args</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> target = <span class="built_in">Object</span>.create(fn.prototype);</span><br><span class="line">    <span class="keyword">const</span> result = fn.call(target, ...args);</span><br><span class="line">    <span class="keyword">const</span> isObjectOrFunction = (result !== <span class="literal">null</span> &amp;&amp; <span class="keyword">typeof</span> result === <span class="string">'object'</span>) || <span class="keyword">typeof</span> result === <span class="string">'function'</span>);</span><br><span class="line">    <span class="keyword">return</span> isObjectOrFunction ? result : target;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶å®å¾ˆå¥½ç†è§£ï¼Œå½“æˆ‘ä»¬è°ƒç”¨ new fn(arg1, arg2, â€¦) çš„æ—¶å€™ï¼Œå…¶å®ç›¸å½“äºæ‰§è¡Œäº† _new(fn, arg1, arg2, â€¦)ã€‚å…·ä½“å†…éƒ¨çš„æ‰§è¡Œæ­¥éª¤æ˜¯è¿™æ ·çš„ï¼š</p><p>é¦–å…ˆæ„é€ ä¸€ä¸ªç©ºå¯¹è±¡ targetï¼Œå®ƒçš„åŸå‹åº”è¯¥ä¸º fn.prototypeï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨äº† ES6 çš„ Object.create æ¥å®ç°ã€‚</p><p>ç„¶åæˆ‘ä»¬éœ€è¦åœ¨ target ä¸Šç»‘å®šä½ åœ¨ fn ä¸­é€šè¿‡ this.key = value æ¥ç»‘å®šåˆ°å®ä¾‹å¯¹è±¡çš„å±æ€§ã€‚å…·ä½“åšæ³•å°±æ˜¯æ‰§è¡Œ fn å¹¶ä¸”å°†å…¶ this æŒ‡å‘ targetï¼Œä¹Ÿå°±æ˜¯ const result = fn.call(target, â€¦args);ã€‚</p><p>æœ€åè¿˜è¦æ³¨æ„çš„å°±æ˜¯å½“ fn çš„è¿”å›å€¼ result æ˜¯å¯¹è±¡æˆ–è€…å‡½æ•°çš„æ—¶å€™ï¼Œnew fn(arg1, arg2, â€¦) è¿”å›çš„å°±æ˜¯æŒ‡è¡Œ fn çš„è¿”å›å€¼è€Œä¸æ˜¯ targetï¼Œå¦åˆ™ç›´æ¥è¿”å› targetï¼Œä¹Ÿå°±æ˜¯å®ä¾‹å¯¹è±¡ã€‚</p><p><img data-src="https://i.loli.net/2019/06/29/5d16ec374162677354.png" alt="new"></p><p>å¦‚æœæœ‰äººé—®ä½ æœ‰å“ªäº›æ–¹å¼å¯ä»¥ä¿®æ”¹å‡½æ•°çš„ this æŒ‡å‘ï¼Œå…¶å® <strong>new æ“ä½œç¬¦ä¹Ÿå¯ä»¥ä¿®æ”¹æ„é€ å‡½æ•°çš„æŒ‡å‘</strong>ï¼Œæ²¡æ¯›ç—…å§ã€‚</p><p>äº†è§£äº† new æ“ä½œç¬¦çš„åŸç†ä¹‹åï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹ä¸Šé¢æˆ‘ä»¬å®ç°çš„ myBind ä¸ºä»€ä¹ˆä¼šåœ¨ new æ—¶å·¥ä½œä¸æ­£å¸¸ã€‚å½“æˆ‘ä»¬è°ƒç”¨ new BoundStudent2(22) æ—¶ï¼Œæ ¹æ®æˆ‘ä¸Šé¢è®²çš„ new çš„åŸç†çŸ¥é“ï¼Œåœ¨æ„é€ å‡ºä¸€ä¸ªä»¥ BoundStudent.prototype ä¸ºåŸå‹çš„ç©ºå¯¹è±¡ target åï¼Œä¼šè°ƒç”¨ BoundStudent.call(target) ã€‚ä½†æ˜¯ï¼Œè§‚å¯Ÿæˆ‘ä»¬å®ç°çš„ myBindï¼Œä½œä¸º myBind(thisArg) çš„è¿”å›å€¼çš„ BoundStudent2ï¼Œå®ƒå†…éƒ¨æ‰§è¡Œæ—¶å§‹æ˜¯è°ƒç”¨ func.call(thisArg, â€¦args, â€¦otherArgs)ï¼Œä¹Ÿå°±æ˜¯è¯´ this å§‹ç»ˆæ˜¯ thisArgï¼Œæ‰€ä»¥æ‰æ²¡æœ‰ç»‘å®š nameï¼Œage å±æ€§åˆ° target ä¸Šï¼Œå…¶å®æ˜¯è¢«ç»‘å®šåˆ°äº† thisArg ä¸Šå»äº†ã€‚è€Œä¸”ç”±äº BoundStudent.call(target) è¿”å›å€¼ä¸º undefinedï¼Œæ‰€ä»¥ new BoundStudent2(22) çš„ç»“æœå°±æ˜¯ targetã€‚</p><h4 id="åŒºåˆ†å‡½æ•°æ˜¯å¦æ˜¯é€šè¿‡-new-è°ƒç”¨"><a href="#åŒºåˆ†å‡½æ•°æ˜¯å¦æ˜¯é€šè¿‡-new-è°ƒç”¨" class="headerlink" title="åŒºåˆ†å‡½æ•°æ˜¯å¦æ˜¯é€šè¿‡ new è°ƒç”¨"></a>åŒºåˆ†å‡½æ•°æ˜¯å¦æ˜¯é€šè¿‡ new è°ƒç”¨</h4><p>ä¸Šé¢æˆ‘ä»¬åˆ†æäº† new è°ƒç”¨ myBind ç»‘å®šçš„å‡½æ•°äº§ç”Ÿçš„é—®é¢˜çš„åŸå› ï¼Œé‚£ä¹ˆè¯¥å¦‚ä½•è§£å†³å‘¢ï¼Ÿæƒ³è¦è§£å†³è¿™ä¸ªé—®é¢˜æˆ‘ä»¬å¿…é¡»å¾—èƒ½å¤ŸåŒºåˆ†å‡ºè°ƒç”¨ BoundFunc2 æ—¶æ˜¯å¦æ˜¯é€šè¿‡ new æ¥è°ƒç”¨çš„ã€‚å¯ä»¥ä½¿ç”¨ ES6 ä¸­ <span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvT3BlcmF0b3JzL25ldy50YXJnZXQ=" title="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/new.target">new.target<i class="fa fa-external-link"></i></span> æ¥åŒºåˆ†ã€‚</p><p><img data-src="https://i.loli.net/2019/06/29/5d16fed23267568788.png" alt="new.target"></p><p><strong>new.target</strong>å±æ€§å…è®¸ä½ æ£€æµ‹å‡½æ•°æˆ–æ„é€ æ–¹æ³•æ˜¯å¦æ˜¯é€šè¿‡<span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvT3BlcmF0b3JzL25ldw==" title="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/new">new<i class="fa fa-external-link"></i></span>è¿ç®—ç¬¦è¢«è°ƒç”¨çš„ã€‚åœ¨é€šè¿‡<span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvT3BlcmF0b3JzL25ldw==" title="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/new">new<i class="fa fa-external-link"></i></span>è¿ç®—ç¬¦è¢«åˆå§‹åŒ–çš„å‡½æ•°æˆ–æ„é€ æ–¹æ³•ä¸­ï¼Œ<code>new.target</code>è¿”å›ä¸€ä¸ªæŒ‡å‘æ„é€ æ–¹æ³•æˆ–å‡½æ•°çš„å¼•ç”¨ã€‚åœ¨æ™®é€šçš„å‡½æ•°è°ƒç”¨ä¸­ï¼Œ<code>new.target</code> çš„å€¼æ˜¯<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/undefined" target="_blank" rel="noopener"><code>undefined</code></a>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.myBind = <span class="function"><span class="keyword">function</span>(<span class="params">thisArg, ...args</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> func = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// bind è¿”å›çš„æ˜¯ä¸€ä¸ªæ–°å‡½æ•°ï¼Œå¦‚æœä½¿ç”¨ new è°ƒç”¨äº†è¢«ç»‘å®šåçš„å‡½æ•°ï¼Œå…¶ä¸­çš„ this å³æ˜¯ new æœ€åè¿”å›çš„å®ä¾‹å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯ target</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">...otherArgs</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// å½“ new.target ä¸º funcï¼Œä¸ä¸ºç©ºæ—¶ï¼Œç»‘å®š thisï¼Œè€Œä¸æ˜¯ thisArg</span></span><br><span class="line">    <span class="keyword">return</span> func.call(<span class="keyword">new</span>.target ? <span class="keyword">this</span> : thisArg, ...args, ...otherArgs);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.age = age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> BoundStudent1 = Student.bind(&#123; <span class="attr">name</span>: <span class="string">'Taylor'</span> &#125;, <span class="string">'ly'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">new</span> BoundStudent1(<span class="number">22</span>)); <span class="comment">// =&gt; Student &#123; name: 'ly', age: 22 &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> BoundStudent2 = Student.myBind(&#123; <span class="attr">name</span>: <span class="string">'Taylor'</span> &#125;, <span class="string">'ly'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">new</span> BoundStudent2(<span class="number">22</span>)); <span class="comment">// =&gt; &#123; name: 'ly', age: 22 &#125;</span></span><br></pre></td></tr></table></figure><h4 id="å¤„ç†åŸå‹é“¾"><a href="#å¤„ç†åŸå‹é“¾" class="headerlink" title="å¤„ç†åŸå‹é“¾"></a>å¤„ç†åŸå‹é“¾</h4><p>å½“å‰ç‰ˆæœ¬çš„ myBind æ²¡æœ‰å¤„ç†åŸå‹é“¾ï¼ŒBoundStudent2 new å‡ºæ¥çš„å®ä¾‹æ— æ³•è®¿é—® Student åŸå‹é“¾ä¸Šçš„å±æ€§ã€‚ä¿®æ”¹å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.myBind = <span class="function"><span class="keyword">function</span>(<span class="params">thisArg, ...args</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> func = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// bind è¿”å›çš„æ˜¯ä¸€ä¸ªæ–°å‡½æ•°ï¼Œå¦‚æœä½¿ç”¨ new è°ƒç”¨äº†è¢«ç»‘å®šåçš„å‡½æ•°ï¼Œå…¶ä¸­çš„ this å³æ˜¯ new æœ€åè¿”å›çš„å®ä¾‹å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯ target</span></span><br><span class="line">  <span class="keyword">const</span> boundFunc = <span class="function"><span class="keyword">function</span>(<span class="params">...otherArgs</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// å½“ new.target ä¸º funcï¼Œä¸ä¸ºç©ºæ—¶ï¼Œç»‘å®š thisï¼Œè€Œä¸æ˜¯ thisArg</span></span><br><span class="line">    <span class="keyword">return</span> func.call(<span class="keyword">new</span>.target ? <span class="keyword">this</span> : thisArg, ...args, ...otherArgs);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  boundFunc.prototype = <span class="built_in">Object</span>.create(func.prototype);</span><br><span class="line">  boundFunc.prototype.constructor = boundFunc;</span><br><span class="line">  <span class="keyword">return</span> boundFunc;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.age = age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Student.prototype.type = <span class="string">'student'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> BoundStudent2 = Student.myBind(&#123; <span class="attr">name</span>: <span class="string">'Taylor'</span> &#125;, <span class="string">'ly'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">new</span> BoundStudent2(<span class="number">22</span>).type); <span class="comment">// =&gt; student</span></span><br></pre></td></tr></table></figure><h4 id="å®Œå–„ä¸€äº›ç»†èŠ‚"><a href="#å®Œå–„ä¸€äº›ç»†èŠ‚" class="headerlink" title="å®Œå–„ä¸€äº›ç»†èŠ‚"></a>å®Œå–„ä¸€äº›ç»†èŠ‚</h4><p>è¿”å›çš„å‡½æ•°æ¯•ç«Ÿæ˜¯ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œå®ƒçš„æœ‰äº›å±æ€§éœ€è¦æˆ‘ä»¬ä¿®æ”¹ã€‚æˆ‘ä»¬åœ¨å¤„ç†ä¸€ä¸‹ name å’Œ length å±æ€§ã€‚å¦‚æœä¸€ä¸ªå‡½æ•° func è¢«ç»‘å®šäº†è‹±æ–‡å« boundï¼Œé‚£ä¹ˆ func.name åº”è¯¥æ˜¯ <code>bound func</code>ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="keyword">const</span> boundFunc = func.bind(&#123;&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(boundFunc.name); <span class="comment">// bound func</span></span><br></pre></td></tr></table></figure><p>func.length è¡¨ç¤ºå‡½æ•°çš„å‚æ•°ä¸ªæ•°ï¼Œä½†æ˜¯ BoundFunc çš„å‚æ•°ä¸ªæ•°å’Œ func çš„å‚æ•°ä¸ªæ•°å¯ä¸ä¸€æ ·ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è°ƒæ•´ func.lengthã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ Function.prototype.name å’Œ Function.prototype.length æ˜¯ä¸å¯å†™çš„ï¼Œæ‰€ä»¥è¦é€šè¿‡ Object.defineProperties æ¥ä¿®æ”¹ã€‚</p><p>æœ€ç»ˆç‰ˆï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Function</span>.prototype.myBind = <span class="function"><span class="keyword">function</span>(<span class="params">thisArg, ...args</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> func = <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// bind è¿”å›çš„æ˜¯ä¸€ä¸ªæ–°å‡½æ•°ï¼Œå¦‚æœä½¿ç”¨ new è°ƒç”¨äº†è¢«ç»‘å®šåçš„å‡½æ•°ï¼Œå…¶ä¸­çš„ this å³æ˜¯ new æœ€åè¿”å›çš„å®ä¾‹å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯ target</span></span><br><span class="line">  <span class="keyword">const</span> boundFunc = <span class="function"><span class="keyword">function</span>(<span class="params">...otherArgs</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// å½“ new.target ä¸º funcï¼Œä¸ä¸ºç©ºæ—¶ï¼Œç»‘å®š thisï¼Œè€Œä¸æ˜¯ thisArg</span></span><br><span class="line">    <span class="keyword">return</span> func.call(<span class="keyword">new</span>.target ? <span class="keyword">this</span> : thisArg, ...args, ...otherArgs);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  boundFunc.prototype = <span class="built_in">Object</span>.create(func.prototype);</span><br><span class="line">  boundFunc.prototype.constructor = boundFunc;</span><br><span class="line">  <span class="built_in">Object</span>.defineProperties(boundFunc, &#123;</span><br><span class="line">    name: &#123;</span><br><span class="line">      value: <span class="string">`bound <span class="subst">$&#123;func.name&#125;</span>`</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    length: &#123;</span><br><span class="line">      value: func.length,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> boundFunc;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.age = age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Student.prototype.type = <span class="string">'student'</span>;</span><br><span class="line"><span class="keyword">const</span> BoundStudent2 = Student.myBind(&#123; <span class="attr">name</span>: <span class="string">'Taylor'</span> &#125;, <span class="string">'ly'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">new</span> BoundStudent2(<span class="number">22</span>).type); <span class="comment">// =&gt; student</span></span><br><span class="line"><span class="built_in">console</span>.log(BoundStudent2.name); <span class="comment">// =&gt; bound Student</span></span><br><span class="line"><span class="built_in">console</span>.log(BoundStudent2.length); <span class="comment">// =&gt; 2</span></span><br></pre></td></tr></table></figure><p>bind æ˜¯ ES5 æ‰æ–°å¢çš„ APIï¼Œ<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2VzLXNoaW1zL2VzNS1zaGlt" title="https://github.com/es-shims/es5-shim">es5-shim<i class="fa fa-external-link"></i></span> æ˜¯ä¸€ä¸ªè®©ä¼ ç»Ÿå’Œç°ä»£çš„æµè§ˆå™¨å¼•æ“å…¼å®¹ es5 çš„å«ç‰‡åº“ï¼Œå…¶ä¸­ bind çš„å®šä¹‰æ˜¯ä¸‹é¢è¿™æ ·çš„ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">defineProperties(FunctionPrototype, &#123;</span><br><span class="line">  bind: <span class="function"><span class="keyword">function</span> <span class="title">bind</span>(<span class="params">that</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// .length is 1</span></span><br><span class="line">    <span class="comment">// 1. Let Target be the this value.</span></span><br><span class="line">    <span class="keyword">var</span> target = <span class="keyword">this</span>;</span><br><span class="line">    <span class="comment">// 2. If IsCallable(Target) is false, throw a TypeError exception.</span></span><br><span class="line">    <span class="keyword">if</span> (!isCallable(target)) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'Function.prototype.bind called on incompatible '</span> + target);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 3. Let A be a new (possibly empty) internal list of all of the</span></span><br><span class="line">    <span class="comment">//   argument values provided after thisArg (arg1, arg2 etc), in order.</span></span><br><span class="line">    <span class="comment">// XXX slicedArgs will stand in for "A" if used</span></span><br><span class="line">    <span class="keyword">var</span> args = array_slice.call(<span class="built_in">arguments</span>, <span class="number">1</span>); <span class="comment">// for normal call</span></span><br><span class="line">    <span class="comment">// 4. Let F be a new native ECMAScript object.</span></span><br><span class="line">    <span class="comment">// 11. Set the [[Prototype]] internal property of F to the standard</span></span><br><span class="line">    <span class="comment">//   built-in Function prototype object as specified in 15.3.3.1.</span></span><br><span class="line">    <span class="comment">// 12. Set the [[Call]] internal property of F as described in</span></span><br><span class="line">    <span class="comment">//   15.3.4.5.1.</span></span><br><span class="line">    <span class="comment">// 13. Set the [[Construct]] internal property of F as described in</span></span><br><span class="line">    <span class="comment">//   15.3.4.5.2.</span></span><br><span class="line">    <span class="comment">// 14. Set the [[HasInstance]] internal property of F as described in</span></span><br><span class="line">    <span class="comment">//   15.3.4.5.3.</span></span><br><span class="line">    <span class="keyword">var</span> bound;</span><br><span class="line">    <span class="keyword">var</span> binder = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">this</span> <span class="keyword">instanceof</span> bound) &#123;</span><br><span class="line">        <span class="comment">// 15.3.4.5.2 [[Construct]]</span></span><br><span class="line">        <span class="comment">// When the [[Construct]] internal method of a function object,</span></span><br><span class="line">        <span class="comment">// F that was created using the bind function is called with a</span></span><br><span class="line">        <span class="comment">// list of arguments ExtraArgs, the following steps are taken:</span></span><br><span class="line">        <span class="comment">// 1. Let target be the value of F's [[TargetFunction]]</span></span><br><span class="line">        <span class="comment">//   internal property.</span></span><br><span class="line">        <span class="comment">// 2. If target has no [[Construct]] internal method, a</span></span><br><span class="line">        <span class="comment">//   TypeError exception is thrown.</span></span><br><span class="line">        <span class="comment">// 3. Let boundArgs be the value of F's [[BoundArgs]] internal</span></span><br><span class="line">        <span class="comment">//   property.</span></span><br><span class="line">        <span class="comment">// 4. Let args be a new list containing the same values as the</span></span><br><span class="line">        <span class="comment">//   list boundArgs in the same order followed by the same</span></span><br><span class="line">        <span class="comment">//   values as the list ExtraArgs in the same order.</span></span><br><span class="line">        <span class="comment">// 5. Return the result of calling the [[Construct]] internal</span></span><br><span class="line">        <span class="comment">//   method of target providing args as the arguments.</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> result = apply.call(target, <span class="keyword">this</span>, array_concat.call(args, array_slice.call(<span class="built_in">arguments</span>)));</span><br><span class="line">        <span class="keyword">if</span> ($<span class="built_in">Object</span>(result) === result) &#123;</span><br><span class="line">          <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 15.3.4.5.1 [[Call]]</span></span><br><span class="line">        <span class="comment">// When the [[Call]] internal method of a function object, F,</span></span><br><span class="line">        <span class="comment">// which was created using the bind function is called with a</span></span><br><span class="line">        <span class="comment">// this value and a list of arguments ExtraArgs, the following</span></span><br><span class="line">        <span class="comment">// steps are taken:</span></span><br><span class="line">        <span class="comment">// 1. Let boundArgs be the value of F's [[BoundArgs]] internal</span></span><br><span class="line">        <span class="comment">//   property.</span></span><br><span class="line">        <span class="comment">// 2. Let boundThis be the value of F's [[BoundThis]] internal</span></span><br><span class="line">        <span class="comment">//   property.</span></span><br><span class="line">        <span class="comment">// 3. Let target be the value of F's [[TargetFunction]] internal</span></span><br><span class="line">        <span class="comment">//   property.</span></span><br><span class="line">        <span class="comment">// 4. Let args be a new list containing the same values as the</span></span><br><span class="line">        <span class="comment">//   list boundArgs in the same order followed by the same</span></span><br><span class="line">        <span class="comment">//   values as the list ExtraArgs in the same order.</span></span><br><span class="line">        <span class="comment">// 5. Return the result of calling the [[Call]] internal method</span></span><br><span class="line">        <span class="comment">//   of target providing boundThis as the this value and</span></span><br><span class="line">        <span class="comment">//   providing args as the arguments.</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// equiv: target.call(this, ...boundArgs, ...args)</span></span><br><span class="line">        <span class="keyword">return</span> apply.call(target, that, array_concat.call(args, array_slice.call(<span class="built_in">arguments</span>)));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 15. If the [[Class]] internal property of Target is "Function", then</span></span><br><span class="line">    <span class="comment">//     a. Let L be the length property of Target minus the length of A.</span></span><br><span class="line">    <span class="comment">//     b. Set the length own property of F to either 0 or L, whichever is</span></span><br><span class="line">    <span class="comment">//       larger.</span></span><br><span class="line">    <span class="comment">// 16. Else set the length own property of F to 0.</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> boundLength = max(<span class="number">0</span>, target.length - args.length);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 17. Set the attributes of the length own property of F to the values</span></span><br><span class="line">    <span class="comment">//   specified in 15.3.5.1.</span></span><br><span class="line">    <span class="keyword">var</span> boundArgs = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; boundLength; i++) &#123;</span><br><span class="line">      array_push.call(boundArgs, <span class="string">'$'</span> + i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// XXX Build a dynamic function with desired amount of arguments is the only</span></span><br><span class="line">    <span class="comment">// way to set the length property of a function.</span></span><br><span class="line">    <span class="comment">// In environments where Content Security Policies enabled (Chrome extensions,</span></span><br><span class="line">    <span class="comment">// for ex.) all use of eval or Function costructor throws an exception.</span></span><br><span class="line">    <span class="comment">// However in all of these environments Function.prototype.bind exists</span></span><br><span class="line">    <span class="comment">// and so this code will never be executed.</span></span><br><span class="line">    bound = $<span class="built_in">Function</span>(</span><br><span class="line">      <span class="string">'binder'</span>,</span><br><span class="line">      <span class="string">'return function ('</span> + array_join.call(boundArgs, <span class="string">','</span>) + <span class="string">')&#123; return binder.apply(this, arguments); &#125;'</span></span><br><span class="line">    )(binder);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (target.prototype) &#123;</span><br><span class="line">      Empty.prototype = target.prototype;</span><br><span class="line">      bound.prototype = <span class="keyword">new</span> Empty();</span><br><span class="line">      <span class="comment">// Clean up dangling references.</span></span><br><span class="line">      Empty.prototype = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// TODO</span></span><br><span class="line">    <span class="comment">// 18. Set the [[Extensible]] internal property of F to true.</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// TODO</span></span><br><span class="line">    <span class="comment">// 19. Let thrower be the [[ThrowTypeError]] function Object (13.2.3).</span></span><br><span class="line">    <span class="comment">// 20. Call the [[DefineOwnProperty]] internal method of F with</span></span><br><span class="line">    <span class="comment">//   arguments "caller", PropertyDescriptor &#123;[[Get]]: thrower, [[Set]]:</span></span><br><span class="line">    <span class="comment">//   thrower, [[Enumerable]]: false, [[Configurable]]: false&#125;, and</span></span><br><span class="line">    <span class="comment">//   false.</span></span><br><span class="line">    <span class="comment">// 21. Call the [[DefineOwnProperty]] internal method of F with</span></span><br><span class="line">    <span class="comment">//   arguments "arguments", PropertyDescriptor &#123;[[Get]]: thrower,</span></span><br><span class="line">    <span class="comment">//   [[Set]]: thrower, [[Enumerable]]: false, [[Configurable]]: false&#125;,</span></span><br><span class="line">    <span class="comment">//   and false.</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// TODO</span></span><br><span class="line">    <span class="comment">// NOTE Function objects created using Function.prototype.bind do not</span></span><br><span class="line">    <span class="comment">// have a prototype property or the [[Code]], [[FormalParameters]], and</span></span><br><span class="line">    <span class="comment">// [[Scope]] internal properties.</span></span><br><span class="line">    <span class="comment">// XXX can't delete prototype in pure-js.</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 22. Return F.</span></span><br><span class="line">    <span class="keyword">return</span> bound;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ç”±äºè¿™ä¸ªåº“æ˜¯ç”¨æ¥å…¼å®¹ ES5 çš„ï¼Œæ‰€ä»¥æ²¡æœ‰ç”¨ ES6 çš„ <strong>new.target</strong> è€Œæ˜¯ç”¨ <strong>instanceOf</strong> æ¥åˆ¤æ–­æ˜¯å¦æ˜¯ä½¿ç”¨ new æ¥è°ƒç”¨çš„ï¼Œä¹Ÿæ²¡æœ‰ä½¿ç”¨ ES6 çš„ Object.defineProperty æˆ–è€… Object.definePropertyiesã€‚å¯ä»¥çœ‹åˆ°å®˜æ–¹æºä»£ç ä¸­çš„æ³¨é‡Šè¿˜æ˜¯å¾ˆè¯¦ç»†æ¸…æ™°çš„ï¼Œæ„Ÿå…´è¶£çš„è¯»è€…å¯ä»¥è‡ªè¡Œç ”ç©¶ä¸€ä¸‹ï¼Œæœ‰ä»€ä¹ˆé—®é¢˜ä¹Ÿå¯ä»¥åœ¨è¯„è®ºåŒºæå‡ºæ¥ã€‚</p><h2 id="å‡ ä¸ªç–‘é—®"><a href="#å‡ ä¸ªç–‘é—®" class="headerlink" title="å‡ ä¸ªç–‘é—®"></a>å‡ ä¸ªç–‘é—®</h2><h3 id="ä½¿ç”¨-bind-å¤šæ¬¡ç»‘å®šä¸€ä¸ªå‡½æ•°ï¼Œåç»­çš„ç»‘å®šèƒ½ç”Ÿæ•ˆå—ï¼Ÿ"><a href="#ä½¿ç”¨-bind-å¤šæ¬¡ç»‘å®šä¸€ä¸ªå‡½æ•°ï¼Œåç»­çš„ç»‘å®šèƒ½ç”Ÿæ•ˆå—ï¼Ÿ" class="headerlink" title="ä½¿ç”¨ bind å¤šæ¬¡ç»‘å®šä¸€ä¸ªå‡½æ•°ï¼Œåç»­çš„ç»‘å®šèƒ½ç”Ÿæ•ˆå—ï¼Ÿ"></a>ä½¿ç”¨ bind å¤šæ¬¡ç»‘å®šä¸€ä¸ªå‡½æ•°ï¼Œåç»­çš„ç»‘å®šèƒ½ç”Ÿæ•ˆå—ï¼Ÿ</h3><p>ä¸èƒ½ï¼Œè¢«ç»‘å®šåï¼Œåç»­å†æ¬¡ä½¿ç”¨ bind ç»‘å®šæ²¡æœ‰ä½œç”¨ã€‚æœ€åæ‰§è¡Œå‡½æ•° fn æ—¶ï¼Œthis å§‹ç»ˆæ—¶è¢«æŒ‡å‘ç¬¬ä¸€æ¬¡ bind æ—¶çš„ thisArgã€‚</p><h3 id="ä½¿ç”¨-bind-ç»‘å®šå‡½æ•°-this-åï¼Œå¯ä»¥ä½¿ç”¨-callï¼Œapply-æ”¹å˜å‡½æ•°çš„æŒ‡å‘å—ï¼Ÿ"><a href="#ä½¿ç”¨-bind-ç»‘å®šå‡½æ•°-this-åï¼Œå¯ä»¥ä½¿ç”¨-callï¼Œapply-æ”¹å˜å‡½æ•°çš„æŒ‡å‘å—ï¼Ÿ" class="headerlink" title="ä½¿ç”¨ bind ç»‘å®šå‡½æ•° this åï¼Œå¯ä»¥ä½¿ç”¨ callï¼Œapply æ”¹å˜å‡½æ•°çš„æŒ‡å‘å—ï¼Ÿ"></a>ä½¿ç”¨ bind ç»‘å®šå‡½æ•° this åï¼Œå¯ä»¥ä½¿ç”¨ callï¼Œapply æ”¹å˜å‡½æ•°çš„æŒ‡å‘å—ï¼Ÿ</h3><p>ä¸èƒ½ï¼ŒåŸå› å’Œä¸Šé¢ä¸€æ ·ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> boundTest = test.bind(&#123; <span class="attr">name</span>: <span class="string">'ly'</span> &#125;);</span><br><span class="line">boundTest(); <span class="comment">// =&gt; &#123; name: 'ly' &#125;</span></span><br><span class="line"></span><br><span class="line">boundTest = boundTest.bind(&#123; <span class="attr">name</span>: <span class="string">'dongdong'</span> &#125;);</span><br><span class="line">boundTest(); <span class="comment">// =&gt; &#123; name: 'ly' &#125;</span></span><br><span class="line"></span><br><span class="line">boundTest.call(&#123; <span class="attr">name</span>: <span class="string">'yinyin'</span> &#125;); <span class="comment">// =&gt; &#123; name: 'ly' &#125;</span></span><br></pre></td></tr></table></figure><p>å…¶å®æœ€è¿‘çœ‹è¿‡æœ‰äº›å…¬å¸å‰ç«¯é¢è¯•è¿˜è€ƒäº†åå‡½æ•°çš„çŸ¥è¯†ï¼Œå…¶å®ä¹Ÿç”¨åˆ°äº† bindã€‚è¿™é‡Œæˆ‘ä¸æ‰“ç®—è®²åå‡½æ•°äº†ï¼Œåå‡½æ•°æˆ‘æœ‰ç©ºå†å†™ä¸€ç¯‡æ–‡ç« å•ç‹¬è®²ã€‚</p><p>å‚è€ƒèµ„æ–™ï¼š</p><ol><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuamlhbnNodS5jb20vcC8wMGRjNGFkOWI4M2Y=" title="https://www.jianshu.com/p/00dc4ad9b83f">JavaScript ä¸­çš„ callã€applyã€bind æ·±å…¥ç†è§£<i class="fa fa-external-link"></i></span></li><li><span class="exturl" data-url="aHR0cHM6Ly9qdWVqaW4uaW0vcG9zdC81YzgxM2FhNWYyNjVkYTJkZDk0Y2Q3YzI=" title="https://juejin.im/post/5c813aa5f265da2dd94cd7c2">å½»åº•å¼„æ¸… this call apply bind ä»¥åŠåŸç”Ÿå®ç°<i class="fa fa-external-link"></i></span></li><li><span class="exturl" data-url="aHR0cHM6Ly9qdWVqaW4uaW0vcG9zdC81YmVjNDE4M2YyNjVkYTYxNmIxMDQ0ZDc=" title="https://juejin.im/post/5bec4183f265da616b1044d7">é¢è¯•å®˜é—®ï¼šèƒ½å¦æ¨¡æ‹Ÿå®ç° JS çš„ bind æ–¹æ³•<i class="fa fa-external-link"></i></span></li></ol><p>å¦‚æœæ–‡ç« å†…å®¹æœ‰ä»€ä¹ˆé”™è¯¯æˆ–è€…ä¸å½“ä¹‹å¤„ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºæŒ‡å‡ºã€‚æ„Ÿè°¢æ‚¨çš„é˜…è¯»ï¼Œå¦‚æœæ–‡ç« å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©æˆ–è€…å¯å‘ï¼Œä¸å¦¨ç‚¹ä¸ªèµï¼Œå…³æ³¨ä¸€ä¸‹å‘—ã€‚</p><p>æœ¬æ–‡ä¸ºåŸåˆ›å†…å®¹ï¼Œé¦–å‘äº<span class="exturl" data-url="aHR0cDovL3d3dy5seXJlYWw2NjYuY29t" title="http://www.lyreal666.com">ä¸ªäººåšå®¢<i class="fa fa-external-link"></i></span>ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>javascript</tag>
      </tags>
  </entry>
  <entry>
    <title>é€šè¿‡ koa2 æœåŠ¡å™¨å®è·µæ¢ç©¶æµè§ˆå™¨ HTTP ç¼“å­˜æœºåˆ¶</title>
    <url>/%E9%80%9A%E8%BF%87-koa2-%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%AE%9E%E8%B7%B5%E6%8E%A2%E7%A9%B6%E6%B5%8F%E8%A7%88%E5%99%A8HTTP%E7%BC%93%E5%AD%98%E6%9C%BA%E5%88%B6/</url>
    <content><![CDATA[<p>æµè§ˆå™¨ HTTP ç¼“å­˜æ˜¯ä¸€ç§å¸¸è§çš„ web æ€§èƒ½ä¼˜åŒ–çš„æ‰‹æ®µï¼Œä¹Ÿæ˜¯åœ¨å‰ç«¯é¢è¯•ä¸­ç»å¸¸è¢«è€ƒå¯Ÿçš„ä¸€ä¸ªçŸ¥è¯†ç‚¹ã€‚æœ¬æ–‡é€šè¿‡é…ç½® koa2 æœåŠ¡å™¨ï¼Œåœ¨å®è·µä¸­å¸¦ä½ æ¢ç©¶æµè§ˆå™¨çš„ HTTP ç¼“å­˜æœºåˆ¶ã€‚</p><a id="more"></a><p>å…ˆæ¥ç›´è§‚è®¤è¯†ä¸€ä¸‹æµè§ˆå™¨ HTTP ç¼“å­˜ï¼š</p><p><img data-src="https://i.loli.net/2019/06/17/5d070499177b444422.png" alt="v2EXé¦–é¡µé¦–æ¬¡åŠ è½½"></p><p>ä¸Šé¢æ˜¯æ‰“å¼€æµè§ˆå™¨åç›´æ¥è®¿é—® V2EX é¦–é¡µåçš„æˆªå›¾ï¼ŒçŸ©å½¢åœˆèµ·æ¥çš„é‚£å—ä¹Ÿå°±æ˜¯ size éƒ¨åˆ†æ˜¾ç¤ºçš„éƒ½æ˜¯ <code>from disk cached</code>ï¼Œè¯´æ˜è¿™äº›èµ„æºå‘½ä¸­äº†å¼ºç¼“å­˜ï¼Œå¼ºç¼“å­˜çš„çŠ¶æ€ç éƒ½æ˜¯ 200ã€‚</p><p>å†æ¥çœ‹çœ‹æˆ‘ç›´æ¥è®¿é—®ä¸Šé¢ç®­å¤´æŒ‡å‘çš„é‚£å¼ å›¾ç‰‡æ˜¯ä»€ä¹ˆæƒ…å†µï¼š</p><p><img data-src="https://i.loli.net/2019/06/17/5d070673e1d7c93593.png" alt="æ¼”ç¤ºåå•†ç¼“å­˜">å¯ä»¥çœ‹åˆ°è¿”å›ç æ˜¯ 304ï¼Œå¹¶ä¸”è¯·æ±‚çš„æ—¶å€™å¸¦ä¸Šäº†åå•†ç¼“å­˜ç”¨äºåå•†çš„ä¸¤ä¸ªè¯·æ±‚å¤´ if-modified-since å’Œ if-none-matchï¼Œå‘½ä¸­äº†åå•†ç¼“å­˜ã€‚å¯èƒ½æœ‰éƒ¨ä»½è¯»è€…çœ‹åˆ°è¿™é‡Œä¸å¤ªç†è§£æˆ‘å‰é¢æåˆ°çš„å¼ºç¼“å­˜å’Œåå•†ç¼“å­˜æ˜¯ä»€ä¹ˆé¬¼ï¼Œæ²¡å…³ç³»ï¼Œçœ‹åˆ°æœ€åå†å›è¿‡å¤´æ¥çœ‹ï¼Œä½ å°±è‡ªç„¶èƒ½æ¸…æ™°çš„çœ‹æ‡‚æˆ‘ä¸Šé¢åœˆèµ·æ¥çš„ä¸œè¥¿å’Œæåˆ°çš„ä¸€äº›ä¸æ‡‚æœ¯è¯­ã€‚</p><h3 id="ç¼“å­˜åˆ¤æ–­è§„åˆ™æ˜¯æ€ä¹ˆå®ç°çš„"><a href="#ç¼“å­˜åˆ¤æ–­è§„åˆ™æ˜¯æ€ä¹ˆå®ç°çš„" class="headerlink" title="ç¼“å­˜åˆ¤æ–­è§„åˆ™æ˜¯æ€ä¹ˆå®ç°çš„"></a>ç¼“å­˜åˆ¤æ–­è§„åˆ™æ˜¯æ€ä¹ˆå®ç°çš„</h3><p><strong>å…¶å®æ‰€æœ‰çš„ç½‘ç»œåè®®éƒ½æ˜¯ä¸€å¥—è§„èŒƒï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯æ˜¯æ€ä¹ˆåªæ˜¯æŒ‰ç…§è§„èŒƒæ¥å®ç°è€Œå·²</strong>ã€‚æµè§ˆå™¨ HTTP ç¼“å­˜ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œæµè§ˆå™¨åœ¨å¼€å‘çš„æ—¶å€™ä¾¿æŒ‰ç…§ HTTP ç¼“å­˜è§„èŒƒæ¥å¼€å‘ï¼Œæˆ‘ä»¬å¼€å‘çš„ HTTP æœåŠ¡å™¨ä¹Ÿåº”è¯¥éµå®ˆå…¶è§„èŒƒã€‚å½“ç„¶äº†ï¼ŒæœåŠ¡å™¨æ˜¯ä½ è‡ªå·±å†™çš„ï¼Œä½ å®Œå…¨å¯ä»¥ä¸æŒ‰è§„èŒƒæ¥ï¼Œä½†æ˜¯æµè§ˆå™¨ä¸çŸ¥é“ä½ åœ¨æä»€ä¹ˆåå ‚å•Šï¼ŒHTTP ç¼“å­˜è‚¯å®šä¸ä¼šæ­£å¸¸å·¥ä½œäº†ã€‚</p><p>æˆ‘ä»¬çŸ¥é“æµè§ˆå™¨å’ŒæœåŠ¡å™¨è¿›è¡Œäº¤äº’çš„æ—¶å€™ä¼šå‘é€ä¸€äº›è¯·æ±‚æ•°æ®å’Œå“åº”æ•°æ®ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º HTTP æŠ¥æ–‡ã€‚</p><p><img data-src="https://i.loli.net/2019/06/17/5d0756f543e2f45062.png" alt="HTTPæŠ¥æ–‡ç»“æ„">ä¸ç¼“å­˜ç›¸å…³çš„è§„åˆ™ä¿¡æ¯å°±åŒ…å«åœ¨æŠ¥æ–‡é¦–éƒ¨ä¸­ã€‚ä¸‹é¢æ˜¯ chrome network é¢æ¿ä¸­çš„ä¿¡æ¯ï¼š</p><p><img data-src="https://i.loli.net/2019/06/18/5d087d429e22146774.png" alt="networkæŠ¥æ–‡ç»“æ„è¯´æ˜"></p><p>æµè§ˆå™¨çš„ HTTP ç¼“å­˜åè®®æœ¬è´¨ä¸Šå°±é€šè¿‡è¯·æ±‚å“åº”è¿‡ç¨‹ä¸­åœ¨é¦–éƒ¨ä¸­æºå¸¦é‚£äº›å’Œç¼“å­˜ç›¸å…³çš„å­—æ®µæ¥å®ç°çš„ã€‚</p><h3 id="æµè§ˆå™¨-HTTP-ç¼“å­˜çš„åˆ†ç±»"><a href="#æµè§ˆå™¨-HTTP-ç¼“å­˜çš„åˆ†ç±»" class="headerlink" title="æµè§ˆå™¨ HTTP ç¼“å­˜çš„åˆ†ç±»"></a>æµè§ˆå™¨ HTTP ç¼“å­˜çš„åˆ†ç±»</h3><p>æµè§ˆå™¨ HTTP ç¼“å­˜åˆ†ä¸¤é’Ÿï¼š</p><ol><li>å¼ºç¼“å­˜</li><li>åå•†ç¼“å­˜</li></ol><p><strong>å¼ºç¼“å­˜</strong>æŒ‡çš„æ˜¯æµè§ˆå™¨åœ¨æœ¬åœ°åˆ¤å®šç¼“å­˜æœ‰æ— è¿‡æœŸï¼Œæœªè¿‡æœŸç›´æ¥ä»å†…å­˜æˆ–ç£ç›˜è¯»å–ç¼“å­˜ï¼Œæ•´ä¸ªè¿‡ç¨‹ä¸éœ€è¦å’ŒæœåŠ¡å™¨é€šä¿¡ã€‚</p><p><strong>åå•†ç¼“å­˜</strong>éœ€è¦å‘æœåŠ¡å™¨å‘é€ä¸€æ¬¡åå•†è¯·æ±‚ï¼Œè¯·æ±‚æ—¶å¸¦ä¸Šå’Œåå•†ç¼“å­˜ç›¸å…³çš„è¯·æ±‚å¤´ï¼Œç”±æœåŠ¡å™¨åˆ¤æ–­ç¼“å­˜æ˜¯å¦è¿‡æœŸï¼Œæœªè¿‡æœŸå°±è¿”å›çŠ¶æ€ç  304ï¼Œæµè§ˆå™¨å½“å‘ç°å“åº”çš„è¿”å›ç æ˜¯ 304ï¼Œä¹Ÿç›´æ¥æ˜¯è¯»å–æœ¬åœ°ç¼“å­˜ï¼Œå¦‚æœæœåŠ¡å™¨åˆ¤å®šè¿‡æœŸå°±ç›´æ¥è¿”å›è¯·æ±‚èµ„æºå’Œ last-modifiedï¼ŒçŠ¶æ€ç ä¸º 200ã€‚</p><p>æµè§ˆå™¨è¯·æ±‚èµ„æºæ—¶åˆ¤å®šç¼“å­˜çš„ç®€ç•¥æµç¨‹å¦‚ä¸‹å›¾ï¼š</p><p><img data-src="https://i.loli.net/2019/06/17/5d0748842436b59302.png" alt="æµè§ˆå™¨ HTTP ç¼“å­˜åˆ¤æ–­è¿‡ç¨‹"></p><p>æ–‡å­—è§£é‡Šä¸€ä¸‹ï¼šå½“æµè§ˆå™¨è¯·æ±‚ä¸€ä¸ªèµ„æºæ—¶ï¼Œæµè§ˆå™¨ä¼šå…ˆä»å†…å­˜ä¸­æˆ–è€…ç£ç›˜ä¸­æŸ¥çœ‹æ˜¯å¦æœ‰è¯¥èµ„æºçš„ç¼“å­˜ã€‚å¦‚æœæ²¡æœ‰ç¼“å­˜ï¼Œå¯èƒ½æµè§ˆå™¨ä¹‹å‰æ²¡è®¿é—®è¿‡è¿™ä¸ªèµ„æºæˆ–è€…ç¼“å­˜è¢«æ¸…é™¤äº†é‚£åªèƒ½å‘æœåŠ¡å™¨è¯·æ±‚è¯¥èµ„æºã€‚</p><p>å¦‚æœæœ‰ç¼“å­˜ï¼Œé‚£ä¹ˆå°±å…ˆåˆ¤æ–­æœ‰æ²¡æœ‰å‘½ä¸­å¼ºç¼“å­˜ã€‚å¦‚æœå‘½ä¸­äº†å¼ºç¼“å­˜åˆ™ç›´æ¥ä½¿ç”¨æœ¬åœ°ç¼“å­˜ã€‚å¦‚æœæ²¡æœ‰å‘½ä¸­å¼ºç¼“å­˜ä½†æ˜¯ä¸Šæ¬¡è¯·æ±‚è¯¥èµ„æºæ—¶è¿”å›äº†å’Œåå•†ç¼“å­˜ç›¸å…³çš„å“åº”å¤´å¦‚ last-modified é‚£ä¹ˆå°±å¸¦ä¸Šå’Œåå•†ç¼“å­˜ç›¸å…³çš„è¯·æ±‚å¤´å‘é€è¯·æ±‚ç»™æœåŠ¡å™¨ï¼Œæ ¹æ®æœåŠ¡å™¨è¿”å›çš„çŠ¶æ€ç æ¥åˆ¤å®šæ˜¯å¦å‘½ä¸­äº†åå•†ç¼“å­˜ï¼Œå‘½ä¸­äº†çš„è¯æ˜¯ç”¨æœ¬åœ°ç¼“å­˜ï¼Œæ²¡æœ‰å‘½ä¸­åˆ™ä½¿ç”¨è¯·æ±‚è¿”å›çš„å†…å®¹ã€‚</p><h4 id="å¼ºç¼“å­˜å’Œåå•†ç¼“å­˜çš„åŒºåˆ«"><a href="#å¼ºç¼“å­˜å’Œåå•†ç¼“å­˜çš„åŒºåˆ«" class="headerlink" title="å¼ºç¼“å­˜å’Œåå•†ç¼“å­˜çš„åŒºåˆ«"></a>å¼ºç¼“å­˜å’Œåå•†ç¼“å­˜çš„åŒºåˆ«</h4><ol><li>å‘½ä¸­æ—¶çŠ¶æ€ç ä¸åŒã€‚å¼ºç¼“å­˜è¿”å› 200ï¼Œåå•†ç¼“å­˜è¿”å› 304ã€‚</li><li>ä¼˜å…ˆçº§ä¸åŒã€‚å…ˆåˆ¤å®šå¼ºç¼“å­˜ï¼Œå¼ºç¼“å­˜åˆ¤æ–­å¤±è´¥å†åˆ¤å®šåå•†ç¼“å­˜ã€‚</li><li>å¼ºç¼“å­˜çš„æ”¶ç›Šé«˜äºåå•†ç¼“å­˜ï¼Œå› ä¸ºåå•†ç¼“å­˜ç›¸å¯¹äºå¼ºç¼“å­˜å¤šäº†ä¸€æ¬¡åå•†è¯·æ±‚ã€‚</li></ol><h3 id="æ¼”ç¤ºæœåŠ¡å™¨è¯´æ˜"><a href="#æ¼”ç¤ºæœåŠ¡å™¨è¯´æ˜" class="headerlink" title="æ¼”ç¤ºæœåŠ¡å™¨è¯´æ˜"></a>æ¼”ç¤ºæœåŠ¡å™¨è¯´æ˜</h3><p>æ•´ä¸ª koa2 æ¼”ç¤ºæœåŠ¡å™¨åœ¨è¿™ï¼š<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RqeDY2Ni9rb2EyLWJyb3dzZXItSFRUUC1jYWNoZQ==" title="https://github.com/tjx666/koa2-browser-HTTP-cache">koa2-browser-HTTP-cache<i class="fa fa-external-link"></i></span>ã€‚æ€»å…±å°±å‡ ä¸ªæ–‡ä»¶ï¼Œindex.js å…¥å£æ–‡ä»¶ï¼Œindex.html é¦–é¡µæºä»£ç ï¼Œsunset.jpg å’Œ style.css æ˜¯ index.html ç”¨åˆ°çš„å›¾ç‰‡å’Œæ ·å¼ã€‚</p><p><img data-src="https://i.loli.net/2019/06/18/5d08b61fe2ee448544.png" alt="ç›®å½•ç»“æ„"></p><p>æœåŠ¡å™¨ä»£ç ä»£ç å¾ˆç®€å•ï¼Œä½¿ç”¨ koa-router é…äº†ä¸‰ä¸ªè·¯ç”±ï¼Œç›®å‰è¿˜æ²¡æœ‰å†™ç¼“å­˜ç›¸å…³çš„ä»£ç ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// src/index.js</span></span><br><span class="line"><span class="keyword">const</span> Koa = <span class="built_in">require</span>(<span class="string">'koa'</span>);</span><br><span class="line"><span class="keyword">const</span> Router = <span class="built_in">require</span>(<span class="string">'koa-router'</span>);</span><br><span class="line"><span class="keyword">const</span> mime = <span class="built_in">require</span>(<span class="string">'mime'</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs-extra'</span>);</span><br><span class="line"><span class="keyword">const</span> Path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Koa();</span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> Router();</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤„ç†é¦–é¡µ</span></span><br><span class="line">router.get(<span class="regexp">/(^\/index(.html)?$)|(^\/$)/</span>, <span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">  ctx.type = mime.getType(<span class="string">'.html'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> content = <span class="keyword">await</span> fs.readFile(Path.resolve(__dirname, <span class="string">'./index.html'</span>), <span class="string">'UTF-8'</span>);</span><br><span class="line">  ctx.body = content;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">await</span> next();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤„ç†å›¾ç‰‡</span></span><br><span class="line">router.get(<span class="regexp">/\S*\.(jpe?g|png)$/</span>, <span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; path &#125; = ctx;</span><br><span class="line">  ctx.type = mime.getType(path);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> imageBuffer = <span class="keyword">await</span> fs.readFile(Path.resolve(__dirname, <span class="string">`.<span class="subst">$&#123;path&#125;</span>`</span>));</span><br><span class="line">  ctx.body = imageBuffer;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">await</span> next();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤„ç† css æ–‡ä»¶</span></span><br><span class="line">router.get(<span class="regexp">/\S*\.css$/</span>, <span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; path &#125; = ctx;</span><br><span class="line">  ctx.type = mime.getType(path);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> content = <span class="keyword">await</span> fs.readFile(Path.resolve(__dirname, <span class="string">`.<span class="subst">$&#123;path&#125;</span>`</span>), <span class="string">'UTF-8'</span>);</span><br><span class="line">  ctx.body = content;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">await</span> next();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.use(router.routes()).use(router.allowedMethods());</span><br><span class="line"></span><br><span class="line">app.listen(<span class="number">3000</span>);</span><br><span class="line">process.on(<span class="string">'unhandledRejection'</span>, err =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.error(<span class="string">'æœ‰ promise æ²¡æœ‰ catch'</span>, err);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è®¿é—®é¦–é¡µåé¡µé¢é•¿è¿™æ ·çš„ï¼š</p><p><img data-src="https://i.loli.net/2019/06/18/5d08a6aaed4b785068.png" alt="æœªé…ç½®ç¼“å­˜è®¿é—®é¦–é¡µ"></p><p>å½“å‰æœåŠ¡å™¨æ²¡æœ‰é…ç½®ç¼“å­˜ï¼Œå¯ä»¥çœ‹åˆ° size éƒ¨åˆ†æ˜¾ç¤ºäº†èµ„æºçš„å¤§å°ï¼Œå¦‚æœæ˜¯å‘½å¼ºç¼“å­˜å°±ä¼šæ˜¾ç¤º <code>from memory cache</code> æˆ–è€… <code>from disk cache</code>ã€‚</p><h3 id="å¼ºç¼“å­˜"><a href="#å¼ºç¼“å­˜" class="headerlink" title="å¼ºç¼“å­˜"></a>å¼ºç¼“å­˜</h3><p>å¼ºç¼“å­˜æ˜¯ web æ€§èƒ½ä¼˜åŒ–ä¸­æ”¶ç›Šéå¸¸é«˜çš„ä¸€ç§æ‰‹æ®µã€‚</p><h4 id="å¼ºç¼“å­˜ç›¸å…³çš„å¤´éƒ¨å­—æ®µ"><a href="#å¼ºç¼“å­˜ç›¸å…³çš„å¤´éƒ¨å­—æ®µ" class="headerlink" title="å¼ºç¼“å­˜ç›¸å…³çš„å¤´éƒ¨å­—æ®µ"></a>å¼ºç¼“å­˜ç›¸å…³çš„å¤´éƒ¨å­—æ®µ</h4><p>å‰é¢è¯´è¿‡ç¼“å­˜åè®®æœ¬è´¨ä¸Šæ˜¯é€šè¿‡è¯·æ±‚å“åº”å¤´æ¥å®ç°çš„ã€‚å’Œå¼ºç¼“å­˜ç›¸å…³çš„å¤´éƒ¨å­—æ®µæœ‰ä»¥ä¸‹è¿™äº›ï¼š</p><h5 id="pragma"><a href="#pragma" class="headerlink" title="pragma"></a><span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9XZWIvSFRUUC9IZWFkZXJzL1ByYWdtYQ==" title="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Pragma">pragma<i class="fa fa-external-link"></i></span></h5><p>progma æ˜¯ HTTP1.0 æ—¶æœŸçš„äº§ç‰©ï¼Œå’Œåé¢è¦è¯´çš„ cache-control ä½œç”¨å·®ä¸å¤šï¼Œå®ƒçš„å€¼åªèƒ½è®¾ç½®ä¸º <code>no-cache</code>ã€‚ä¸ Cache-Control: no-cache æ•ˆæœä¸€è‡´ï¼Œå³ç¦ç”¨å¼ºç¼“å­˜ï¼Œåªèƒ½ä½¿ç”¨åå•†ç¼“å­˜ã€‚</p><h5 id="expires"><a href="#expires" class="headerlink" title="expires"></a><span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9XZWIvSFRUUC9IZWFkZXJzL0V4cGlyZXM=" title="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Expires">expires<i class="fa fa-external-link"></i></span></h5><p>å“åº”å¤´å­—æ®µï¼ŒåŒ…å«æ—¥æœŸ/æ—¶é—´ï¼Œ è¡¨ç¤ºèµ„æºçš„è¿‡æœŸæ—¶é—´ã€‚ä¾‹å¦‚ <code>Thu, 31 Dec 2037 23:55:55 GMT</code>ã€‚æ— æ•ˆçš„æ—¥æœŸï¼Œæ¯”å¦‚ 0ï¼Œä»£è¡¨ç€è¿‡å»çš„æ—¥æœŸï¼Œéƒ½è¡¨æ˜è¯¥èµ„æºå·²ç»è¿‡æœŸã€‚</p><p>å¦‚æœåœ¨<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Cache-Control" target="_blank" rel="noopener"><code>Cache-Control</code></a>å“åº”å¤´è®¾ç½®äº† â€œmax-ageâ€ æˆ–è€… â€œs-max-ageâ€ æŒ‡ä»¤ï¼Œé‚£ä¹ˆ <code>Expires</code> å¤´ä¼šè¢«å¿½ç•¥ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼˜å…ˆçº§ cacahe-control å¤§äº expiresã€‚</p><p>å› ä¸º expires æ˜¯ä¸€ä¸ªæ—¶é—´å€¼ï¼Œå¦‚æœæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯æ˜¯ç³»ç»Ÿæ—¶é—´å·®è¾ƒå¤§ï¼Œå°±ä¼šå¼•èµ·ç¼“å­˜æ··ä¹±ã€‚</p><h5 id="cache-control"><a href="#cache-control" class="headerlink" title="cache-control"></a><span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9XZWIvSFRUUC9IZWFkZXJzL0NhY2hlLUNvbnRyb2w=" title="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Cache-Control">cache-control<i class="fa fa-external-link"></i></span></h5><p>HTTP 1.1 ä¸­å¢åŠ çš„å­—æ®µï¼Œè¢«è®¾è®¡ç”¨æ¥æ›¿ä»£ pragmaã€‚cache-control è¿™ä¸ªå¤´éƒ¨å­—æ®µæ—¢å¯ä»¥ç”¨åœ¨è¯·æ±‚å¤´ä¹Ÿå¯ä»¥ç”¨åœ¨å“åº”å¤´ä¸­ã€‚</p><p>æˆ‘ä»¬éƒ½çŸ¥é“åœ¨ chrome ä¸­ shift + F5 æˆ–è€…åœ¨ network é¢æ¿å‹¾é€‰äº† disable cache æ—¶æµè§ˆå™¨æ¯æ¬¡åŠ è½½èµ„æºæ—¶éƒ½ä¼šè¯·æ±‚æœ€æ–°çš„èµ„æºè€Œä¸æ˜¯ä½¿ç”¨ç¼“å­˜ã€‚ä»”ç»†è§‚å¯Ÿ network é¢æ¿çš„ request headersï¼Œå‘ç°å½“ç¦ç”¨ç¼“å­˜åï¼Œæµè§ˆå™¨æ¯æ¬¡è¯·æ±‚èµ„æºæ—¶ä¼šå¸¦ä¸Š cache-control: no-cache æ¥å‘Šè¯‰æœåŠ¡å™¨æˆ‘ä¸éœ€è¦åå•†ç¼“å­˜ï¼Œä½ ç›´æ¥æŠŠæœ€æ–°çš„èµ„æºè¿”å›ã€‚</p><p>ä¸‹é¢æ˜¯æˆ‘å‹¾é€‰äº†ç¦ç”¨ç¼“å­˜ä¹‹åè¯·æ±‚é…ç½®äº†åå•†ç¼“å­˜çš„å›¾ç‰‡çš„æˆªå›¾ï¼š</p><p><img data-src="https://i.loli.net/2019/06/18/5d08b2aa904ec34767.png" alt="ç¦ç”¨ç¼“å­˜"></p><p>cache-control ä½œä¸ºå“åº”å¤´å­—æ®µå…¶å®æ˜¯å¯¹ expires åšäº†æ”¹è¿›ï¼Œcache-control å…¶ä¸­çš„ä¸€ç§å€¼å½¢å¼ä¸º cache-control: max-age=secondsï¼Œä¾‹å¦‚ï¼šcache-control: max-age=315360000ã€‚seconds æ˜¯ä¸€ä¸ªæ—¶é—´å·®è€Œä¸æ˜¯å›ºå®šçš„æ—¶é—´ï¼Œå› ä¸ºæ˜¯æ—¶é—´å·®æ‰€ä»¥ä¸å­˜åœ¨ä¸Šé¢æåˆ°çš„ expires çš„å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯æ—¶é—´ä¸åŒæ­¥å¯¼è‡´ç¼“å­˜æ··ä¹±çš„é—®é¢˜ã€‚</p><h4 id="å¼ºç¼“å­˜ç›¸å…³çš„é¦–éƒ¨å­—æ®µçš„ä¼˜å…ˆçº§"><a href="#å¼ºç¼“å­˜ç›¸å…³çš„é¦–éƒ¨å­—æ®µçš„ä¼˜å…ˆçº§" class="headerlink" title="å¼ºç¼“å­˜ç›¸å…³çš„é¦–éƒ¨å­—æ®µçš„ä¼˜å…ˆçº§"></a>å¼ºç¼“å­˜ç›¸å…³çš„é¦–éƒ¨å­—æ®µçš„ä¼˜å…ˆçº§</h4><p>pragma &gt; cache-control &gt; expiresã€‚</p><h4 id="å¼ºç¼“å­˜çš„å…·ä½“æµç¨‹"><a href="#å¼ºç¼“å­˜çš„å…·ä½“æµç¨‹" class="headerlink" title="å¼ºç¼“å­˜çš„å…·ä½“æµç¨‹"></a>å¼ºç¼“å­˜çš„å…·ä½“æµç¨‹</h4><p>å‰é¢è®²è¿‡æµè§ˆå™¨ HTTP ç¼“å­˜çš„ç®€ç•¥æµç¨‹ï¼Œè¿™é‡Œå…·ä½“è®²è®²<strong>å¼ºç¼“å­˜</strong>çš„åˆ¤å®šè¿‡ç¨‹ã€‚</p><p>é¦–å…ˆï¼Œå½“æµè§ˆå™¨å‘ç°äº†å†…å­˜æˆ–è€…ç£ç›˜æœ‰ä½ è¯·æ±‚çš„èµ„æºç¼“å­˜æ—¶ï¼Œæ­¤æ—¶æµè§ˆå™¨è¿˜ä¼šæ£€æŸ¥è¯¥èµ„æºä¸Šä¸€æ¬¡è¯·æ±‚æ—¶çš„æœ‰æ²¡æœ‰è¿”å›ä¸Šé¢å™è¿°çš„å’Œå¼ºç¼“å­˜ç›¸å…³çš„å“åº”å¤´ã€‚æ ¹æ®ä¸Šé¢è¯´çš„å’Œå¼ºç¼“å­˜ç›¸å…³çš„é¦–éƒ¨å­—æ®µçš„ä¼˜å…ˆçº§ï¼Œä¸€æ­¥ä¸€æ­¥åˆ¤æ–­ã€‚å¯èƒ½æœ‰äº›å­—æ®µæœåŠ¡å™¨ä¸ä¼šè¿”å›ï¼Œæ¯”å¦‚ pragmaï¼Œé‚£å°±ç›´æ¥å¾€ååˆ¤æ–­ã€‚å…·ä½“å°±æ˜¯ï¼šå¦‚æœ pragma: no-cacheï¼Œé‚£å¼ºç¼“å­˜ç›´æ¥å°±åˆ¤æ–­å¤±è´¥äº†ï¼Œåªèƒ½èµ°åå•†ç¼“å­˜ã€‚å¦‚æœæ²¡æœ‰ pragmaï¼Œä½†æ˜¯æœ‰ cache-control: no-cacheï¼Œè¿™å°±å’Œ pragma: no-cache ä¸€æ ·ï¼Œå¼ºç¼“å­˜åˆ¤æ–­å¤±è´¥ã€‚å¦‚æœ cache-control: max-age=secondsï¼Œé‚£ä¹ˆæ­¤æ—¶å°±æ ¹æ®æµè§ˆå™¨ä¸Šæ¬¡è¯·æ±‚è¯¥èµ„æºçš„æ—¶é—´å’Œ seconds ç®—å‡ºè¿‡æœŸæ—¶é—´ï¼Œå¦‚æœæ—©äºè¿‡æœŸæ—¶é—´ä¹Ÿå°±æ˜¯æœªè¿‡æœŸï¼Œé‚£ä¹ˆå‘½ä¸­å¼ºç¼“å­˜ï¼Œå¦‚æœè¿‡æœŸäº†å¼ºç¼“å­˜åˆ¤å®šå¤±è´¥ã€‚å‰é¢è¯´è¿‡äº†å¦‚æœ control-control å€¼ä¸º max-age æˆ–è€… s-max-age é‚£ä¹ˆ expires ç›´æ¥å°±æ— æ•ˆäº†ã€‚å½“ cache-control å€¼ä¸æ˜¯é‚£ä¸¤ä¸ªæˆ–åˆ™æ²¡æœ‰æ—¶ï¼Œè¿˜è¦æ ¹æ® expires å€¼ä¹Ÿå°±æ˜¯è¿‡æœŸæ—¶é—´æ¥åˆ¤å®šæœ‰æ²¡æœ‰è¿‡æœŸï¼Œæ²¡æœ‰è¿‡æœŸå°±å‘½ä¸­å¼ºç¼“å­˜ï¼Œå¦åˆ™ï¼Œç¼“å­˜å¤±æ•ˆï¼Œå‘æœåŠ¡å™¨è¯·æ±‚æœ€æ–°èµ„æºã€‚</p><h4 id="ä½¿ç”¨-expires-é…ç½®å¼ºç¼“å­˜"><a href="#ä½¿ç”¨-expires-é…ç½®å¼ºç¼“å­˜" class="headerlink" title="ä½¿ç”¨ expires é…ç½®å¼ºç¼“å­˜"></a>ä½¿ç”¨ expires é…ç½®å¼ºç¼“å­˜</h4><p>ä¿®æ”¹ src/index.js ä¸­å¤„ç†å›¾ç‰‡çš„è·¯ç”±ï¼Œå…¶å®å°±æ˜¯åœ¨å“åº”å¤´ä¸­åŠ ä¸Šäº† expires å­—æ®µï¼Œè¿‡æœŸæ—¶é—´ä¸º 2 åˆ†é’Ÿåã€‚</p><figure class="highlight diff"><table><tr><td class="code"><pre><span class="line">// å¤„ç†å›¾ç‰‡</span><br><span class="line">router.get(/\S*\.(jpe?g|png)$/, async (ctx, next) =&gt; &#123;</span><br><span class="line">    const &#123; response, path &#125; = ctx;</span><br><span class="line">    ctx.type = mime.getType(path);</span><br><span class="line"></span><br><span class="line">    // æ·»åŠ  expires å­—æ®µåˆ°å“åº”å¤´ï¼Œè¿‡æœŸæ—¶é—´ 2 åˆ†é’Ÿ</span><br><span class="line"><span class="addition">+    response.set('expires', new Date(Date.now() + 2 * 60 * 1000).toString());</span></span><br><span class="line"></span><br><span class="line">    const imageBuffer = await fs.readFile(Path.resolve(__dirname, `.$&#123;path&#125;`));</span><br><span class="line">    ctx.body = imageBuffer;</span><br><span class="line"></span><br><span class="line">    await next();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€æ¬¡è®¿é—®ï¼š</p><p><img data-src="https://i.loli.net/2019/06/18/5d09071435c3c54245.png" alt="expiresé…ç½®å¼ºç¼“å­˜ç¬¬ä¸€æ¬¡è®¿é—®"></p><p>æ³¨æ„æˆ‘ä¸Šé¢çš„ç®­å¤´æŒ‡å‘çš„åœ°æ–¹ï¼Œé¼ æ ‡å·¦é”®é•¿æŒ‰åŠ è½½æŒ‰é’®ä¼šå¼¹å‡ºä¸‰ä¸ªä¸åŒçš„åŠ è½½é€‰é¡¹ï¼Œå°¤å…¶æ˜¯æœ€åä¸€ä¸ªåœ¨å¼€å‘æ—¶å¾ˆæœ‰ç”¨ï¼Œå¯ä»¥æ¸…é™¤é¡µé¢ç¼“å­˜ã€‚</p><p>ç„¶åç«‹å³åˆ·æ–°é¡µé¢ï¼š</p><p><img data-src="https://i.loli.net/2019/06/18/5d0907799f29b67306.png" alt="expires é…ç½®å¼ºç¼“å­˜ç”Ÿæ•ˆ"></p><p>2 åˆ†é’Ÿåå†æ¬¡åˆ·æ–°åˆæ˜¯å’Œç¬¬ä¸€å¼ å›¾ä¸€æ ·ï¼Œæˆ‘å°±ä¸æ”¾æˆªå›¾äº†ã€‚å¯ä»¥çœ‹å‡ºï¼Œå…¶å®é…ç½®å¼ºç¼“å­˜å¾ˆç®€å•ï¼Œå°±æ˜¯æŒ‰ç…§åè®®çº¦å®šé…ç½®å“åº”å¤´ã€‚</p><h4 id="æµ‹è¯•-pragramï¼Œcache-controlï¼Œ-expires-ä¼˜å…ˆçº§"><a href="#æµ‹è¯•-pragramï¼Œcache-controlï¼Œ-expires-ä¼˜å…ˆçº§" class="headerlink" title="æµ‹è¯• pragramï¼Œcache-controlï¼Œ expires ä¼˜å…ˆçº§"></a>æµ‹è¯• pragramï¼Œcache-controlï¼Œ expires ä¼˜å…ˆçº§</h4><p>å“åº”å¤´æ·»åŠ  cache-control: no-cacheï¼Œå³ä¸å…è®¸ä½¿ç”¨å¼ºç¼“å­˜ã€‚</p><figure class="highlight diff"><table><tr><td class="code"><pre><span class="line">// å¤„ç†å›¾ç‰‡</span><br><span class="line">router.get(/\S*\.(jpe?g|png)$/, async (ctx, next) =&gt; &#123;</span><br><span class="line">    const &#123; response, path &#125; = ctx;</span><br><span class="line">    ctx.type = mime.getType(path);</span><br><span class="line"></span><br><span class="line"><span class="addition">+    response.set('cache-control', 'no-cache');</span></span><br><span class="line">    // æ·»åŠ  expires å­—æ®µåˆ°å“åº”å¤´ï¼Œè¿‡æœŸæ—¶é—´ 2 åˆ†é’Ÿ</span><br><span class="line">    response.set('expires', new Date(Date.now() + 2 * 60 * 1000).toString());</span><br><span class="line"></span><br><span class="line">    const imageBuffer = await fs.readFile(Path.resolve(__dirname, `.$&#123;path&#125;`));</span><br><span class="line">    ctx.body = imageBuffer;</span><br><span class="line"></span><br><span class="line">    await next();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// å¤„ç† css æ–‡ä»¶</span><br><span class="line">router.get(/\S*\.css$/, async (ctx, next) =&gt; &#123;</span><br><span class="line">    const &#123; path &#125; = ctx;</span><br><span class="line">    ctx.type = mime.getType(path);</span><br><span class="line"></span><br><span class="line">    const content = await fs.readFile(Path.resolve(__dirname, `.$&#123;path&#125;`), 'UTF-8');</span><br><span class="line">    ctx.body = content;</span><br><span class="line"></span><br><span class="line">    await next();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è®¾ç½®äº† cache-control: no-cache åï¼Œæ¯æ¬¡åˆ·æ–°éƒ½æ˜¯ä¸‹é¢æˆªå›¾ä¸€æ ·ï¼Œæµè§ˆå™¨ä¸å†ä½¿ç”¨ç¼“å­˜ï¼Œå¦‚æœä½¿ç”¨äº†ç¼“å­˜å°±ä¼šåƒä¸Šé¢çš„é‚£å¼ æˆªå›¾ä¸€æ ·åœ¨ Status Code éƒ¨åˆ†æœ‰è¯´æ˜ã€‚å¾—å‡ºç»“è®º cache-control ç¡®å®ä¼˜å…ˆçº§æ¯” expires é«˜ã€‚</p><p><img data-src="https://i.loli.net/2019/06/22/5d0e28a42085198392.png" alt=""></p><p>è®¾ç½® cache-control: max-age=60ï¼Œç†è®ºä¸Šæ•ˆæœåº”è¯¥æ˜¯ç¼“å­˜ 1 åˆ†é’Ÿåå¤±æ•ˆï¼Œäº‹å®è¯æ˜ç¡®å®å¦‚æ­¤ã€‚</p><p>æ³¨æ„è§‚å¯Ÿä¸‹é¢ä¸¤å¼ å›¾çš„ expires æ—¶é—´ï¼Œç¬¬ä¸€å¼ æˆªå›¾æ˜¾ç¤º 21:33 å¤±æ•ˆã€‚ç„¶è€Œï¼Œç”±äº cache-control ä¼˜å…ˆçº§æ›´é«˜ï¼Œæ‰€ä»¥ä¼šæå‰ä¸€åˆ†é’Ÿè¿‡æœŸï¼Œæ‰€ä»¥ç»“æœå°±åƒç¬¬äºŒå¼ å›¾ 21:22 åˆ†é’Ÿç¼“å­˜å°±å¤±æ•ˆäº†ã€‚</p><p><img data-src="https://i.loli.net/2019/06/22/5d0e2e1ac157716766.png" alt="max-age1"></p><p><img data-src="https://i.loli.net/2019/06/22/5d0e2e5095d0115156.png" alt="max-age2"></p><p>å†æ¥æµ‹è¯•ä¸€ä¸‹ pragmaã€‚</p><figure class="highlight diff"><table><tr><td class="code"><pre><span class="line">// å¤„ç†å›¾ç‰‡</span><br><span class="line">router.get(/\S*\.(jpe?g|png)$/, async (ctx, next) =&gt; &#123;</span><br><span class="line">    const &#123; response, path &#125; = ctx;</span><br><span class="line">    ctx.type = mime.getType(path);</span><br><span class="line"></span><br><span class="line"><span class="addition">+    response.set('pragma', 'no-cache');</span></span><br><span class="line">    // max-age å€¼æ˜¯ç²¾ç¡®åˆ°ç§’ï¼Œè®¾ç½®è¿‡æœŸæ—¶é—´ä¸º 1 åˆ†é’Ÿ</span><br><span class="line">    response.set('cache-control', `max-age=$&#123;1 * 60&#125;`);</span><br><span class="line">    // æ·»åŠ  expires å­—æ®µåˆ°å“åº”å¤´ï¼Œè¿‡æœŸæ—¶é—´ 2 åˆ†é’Ÿ</span><br><span class="line">    response.set('expires', new Date(Date.now() + 2 * 60 * 1000).toString());</span><br><span class="line"></span><br><span class="line">    const imageBuffer = await fs.readFile(Path.resolve(__dirname, `.$&#123;path&#125;`));</span><br><span class="line">    ctx.body = imageBuffer;</span><br><span class="line"></span><br><span class="line">    await next();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// å¤„ç† css æ–‡ä»¶</span><br><span class="line">router.get(/\S*\.css$/, async (ctx, next) =&gt; &#123;</span><br><span class="line">    const &#123; path &#125; = ctx;</span><br><span class="line">    ctx.type = mime.getType(path);</span><br><span class="line"></span><br><span class="line">    const content = await fs.readFile(Path.resolve(__dirname, `.$&#123;path&#125;`), 'UTF-8');</span><br><span class="line">    ctx.body = content;</span><br><span class="line"></span><br><span class="line">    await next();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ç»“æœå’Œè®¾ç½® cache-control: no-cache æ•ˆæœä¸€æ ·ï¼Œæ°¸è¿œä¸ä¼šä½¿ç”¨æœ¬åœ°ç¼“å­˜ã€‚æ‰€ä»¥ç»“è®ºå°±æ˜¯:</p><blockquote><p>pragma &gt; cache-control &gt; expiresã€‚</p></blockquote><h3 id="åå•†ç¼“å­˜"><a href="#åå•†ç¼“å­˜" class="headerlink" title="åå•†ç¼“å­˜"></a>åå•†ç¼“å­˜</h3><p>åå•†ç¼“å­˜ç”±äºéœ€è¦å‘æœåŠ¡å™¨å‘é€ä¸€æ¬¡è¯·æ±‚ï¼Œæ‰€ä»¥ç›¸æ¯”äºå¼ºç¼“å­˜æ¥æ”¶æ”¶ç›Šæ›´ä½ï¼Œç¼“å­˜èµ„æºä½“ç§¯è¶Šå¤§ï¼Œæ”¶ç›Šè¶Šé«˜ã€‚</p><h4 id="å’Œåå•†ç¼“å­˜ç›¸å…³çš„é¦–éƒ¨å­—æ®µ"><a href="#å’Œåå•†ç¼“å­˜ç›¸å…³çš„é¦–éƒ¨å­—æ®µ" class="headerlink" title="å’Œåå•†ç¼“å­˜ç›¸å…³çš„é¦–éƒ¨å­—æ®µ"></a>å’Œåå•†ç¼“å­˜ç›¸å…³çš„é¦–éƒ¨å­—æ®µ</h4><p>åå•†ç¼“å­˜ä¸­é‚£å‡ ä¸ªé¦–éƒ¨å­—æ®µæ˜¯<strong>é…å¯¹ä½¿ç”¨</strong>çš„ï¼Œå³ï¼š</p><ul><li>è¯·æ±‚å¤´ if-modified-since å’Œå“åº”å¤´ last-modified</li><li>è¯·æ±‚å¤´ if-none-match å’Œå“åº”å¤´ etag</li></ul><h5 id="if-modified-since-å’Œ-last-modified"><a href="#if-modified-since-å’Œ-last-modified" class="headerlink" title="if-modified-since å’Œ last-modified"></a><span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9XZWIvSFRUUC9IZWFkZXJzL0lmLU1vZGlmaWVkLVNpbmNl" title="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/If-Modified-Since">if-modified-since<i class="fa fa-external-link"></i></span> å’Œ <span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9XZWIvSFRUUC9IZWFkZXJzL0xhc3QtTW9kaWZpZWQ=" title="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Last-Modified">last-modified<i class="fa fa-external-link"></i></span></h5><p>å®ƒä¿©çš„å€¼éƒ½æ˜¯ GMT æ ¼å¼çš„<strong>ç²¾ç¡®åˆ°ç§’</strong>çš„æ—¶é—´å€¼ã€‚ä»å­—é¢ä¸Šå°±å¾ˆå¥½ç†è§£å®ƒä»¬çš„å«ä¹‰ï¼š<code>è‡ªä»æŸæŸæ—¶é—´æœ‰æ²¡æœ‰ä¿®æ”¹è¿‡?</code>ï¼Œ<code>æœ€åä¸€æ¬¡ä¿®æ”¹æ—¶é—´ä¸ºæŸæŸæ—¶é—´</code>ã€‚</p><p>ä»–ä¿©æœ‰å•¥å…³ç³»å‘¢ï¼Ÿå…¶å®<strong>æœ¬æ¬¡è¯·æ±‚å¤´ if-modified-since çš„å€¼åº”è¯¥ä¸ºä¸Šä¸€æ¬¡è¯·æ±‚è¯¥èµ„æºçš„å“åº”å¤´ä¸­ last-modified çš„å€¼</strong>ã€‚</p><p>å½“æµè§ˆå™¨å‘èµ·èµ„æºè¯·æ±‚å¹¶æºå¸¦ if-modified-since å­—æ®µï¼ŒæœåŠ¡å™¨ä¼šå°†è¯·æ±‚å¤´ä¸­çš„ if-modified-since å€¼å’Œè¯·æ±‚èµ„æºçš„ æœ€åä¿®æ”¹æ—¶é—´è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœèµ„æºæœ€åä¿®æ”¹æ—¶é—´æ¯” if-modified-since æ—¶é—´æ™šï¼Œé‚£ä¹ˆèµ„æºè¿‡æœŸï¼ŒçŠ¶æ€ç ä¸º 200ï¼Œå“åº”ä½“ä¸ºè¯·æ±‚èµ„æºï¼Œå“åº”å¤´ä¸­åŠ å…¥æœ€æ–°çš„ last-modified çš„å€¼ã€‚æ²¡è¿‡æœŸå°±è¿”å›çŠ¶æ€ç  304ï¼Œå‘½ä¸­åå•†ç¼“å­˜ï¼Œå“åº”ä½“ä¸ºç©ºï¼Œå“åº”å¤´ä¸éœ€è¦ last-modified å€¼ã€‚</p><h5 id="if-none-match-å’Œå“åº”å¤´-etag"><a href="#if-none-match-å’Œå“åº”å¤´-etag" class="headerlink" title="if-none-match å’Œå“åº”å¤´ etag"></a><span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9XZWIvSFRUUC9IZWFkZXJzL0lmLU5vbmUtTWF0Y2g=" title="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/If-None-Match">if-none-match<i class="fa fa-external-link"></i></span> å’Œå“åº”å¤´ <span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvemgtQ04vZG9jcy9XZWIvSFRUUC9IZWFkZXJzL0VUYWc=" title="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/ETag">etag<i class="fa fa-external-link"></i></span></h5><p>ä¸Šé¢ä¸¤ä¸ªæ˜¯ HTTP 1.0 ä¸­å¤„ç†åå•†ç¼“å­˜çš„é¦–éƒ¨å­—æ®µï¼Œè¿™ä¸¤ä¸ªæ˜¯ HTTP 1.1 æ‰å‡ºç°çš„ã€‚</p><p>è¿™é‡Œæˆ‘æ€»ç»“ä¸‹ MDN ä¸­å¯¹ if-none-match çš„æè¿°çš„å‡ ä¸ªé‡ç‚¹ï¼ˆè¿™é‡Œåªè®¨è®º GET è¯·æ±‚èµ„æºï¼‰ï¼š</p><ol><li>å½“ä¸”ä»…å½“æœåŠ¡å™¨ä¸Šæ²¡æœ‰ä»»ä½•èµ„æºçš„ <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/ETag" target="_blank" rel="noopener"><code>ETag</code></a> å±æ€§å€¼ä¸è¿™ä¸ªé¦–éƒ¨ä¸­åˆ—å‡ºçš„ç›¸åŒ¹é…çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨ç«¯ä¼šæ‰è¿”å›æ‰€è¯·æ±‚çš„èµ„æºï¼Œå“åº”ç ä¸º 200ã€‚</li><li>æœåŠ¡å™¨ç«¯åœ¨ç”ŸæˆçŠ¶æ€ç ä¸º 304 çš„å“åº”çš„æ—¶å€™ï¼Œä¼šå­˜åœ¨äºå¯¹åº”çš„ 200 å“åº”ä¸­çš„é¦–éƒ¨ï¼šCache-Controlã€Content-Locationã€Dateã€ETagã€Expires å’Œ Vary ã€‚</li><li>If-none-match ä¼˜å…ˆçº§æ¯” if-modified-since ä¼˜å…ˆçº§é«˜ã€‚</li></ol><p>etag å¸¸è§çš„æ ·å­æ˜¯ <code>etag: &quot;54984c2b-44e&quot;</code>ã€‚å’Œä¸Šé¢é‚£å¯¹ä¸€æ ·ï¼Œ<strong>æœ¬æ¬¡è¯·æ±‚å¤´ if-none-match çš„å€¼ä¸ºä¸Šä¸€æ¬¡è¯·æ±‚è¯¥èµ„æºçš„å“åº”å¤´ä¸­ etag çš„å€¼</strong>ã€‚</p><p>æœ‰äººå¯èƒ½çœ‹åˆ°è¿™é‡Œä¼šé—®ï¼šetag åˆ°åº•æ˜¯ä¸ªå•¥ç©æ„ï¼Ÿå¦‚æœä½ äº†è§£å“ˆå¸Œæ‘˜è¦æˆ‘è§‰å¾—å°±å¾ˆå¥½ç†è§£äº†ï¼Œetag è¡¨ç¤ºçš„æ˜¯æ‰€è¯·æ±‚èµ„æºçš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œç®€å•æ¥å®ç°å°±æ˜¯ç»™è¯·æ±‚çš„èµ„æºé€šè¿‡æŸç§ hash ç®—æ³•å–ä¸ªæ‘˜è¦å­—ç¬¦ä¸²ç„¶åç”¨åŒå¼•å·åŒ…èµ·æ¥å°±å¥½äº†ã€‚</p><p>MDN ä¸Šå¯¹ etag çš„æè¿°æ˜¯ï¼š</p><blockquote><p>å®ƒä»¬æ˜¯ä½äºåŒå¼•å·ä¹‹é—´çš„ ASCII å­—ç¬¦ä¸²ï¼ˆå¦‚â€œ675af34563dc-tr34â€ï¼‰ã€‚ æ²¡æœ‰æ˜ç¡®æŒ‡å®šç”Ÿæˆ ETag å€¼çš„æ–¹æ³•ã€‚ é€šå¸¸ï¼Œä½¿ç”¨å†…å®¹çš„æ•£åˆ—ï¼Œæœ€åä¿®æ”¹æ—¶é—´æˆ³çš„å“ˆå¸Œå€¼ï¼Œæˆ–ç®€å•åœ°ä½¿ç”¨ç‰ˆæœ¬å·ã€‚ ä¾‹å¦‚ï¼ŒMDN ä½¿ç”¨ wiki å†…å®¹çš„åå…­è¿›åˆ¶æ•°å­—çš„å“ˆå¸Œå€¼ã€‚</p></blockquote><p>ä½¿ç”¨ if-none-match/etag è¿™å¯¹å¤´éƒ¨å­—æ®µæ¥å¤„ç†åå•†ç¼“å­˜çš„è¿‡ç¨‹å’Œ if-modified-since/etag å…¶å®æ˜¯å·®ä¸å¤šã€‚åªä¸è¿‡æ¯”è¾ƒçš„æ˜¯ hash å€¼è€Œä¸æ˜¯æ—¥æœŸã€‚</p><h4 id="ä¸ºä»€ä¹ˆæœ‰äº†-last-modified-è¿˜éœ€è¦-etag-ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆæœ‰äº†-last-modified-è¿˜éœ€è¦-etag-ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆæœ‰äº† last-modified è¿˜éœ€è¦ etag ï¼Ÿ"></a>ä¸ºä»€ä¹ˆæœ‰äº† last-modified è¿˜éœ€è¦ etag ï¼Ÿ</h4><ol><li>èµ„æºåœ¨ 1 ç§’å†…æ›´æ–°ï¼Œå¹¶ä¸”åœ¨è¯¥ä¸€ç§’å†…è®¿é—®ï¼Œä½¿ç”¨ last-modified å¤„ç†åå•†ç¼“å­˜æ— æ³•è·å–æœ€æ–°èµ„æºã€‚æœ¬è´¨ä¸Šçš„åŸå› è¿˜æ˜¯å› ä¸º last-modified æ˜¯ç²¾ç¡®åˆ°ç§’çš„ï¼Œæ— æ³•åæ˜ åœ¨ 1 ç§’å†…çš„å˜åŒ–ã€‚</li><li>å½“èµ„æºå¤šæ¬¡è¢«ä¿®æ”¹åå†…å®¹ä¸å˜ï¼Œä½¿ç”¨ last-modified æ¥å¤„ç†æœ‰ç‚¹æµªè´¹ã€‚å¤šæ¬¡ä¿®æ”¹èµ„æºï¼Œå…¶ last-modified å€¼è‚¯å®šæ˜¯ä¼šå˜çš„ï¼Œä½†æ˜¯å¦‚æœå†…å®¹ä¸å˜æˆ‘ä»¬å…¶å®ä¸éœ€è¦æœåŠ¡å™¨è¿”å›æœ€æ–°èµ„æºï¼Œç›´æ¥ä½¿ç”¨æœ¬åœ°ç¼“å­˜ã€‚ä½¿ç”¨ etag å°±æ²¡è¿™ä¸ªé—®é¢˜ï¼Œå› ä¸ºåŒä¸€ä¸ªèµ„æºå¤šæ¬¡ä¿®æ”¹ï¼Œå†…å®¹ä¸€æ ·ï¼Œ hash å€¼ä¹Ÿä¸€æ ·ã€‚</li><li>ä½¿ç”¨ etag æ›´åŠ çµæ´»ï¼Œå› ä¸º etag å¹¶ä¸ä¸€å®šæ˜¯æˆ‘è¯´çš„å°±ç”¨ hash å€¼ï¼Œetag é‡‡ç”¨çš„æ˜¯å¼±æ¯”è¾ƒç®—æ³•ï¼Œå³ä¸¤ä¸ªæ–‡ä»¶é™¤äº†æ¯ä¸ªæ¯”ç‰¹éƒ½ç›¸åŒå¤–ï¼Œå†…å®¹ä¸€è‡´ä¹Ÿå¯ä»¥è®¤ä¸ºæ˜¯ç›¸åŒçš„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸¤ä¸ªé¡µé¢ä»…ä»…åœ¨é¡µè„šçš„ç”Ÿæˆæ—¶é—´æœ‰æ‰€ä¸åŒï¼Œå°±å¯ä»¥è®¤ä¸ºäºŒè€…æ˜¯ç›¸åŒçš„ã€‚</li></ol><h4 id="åå•†ç¼“å­˜é¦–éƒ¨å­—æ®µä¼˜å…ˆçº§"><a href="#åå•†ç¼“å­˜é¦–éƒ¨å­—æ®µä¼˜å…ˆçº§" class="headerlink" title="åå•†ç¼“å­˜é¦–éƒ¨å­—æ®µä¼˜å…ˆçº§"></a>åå•†ç¼“å­˜é¦–éƒ¨å­—æ®µä¼˜å…ˆçº§</h4><p><strong>if-none-match &gt; if-modified-since</strong>ã€‚</p><p>å½“æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ä¸­åŒæ—¶åŒ…å« if-modified-since å’Œ if-none-match æ—¶ï¼ŒæœåŠ¡å™¨ä¼šå¿½ç•¥ if-modified-sinceã€‚</p><h4 id="æµ‹è¯•-last-modified-é…ç½®åå•†ç¼“å­˜"><a href="#æµ‹è¯•-last-modified-é…ç½®åå•†ç¼“å­˜" class="headerlink" title="æµ‹è¯• last-modified é…ç½®åå•†ç¼“å­˜"></a>æµ‹è¯• last-modified é…ç½®åå•†ç¼“å­˜</h4><p>å†™åˆ°è¿™é‡Œæ—¶ï¼Œç¬”è€…ç¨å¾®é‡æ„äº†ä¸‹æœåŠ¡å™¨ä»£ç å¹¶ä½¿ç”¨ last-modified é…ç½®äº†åå•†ç¼“å­˜ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> Koa = <span class="built_in">require</span>(<span class="string">'koa'</span>);</span><br><span class="line"><span class="keyword">const</span> Router = <span class="built_in">require</span>(<span class="string">'koa-router'</span>);</span><br><span class="line"><span class="keyword">const</span> mime = <span class="built_in">require</span>(<span class="string">'mime'</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs-extra'</span>);</span><br><span class="line"><span class="keyword">const</span> Path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Koa();</span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> Router();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> responseFile = <span class="keyword">async</span> (path, context, encoding) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> fileContent = <span class="keyword">await</span> fs.readFile(path, encoding);</span><br><span class="line">  context.type = mime.getType(path);</span><br><span class="line">  context.body = fileContent;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤„ç†é¦–é¡µ</span></span><br><span class="line">router.get(<span class="regexp">/(^\/index(.html)?$)|(^\/$)/</span>, <span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">  <span class="keyword">await</span> responseFile(Path.resolve(__dirname, <span class="string">'./index.html'</span>), ctx, <span class="string">'UTF-8'</span>);</span><br><span class="line">  <span class="keyword">await</span> next();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤„ç†å›¾ç‰‡</span></span><br><span class="line">router.get(<span class="regexp">/\S*\.(jpe?g|png)$/</span>, <span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; request, response, path &#125; = ctx;</span><br><span class="line">  response.set(<span class="string">'pragma'</span>, <span class="string">'no-cache'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// max-age å€¼æ˜¯ç²¾ç¡®åˆ°ç§’ï¼Œè®¾ç½®è¿‡æœŸæ—¶é—´ä¸º 1 åˆ†é’Ÿ</span></span><br><span class="line">  <span class="comment">// response.set('cache-control', `max-age=$&#123;1 * 60&#125;`);</span></span><br><span class="line">  <span class="comment">// æ·»åŠ  expires å­—æ®µåˆ°å“åº”å¤´ï¼Œè¿‡æœŸæ—¶é—´ 2 åˆ†é’Ÿ</span></span><br><span class="line">  <span class="comment">// response.set('expires', new Date(Date.now() + 2 * 60 * 1000).toString());</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> imagePath = Path.resolve(__dirname, <span class="string">`.<span class="subst">$&#123;path&#125;</span>`</span>);</span><br><span class="line">  <span class="keyword">const</span> ifModifiedSince = request.headers[<span class="string">'if-modified-since'</span>];</span><br><span class="line">  <span class="keyword">const</span> imageStatus = <span class="keyword">await</span> fs.stat(imagePath);</span><br><span class="line">  <span class="keyword">const</span> lastModified = imageStatus.mtime.toGMTString();</span><br><span class="line">  <span class="keyword">if</span> (ifModifiedSince === lastModified) &#123;</span><br><span class="line">    response.status = <span class="number">304</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    response.lastModified = lastModified;</span><br><span class="line">    <span class="keyword">await</span> responseFile(imagePath, ctx);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">await</span> next();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤„ç† css æ–‡ä»¶</span></span><br><span class="line">router.get(<span class="regexp">/\S*\.css$/</span>, <span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; path &#125; = ctx;</span><br><span class="line">  <span class="keyword">await</span> responseFile(Path.resolve(__dirname, <span class="string">`.<span class="subst">$&#123;path&#125;</span>`</span>), ctx, <span class="string">'UTF-8'</span>);</span><br><span class="line">  <span class="keyword">await</span> next();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.use(router.routes()).use(router.allowedMethods());</span><br><span class="line"></span><br><span class="line">app.listen(<span class="number">3000</span>);</span><br><span class="line">process.on(<span class="string">'unhandledRejection'</span>, err =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.error(<span class="string">'æœ‰ promise æ²¡æœ‰ catch'</span>, err);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>é¦–å…ˆæ˜¯ç¦ç”¨ç¼“å­˜æƒ…å†µä¸‹é¦–æ¬¡è®¿é—®ï¼Œå¯ä»¥çœ‹åˆ°è¯·æ±‚å¤´ä¸­æ²¡æœ‰ if-modified-sinceï¼ŒæœåŠ¡å™¨è¿”å›äº† last-modifiedã€‚</p><p><img data-src="https://i.loli.net/2019/06/23/5d0f7bf17fe8b85005.png" alt=""></p><p>å…³é—­ disable cache åå†æ¬¡è®¿é—®å›¾ç‰‡æ—¶ï¼Œå‘ç°å¸¦ä¸Šäº† if-modified-since è¯·æ±‚å¤´ï¼Œå€¼å°±æ˜¯ä¸Šæ¬¡è¯·æ±‚å“åº”çš„ last-modified å€¼ï¼Œå› ä¸ºå›¾ç‰‡æœ€åä¿®æ”¹æ—¶é—´ä¸å˜ï¼Œæ‰€ä»¥ 304 Not Modified,ã€‚å…¶å®ä¸Šé¢çš„ä»£ç æœ‰ç‚¹å°æ¯›ç—…ï¼Œåœ¨ if-modified-since ä¸ç­‰äº last-modified æ—¶æ²¡æœ‰è®¾ç½® content-typeï¼Œä¸è¿‡è¿™äº›ç»†èŠ‚ä¸å½±å“æˆ‘ä»¬æ¢è®¨åå•†ç¼“å­˜æ ¸å¿ƒçŸ¥è¯†ã€‚</p><p><img data-src="https://i.loli.net/2019/06/23/5d0f7d383c8c222295.png" alt="last-modified"></p><p>å½“æˆ‘æŠŠ sunset.jpg è¿™å¼ å›¾æ›¿æ¢æˆå¦å¤–ä¸€å¼ å›¾åï¼Œå›¾ç‰‡æœ€åä¿®æ”¹æ—¶é—´æ”¹å˜äº†ï¼Œæ‰€ä»¥è¿”å›äº†æ–°çš„å›¾ç‰‡å¹¶ä¸”å“åº”å¤´ä¸­è¿˜åŠ å…¥äº†æœ€æ–°çš„ last-modifiedï¼Œä¸‹æ¬¡è¯·æ±‚å¸¦ä¸Šçš„ if-modified-since å°±æ˜¯è¿™æ¬¡è¿”å›åçš„ last-modified äº†ã€‚</p><p><img data-src="https://i.loli.net/2019/06/23/5d0f7e780cc7448744.png" alt=""></p><h4 id="æµ‹è¯•ä½¿ç”¨-etag-é…ç½®åå•†ç¼“å­˜"><a href="#æµ‹è¯•ä½¿ç”¨-etag-é…ç½®åå•†ç¼“å­˜" class="headerlink" title="æµ‹è¯•ä½¿ç”¨ etag é…ç½®åå•†ç¼“å­˜"></a>æµ‹è¯•ä½¿ç”¨ etag é…ç½®åå•†ç¼“å­˜</h4><p>ä¿®æ”¹å¤„ç†å›¾ç‰‡çš„è·¯ç”±ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å¤„ç†å›¾ç‰‡</span></span><br><span class="line">router.get(<span class="regexp">/\S*\.(jpe?g|png)$/</span>, <span class="keyword">async</span> (ctx, next) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; request, response, path &#125; = ctx;</span><br><span class="line">  ctx.type = mime.getType(path);</span><br><span class="line">  response.set(<span class="string">'pragma'</span>, <span class="string">'no-cache'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> ifNoneMatch = request.headers[<span class="string">'if-none-match'</span>];</span><br><span class="line">  <span class="keyword">const</span> imagePath = Path.resolve(__dirname, <span class="string">`.<span class="subst">$&#123;path&#125;</span>`</span>);</span><br><span class="line">  <span class="keyword">const</span> hash = crypto.createHash(<span class="string">'md5'</span>);</span><br><span class="line">  <span class="keyword">const</span> imageBuffer = <span class="keyword">await</span> fs.readFile(imagePath);</span><br><span class="line">  hash.update(imageBuffer);</span><br><span class="line">  <span class="keyword">const</span> etag = <span class="string">`"<span class="subst">$&#123;hash.digest(<span class="string">'hex'</span>)&#125;</span>"`</span>;</span><br><span class="line">  <span class="keyword">if</span> (ifNoneMatch === etag) &#123;</span><br><span class="line">    response.status = <span class="number">304</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    response.set(<span class="string">'etag'</span>, etag);</span><br><span class="line">    ctx.body = imageBuffer;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">await</span> next();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå°±ä¸æ”¾å›¾äº†ï¼Œæ•ˆæœå’Œä½¿ç”¨ last-modified å·®ä¸å¤šã€‚</p><p><strong>æ³¨æ„</strong>ï¼šæˆ‘è¿™é‡Œçš„ä»£ç åªæ˜¯ä¸ºäº†è¾¾åˆ°æ¼”ç¤ºçš„ç›®çš„ï¼Œå¦‚æœæ˜¯çœŸæ­£è¦é…ç½®ä¸€ä¸ªç”¨äºç”Ÿäº§çš„ç¼“å­˜æœºåˆ¶ï¼Œæ˜¯ä¼šå¯¹èµ„æºçš„ last-modified å’Œ etag å€¼å»ºç«‹ç´¢å¼•ç¼“å­˜çš„ï¼Œè€Œä¸æ˜¯åƒæˆ‘ä»£ç ä¸­é‚£æ ·æ¯æ¬¡éƒ½å»è®¿é—®æ–‡ä»¶çŠ¶æ€å’Œè¯»å–æ–‡ä»¶é€šè¿‡ hash ç®—æ³•å– hash å€¼ã€‚</p><h3 id="æ€æ ·æ›´æ–°é…ç½®äº†å¼ºç¼“å­˜çš„èµ„æºï¼Ÿ"><a href="#æ€æ ·æ›´æ–°é…ç½®äº†å¼ºç¼“å­˜çš„èµ„æºï¼Ÿ" class="headerlink" title="æ€æ ·æ›´æ–°é…ç½®äº†å¼ºç¼“å­˜çš„èµ„æºï¼Ÿ"></a>æ€æ ·æ›´æ–°é…ç½®äº†å¼ºç¼“å­˜çš„èµ„æºï¼Ÿ</h3><p>ä¹‹å‰é¢æ˜¥æ‹›å®ä¹ çš„æ—¶å€™æˆ‘åœ¨é¢è¯•è…¾è®¯çš„æ—¶å€™æŸæ¬¡ 2 é¢è¢«é—®è¿‡è¿™ä¸ªé—®é¢˜ï¼Œç„¶åç­”ä¸ä¸Šä¸Šæ¥ï¼Œè¢«æŒ‚äº†ã€‚é‚£æ¬¡é¢è¯•æ„Ÿè§‰éš¾åº¦æŒºå¤§çš„ï¼Œå½±å“æ¯”è¾ƒæ·±åˆ»ï¼Œå½“æ—¶è¿˜é—®äº†æ€æ ·åš dns ä¼˜åŒ–ï¼Œä¹Ÿç­”çš„ä¸å¥½ï¼Œæ—¥åæŠ½ç©ºä¸€å®šä¼šå†™ä¸€ç¯‡æ€ä¹ˆåš dns ä¼˜åŒ–çš„æ–‡ç« ã€‚</p><p>æ›´æ–°å¼ºç¼“å­˜è¿™ä¸ªé—®é¢˜ï¼Œè¦æ˜¯ä»¥å‰æ²¡ç ”ç©¶è¿‡ï¼Œçªç„¶é—®ä½ ï¼Œç¡®å®æœ‰ç‚¹éš¾ã€‚å…¶å®æƒ³æƒ³çœ‹ï¼Œä½ è¦æ›´æ–°å¼ºç¼“å­˜ï¼Œå¦‚æœè¯·æ±‚çš„æ˜¯åŒä¸€ä¸ª urlï¼Œæµè§ˆå™¨è‚¯å®šåœ¨æ²¡è¿‡æœŸçš„æƒ…å†µä¸‹ä¼šç›´æ¥è¿”å›ç¼“å­˜äº†ã€‚æ‰€ä»¥è§£å†³åŠæ³•å°±æ˜¯é¡µé¢ä¸­éœ€è¦æ›´æ–°å¼ºç¼“å­˜çš„åœ°æ–¹å¯¹ä»–ä»¬çš„ url åšæ–‡ç« ï¼Œä¹Ÿå°±æ˜¯éœ€è¦æ›´æ–°å¼ºç¼“å­˜çš„æ—¶å€™æ›´æ–° url å°±å¯ä»¥äº†ã€‚å› ä¸ºéœ€è¦å¯ä»¥æ›´æ–° urlï¼Œæ‰€ä»¥å½“å‰é¡µé¢é‚£ä¹ˆå°±ä¸èƒ½ä½¿ç”¨å¼ºç¼“å­˜äº†ï¼Œä¸ç„¶å’‹æ›´æ–° urlã€‚å…·ä½“å’‹æ›´æ–° url æœ‰å¾ˆå¤šå½¢å¼æ¯”å¦‚ä½¿ç”¨ç‰ˆæœ¬å·ï¼š â€œ/v1-0-0/sunset.jpgâ€ï¼Œè¿˜å¯ä»¥åœ¨ url ä¸­æ’å…¥èµ„æºå†…å®¹çš„ hash å€¼: â€œ/5bed2702-557a-sunset.jpgâ€ã€‚</p><p>ä¸¾ä¸ªå®ä¾‹ï¼š</p><p>ç¬¬ä¸€æ¬¡è®¿é—®é¦–é¡µ index.html ä¸­ img æ ‡ç­¾çš„ src ä¸º â€œ/v1-0-0/sunset.jpgâ€ï¼Œå½“æœåŠ¡å™¨ä¸Šä¿®æ”¹äº† sunset.jpg ä¸ºå¦å¤–ä¸€å¼ å›¾ç‰‡æ—¶ã€‚</p><p>å†æ¬¡è®¿é—® index.htmlã€‚ç”±äº index.html æœ¬èº«è¿™ä¸ª html æ–‡ä»¶æ²¡æœ‰ä½¿ç”¨å¼ºç¼“å­˜ï¼Œæ¯æ¬¡è®¿é—®éƒ½éœ€è¦è¯·æ±‚æœåŠ¡å™¨ï¼Œé¡µé¢ä¸­ src è¢«ä¿®æ”¹ä¸ºäº† â€œ/v1-0-1/sunset.jpgâ€ï¼Œè¿™å¼ é…ç½®å¼ºç¼“å­˜çš„å›¾ç‰‡å°±æ›´æ–°è¿‡æ¥äº†ã€‚</p><p>æœ€åæ”¾ä¸€å¼ ç›—æ¥çš„å›¾ï¼Œæœ¬äººå®åœ¨ä¸æ“…é•¿ç”»å›¾(ã€‚&gt;ï¸¿&lt;)_Î¸ï¼Œè¿™å¼ å›¾æ¯”è¾ƒè¯¦ç»†çš„å±•ç¤ºäº†å¼ºç¼“å­˜å’Œåå•†ç¼“å­˜çš„åˆ¤å®šæµç¨‹ã€‚</p><p><img data-src="https://i.loli.net/2019/06/23/5d0f938d920a328031.png" alt="summary"></p><p>æ„Ÿè°¢æ‚¨çš„é˜…è¯»ï¼Œå¦‚æœå¯¹ä½ æœ‰æ‰€å¸®åŠ©ä¸å¦¨åŠ ä¸ªå…³æ³¨ï¼Œç‚¹ä¸ªèµæ”¯æŒä¸€ä¸‹ O(âˆ©_âˆ©)Oï¼Œå¦‚æœæ–‡ä¸­æœ‰ä»€ä¹ˆé”™è¯¯ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºæŒ‡å‡ºã€‚</p><p>æœ¬æ–‡ä¸ºåŸåˆ›å†…å®¹ï¼Œé¦–å‘äº<span class="exturl" data-url="aHR0cDovL3d3dy5seXJlYWw2NjYuY29t" title="http://www.lyreal666.com">ä¸ªäººåšå®¢<i class="fa fa-external-link"></i></span>ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p><p>å‚è€ƒèµ„æºï¼š</p><ol><li><span class="exturl" data-url="aHR0cHM6Ly9qdWVqaW4uaW0vcG9zdC81YmRlYWJiYmU1MWQ0NTA1NDY2Y2Q3NDE=" title="https://juejin.im/post/5bdeabbbe51d4505466cd741">æµ…è°ˆ HTTP ç¼“å­˜<i class="fa fa-external-link"></i></span></li><li><span class="exturl" data-url="aHR0cHM6Ly9qdWVqaW4uaW0vcG9zdC81YjNjODczODZmYjlhMDRmOWE1Y2IwMzc=" title="https://juejin.im/post/5b3c87386fb9a04f9a5cb037">é¢è¯•ç²¾é€‰ä¹‹ http ç¼“å­˜<i class="fa fa-external-link"></i></span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vdHVnZW5odWEwNzA3L3AvMTA4MDcyODkuaHRtbA==" title="https://www.cnblogs.com/tugenhua0707/p/10807289.html">ç†è§£ http æµè§ˆå™¨çš„åå•†ç¼“å­˜å’Œå¼ºåˆ¶ç¼“å­˜<i class="fa fa-external-link"></i></span></li></ol>]]></content>
      <categories>
        <category>è®¡ç®—æœºç½‘ç»œ</category>
      </categories>
      <tags>
        <tag>HTTP</tag>
      </tags>
  </entry>
  <entry>
    <title>æ­å»º react + typescript + ant design å¼€å‘ç¯å¢ƒ</title>
    <url>/%E6%90%AD%E5%BB%BA-react-typescript-ant-design-%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/</url>
    <content><![CDATA[<p>9102 å¹´äº†ï¼Œå‰ç«¯å·¥ç¨‹åŒ–å‘å±•åœ¨ nodejs çš„åŸºç¡€ä¸Šå·²ç»å‘å±•çš„éå¸¸å®Œå–„äº†ï¼Œå„ç§å‰ç«¯æ„å»ºè¾…åŠ©å·¥å…·å±‚å‡ºä¸ç©·ã€‚ES6 ç¼–è¯‘å™¨ babelï¼Œcss è¾…åŠ©å·¥å…· postcss / sass / lessï¼Œä»£ç é£æ ¼æ£€æµ‹å·¥å…· eslint / prettier / stylelintï¼Œgit è¾…åŠ©å·¥å…· husky / lint-staged / commitizen / commitlintï¼Œè‡ªåŠ¨åŒ–æ„å»ºå·¥å…· webpack / gulp / gruntï¼Œæµ‹è¯•å·¥å…· jest / mocha ç­‰ç­‰ã€‚</p><p>è¿™ä¹ˆå¤šå¼€å‘è¾…åŠ©å·¥å…·æ¯æ¬¡å†™é¡¹ç›®éƒ½å»é…ç½®ä¸€éé‚£ä¹Ÿå¤ªæµªè´¹æ—¶é—´äº†ï¼Œè‡ªå·±ç»´æŠ¤ä¸€å¥—æ¨¡æ¿æœ‰å¾—æ—¶ä¸æ—¶å»æ›´æ–°ã€‚æ¯”è¾ƒæ–¹ä¾¿çš„é…ç½®å¼€å‘ç¯å¢ƒè¿˜æ˜¯ä½¿ç”¨ cli æˆ–è€…ä¸€äº›çƒ­é—¨çš„ bolierplateã€‚æœ¬ç¯‡æ–‡ç« å°†ä»¥ react å®˜æ–¹ç»´æŠ¤çš„ cli å·¥å…· create-react-app ï¼ˆç®€ç§° craï¼‰ä¸ºåŸºç¡€ï¼Œä»¥ä¸ eject çš„æ–¹å¼å»é…ç½® ant designï¼Œä»¥åŠä¸€äº› cra å¹¶æ²¡æœ‰å†…ç½®çš„è¾…åŠ©å·¥å…·ã€‚</p><a id="more"></a><h2 id="åˆå§‹åŒ–é¡¹ç›®å¹¶æ·»åŠ -typescript-æ”¯æŒ"><a href="#åˆå§‹åŒ–é¡¹ç›®å¹¶æ·»åŠ -typescript-æ”¯æŒ" class="headerlink" title="åˆå§‹åŒ–é¡¹ç›®å¹¶æ·»åŠ  typescript æ”¯æŒ"></a>åˆå§‹åŒ–é¡¹ç›®å¹¶æ·»åŠ  typescript æ”¯æŒ</h2><p>Typescript åœ¨è¿‘ä¸¤å¹´ä»¥æƒŠäººçš„é€Ÿåº¦è¢«è¶Šæ¥è¶Šå¤šçš„å¼€å‘è€…å’Œå¼€æºé¡¹ç›®æ‰€é‡‡ç”¨ï¼Œæˆ‘åœ¨ä½¿ç”¨ typescript å¼€å‘äº†ä¸€ä¸ªé¡¹ç›®ä¹‹åä¹Ÿè¢« typescript åœˆç²‰äº†ã€‚ä½¿ç”¨ typescript å¼€å‘å¸¦æ¥çš„æ™ºèƒ½æç¤ºå¯ä»¥å¾ˆå¤§ç¨‹åº¦ä¸Šæœç»æ‰‹è´±çš„å‘ç”Ÿï¼Œå¤§å¤šæ•°æƒ…å†µæˆ‘ä»¬éƒ½ä¸éœ€è¦æŸ¥æ–‡æ¡£äº†ï¼Œä»¥åŠ typescript ä¸­çš„ä¸€äº› javascript ä¸­æ²¡æœ‰çš„è¯­æ³•ç‰¹æ€§å¦‚æšä¸¾ï¼Œä½¿å¾—é¡¹ç›®ç»„ç»‡å¯ä»¥éå¸¸çš„ä¼˜é›…ã€‚ä» angular2 é»˜è®¤ä½¿ç”¨ typescript å¼€å‘ï¼Œåˆ°å¦‚ä»Š vue3 ä½¿ç”¨ typescript é‡å†™ä¹Ÿèƒ½çœ‹å‡º typescript åœ¨å‰ç«¯ç•Œçš„åœ°ä½å°†è¶Šæ¥è¶Šé‡è¦ã€‚9102ï¼Œé™¤éæ˜¯éå¸¸å°çš„é¡¹ç›®ï¼Œå¦åˆ™ä¸Š typescript ç»å¯¹æ˜¯æ˜æ™ºä¹‹ä¸¾ã€‚</p><p>æˆ‘çš„å¼€å‘ç¯å¢ƒï¼š</p><blockquote><p>node: 10.15.3 LTS</p><p>yarn: 1.15.2</p><p>editor: visual studio code</p></blockquote><p>cra å†…ç½®äº† typescript æ”¯æŒï¼Œåªéœ€è¦åœ¨åˆå§‹åŒ–é¡¹ç›®æ—¶æŒ‡å®š <code>--typescript</code> å‚æ•°å³å¯ã€‚</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">npx create-react-app my-app --typescript</span><br><span class="line"></span><br><span class="line"><span class="comment"># or</span></span><br><span class="line"></span><br><span class="line">yarn create react-app my-app --typescript</span><br></pre></td></tr></table></figure><p>å¦‚æœ cra é¡¹ç›®å·²ç»å­˜åœ¨ï¼Œå…ˆå®‰è£…ä»¥ä¸‹ ts types ä¾èµ–ï¼š</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">npm install --save typescript @types/node @types/react @types/react-dom @types/jest</span><br><span class="line"></span><br><span class="line"><span class="comment"># or</span></span><br><span class="line"></span><br><span class="line">yarn add typescript @types/node @types/react @types/react-dom @types/jest</span><br></pre></td></tr></table></figure><p>ç„¶åå°† .js ç»“å°¾çš„æ–‡ä»¶é‡å‘½åä¸º .tsx å³å¯ã€‚</p><p>æ›´å¤šå…³äºåœ¨ cra ä¸­ä½¿ç”¨ ts çš„ä¿¡æ¯æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼š<span class="exturl" data-url="aHR0cHM6Ly9mYWNlYm9vay5naXRodWIuaW8vY3JlYXRlLXJlYWN0LWFwcC9kb2NzL2FkZGluZy10eXBlc2NyaXB0" title="https://facebook.github.io/create-react-app/docs/adding-typescript">Adding TypeScript<i class="fa fa-external-link"></i></span></p><h2 id="é…ç½®-ant-design"><a href="#é…ç½®-ant-design" class="headerlink" title="é…ç½® ant design"></a>é…ç½® ant design</h2><h3 id="å®‰è£…-ant-design-ä¾èµ–"><a href="#å®‰è£…-ant-design-ä¾èµ–" class="headerlink" title="å®‰è£… ant design ä¾èµ–"></a>å®‰è£… ant design ä¾èµ–</h3><p>ç°åœ¨ä» yarn æˆ– npm å®‰è£…å¹¶å¼•å…¥ antdã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ yarn add antd</span><br></pre></td></tr></table></figure><h3 id="é…ç½®-ant-design-css-æŒ‰éœ€åŠ è½½"><a href="#é…ç½®-ant-design-css-æŒ‰éœ€åŠ è½½" class="headerlink" title="é…ç½® ant design css æŒ‰éœ€åŠ è½½"></a>é…ç½® ant design css æŒ‰éœ€åŠ è½½</h3><p>é…ç½® css æŒ‰éœ€åŠ è½½çš„æ–¹å¼æœ‰å¾ˆå¤šï¼Œå½’æ ¹åˆ°åº•å°±æ˜¯ä¿®æ”¹ cra çš„ webpack é…ç½®ã€‚å¯ä»¥é‡‡ç”¨æš´éœ² cra webpack é…ç½®çš„æ–¹å¼ï¼Œä½¿ç”¨ <code>yarn eject</code> å‘½ä»¤å³å¯åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æš´éœ²å‡ºé¡¹ç›®çš„ webpack é…ç½®ï¼Œé…ç½®ä¿å­˜åœ¨ config æ–‡ä»¶å¤¹ä¸‹é¢ã€‚æˆ‘è®°å¾— cra æ—©æœŸç‰ˆæœ¬ eject ä¹‹åæš´éœ²çš„é…ç½®æ˜¯æ‹†åˆ†æˆä¸¤ä»½ <code>webpack.config.dev.js</code>ï¼Œ<code>webpack.config.prod.js</code>ã€‚æœ€æ–°çš„ cra é…ç½®è¢«åˆå¹¶åˆ°ä¸€ä¸ªé…ç½®æ–‡ä»¶é‡Œé¢äº†ï¼Œå°±ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œé€šè¿‡ä¸€ä¸ªè®¡ç®—å‡ºçš„ç¯å¢ƒï¼ˆdevelopment/producationï¼‰æ¥åŠ¨æ€ç”Ÿæˆ webpack é…ç½®ï¼Œè¿™ç§æ–¹å¼æˆ‘è§‰å¾—é…ç½®èµ·æ¥æ›´éº»çƒ¦äº†ï¼Œè€Œä¸” eject æ˜¯ä¸å¯é€†çš„ï¼Œé‡‡ç”¨ eject æ¥ä¿®æ”¹ webpack é…ç½®éœ€è¦æ…é‡è€ƒè™‘ã€‚è¿™ç§æ–¹å¼çš„å¥½å¤„å°±æ˜¯ webpack é…ç½®ä½ å¯ä»¥ç›´æ¥ä¿®æ”¹ï¼Œæ‰€ä»¥åŸºæœ¬ä¸Šæ²¡ä»€ä¹ˆé…ç½®ä¸èƒ½é€šè¿‡è¿™ç§æ–¹å¼æ¥åŠ è½½ã€‚</p><p>è¿™é‡Œæˆ‘é‡‡ç”¨ç¤¾åŒºçš„ cra é…ç½®è§£å†³æ–¹æ¡ˆï¼š<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RpbWFybmV5L3JlYWN0LWFwcC1yZXdpcmVk" title="https://github.com/timarney/react-app-rewired">react-app-rewired<i class="fa fa-external-link"></i></span>ã€‚</p><p>å¼•å…¥ react-app-rewired å¹¶ä¿®æ”¹ package.json é‡Œçš„å¯åŠ¨é…ç½®ã€‚ç”±äºæ–°çš„ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RpbWFybmV5L3JlYWN0LWFwcC1yZXdpcmVkI2FsdGVybmF0aXZlcw==" title="https://github.com/timarney/react-app-rewired#alternatives">react-app-rewired@2.x<i class="fa fa-external-link"></i></span> ç‰ˆæœ¬çš„å…³ç³»ï¼Œä½ è¿˜éœ€è¦å®‰è£… <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FyYWNrYWYvY3VzdG9taXplLWNyYQ==" title="https://github.com/arackaf/customize-cra">customize-cra<i class="fa fa-external-link"></i></span>ã€‚</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ yarn add react-app-rewired customize-cra</span><br></pre></td></tr></table></figure><figure class="highlight diff"><table><tr><td class="code"><pre><span class="line">/* package.json */</span><br><span class="line">"scripts": &#123;</span><br><span class="line"><span class="deletion">-   "start": "react-scripts start",</span></span><br><span class="line"><span class="addition">+   "start": "react-app-rewired start",</span></span><br><span class="line"><span class="deletion">-   "build": "react-scripts build",</span></span><br><span class="line"><span class="addition">+   "build": "react-app-rewired build",</span></span><br><span class="line"><span class="deletion">-   "test": "react-scripts test",</span></span><br><span class="line"><span class="addition">+   "test": "react-app-rewired test",</span></span><br><span class="line">	"eject": "react-scripts eject"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨é¡¹ç›®æ ¹ç›®å½•æ–°å»º <code>config</code> æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨ package.json ä¸­æ·»åŠ é…ç½®ï¼š</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line">"config-overrides-path": "config/config-overrides.js"</span><br></pre></td></tr></table></figure><p>ç„¶åå†åœ¨å…¶ä¸­åˆ›å»ºä¸€ä¸ª <code>config-overrides.js</code> ç”¨äºä¿®æ”¹é»˜è®¤é…ç½®ã€‚</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> <span class="title">override</span>(<span class="params">config, env</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// do stuff with the webpack config...</span></span><br><span class="line">  <span class="keyword">return</span> config;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨-babel-plugin-import"><a href="#ä½¿ç”¨-babel-plugin-import" class="headerlink" title="ä½¿ç”¨ babel-plugin-import"></a>ä½¿ç”¨ babel-plugin-import</h3><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FudC1kZXNpZ24vYmFiZWwtcGx1Z2luLWltcG9ydA==" title="https://github.com/ant-design/babel-plugin-import">babel-plugin-import<i class="fa fa-external-link"></i></span> æ˜¯ä¸€ä¸ªç”¨äºæŒ‰éœ€åŠ è½½ç»„ä»¶ä»£ç å’Œæ ·å¼çš„ babel æ’ä»¶ï¼ˆ<span class="exturl" data-url="aHR0cHM6Ly9hbnQuZGVzaWduL2RvY3MvcmVhY3QvZ2V0dGluZy1zdGFydGVkLWNuI+aMiemcgOWKoOi9vQ==" title="https://ant.design/docs/react/getting-started-cn#æŒ‰éœ€åŠ è½½">åŸç†<i class="fa fa-external-link"></i></span>ï¼‰ï¼Œç°åœ¨æˆ‘ä»¬å°è¯•å®‰è£…å®ƒå¹¶ä¿®æ”¹ <code>config-overrides.js</code> æ–‡ä»¶ã€‚</p><figure class="highlight diff"><table><tr><td class="code"><pre><span class="line">$ yarn add babel-plugin-import</span><br><span class="line"><span class="addition">+ const &#123; override, fixBabelImports &#125; = require('customize-cra');</span></span><br><span class="line"></span><br><span class="line"><span class="deletion">- module.exports = function override(config, env) &#123;</span></span><br><span class="line"><span class="deletion">-   // do stuff with the webpack config...</span></span><br><span class="line"><span class="deletion">-   return config;</span></span><br><span class="line"><span class="deletion">- &#125;;</span></span><br><span class="line"><span class="addition">+ module.exports = override(</span></span><br><span class="line"><span class="addition">+   fixBabelImports('import', &#123;</span></span><br><span class="line"><span class="addition">+     libraryName: 'antd',</span></span><br><span class="line"><span class="addition">+     libraryDirectory: 'es',</span></span><br><span class="line"><span class="addition">+     style: 'css',</span></span><br><span class="line"><span class="addition">+   &#125;),</span></span><br><span class="line"><span class="addition">+ );</span></span><br></pre></td></tr></table></figure><p>æŒ‰ä¸‹é¢çš„æ ¼å¼å¼•å…¥ ant design ç»„ä»¶ã€‚</p><figure class="highlight diff"><table><tr><td class="code"><pre><span class="line">  // src/App.js</span><br><span class="line">  import React, &#123; Component &#125; from 'react';</span><br><span class="line"><span class="deletion">- import Button from 'antd/lib/button';</span></span><br><span class="line"><span class="addition">+ import &#123; Button &#125; from 'antd';</span></span><br><span class="line">  import './App.css';</span><br><span class="line"></span><br><span class="line">  class App extends Component &#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">      return (</span><br><span class="line">        &lt;div className="App"&gt;</span><br><span class="line">          &lt;Button type="primary"&gt;Button&lt;/Button&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  export default App;</span><br></pre></td></tr></table></figure><p>æœ€åé‡å¯ <code>yarn start</code> è®¿é—®é¡µé¢ï¼Œantd ç»„ä»¶çš„ js å’Œ css ä»£ç éƒ½ä¼šæŒ‰éœ€åŠ è½½ï¼Œä½ åœ¨æ§åˆ¶å°ä¹Ÿä¸ä¼šçœ‹åˆ°è¿™æ ·çš„<span class="exturl" data-url="aHR0cHM6Ly96b3MuYWxpcGF5b2JqZWN0cy5jb20vcm1zcG9ydGFsL3ZnY0hKUlZaRm1QakFhd3dWb1hLLnBuZw==" title="https://zos.alipayobjects.com/rmsportal/vgcHJRVZFmPjAawwVoXK.png">è­¦å‘Šä¿¡æ¯<i class="fa fa-external-link"></i></span>ã€‚å…³äºæŒ‰éœ€åŠ è½½çš„åŸç†å’Œå…¶ä»–æ–¹å¼å¯ä»¥é˜…è¯»<span class="exturl" data-url="aHR0cHM6Ly9hbnQuZGVzaWduL2RvY3MvcmVhY3QvZ2V0dGluZy1zdGFydGVkLWNuI+aMiemcgOWKoOi9vQ==" title="https://ant.design/docs/react/getting-started-cn#æŒ‰éœ€åŠ è½½">è¿™é‡Œ<i class="fa fa-external-link"></i></span>ã€‚</p><h3 id="è‡ªå®šä¹‰ä¸»é¢˜"><a href="#è‡ªå®šä¹‰ä¸»é¢˜" class="headerlink" title="è‡ªå®šä¹‰ä¸»é¢˜"></a>è‡ªå®šä¹‰ä¸»é¢˜</h3><p>æŒ‰ç…§ <span class="exturl" data-url="aHR0cHM6Ly9hbnQuZGVzaWduL2RvY3MvcmVhY3QvY3VzdG9taXplLXRoZW1lLWNu" title="https://ant.design/docs/react/customize-theme-cn">é…ç½®ä¸»é¢˜<i class="fa fa-external-link"></i></span> çš„è¦æ±‚ï¼Œè‡ªå®šä¹‰ä¸»é¢˜éœ€è¦ç”¨åˆ° less å˜é‡è¦†ç›–åŠŸèƒ½ã€‚æˆ‘ä»¬å¯ä»¥å¼•å…¥ <code>customize-cra</code> ä¸­æä¾›çš„ less ç›¸å…³çš„å‡½æ•° <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FyYWNrYWYvY3VzdG9taXplLWNyYSNhZGRsZXNzbG9hZGVybG9hZGVyb3B0aW9ucw==" title="https://github.com/arackaf/customize-cra#addlessloaderloaderoptions">addLessLoader<i class="fa fa-external-link"></i></span> æ¥å¸®åŠ©åŠ è½½ less æ ·å¼ï¼ŒåŒæ—¶ä¿®æ”¹ <code>config-overrides.js</code> æ–‡ä»¶å¦‚ä¸‹ã€‚</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ yarn add less less-loader</span><br></pre></td></tr></table></figure><figure class="highlight diff"><table><tr><td class="code"><pre><span class="line"><span class="deletion">- const &#123; override, fixBabelImports &#125; = require('customize-cra');</span></span><br><span class="line"><span class="addition">+ const &#123; override, fixBabelImports, addLessLoader &#125; = require('customize-cra');</span></span><br><span class="line"></span><br><span class="line">module.exports = override(</span><br><span class="line">  fixBabelImports('import', &#123;</span><br><span class="line">    libraryName: 'antd',</span><br><span class="line">    libraryDirectory: 'es',</span><br><span class="line"><span class="deletion">-   style: 'css',</span></span><br><span class="line"><span class="addition">+   style: true,</span></span><br><span class="line">  &#125;),</span><br><span class="line"><span class="addition">+ addLessLoader(&#123;</span></span><br><span class="line"><span class="addition">+   javascriptEnabled: true,</span></span><br><span class="line"><span class="addition">+   modifyVars: &#123; '@primary-color': '#1DA57A' &#125;,</span></span><br><span class="line"><span class="addition">+ &#125;),</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>è¿™é‡Œåˆ©ç”¨äº† <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3dlYnBhY2svbGVzcy1sb2FkZXIjbGVzcy1vcHRpb25z" title="https://github.com/webpack/less-loader#less-options">less-loader<i class="fa fa-external-link"></i></span> çš„ <code>modifyVars</code> æ¥è¿›è¡Œä¸»é¢˜é…ç½®ï¼Œ å˜é‡å’Œå…¶ä»–é…ç½®æ–¹å¼å¯ä»¥å‚è€ƒ <span class="exturl" data-url="aHR0cHM6Ly9hbnQuZGVzaWduL2RvY3MvcmVhY3QvY3VzdG9taXplLXRoZW1lLWNu" title="https://ant.design/docs/react/customize-theme-cn">é…ç½®ä¸»é¢˜<i class="fa fa-external-link"></i></span> æ–‡æ¡£ã€‚</p><p>ä¿®æ”¹åé‡å¯ <code>yarn start</code>ã€‚</p><h2 id="æ·»åŠ -sass-æ”¯æŒ"><a href="#æ·»åŠ -sass-æ”¯æŒ" class="headerlink" title="æ·»åŠ  sass æ”¯æŒ"></a>æ·»åŠ  <span class="exturl" data-url="aHR0cHM6Ly93d3cuc2Fzcy5oay8=" title="https://www.sass.hk/">sass<i class="fa fa-external-link"></i></span> æ”¯æŒ</h2><p><span class="exturl" data-url="bWFpbHRvOnJlYWN0LXNjcmlwdHNAMi4wLjA=" title="mailto:react-scripts@2.0.0">react-scripts@2.0.0<i class="fa fa-external-link"></i></span> å†…ç½®äº† sass æ”¯æŒï¼Œæˆ‘ä»¬åªéœ€è¦å®‰è£… node-sass ä¾èµ–å³å¯ã€‚</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ yarn add node-sass</span><br></pre></td></tr></table></figure><p>ç„¶åå°±å¯ä»¥æŠŠé¡¹ç›®æ¨¡æ¿ä¸­çš„ css æ–‡ä»¶åç¼€æ”¹æˆ <code>.scss</code> äº†ã€‚æ³¨æ„æ˜¯ <code>.scss</code> ä¸æ˜¯ <code>.sass</code> å“¦ï¼Œ<code>.sass</code> æ˜¯ yml çš„å†™æ³•ã€‚</p><h2 id="æ·»åŠ -editorconfig"><a href="#æ·»åŠ -editorconfig" class="headerlink" title="æ·»åŠ  editorconfig"></a>æ·»åŠ  <span class="exturl" data-url="aHR0cHM6Ly9lZGl0b3Jjb25maWcub3JnLw==" title="https://editorconfig.org/">editorconfig<i class="fa fa-external-link"></i></span></h2><p>editorconfig å¸®åŠ©æˆ‘ä»¬çº¦æŸå¤šä¸ªå¼€å‘è€…åœ¨åŒä¸€ä¸ªé¡¹ç›®ä¸­ä»£ç é£æ ¼ï¼Œæ›´é‡è¦çš„æ˜¯å®ƒæ˜¯è·¨ç¼–è¾‘å™¨ï¼ŒIDE çš„ã€‚</p><p>åœ¨ vscode ä¸­ä½¿ç”¨æ—¶å¯ä»¥å®‰è£… <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2VkaXRvcmNvbmZpZy9lZGl0b3Jjb25maWctdnNjb2Rl" title="https://github.com/editorconfig/editorconfig-vscode">EditorConfig for VS Code<i class="fa fa-external-link"></i></span> æ’ä»¶ï¼Œç„¶å <code>ctrl + shift + p</code> è°ƒå‡ºå‘½ä»¤é¢æ¿ï¼Œè¾“å…¥ <code>editorconfig</code> å°±å¯ä»¥çœ‹åˆ° <code>Generator .editorconfig</code> å‘½ä»¤ï¼Œé€‰æ‹©å‘½ä»¤åæ ¹ç›®å½•å°±ä¼šç”Ÿæˆåˆå§‹çš„ <code>.editorconfig</code> æ–‡ä»¶ã€‚</p><h2 id="æ·»åŠ -nvmrc"><a href="#æ·»åŠ -nvmrc" class="headerlink" title="æ·»åŠ  nvmrc"></a>æ·»åŠ  nvmrc</h2><p>åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºæ–‡ä»¶ <code>.nvmrc</code>ï¼Œå†å°† <code>node -v</code> çš„ç»“æœå¤åˆ¶è¿›å»å°±å¯ä»¥äº†ã€‚æˆ–è€…ç›´æ¥åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ã€‚</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ node -v &gt; .nvmrc</span><br></pre></td></tr></table></figure><h2 id="æ·»åŠ -gitignore"><a href="#æ·»åŠ -gitignore" class="headerlink" title="æ·»åŠ  .gitignore"></a>æ·»åŠ  .gitignore</h2><p>cra é»˜è®¤å·²ç»å¸®æˆ‘ä»¬æ·»åŠ äº† <code>.gitignore</code>ï¼Œæˆ‘ä»¬å¯ä»¥å†æ·»åŠ ä¸€äº›æ¯”å¦‚ <code>src/assets/videos/*</code>ã€‚ä½¿ç”¨ vscode çš„æ’ä»¶ <span class="exturl" data-url="aHR0cHM6Ly9tYXJrZXRwbGFjZS52aXN1YWxzdHVkaW8uY29tL2l0ZW1zP2l0ZW1OYW1lPWNvZGV6b21iaWVjaC5naXRpZ25vcmU=" title="https://marketplace.visualstudio.com/items?itemName=codezombiech.gitignore">gitignore<i class="fa fa-external-link"></i></span> æˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿çš„è¿½åŠ å…¶å®ƒè¦å¿½ç•¥çš„æ–‡ä»¶ï¼Œæ¯”å¦‚å¯ä»¥é€‰æ‹©å†æ·»åŠ  <code>VisualStudioCode</code>ï¼Œ<code>Windows</code> çš„å¿½ç•¥æ–‡ä»¶ã€‚</p><p><img data-src="https://i.loli.net/2019/05/11/5cd6c95ba52a1.gif" alt="gitignore"></p><h2 id="é…ç½®-linters"><a href="#é…ç½®-linters" class="headerlink" title="é…ç½® linters"></a>é…ç½® linters</h2><h3 id="ESLint"><a href="#ESLint" class="headerlink" title="ESLint"></a><span class="exturl" data-url="aHR0cHM6Ly9jbi5lc2xpbnQub3JnLw==" title="https://cn.eslint.org/">ESLint<i class="fa fa-external-link"></i></span></h3><p>ESLint å¯ä»¥çº¦æŸå›¢é˜Ÿæˆå‘˜çš„ä»£ç é£æ ¼ï¼Œå¹¶ä¸”æ‰¾å‡ºä¸€äº›å®¹æ˜“äº§ç”Ÿé—®é¢˜çš„ä»£ç ã€‚vscode ä¸­å®‰è£… ESLint åå¯ä»¥åœ¨ <code>PROBLEMS</code> é¢æ¿ä¸­çœ‹åˆ° ESLint æç¤ºçš„å„ç§é”™è¯¯ã€‚ESLint è‡ªå¸¦çš„ <code>autoFix</code> ä¹ŸæŒºå¥½ç”¨çš„ï¼Œä¸è¿‡æˆ‘ä¸€èˆ¬ä¼šç›´æ¥è®© <code>prettier</code> å»åœ¨æäº¤ä»£ç æ—¶æ ¼å¼åŒ–ä¸€éã€‚</p><p>cra é»˜è®¤é›†æˆäº† ESLintï¼Œè¦è®©ç¼–è¾‘å™¨æ­£ç¡®æç¤º ESLint é”™è¯¯ï¼Œéœ€è¦åœ¨é¡¹ç›®æ ¹ç›®å½•æ·»åŠ  <code>.eslintrc.json</code>ã€‚å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"extends"</span>: <span class="string">"react-app"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸ºäº†è®© vscode çš„ eslint æ’ä»¶å¯ç”¨ typescript æ”¯æŒï¼Œéœ€è¦æ·»åŠ ä¸‹é¢çš„é…ç½®åˆ° <code>.vscode/settings.json</code> ä¸­ã€‚</p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"eslint.validate"</span>: [</span><br><span class="line">    <span class="string">"javascript"</span>,</span><br><span class="line">    <span class="string">"javascriptreact"</span>,</span><br><span class="line">    &#123; <span class="attr">"language"</span>: <span class="string">"typescript"</span>, <span class="attr">"autoFix"</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">"language"</span>: <span class="string">"typescriptreact"</span>, <span class="attr">"autoFix"</span>: <span class="literal">true</span> &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é›†æˆ-prettier"><a href="#é›†æˆ-prettier" class="headerlink" title="é›†æˆ prettier"></a>é›†æˆ <span class="exturl" data-url="aHR0cHM6Ly9wcmV0dGllci5pby8=" title="https://prettier.io/">prettier<i class="fa fa-external-link"></i></span></h3><blockquote><p>Prettier is an opinionated code formatter</p></blockquote><p>opinionated æœ‰æ­¦æ–­ï¼Œè‡ªä»¥ä¸ºæ˜¯çš„æ„æ€ï¼Œè¿™é‡Œåº”è¯¥ç†è§£ä¸º prettier æä¾›çš„é…ç½®å¾ˆå°‘ï¼Œæœ‰ç‚¹å¼ºåˆ¶çº¦å®šä»£ç é£æ ¼çš„æ„æ€ã€‚</p><p>ä½¿ç”¨ prettier æ¥æ ¼å¼åŒ–æˆ‘ä»¬çš„ä»£ç å»ºè®®åœ¨ git commit æ—¶è‡ªåŠ¨è§¦å‘å°±å¥½äº†ï¼Œè¦ç»™ git è®¾ç½®é’©å­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R5cGljb2RlL2h1c2t5" title="https://github.com/typicode/husky">husky<i class="fa fa-external-link"></i></span> å·¥å…·ã€‚</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">yarn add -D husky lint-staged prettier</span><br></pre></td></tr></table></figure><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL29rb25ldC9saW50LXN0YWdlZA==" title="https://github.com/okonet/lint-staged">lint-staged<i class="fa fa-external-link"></i></span> æ˜¯ä¸€ä¸ªæé«˜ lint å·¥å…·é€Ÿåº¦çš„å·¥å…·ï¼Œä»–çš„ä½œç”¨å°±å’Œå®ƒçš„åå­—ä¸€æ ·ï¼Œlint-staged å¯ä»¥è®© lint å·¥å…·åª lint ä¿å­˜åœ¨ stage åŒºçš„ä»£ç ï¼Œä»è€ŒåŠ å¿« lint é€Ÿåº¦ã€‚</p><p>æ¥ç€é…ç½® husky å’Œ lint-stagedã€‚åœ¨ package.json ä¸­åŠ å…¥ä¸‹é¢å†…å®¹ã€‚</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line">"husky": &#123;</span><br><span class="line">    "hooks": &#123;</span><br><span class="line">      "pre-commit": "lint-staged"</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  "lint-staged": &#123;</span><br><span class="line">    "src/**/*.&#123;js,jsx,ts,tsx,json,css,scss,md&#125;": [</span><br><span class="line">      "prettier --single-quote --write",</span><br><span class="line">      <span class="string">"git add"</span></span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure><p>å¦‚æœè¿˜éœ€è¦é…ç½® prettierï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•æ·»åŠ é…ç½®æ–‡ä»¶ .prettierrc.jsã€‚å°±åƒå‰é¢å™è¿°çš„ï¼Œprettier å¯ä»¥é…ç½®çš„é€‰é¡¹å¾ˆå°‘ã€‚å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">// prettier.config.js or .prettierrc.js</span></span><br><span class="line">module.exports = &#123;</span><br><span class="line">    trailingComma: "es5",</span><br><span class="line">    tabWidth: 4,</span><br><span class="line">    semi: false,</span><br><span class="line">    singleQuote: true</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="é›†æˆ-stylelint"><a href="#é›†æˆ-stylelint" class="headerlink" title="é›†æˆ stylelint"></a>é›†æˆ <span class="exturl" data-url="aHR0cHM6Ly9zdHlsZWxpbnQuaW8v" title="https://stylelint.io/">stylelint<i class="fa fa-external-link"></i></span></h3><p>stylelint æˆ‘ä¸»è¦å‚è€ƒäº† ant design çš„é…ç½®ã€‚</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">yarn add -D stylelint</span><br></pre></td></tr></table></figure><p>åœ¨æ ¹ç›®å½•æ·»åŠ  stylelint é…ç½®æ–‡ä»¶ <code>.stylelintrc.json</code> æˆ–è€… package æ·»åŠ å­—æ®µ â€œstylelintâ€ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"extends"</span>: [<span class="string">"stylelint-config-standard"</span>, <span class="string">"stylelint-config-rational-order"</span>, <span class="string">"stylelint-config-prettier"</span>],</span><br><span class="line">  <span class="attr">"plugins"</span>: [<span class="string">"stylelint-order"</span>, <span class="string">"stylelint-declaration-block-no-ignored-properties"</span>],</span><br><span class="line">  <span class="attr">"rules"</span>: &#123;</span><br><span class="line">    <span class="attr">"comment-empty-line-before"</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">"function-name-case"</span>: [<span class="string">"lower"</span>],</span><br><span class="line">    <span class="attr">"no-invalid-double-slash-comments"</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">"no-descending-specificity"</span>: <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">"declaration-empty-line-before"</span>: <span class="literal">null</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"ignoreFiles"</span>: []</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®‰è£…ä¸Šé¢é…ç½®ä¸­ä½¿ç”¨çš„æ’ä»¶ã€‚</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">yarn add -D stylelint-config-standard stylelint-config-rational-order stylelint-config-prettier stylelint-order stylelint-declaration-block-no-ignored-properties</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ lint-staged é…ç½®ä¸ºï¼š</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line">"lint-staged": &#123;</span><br><span class="line">    "src/**/*.&#123;js,jsx,ts,tsx,json,css,scss,md&#125;": [</span><br><span class="line">      "prettier --single-quote --write",</span><br><span class="line">      <span class="string">"git add"</span></span><br><span class="line">    ],</span><br><span class="line">    "src/**/*.css": "stylelint",</span><br><span class="line">    "src/**/*.scss": "stylelint --syntax=scss"</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h2 id="é…ç½®-commitlint"><a href="#é…ç½®-commitlint" class="headerlink" title="é…ç½® commitlint"></a>é…ç½® commitlint</h2><p>æ¨èä¸€ä¸ªå¯ä»¥å®ç°è§„èŒƒçš„<strong>æäº¤è¯´æ˜</strong>çš„å·¥å…·ï¼š<span class="exturl" data-url="aHR0cHM6Ly9saW5rLmp1ZWppbi5pbS8/dGFyZ2V0PWh0dHBzJTNBJTJGJTJGZ2l0aHViLmNvbSUyRmNvbW1pdGl6ZW4lMkZjei1jbGk=" title="https://link.juejin.im/?target=https%3A%2F%2Fgithub.com%2Fcommitizen%2Fcz-cli">commitizen/cz-cli<i class="fa fa-external-link"></i></span>ã€‚å…¨å±€å®‰è£…è¯¥å·¥å…·ï¼š</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">yarn global add commitizen</span><br></pre></td></tr></table></figure><p>è¯¥å·¥å…·çš„ä½¿ç”¨æ–¹å¼å¯ä»¥æ–‡ç« æœ€åçš„æäº¤ä»£ç æ—¶çš„ GIF å›¾ã€‚ä½¿ç”¨æ—¶è¾“å…¥ <code>git cz</code> å³å¯ã€‚</p><p>å®‰è£…æ ¡éªŒå·¥å…· @commitlint/cliã€‚</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">yarn add -D @commitlint/cli</span><br></pre></td></tr></table></figure><p>å®‰è£…ç¬¦åˆ Angular é£æ ¼çš„æ ¡éªŒè§„åˆ™ã€‚</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">yarn add -D @commitlint/config-conventional</span><br></pre></td></tr></table></figure><p>package.json æ·»åŠ  â€œcommitlintâ€ å­—æ®µå¹¶è®¾ç½®ï¼š</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line">"commitlint": &#123;</span><br><span class="line">    "extends": [</span><br><span class="line">      <span class="string">"@commitlint/config-conventional"</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>package.json ä¸­ husky é…ç½®ä¿®æ”¹ä¸ºï¼š</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line">"husky": &#123;</span><br><span class="line">        "hooks": &#123;</span><br><span class="line">            "pre-commit": "lint-staged",</span><br><span class="line">            "commit-msg": "commitlint -E HUSKY_GIT_PARAMS"</span><br><span class="line">        &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h2 id="è°ƒæ•´æ¨¡æ¿"><a href="#è°ƒæ•´æ¨¡æ¿" class="headerlink" title="è°ƒæ•´æ¨¡æ¿"></a>è°ƒæ•´æ¨¡æ¿</h2><p>è¿™ç¯‡æ–‡ç« æ˜¯æˆ‘è¾¹é…ç½®æˆ‘çš„ä¸€ä¸ªé¡¹ç›®è¾¹å†™çš„ï¼Œä¸‹é¢éƒ¨åˆ†æœ‰äº›å†…å®¹æ˜¯æ ¹æ®æˆ‘è¿™ä¸ªé¡¹ç›®æŠ€æœ¯æ ˆæ¥é…ç½®çš„ï¼Œåé¢çš„å†…å®¹è‡ªè¡Œæ–Ÿé…ŒæŒ‰éœ€é…ç½®ã€‚æ¯”å¦‚æˆ‘æ‰“ç®—ç”¨ react hooks å†™é¡¹ç›®ï¼Œé‚£ä¹ˆå¯ä»¥å®‰è£… react-use è¿™ä¸ªå·¥å…·åº“ï¼Œä¸æ‰“ç®—ä½¿ç”¨ react hooks å°±ä¸è¦å®‰è£…äº†ã€‚</p><h3 id="æ·»åŠ å¸¸ç”¨æ–‡ä»¶å¤¹"><a href="#æ·»åŠ å¸¸ç”¨æ–‡ä»¶å¤¹" class="headerlink" title="æ·»åŠ å¸¸ç”¨æ–‡ä»¶å¤¹"></a>æ·»åŠ å¸¸ç”¨æ–‡ä»¶å¤¹</h3><p>é¡¹ç›®æ ¹ç›®å½•æ·»åŠ  docs æ–‡ä»¶å¤¹ç”¨æ¥æ”¾æ–‡æ¡£ã€‚åœ¨ src ç›®å½•ä¸‹æ·»åŠ  assetsï¼ˆå­˜æ”¾èµ„æºï¼‰ï¼Œcomponentsï¼ˆæ”¾ç»„ä»¶ï¼‰ï¼Œpagesï¼ˆé¡µé¢ç»„ä»¶ï¼‰ï¼Œstoresï¼ˆçŠ¶æ€ç®¡ç†å·¥å…·ç›¸å…³çš„æ–‡ä»¶ï¼‰ï¼Œmodelsï¼ˆtypescript ç±»æˆ–è€…æ¥å£ï¼‰ï¼Œutilsï¼Œstylesï¼ˆå…¨å±€æ ·å¼ä¸»é¢˜ç­‰ï¼‰ è¿™å‡ ä¸ªæ–‡ä»¶å¤¹ã€‚assets æ–‡ä»¶å¤¹ä¸‹é¢è¿˜æœ‰ imagesï¼Œvideos ç­‰ï¼Œcomponents å’Œ pages ç›®å½•ä¸‹åŠ å…¥ index.tsx ç”¨æ¥å¯¼å‡ºæ‰€æœ‰ component å’Œ pageã€‚</p><h3 id="åˆ é™¤æ— ç”¨æ–‡ä»¶å’Œå†…å®¹"><a href="#åˆ é™¤æ— ç”¨æ–‡ä»¶å’Œå†…å®¹" class="headerlink" title="åˆ é™¤æ— ç”¨æ–‡ä»¶å’Œå†…å®¹"></a>åˆ é™¤æ— ç”¨æ–‡ä»¶å’Œå†…å®¹</h3><p>public/manifest.json æ˜¯ç”¨æ¥åš PWA çš„ï¼Œä¸æ PWA å¯ä»¥åˆ æ‰ã€‚ä¿®æ”¹ public/index.html ä¸­çš„é¦–é¡µæ ‡é¢˜ã€‚App.scss ä¸­çš„å†…å®¹å¯ä»¥å…¨åˆ äº†ã€‚src/logo.svg å¯ä»¥åˆ äº†ã€‚åˆ é™¤ App.tsx çš„æ— ç”¨ä»£ç ã€‚cra ç”Ÿæˆçš„é»˜è®¤ README.md ä¸­çš„å†…å®¹ä¹Ÿå…¨åˆ äº†ï¼ŒåŠ å…¥è‡ªå·±çš„é¡¹ç›®æè¿°ã€‚</p><h3 id="æ›¿æ¢ç½‘ç«™å›¾æ ‡-favicon-ico"><a href="#æ›¿æ¢ç½‘ç«™å›¾æ ‡-favicon-ico" class="headerlink" title="æ›¿æ¢ç½‘ç«™å›¾æ ‡ favicon.ico"></a>æ›¿æ¢ç½‘ç«™å›¾æ ‡ favicon.ico</h3><p>æ¨èä½¿ç”¨ <span class="exturl" data-url="aHR0cDovL2Jsb2cuc2luYS5jb20uY24vcy9ibG9nXzg5YTcyOWE0MDEwMnh1eTMuaHRtbA==" title="http://blog.sina.com.cn/s/blog_89a729a40102xuy3.html">iconfx<i class="fa fa-external-link"></i></span> å·¥å…·åˆ¶ä½œ ico æ ¼å¼çš„å›¾æ ‡ã€‚iconfx ä½¿ç”¨æ–¹å¼å¾ˆç®€å•ï¼Œæ‰“å¼€è½¯ä»¶å°±ä¼šç”¨ã€‚å¯ä»¥ç›´æ¥å°†å›¾ç‰‡è½¬æˆ ico æ ¼å¼çš„å›¾æ ‡ã€‚å°†åˆ¶ä½œå¥½çš„å›¾æ ‡æ›¿æ¢ public/favicon.ico å³å¯è®¾ç½®å¥½ç½‘ç«™å›¾æ ‡ã€‚</p><h3 id="æ·»åŠ å…¶å®ƒä¾èµ–"><a href="#æ·»åŠ å…¶å®ƒä¾èµ–" class="headerlink" title="æ·»åŠ å…¶å®ƒä¾èµ–"></a>æ·»åŠ å…¶å®ƒä¾èµ–</h3><p>å®‰è£… react-router-domï¼Œclassnamesï¼Œlodashï¼Œreact-useï¼Œconstateï¼Œfaker.js ç­‰å·¥å…·åº“å’Œå¯¹åº”çš„ types æ–‡ä»¶ï¼Œæœ‰äº›è‡ªå¸¦äº†ç±»å‹å£°æ˜çš„åº“å°±ä¸ç”¨å®‰è£… types äº†ã€‚åƒ react-use å’Œ constate æœ¬èº«å°±æ˜¯ typescript ç¼–å†™çš„å°±ä¸ç”¨å®‰è£…å¯¹åº”çš„ types äº†ã€‚å®‰è£… normalize.css å¹¶åœ¨ index.tsx ç›´æ¥å¯¼å…¥ã€‚</p><p>åšåˆ°è¿™é‡Œï¼Œæˆ‘çš„é¡¹ç›®çš„å¼€å‘ç¯å¢ƒç®—æ˜¯é…ç½®å¥½äº†,ç„¶åå°±å¯ä»¥è¿›è¡Œä¸šåŠ¡å¼€å‘äº†ã€‚</p><p>æˆ‘çš„ä¸€ä¸ªå®Œå…¨æŒ‰ç…§ä¸Šè¿°æ­¥éª¤é…ç½®çš„é¡¹ç›®ï¼š<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RqeDY2Ni9taW5pLXNob3A=" title="https://github.com/tjx666/mini-shop">mini-shop<i class="fa fa-external-link"></i></span>ã€‚æœ‰éœ€è¦å¯ä»¥ç›´æ¥å»çœ‹æˆ‘çš„é…ç½®ï¼Œä¸€èˆ¬æ¥è¯´é…ç½®ä¸ä¼šç»å¸¸æ”¹åŠ¨ã€‚</p><p>çœ‹çœ‹é…ç½®äº†ä¸Šé¢é‚£äº›å·¥å…·æäº¤ä»£ç æ—¶æ˜¯å•¥æ ·å­çš„ï¼š</p><p><img data-src="https://i.loli.net/2019/05/11/5cd6dc5b8c31f.gif" alt="commit"></p><p>æœ¬æ–‡ä¸ºåŸåˆ›å†…å®¹ï¼Œé¦–å‘äº<span class="exturl" data-url="aHR0cDovL3d3dy5seXJlYWw2NjYuY29t" title="http://www.lyreal666.com">ä¸ªäººåšå®¢<i class="fa fa-external-link"></i></span>ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p><p>å‚è€ƒèµ„æ–™ï¼š</p><ol><li><span class="exturl" data-url="aHR0cHM6Ly9mYWNlYm9vay5naXRodWIuaW8vY3JlYXRlLXJlYWN0LWFwcC9kb2NzL2dldHRpbmctc3RhcnRlZA==" title="https://facebook.github.io/create-react-app/docs/getting-started">create-react-app å®˜æ–¹æ–‡æ¡£<i class="fa fa-external-link"></i></span></li><li><span class="exturl" data-url="aHR0cHM6Ly9hbnQuZGVzaWduL2RvY3MvcmVhY3QvdXNlLXdpdGgtY3JlYXRlLXJlYWN0LWFwcC1jbg==" title="https://ant.design/docs/react/use-with-create-react-app-cn">åœ¨ create-react-app ä¸­ä½¿ç”¨ ant design<i class="fa fa-external-link"></i></span></li><li><span class="exturl" data-url="aHR0cHM6Ly9qdWVqaW4uaW0vcG9zdC81Y2M0Njk0YTZmYjlhMDMyMzgxMDZlYjk=" title="https://juejin.im/post/5cc4694a6fb9a03238106eb9">Cz å·¥å…·é›†ä½¿ç”¨ä»‹ç» - è§„èŒƒ Git æäº¤è¯´æ˜<i class="fa fa-external-link"></i></span></li></ol>]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>react</tag>
        <tag>typescript</tag>
        <tag>webpack</tag>
        <tag>ant design</tag>
      </tags>
  </entry>
  <entry>
    <title>git å¸¸ç”¨æ“ä½œ</title>
    <url>/git-%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/</url>
    <content><![CDATA[<p>è¿™å‡ å¤©ç”µè„‘æ€»æ˜¯è“å±ï¼Œæœ‰æ—¶å€™é‡å¯æ—¶è¿˜æ˜¾ç¤ºæ‰¾ä¸åˆ°ç³»ç»Ÿï¼Œç„¶åå¤šé‡å¯å‡ æ¬¡åˆæ­£å¸¸è¿›å…¥ç³»ç»Ÿã€‚æ˜¨å¤©ç”µè„‘è“å±é‡å¯ä¸ä¸‹åæ¬¡ï¼Œå¿æ— å¯å¿ï¼Œæ— é¡»å†å¿ï¼Œåªå¥½é‡è£…ç³»ç»Ÿï¼Œæ¢ä¸Šäº†æœ€æ–°çš„ win10 1903ã€‚1903 åœ¨ç”¨æˆ·ç•Œé¢ä¸Šåšäº†æŒºå¤šä¼˜åŒ–ï¼Œçª—å£é˜´å½±ï¼Œæµ…è‰²ä¸»é¢˜ï¼Œç£¨ç ‚é”å±ç­‰ï¼Œè¿˜æœ‰ windows æ²™ç›’ç­‰æ–°ç©æ„ã€‚</p><p>ä½†æ˜¯æ¢äº†ä¹‹åè¿˜æ˜¯ä¼šè“å±é‡å¯ï¼Œè¯´æ˜æ˜¯ç¡¬ä»¶çš„é—®é¢˜ã€‚æ€€ç–‘æ˜¯ä¸»æ¿æœ‰é—®é¢˜ï¼Œå¹³æ—¶ç”¨çš„æ˜¯ç¬”è®°æœ¬è‡ªå¸¦çš„é”®ç›˜ï¼Œå¾ˆå®¹æ˜“è¿›ç°ï¼Œæœ‰æ—¶å€™è¾¹çœ‹è§†é¢‘è¾¹åƒé¥­çš„æ—¶å€™å¯èƒ½è¿›äº†äº›èœæ°´ä»€ä¹ˆçš„ã€‚ä»Šå¤©æŠŠç”µè„‘åç›–æ‹†äº†ä¹‹åæ¸…äº†æ¸…ç°ï¼Œç”¨å¹é£æœºå¯¹ç€è‡ªå¸¦é”®ç›˜å¹äº†åŠå¤©çƒ­é£ï¼Œå†æ¬¡é‡æ–°è£…äº†ç³»ç»Ÿã€‚ä¸€å¤©ä¸‹æ¥ï¼Œå•¥ä¹Ÿæ²¡å¹²ï¼Œè£…å„ç§è½¯ä»¶ï¼Œé…ç¯å¢ƒï¼Œç”¨åˆ°ç°åœ¨ä¹Ÿæ²¡è“å±ï¼Œä¸çŸ¥é“èƒ½æŒç»­å‡ å¤©ã€‚è¿™ä¸ï¼Œç°åœ¨è¦é‡æ–°é…ä¸‹ gitï¼Œé¡ºä¾¿å†™ç¯‡æ–‡ç« è®°å½•ä¸€ä¸‹ï¼Œçœçš„ä»¥åé‡æ–°é…çš„æ—¶å€™è¿˜è¦åˆ°å¤„æŸ¥èµ„æ–™ã€‚</p><a id="more"></a><h2 id="å…¨å±€é…ç½®ç”¨æˆ·åå’Œé‚®ç®±"><a href="#å…¨å±€é…ç½®ç”¨æˆ·åå’Œé‚®ç®±" class="headerlink" title="å…¨å±€é…ç½®ç”¨æˆ·åå’Œé‚®ç®±"></a>å…¨å±€é…ç½®ç”¨æˆ·åå’Œé‚®ç®±</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># é…ç½®å…¨å±€ç”¨æˆ·å</span></span><br><span class="line">git config --global user.name <span class="string">'your name'</span></span><br><span class="line"><span class="comment"># é…ç½®å…¨å±€é‚®ç®±</span></span><br><span class="line">git config --global user.email <span class="string">'your email address'</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œé¡ºä¾¿è¯´ä¸ªä¹‹å‰ç¢°åˆ°çš„ä¸€ä¸ªå¾ˆè¿·çš„é—®é¢˜ã€‚ä¹‹å‰æˆ‘å‘ç°æˆ‘ github çš„ <code>contributions</code> ä¸€ç›´æ²¡æœ‰è®¡ç®—æˆ‘æœ€è¿‘çš„ commitï¼Œåªæœ‰é›¶æ˜Ÿå‡ ä¸ªç»¿ç‚¹ã€‚å½“æ—¶æˆ‘å°±å‘äº†ä¸ªé‚®ä»¶å‘ github å›¢é˜Ÿæ±‚åŠ©ï¼Œgithub å›¢é˜ŸæŒºç»™åŠ›çš„ï¼Œå¾ˆå¿«å°±ç»™æˆ‘è¯´æ˜äº†æƒ…å†µï¼Œè¯´æ˜¯è®¡ç®—ç”¨æˆ·çš„ commit æ˜¯å’Œä½ æäº¤æ•°æ®ä¸­çš„é‚®ç®±è´¦å·ç›¸å…³çš„ã€‚ä¹Ÿå°±æ˜¯è¯´åˆ¤æ–­ä¸€æ¬¡æäº¤æ˜¯å¦æ˜¯æŸä¸ª github ç”¨æˆ·çš„æäº¤æ˜¯çœ‹<strong>è¯¥ç”¨æˆ·ç»‘å®šçš„é‚®ç®±æ˜¯å¦å’Œ commit ç”¨æˆ·çš„é‚®ç®±æ˜¯ç›¸åŒçš„</strong>ã€‚ç„¶åæˆ‘å°±æŠŠæˆ‘ github ç»‘å®šäº†æˆ‘æœ¬åœ° git é…ç½®çš„é‚®ç®±ï¼Œä¹‹å‰çš„æäº¤éƒ½é‡æ–°ç®—åˆ°æˆ‘çš„ github è´¦å·ä¸Šäº†ã€‚</p><h2 id="ç”Ÿæˆéå¯¹ç§°å¯†é’¥å¯¹"><a href="#ç”Ÿæˆéå¯¹ç§°å¯†é’¥å¯¹" class="headerlink" title="ç”Ÿæˆéå¯¹ç§°å¯†é’¥å¯¹"></a>ç”Ÿæˆéå¯¹ç§°å¯†é’¥å¯¹</h2><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å„ä¸ªå‚æ•°å«ä¹‰</span></span><br><span class="line">$ ssh-keygen --<span class="built_in">help</span></span><br><span class="line">ssh-keygen: unknown option -- -</span><br><span class="line">usage: ssh-keygen [-q] [-b bits] [-t dsa | ecdsa | ed25519 | rsa]</span><br><span class="line">                  [-N new_passphrase] [-C comment] [-f output_keyfile]</span><br><span class="line">       ssh-keygen -p [-P old_passphrase] [-N new_passphrase] [-f keyfile]</span><br><span class="line">       ssh-keygen -i [-m key_format] [-f input_keyfile]</span><br><span class="line">       ssh-keygen -e [-m key_format] [-f input_keyfile]</span><br><span class="line">       ssh-keygen -y [-f input_keyfile]</span><br><span class="line">       ssh-keygen -c [-P passphrase] [-C comment] [-f keyfile]</span><br><span class="line">       ssh-keygen -l [-v] [-E fingerprint_hash] [-f input_keyfile]</span><br><span class="line">       ssh-keygen -B [-f input_keyfile]</span><br><span class="line">       ssh-keygen -D pkcs11</span><br><span class="line">       ssh-keygen -F hostname [-f known_hosts_file] [-l]</span><br><span class="line">       ssh-keygen -H [-f known_hosts_file]</span><br><span class="line">       ssh-keygen -R hostname [-f known_hosts_file]</span><br><span class="line">       ssh-keygen -r hostname [-f input_keyfile] [-g]</span><br><span class="line">       ssh-keygen -G output_file [-v] [-b bits] [-M memory] [-S start_point]</span><br><span class="line">       ssh-keygen -T output_file -f input_file [-v] [-a rounds] [-J num_lines]</span><br><span class="line">                  [-j start_line] [-K checkpt] [-W generator]</span><br><span class="line">       ssh-keygen -s ca_key -I certificate_identity [-h] [-U]</span><br><span class="line">                  [-D pkcs11_provider] [-n principals] [-O option]</span><br><span class="line">                  [-V validity_interval] [-z serial_number] file ...</span><br><span class="line">       ssh-keygen -L [-f input_keyfile]</span><br><span class="line">       ssh-keygen -A</span><br><span class="line">       ssh-keygen -k -f krl_file [-u] [-s ca_public] [-z version_number]</span><br><span class="line">                  file ...</span><br><span class="line">       ssh-keygen -Q -f krl_file file ...</span><br></pre></td></tr></table></figure><p>ä¸€èˆ¬ç”¨æ³•ï¼š</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¯†é’¥éœ€è¦å­˜æ”¾åœ¨ "~/.ssh" æ–‡ä»¶å¤¹ä¸‹é¢ï¼Œå› ä¸ºæ— è®ºæ˜¯ ssh è¿œç¨‹è¿˜æ˜¯ git è¿œç¨‹ä»“åº“è¯»å–ç§é’¥éƒ½æ˜¯ä»è¿™ä¸ªæ–‡ä»¶å¤¹ç›®å½•ä¸‹è¯»å–ï¼Œå¦‚æœå½“å‰æ²¡æœ‰å°±åˆ›å»º</span></span><br><span class="line">$ <span class="built_in">cd</span> ~/.ssh</span><br><span class="line"><span class="comment"># å¯†é’¥é•¿åº¦å»ºè®®è®¾ç½® 2048ï¼Œè¶Šé•¿è¶Šå®‰å…¨</span></span><br><span class="line">$ ssh-keygen -b 2048 -t rsa -C <span class="string">'ytj2713151713@gmail.com'</span></span><br></pre></td></tr></table></figure><h3 id="æ·»åŠ å…¬é’¥ï¼ˆpublic-keyï¼‰åˆ°-github"><a href="#æ·»åŠ å…¬é’¥ï¼ˆpublic-keyï¼‰åˆ°-github" class="headerlink" title="æ·»åŠ å…¬é’¥ï¼ˆpublic keyï¼‰åˆ° github"></a>æ·»åŠ å…¬é’¥ï¼ˆpublic keyï¼‰åˆ° github</h3><p>æ‰“å¼€ â€˜~/.sshâ€™ ç›®å½•ï¼Œä»¥ <code>.pub</code> ç»“å°¾çš„ä¾¿æ˜¯å…¬é’¥ã€‚æ³¨æ„ç”Ÿæˆçš„å…¬é’¥çš„ç¬¬äºŒè¡Œçš„ç©ºè¡Œä¹Ÿè¦å¤åˆ¶è¿‡å»ã€‚</p><p>å¯ä»¥çœ‹åˆ°ä¸‹é¢çš„å…¬é’¥æ˜¯æœ‰ä¸ªç©ºè¡Œçš„ã€‚</p><p><img data-src="https://i.loli.net/2019/05/08/5cd2d0b0d4753.png" alt="public key"></p><p><img data-src="https://i.loli.net/2019/05/08/5cd2df9832175.jpg" alt="github-ssh"></p><h2 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h2><h3 id="åˆå§‹åŒ–ä»“åº“"><a href="#åˆå§‹åŒ–ä»“åº“" class="headerlink" title="åˆå§‹åŒ–ä»“åº“"></a>åˆå§‹åŒ–ä»“åº“</h3><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">git init</span><br></pre></td></tr></table></figure><p>åˆå§‹åŒ–ä»“åº“åä¼šåœ¨å½“å‰æ–‡ä»¶å¤¹ç”Ÿæˆä¸€ä¸ª <code>.git</code> æ–‡ä»¶å¤¹ï¼Œè¿™ä¸ªæ–‡ä»¶å¤¹å°±æ˜¯ç”¨æ¥å­˜æ”¾äº†æ•´ä¸ªä»“åº“çš„ç‰ˆæœ¬ä¿¡æ¯ã€‚</p><h3 id="å°†ä»“åº“æ·»åŠ ä¸ºæ–°ç‰ˆæœ¬"><a href="#å°†ä»“åº“æ·»åŠ ä¸ºæ–°ç‰ˆæœ¬" class="headerlink" title="å°†ä»“åº“æ·»åŠ ä¸ºæ–°ç‰ˆæœ¬"></a>å°†ä»“åº“æ·»åŠ ä¸ºæ–°ç‰ˆæœ¬</h3><h4 id="æ·»åŠ ä¿®æ”¹åˆ°æš‚å­˜åŒº"><a href="#æ·»åŠ ä¿®æ”¹åˆ°æš‚å­˜åŒº" class="headerlink" title="æ·»åŠ ä¿®æ”¹åˆ°æš‚å­˜åŒº"></a>æ·»åŠ ä¿®æ”¹åˆ°æš‚å­˜åŒº</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å°† file æ·»åŠ åˆ° stage åŒº</span></span><br><span class="line">git add &lt;file&gt;</span><br><span class="line"><span class="comment"># æˆ‘ä¸€èˆ¬éƒ½æ˜¯ç”¨ä¸‹é¢çš„å‘½ä»¤ä¸€æ¬¡æ€§æäº¤æ‰€æœ‰ä¿®æ”¹</span></span><br><span class="line">git add -A</span><br></pre></td></tr></table></figure><h4 id="æäº¤"><a href="#æäº¤" class="headerlink" title="æäº¤"></a>æäº¤</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">git commit -m <span class="string">'commit message'</span></span><br></pre></td></tr></table></figure><h3 id="æ¨é€æœ¬åœ°ä»£ç åˆ°è¿œç¨‹ä»“åº“æœåŠ¡å™¨"><a href="#æ¨é€æœ¬åœ°ä»£ç åˆ°è¿œç¨‹ä»“åº“æœåŠ¡å™¨" class="headerlink" title="æ¨é€æœ¬åœ°ä»£ç åˆ°è¿œç¨‹ä»“åº“æœåŠ¡å™¨"></a>æ¨é€æœ¬åœ°ä»£ç åˆ°è¿œç¨‹ä»“åº“æœåŠ¡å™¨</h3><h4 id="æ·»åŠ è¿œç¨‹ä»“åº“åœ°å€"><a href="#æ·»åŠ è¿œç¨‹ä»“åº“åœ°å€" class="headerlink" title="æ·»åŠ è¿œç¨‹ä»“åº“åœ°å€"></a>æ·»åŠ è¿œç¨‹ä»“åº“åœ°å€</h4><p><code>remote-server-name</code> æ˜¯ä½ ç»™è¿œç¨‹æœåŠ¡å™¨å–çš„ä¸€ä¸ªåå­—ã€‚</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">git remote add remote-server-name server-address</span><br></pre></td></tr></table></figure><h4 id="æ¨é€æœ¬åœ°æäº¤"><a href="#æ¨é€æœ¬åœ°æäº¤" class="headerlink" title="æ¨é€æœ¬åœ°æäº¤"></a>æ¨é€æœ¬åœ°æäº¤</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">git push remote-server-name -u branch-name</span><br></pre></td></tr></table></figure><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzIwMDE5NDE5" title="https://www.zhihu.com/question/20019419">git push çš„ -u å‚æ•°å…·ä½“é€‚åˆå«ä¹‰ï¼Ÿ<i class="fa fa-external-link"></i></span></p><p>ä½¿ç”¨ <code>-u</code> å‚æ•°å»ºç«‹åˆ†æ”¯ä¹‹é—´çš„å…³è”åï¼Œåç»­å°±å¯ä»¥ä¸ç”¨åé¢çš„å‚æ•°äº†ï¼Œä¸€ä¸ª <code>git push</code> å°±ä¼šå°†å½“å‰åˆ†æ”¯æ¨é€åˆ°å…³è”çš„è¿œç¨‹åˆ†æ”¯äº†ã€‚</p><h3 id="æŸ¥çœ‹ä»“åº“ä¿¡æ¯"><a href="#æŸ¥çœ‹ä»“åº“ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹ä»“åº“ä¿¡æ¯"></a>æŸ¥çœ‹ä»“åº“ä¿¡æ¯</h3><h4 id="æŸ¥çœ‹ä»“åº“çŠ¶æ€"><a href="#æŸ¥çœ‹ä»“åº“çŠ¶æ€" class="headerlink" title="æŸ¥çœ‹ä»“åº“çŠ¶æ€"></a>æŸ¥çœ‹ä»“åº“çŠ¶æ€</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç¤ºä¾‹</span></span><br><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">Changes not staged <span class="keyword">for</span> commit:</span><br><span class="line">  (use <span class="string">"git add &lt;file&gt;..."</span> to update what will be committed)</span><br><span class="line">  (use <span class="string">"git checkout -- &lt;file&gt;..."</span> to discard changes <span class="keyword">in</span> working directory)</span><br><span class="line"></span><br><span class="line">        modified:   test.txt</span><br><span class="line"></span><br><span class="line">no changes added to commit (use <span class="string">"git add"</span> and/or <span class="string">"git commit -a"</span>)</span><br></pre></td></tr></table></figure><h4 id="æŸ¥çœ‹æ–‡ä»¶ä¿®æ”¹å†…å®¹"><a href="#æŸ¥çœ‹æ–‡ä»¶ä¿®æ”¹å†…å®¹" class="headerlink" title="æŸ¥çœ‹æ–‡ä»¶ä¿®æ”¹å†…å®¹"></a>æŸ¥çœ‹æ–‡ä»¶ä¿®æ”¹å†…å®¹</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ git diff HEAD -- test.txt</span><br><span class="line">diff --git a/test.txt b/test.txt</span><br><span class="line">index a9682e5..a9ef16d 100644</span><br><span class="line">--- a/test.txt</span><br><span class="line">+++ b/test.txt</span><br><span class="line">@@ -1 +1,2 @@</span><br><span class="line">-åŸè°…æˆ‘æ”¾è¡ä¸ç¾çˆ±è‡ªç”±ã€‚</span><br><span class="line">\ No newline at end of file</span><br><span class="line">+åŸè°…æˆ‘æ”¾è¡ä¸ç¾çˆ±è‡ªç”±ã€‚</span><br><span class="line">+æ”¾å±ï¼Œå•èº«ç‹—çš„è‡ªæˆ‘å®‰æ…°ã€‚</span><br><span class="line">\ No newline at end of file</span><br></pre></td></tr></table></figure><h4 id="æŸ¥çœ‹æäº¤è®°å½•"><a href="#æŸ¥çœ‹æäº¤è®°å½•" class="headerlink" title="æŸ¥çœ‹æäº¤è®°å½•"></a>æŸ¥çœ‹æäº¤è®°å½•</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ git <span class="built_in">log</span></span><br><span class="line">commit 412d436e2380d4d64c663849c81eb7646a204755 (HEAD -&gt; master)</span><br><span class="line">Author: YuTengjing &lt;ytj2713151713@gmail.com&gt;</span><br><span class="line">Date:   Wed May 8 21:46:39 2019 +0800</span><br><span class="line"></span><br><span class="line">    append comment to test.txt</span><br><span class="line"></span><br><span class="line">commit 6bc24d2f5c1b1462e4fe8828492151ffab78b49e</span><br><span class="line">Author: YuTengjing &lt;ytj2713151713@gmail.com&gt;</span><br><span class="line">Date:   Wed May 8 21:40:26 2019 +0800</span><br><span class="line"></span><br><span class="line">    init project</span><br></pre></td></tr></table></figure><h4 id="æŸ¥çœ‹ç‰ˆæœ¬æ“ä½œè®°å½•"><a href="#æŸ¥çœ‹ç‰ˆæœ¬æ“ä½œè®°å½•" class="headerlink" title="æŸ¥çœ‹ç‰ˆæœ¬æ“ä½œè®°å½•"></a>æŸ¥çœ‹ç‰ˆæœ¬æ“ä½œè®°å½•</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">$ git reflog</span><br><span class="line">412d436 (HEAD -&gt; master) HEAD@&#123;0&#125;: commit: append comment to test.txt</span><br><span class="line">6bc24d2 HEAD@&#123;1&#125;: commit (initial): init project</span><br></pre></td></tr></table></figure><p>å¾…è¡¥å……â€¦</p>]]></content>
      <categories>
        <category>å¼€å‘å·¥å…·</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title>è¶…å®ç”¨çš„ chrome æ‰©å±•æ¨è</title>
    <url>/%E8%B6%85%E5%AE%9E%E7%94%A8%E7%9A%84%20chrome%20%E6%89%A9%E5%B1%95%E6%8E%A8%E8%8D%90/</url>
    <content><![CDATA[<p><img data-src="https://i.loli.net/2019/04/06/5ca8647de4816.png" alt="æ–°æ ‡ç­¾é¡µ"></p><p>chrome æµè§ˆå™¨è¿™ä¹ˆå—æ¬¢è¿ï¼Œä¸ä»…æ˜¯ç”±äºä»–çš„é€Ÿåº¦å¿«ï¼Œæ‰©å±•çš„ä¸°å¯Œå’Œå¼ºå¤§ä¹Ÿæ˜¯éå¸¸é‡è¦çš„ä¸€ä¸ªå› ç´ ã€‚æˆ‘æ˜¯ä¸€ä¸ªå‰ç«¯å¼€å‘è€…ï¼Œæ‰€ä»¥æ‰©å±•ä¸­å¯èƒ½æœ‰ç›¸å½“å¤§çš„ä¸€éƒ¨ä»½æ˜¯å¼€å‘è€…å·¥å…·ã€‚å½“ç„¶äº†ï¼Œç¨‹åºå‘˜ä¹Ÿæ˜¯æœ‰ç”Ÿæ´»å¨±ä¹çš„ï¼Œæˆ‘ä¹Ÿæ”¶è—äº†è®¸å¤šæ™®é€šå¤§ä¼—é€‚ç”¨çš„æ‰©å±•ã€‚</p><p>æˆ‘å¯¹å·¥å…·çš„é€‰æ‹©æ˜¯æ¯”è¾ƒæŒ‘å‰”çš„ï¼ŒåŒç±»å‹çš„æ’ä»¶ä¸­ï¼Œæˆ‘ä¼šä¼˜å…ˆé€‰æ‹©å…è´¹ï¼Œæ›´æ–°åŠ›åº¦å¤§ï¼Œå¥½è¯„ç‡é«˜ä»¥åŠæ˜¯å¦æ˜¯å®˜æ–¹å‡ºå“çš„ã€‚æˆ‘å¹³æ—¶æœ‰äº‹æ²¡äº‹å°±ä¼šå» chrome æ‰©å±•å¸‚åœºå»é€›é€›ï¼Œä¹Ÿçœ‹è¿‡å¾ˆå¤šå’Œ chrome æ‰©å±•ç›¸å…³çš„å¸–å­ï¼Œæ‰€ä»¥ç§¯æ”’çš„æ’ä»¶æ¯”è¾ƒå¤šã€‚</p><p>ä¸€å¤§æ³¢å›¾ç‰‡å³å°†æ¥è¢­ï¼Œè¯·åœ¨æµé‡å……è¶³çš„æƒ…å†µä¸‹é˜…è¯»[]<del>(ï¿£ â–½ ï¿£)</del>*</p><a id="more"></a><h2 id="åŸºç¡€åŠŸèƒ½æ‰©å±•"><a href="#åŸºç¡€åŠŸèƒ½æ‰©å±•" class="headerlink" title="åŸºç¡€åŠŸèƒ½æ‰©å±•"></a><strong>åŸºç¡€åŠŸèƒ½æ‰©å±•</strong></h2><p>chrome æœ¬èº«å¾ˆå¤šåŠŸèƒ½åšçš„éå¸¸çš„ç®€æ´ï¼Œå› äººè€Œå¼‚ï¼Œå¯èƒ½ä¼šæ»¡è¶³ä¸äº†ç”¨æˆ·çš„éœ€æ±‚ã€‚éƒ¨åˆ†ç”¨æˆ·ä»ä¸€äº›å›½äº§çš„æµè§ˆå™¨åˆ‡æ¢åˆ° chrome ä¸Šæ—¶ï¼Œå¯èƒ½ä¼šè§‰å¾— chrome å¾ˆéš¾ç”¨ï¼Œè¦å•¥æ²¡å•¥ã€‚å›½äº§æµè§ˆå™¨ä¹‹æ‰€ä»¥å¥½åƒæ¯” chorme åŠŸèƒ½å¤šå¾ˆå¤šï¼Œéƒ¨åˆ†åŸå› æ˜¯å›½äº§æµè§ˆå™¨å†…ç½®äº†ä¸€äº›æ‰©å±•ï¼Œæ¯”å¦‚ä¸‹è½½ï¼Œæ‰‹åŠ¿ç­‰æ‰©å±•ã€‚åˆç”±äºä¸å¯æŠ—ä¹‹åŠ›å¯¼è‡´æ— æ³•åŒæ­¥å’Œè®¿é—®æ‰©å±•å¸‚åœºæ›´åŠ è§‰å¾— chrome åƒåœ¾â€¦</p><p><strong>æˆ‘ç›¸ä¿¡è¿™éƒ¨åˆ†çš„æ‰©å±•ç»å¯¹ä¼šè®©ä½ æ„Ÿå— chrome æ‰©å±•é­…åŠ›</strong>ã€‚</p><h3 id="Chrome-Better-History"><a href="#Chrome-Better-History" class="headerlink" title="Chrome Better History"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvY2hyb21lLWJldHRlci1oaXN0b3J5L2FhZGJhYWdiYW5maWpkbmZsa2hlcGdqbWhscHBwYmFk" title="https://chrome.google.com/webstore/detail/chrome-better-history/aadbaagbanfijdnflkhepgjmhlpppbad">Chrome Better History<i class="fa fa-external-link"></i></span></h3><p>è¿™æ˜¯ä¸€ä¸ªç”¨æ¥æ›¿ä»£ chrome è‡ªå¸¦çš„æŸ¥çœ‹å†å²è®°å½•åŠŸèƒ½çš„æ‰©å±•ï¼Œç•Œé¢è®¾è®¡çš„å¾ˆç®€æ´ï¼Œæ¯”è¾ƒèµçš„æ˜¯æœ‰ä¸ªå¯è§†åŒ–çš„æ—¥å†è®©æˆ‘ä»¬å¯ä»¥å•ç‹¬æŸ¥çœ‹æŸä¸€å¤©çš„å†å²è®°å½•ã€‚</p><p><img data-src="https://pic4.zhimg.com/v2-10f32c63e7da1c55318384401d79cf1b_b.png" alt="img"></p><h3 id="Grammarly-for-Chrome"><a href="#Grammarly-for-Chrome" class="headerlink" title="Grammarly for Chrome"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvZ3JhbW1hcmx5LWZvci1jaHJvbWUva2JmbmJjYWVwbGJjaW9ha2twY3BnZmtvYmtnaGxoZW4=" title="https://chrome.google.com/webstore/detail/grammarly-for-chrome/kbfnbcaeplbcioakkpcpgfkobkghlhen">Grammarly for Chrome<i class="fa fa-external-link"></i></span></h3><p>å…¶å®åŒ…æ‹¬å¾ˆå¤šç¼–è¾‘å™¨å’Œ ide éƒ½æœ‰ç±»ä¼¼çš„æ‰©å±•ç”¨æ¥çº æ­£è‹±æ–‡çš„æ‹¼å†™é”™è¯¯ã€‚å½“ä½ åœ¨ç½‘é¡µä¸­çš„ç¼–è¾‘æ¡†ä¸­ç¼–è¾‘æ–‡æœ¬æ—¶ï¼Œè¿™ä¸ªæ‰©å±•èƒ½æç¤ºä½ å•è¯çš„æ‹¼å†™é”™è¯¯ï¼Œä½ å°‘äº†æ ‡ç‚¹ç¬¦å·å’Œæ··æ·†å•è¯æç¤ºç­‰ã€‚å¦ˆå¦ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒæˆ‘è‹±è¯­ä¸å¥½è€æ‹¼é”™å•è¯äº†ã€‚ é«˜çº§ç‰ˆåŠŸèƒ½æ›´å¤šï¼Œä¸è¿‡æˆ‘è§‰å¾—å¦‚æœä½ ä¸æ˜¯æ—¥å¸¸è‹±æ–‡å†™ä½œçš„è¯æ ‡å‡†ç‰ˆå°±å·²ç»å¤Ÿç”¨äº†ã€‚</p><p><img data-src="https://pic3.zhimg.com/v2-a776c7397092af45bf7fcaae38ec43da_b.png" alt="img"></p><h3 id="Webtime-Tracker"><a href="#Webtime-Tracker" class="headerlink" title="Webtime Tracker"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvd2VidGltZS10cmFja2VyL3BwYW9qbmJtbWFpZ2ptbHBqYWxkbmtnbmtsaGljcHBr" title="https://chrome.google.com/webstore/detail/webtime-tracker/ppaojnbmmaigjmlpjaldnkgnklhicppk">Webtime Tracker<i class="fa fa-external-link"></i></span></h3><p>ç»Ÿè®¡ä½ æµè§ˆå„ä¸ªç½‘ç«™çš„æ—¶é—´ï¼Œä»¥ç¯å½¢å›¾å’Œåˆ—è¡¨çš„å½¢å¼å±•ç¤ºï¼Œé£æ ¼ç®€æ´åŠŸèƒ½ä¸“ä¸€ã€‚</p><p><img data-src="https://pic2.zhimg.com/v2-e0051da2db2125630e5e6483fc0bf069_b.png" alt="img"></p><h3 id="uBlock-Origin"><a href="#uBlock-Origin" class="headerlink" title="uBlock Origin"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvdWJsb2NrLW9yaWdpbi9janBhbGhkbG5icGFmaWFtZWpkbmhjcGhqYmtlaWFnbQ==" title="https://chrome.google.com/webstore/detail/ublock-origin/cjpalhdlnbpafiamejdnhcphjbkeiagm">uBlock Origin<i class="fa fa-external-link"></i></span></h3><p>æ‹¦æˆªå¹¿å‘Šçš„æ‰©å±•æœ‰å¾ˆå¤šï¼Œæ¯”è¾ƒæœ‰åçš„æœ‰ Adblockï¼ŒAdblocks plusï¼ŒAdGuardï¼Œ uBlock Origin ç­‰ã€‚è¯´å®è¯ï¼Œæˆ‘æ²¡æ€ä¹ˆå»æ·±å…¥ç ”ç©¶è¿‡å®ƒä»¬çš„åŒºåˆ«ï¼Œä¸å¥½è¯„ä»·å®ƒä»¬ä¹‹é—´çš„ä¼˜ç¼ºç‚¹ã€‚æŒ‘ä¸€ä¸ªè‡ªå·±å–œæ¬¢çš„å®‰è£…å°±è¡Œäº†ï¼Œå®‰è£…å¤šä¸ªå®Œå…¨æ²¡å¿…è¦ï¼Œæµªè´¹å†…å­˜è¿˜å®¹æ˜“èµ·å†²çªã€‚å°¤å…¶æ˜¯æˆ‘ä»¬åšå‰ç«¯å¼€å‘çš„ï¼Œå¾ˆå¯èƒ½ä¼šå¯¼è‡´æˆ‘ä»¬å¼€å‘ç½‘é¡µå‡ºç°é—®é¢˜ï¼Œå‡ºç°è¯¯æ‹¦æˆªï¼Œè§£å†³åŠæ³•å°±æ˜¯åŠ ç™½åå•æˆ–è€…ç›´æ¥å…³äº†å¹¿å‘Šæ‹¦æˆªæ’ä»¶ã€‚æ„Ÿè§‰è‡ªä»ç”¨äº†æ‹¦æˆªå¹¿å‘Šçš„æ‰©å±•åï¼Œæµè§ˆç½‘é¡µå°±æ²¡æ€ä¹ˆç¢°åˆ°è¿‡æ¶å¿ƒçš„å¹¿å‘Šå’Œå¼¹çª—ï¼Œæ¸…çˆ½äº†ä¸å°‘ï¼Œå®åœ¨å¿…å¤‡ç¥å™¨å•Šã€‚</p><p><img data-src="https://pic2.zhimg.com/v2-43f1705ab13c3dd0487264dfb0fcbbdd_b.png" alt="img"></p><p>ä¸Šé¢æåˆ°çš„å‡ ä¸ªå¤§éƒ½æ˜¯å›½å¤–çš„å¼€å‘è€…å¼€å‘ï¼Œå›½å†…çš„å¾ˆå¤šå¹¿å‘Šæœ‰å¯èƒ½æ‹¦æˆªä¸äº†ï¼Œå¯ä»¥è¯•è¯•å¦ä¸€æ¬¾å›½äººå¼€å‘çš„æ‰©å±•ï¼š <span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC82MTYwNTEyNC9baHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwv5bm/5ZGK57uI57uT6ICFL2ZwZG5qZGxiZG1pZm9vY2VkaGtpZ2hobGJjaGJpaWtsXShodHRwczovL2Nocm9tZS5nb29nbGUuY29tL3dlYnN0b3JlL2RldGFpbC/lub/lkYrnu4jnu5PogIUvZnBkbmpkbGJkbWlmb29jZWRoa2lnaGhsYmNoYmlpa2wp" title="https://zhuanlan.zhihu.com/p/61605124/[https://chrome.google.com/webstore/detail/å¹¿å‘Šç»ˆç»“è€…/fpdnjdlbdmifoocedhkighhlbchbiikl](https://chrome.google.com/webstore/detail/å¹¿å‘Šç»ˆç»“è€…/fpdnjdlbdmifoocedhkighhlbchbiikl)">å¹¿å‘Šç»ˆç»“è€…<i class="fa fa-external-link"></i></span>ã€‚</p><h3 id="Enable-Copy"><a href="#Enable-Copy" class="headerlink" title="Enable Copy"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvZW5hYmxlLWNvcHkvbG1uZ2FuYWRrZWNlZm5obmNva2RsYW9obGtuZWloaW8=" title="https://chrome.google.com/webstore/detail/enable-copy/lmnganadkecefnhncokdlaohlkneihio">Enable Copy<i class="fa fa-external-link"></i></span></h3><p>é‡åˆ°é™åˆ¶å¤åˆ¶å’Œå³é”®çš„ç½‘é¡µæ˜¯ä¸æ˜¯å¾ˆå¤´ç—›ï¼Ÿå®‰è£…è¿™ä¸ªæ‰©å±•åï¼Œç‚¹ä¸‹æ‰©å±•æŒ‰é’®å°±èƒ½è§£å†³äº†ï½</p><p><img data-src="https://pic3.zhimg.com/v2-ba2281ec4ead7085b4fb80f623277bee_b.png" alt="img"></p><h3 id="Chrome-æ¸…ç†å¤§å¸ˆ"><a href="#Chrome-æ¸…ç†å¤§å¸ˆ" class="headerlink" title="Chrome æ¸…ç†å¤§å¸ˆ"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvY2xlYW4tbWFzdGVyLXRoZS1iZXN0LWNoci9lYWdpYWtqbWpuYmxsaWFjb2toY2FsZWJnbmhlbGxmaQ==" title="https://chrome.google.com/webstore/detail/clean-master-the-best-chr/eagiakjmjnblliacokhcalebgnhellfi">Chrome æ¸…ç†å¤§å¸ˆ<i class="fa fa-external-link"></i></span></h3><p>éå¸¸å°å·§å®ç”¨çš„æ¸…ç†å·¥å…·ï¼Œæ²¡æœ‰å…¶ä»–ä¹±ä¸ƒå…«ç³Ÿçš„åŠŸèƒ½ã€‚</p><p><img data-src="https://pic4.zhimg.com/v2-07cf825f6a6811ca14afd77af5110c07_b.png" alt="img"></p><h3 id="é«˜æ•ˆç½‘é¡µæˆªå›¾ç¼–è¾‘æ‰©å±•"><a href="#é«˜æ•ˆç½‘é¡µæˆªå›¾ç¼–è¾‘æ‰©å±•" class="headerlink" title="é«˜æ•ˆç½‘é¡µæˆªå›¾ç¼–è¾‘æ‰©å±•"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvZXhwbGFpbi1hbmQtc2VuZC1zY3JlZW5zaC9tZGRkYWJqaGVscGlscG5wZ29uZGZtZWhoY3BscGlpbg==" title="https://chrome.google.com/webstore/detail/explain-and-send-screensh/mdddabjhelpilpnpgondfmehhcplpiin">é«˜æ•ˆç½‘é¡µæˆªå›¾ç¼–è¾‘æ‰©å±•<i class="fa fa-external-link"></i></span></h3><p>è¿™æ¬¾æˆªå›¾å·¥å…·ä¸ä½†æˆªå›¾ç±»å‹ä¸°å¯Œï¼Œè¿˜å¯ä»¥åœ¨æˆªå›¾ä¹‹åç›´æ¥æ ‡æ³¨ã€‚</p><p><img data-src="https://pic3.zhimg.com/v2-75bb8bb483b438bb4e2ae385bcd29b3e_b.png" alt="img"></p><h3 id="åˆ’è¯ç¿»è¯‘"><a href="#åˆ’è¯ç¿»è¯‘" class="headerlink" title="åˆ’è¯ç¿»è¯‘"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwv5YiS6K+N57+76K+RL2lraGRra25jbm9nbGdobGpsa21jaW1sbmxoa2VhbWFk" title="https://chrome.google.com/webstore/detail/åˆ’è¯ç¿»è¯‘/ikhdkkncnoglghljlkmcimlnlhkeamad">åˆ’è¯ç¿»è¯‘<i class="fa fa-external-link"></i></span></h3><p>ä¸€æ¬¾å›½äºº<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL1NlbGVjdGlvbi1UcmFuc2xhdG9yL2NyeC1zZWxlY3Rpb24tdHJhbnNsYXRl" title="https://github.com/Selection-Translator/crx-selection-translate">å¼€æº<i class="fa fa-external-link"></i></span>çš„ç¿»è¯‘å·¥å…·ï¼Œéå¸¸ç®€æ´æ–¹ä¾¿ã€‚</p><p><img data-src="https://pic3.zhimg.com/v2-ce82332c55c2ee3916ca597c4015b62a_b.png" alt="img"></p><h3 id="Quick-Tabs-å’Œ-OneTab"><a href="#Quick-Tabs-å’Œ-OneTab" class="headerlink" title="Quick Tabs å’Œ OneTab"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvcXVpY2stdGFicy9qbmpmZWluamZtZW5sZGRhaGRqZG1ncGJva2lhY2JiYg==" title="https://chrome.google.com/webstore/detail/quick-tabs/jnjfeinjfmenlddahdjdmgpbokiacbbb">Quick Tabs<i class="fa fa-external-link"></i></span> å’Œ <span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvb25ldGFiL2NocGhscGdra2JvbGlmYWltbmxsb2lpcGtkbmloYWxs" title="https://chrome.google.com/webstore/detail/onetab/chphlpgkkbolifaimnlloiipkdnihall">OneTab<i class="fa fa-external-link"></i></span></h3><p>ç»å¸¸çœ‹åˆ° PM åŒäº‹å¼€å‡ åä¸ª tab é¡µï¼Œtab é¡µå¤šçš„åªèƒ½çœ‹åˆ°ä¸€ä¸ªç½‘ç«™å›¾æ ‡ å½¡(-_-;)å½¡ã€‚é‚£ä¹ˆå¤š tab é¡µä¸€ä¸ªä¸€ä¸ªæ‰“å¼€çœ‹çœ‹æ˜¯ä¸æ˜¯è‡ªå·±æƒ³çœ‹çš„é‚£ä¸ª tab é¡µæ•ˆç‡ä¹Ÿå¤ªä½äº†ã€‚å¦‚ä½•ä½ å¹³æ—¶ä¹Ÿæ˜¯è¿™æ ·çš„æƒ…å†µï¼Œé‚£ä¹ˆ Quick Tabs å’Œ OneTab éå¸¸é€‚åˆä½ ã€‚</p><p>Quick Tabs æ¿€æ´»æœç´¢æ¡†çš„å¿«æ·é”®æ˜¯ cmd + e ï¼Œä½œè€…å— IntelliJ IDEA å¯å‘å¼€å‘çš„è¿™æ¬¾æŒ‰ç…§æœ€è¿‘ä½¿ç”¨é¡ºåºæ’åºï¼Œå¯ä»¥æœç´¢å’Œå¿«é€Ÿåˆ‡æ¢åˆ°ä½ æƒ³è¦æ‰“å¼€çš„æ‰©å±•ã€‚</p><p><img data-src="https://pic2.zhimg.com/v2-0efe002b694552eaef8e5537d6e4dbad_b.png" alt="img"></p><p>OneTab è¿™ä¸ªæ‰©å±•ä¼šå°†ä½ æ‰€æœ‰æ‰“å¼€çš„ tab æ”¶åˆ°ä¸€ä¸ªé¡µé¢ï¼Œéœ€è¦æ‰“å¼€å“ªä¸ªé¡µé¢ç›´æ¥åœ¨è¿™ä¸ªé¡µé¢ç‚¹å‡»æ¢å¤å³å¯ã€‚</p><p><img data-src="https://pic2.zhimg.com/v2-f4442328d3cafea61c297cf32077c90d_b.png" alt="img"></p><h3 id="The-Great-Suspender"><a href="#The-Great-Suspender" class="headerlink" title="The Great Suspender"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvdGhlLWdyZWF0LXN1c3BlbmRlci9rbGJpYmtlY2Nuamxramtpb2tqb2RvY2ViYWphbmFrZw==" title="https://chrome.google.com/webstore/detail/the-great-suspender/klbibkeccnjlkjkiokjodocebajanakg">The Great Suspender<i class="fa fa-external-link"></i></span></h3><p>è¿™æ¬¾æ’ä»¶ä¹Ÿæ˜¯ä¸€ä¸ª tab é¡µæ’ä»¶ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯ä¼šåœ¨ä½ ä¸è®¿é—®æŸä¸ªé¡µé¢ä¸€å®šæ—¶é—´åè‡ªåŠ¨å†»ç»“é¡µé¢æˆ–è€…æ‰‹åŠ¨å†»ç»“ï¼Œè¾¾åˆ°èŠ‚çœå†…å­˜çš„ç›®çš„ã€‚å½“ä½ éœ€è¦æ¢å¤é¡µé¢ï¼Œåªè¦ç‚¹å‡»ä¸€ä¸‹é¡µé¢å³å¯æ¢å¤ã€‚å›¾æ ‡éå¸¸ cute å‘¢ ï¸¿(ï¿£ï¸¶ï¿£)ï¸¿</p><p><img data-src="https://pic1.zhimg.com/v2-79ed87fe35cac30f79f7b07c4d6a5dc0_b.png" alt="img"></p><h3 id="Super-Simple-Highlighter"><a href="#Super-Simple-Highlighter" class="headerlink" title="Super Simple Highlighter"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvc3VwZXItc2ltcGxlLWhpZ2hsaWdodGVyL2hobGhqZ2lhbnBvY3BvcHBhaWlobWxwZ2NvZWhsaGlv" title="https://chrome.google.com/webstore/detail/super-simple-highlighter/hhlhjgianpocpoppaiihmlpgcoehlhio">Super Simple Highlighter<i class="fa fa-external-link"></i></span></h3><p>è¿™æ¬¾æ‰©å±•å…è®¸ä½ åœ¨ç½‘é¡µä¸Šç›´æ¥é«˜äº®æ–‡å­—ï¼Œå½“ä½ å…³æ‰é¡µé¢é‡æ–°æ‰“å¼€é«˜äº®ä¹Ÿä¼šæ¢å¤ï¼Œå¯¹äºä¸€äº›ç»å¸¸éœ€è¦åœ¨ç½‘é¡µä¸Šæµè§ˆæ–‡æ¡£çš„äººæˆ–è®¸å¾ˆæœ‰å¸®åŠ©ã€‚</p><p><img data-src="https://pic1.zhimg.com/v2-7d2424fdea5f4dc9bd8b4aebefaa6788_b.png" alt="img"></p><h3 id="Linkclump"><a href="#Linkclump" class="headerlink" title="Linkclump"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvbGlua2NsdW1wL2xmcGprbmNva2xsbmZva2tncGtvYm5rYmttZWxmZWZq" title="https://chrome.google.com/webstore/detail/linkclump/lfpjkncokllnfokkgpkobnkbkmelfefj">Linkclump<i class="fa fa-external-link"></i></span></h3><p>é€‰ä¸­ä¸€ç‰‡å±€åŸŸä¸€æ¬¡æ€§æ‰“å¼€å¤šä¸ªé“¾æ¥ï¼Œè¿™åœ¨æŸäº›æƒ…å†µä¸‹å¾ˆå®ç”¨ã€‚</p><p><img data-src="https://pic2.zhimg.com/v2-8a67eb0370247e36679fdad70e2d6451_b.png" alt="img"></p><h3 id="ä¹¦ç­¾ä¾§è¾¹æ "><a href="#ä¹¦ç­¾ä¾§è¾¹æ " class="headerlink" title="ä¹¦ç­¾ä¾§è¾¹æ "></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvYm9va21hcmstc2lkZWJhci9qZGJub2ZjY21oZWZrbWpia2tka2ZpaWNqa2dvZmtkaA==" title="https://chrome.google.com/webstore/detail/bookmark-sidebar/jdbnofccmhefkmjbkkdkfiicjkgofkdh">ä¹¦ç­¾ä¾§è¾¹æ <i class="fa fa-external-link"></i></span></h3><p>å¦‚æœä½ è§‰å¾—æ¯æ¬¡æ‰“å¼€è‡ªå¸¦çš„ä¹¦ç­¾ç®¡ç†å™¨éƒ½æ‰“å¼€ä¸€ä¸ªæ–° tab é¡µé‡Œé¢å¾ˆä¸æ–¹ä¾¿ï¼Œä¸å¦¨è¯•è¯•è¿™æ¬¾ä¹¦ç­¾æ’ä»¶ï¼Œè¿™æ¬¾ä¹¦ç­¾ç®¡ç†éå¸¸ material éå¸¸éªšæ°”ï¼Œå¯ä»¥è‡ªå®šä¹‰çš„é…ç½®å¾ˆå¤šã€‚</p><p><img data-src="https://pic4.zhimg.com/v2-e159365aa5f6e455e1b73dbfc4271757_b.jpg" alt="img"></p><h3 id="Pinbox-ç½‘ç»œæ”¶è—å¤¹"><a href="#Pinbox-ç½‘ç»œæ”¶è—å¤¹" class="headerlink" title="Pinbox - ç½‘ç»œæ”¶è—å¤¹"></a><span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC82MTYwNTEyNC9baHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvcGluYm94Lee9kee7nOaUtuiXj+WkuS9rbWlqZWFuZ25hamRjYW9tZGZqb2hoYm1uYmhuaGpqZF0oaHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvcGluYm94Lee9kee7nOaUtuiXj+WkuS9rbWlqZWFuZ25hamRjYW9tZGZqb2hoYm1uYmhuaGpqZCk=" title="https://zhuanlan.zhihu.com/p/61605124/[https://chrome.google.com/webstore/detail/pinbox-ç½‘ç»œæ”¶è—å¤¹/kmijeangnajdcaomdfjohhbmnbhnhjjd](https://chrome.google.com/webstore/detail/pinbox-ç½‘ç»œæ”¶è—å¤¹/kmijeangnajdcaomdfjohhbmnbhnhjjd)">Pinbox - ç½‘ç»œæ”¶è—å¤¹<i class="fa fa-external-link"></i></span></h3><p>å¦‚æœä¸Šæ»¡é‚£æ¬¾æ’ä»¶è¿˜æ˜¯ä¸èƒ½æ»¡è¶³ä½ çš„éœ€æ±‚ï¼Œä½ å¯ä»¥è¯•è¯•è¿™æ¬¾å›½äººå¼€å‘çš„ç½‘ç»œæ”¶è—å·¥å…·ã€‚å®˜æ–¹ä»‹ç»ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æ‚¨çš„ä¸“å±ç½‘ç»œæ”¶è—å¤¹ï¼Œå°†æ–‡ç« ã€è§†é¢‘æˆ–å–œæ¬¢çš„ä»»ä½•å†…å®¹ä¸€é”®ä¿å­˜åˆ° Pinbox, éšæ—¶éšåœ°æ”¶è—äº’è”ç½‘</span><br><span class="line">Pinbox æ˜¯ä¸€æ¬¾è·¨å¹³å°çš„æ”¶è—å·¥å…·ï¼Œæ‚¨å¯ä»¥ç”¨å®ƒæ¥è®°å½•çµæ„Ÿï¼Œä¿å­˜èµ„æ–™ç”šè‡³ç½‘ç»œä¸Šçš„ä»»ä½•å†…å®¹ã€‚</span><br><span class="line"></span><br><span class="line">é€šè¿‡ Pinbox æ‚¨å¯ä»¥æ”¶è—ï¼ˆç½‘é¡µï¼Œå›¾ç‰‡ï¼Œæ–‡æœ¬ï¼‰ï¼Œæ‰“é€ æ‚¨çš„ç§äººç©ºé—´ï¼ŒåŒæ—¶å¯ä»¥é€šè¿‡å¤šçº§æ”¶è—é›†å’Œæ‰¹é‡æ“ä½œæ¥æ•´ç†å®ƒä»¬ã€‚</span><br><span class="line"></span><br><span class="line">Pinbox åŒæ—¶æ˜¯ä¸€æ¬¾å¼ºå¤§çš„ç”Ÿäº§åŠ›å·¥å…·ï¼Œåˆ©ç”¨å¿«æ·é”®ï¼Œæ‚¨å¯ä»¥è¿…é€Ÿçš„æ‰“å¼€æ”¶è—çš„å†…å®¹ã€‚</span><br><span class="line"></span><br><span class="line">åŠŸèƒ½ï¼š</span><br><span class="line">1.æ”¶è—ç½‘é¡µã€å›¾ç‰‡ã€æ–‡æœ¬ï¼Œç”šè‡³ç½‘ç»œä¸Šçš„ä¸€åˆ‡å†…å®¹ï¼›</span><br><span class="line">2.ç¼–è¾‘æ ‡é¢˜å’Œå¤‡æ³¨ï¼šæ‚¨å¯ä»¥ç¼–è¾‘å·²ç»æ”¶è—çš„å†…å®¹ï¼Œä½¿ä¹‹æ›´åŠ æ¸…æ™°ç›´è§‚ï¼›</span><br><span class="line">3.å¤šçº§æ”¶è—é›†ï¼šå¸®åŠ©æ‚¨æ•´ç†æ”¶è—çš„å†…å®¹ï¼›</span><br><span class="line">4.ç¼–è¾‘æ¨¡å¼ï¼šæ”¯æŒå¤šé€‰ã€æ‹–æ‹½ç­‰åŠŸèƒ½ï¼Œå¯ä»¥æ‰¹é‡æ•´ç†æ‚¨çš„æ”¶è—ï¼›</span><br><span class="line">5.æœç´¢ï¼šæœç´¢æ”¶è—çš„æ ‡é¢˜ã€é“¾æ¥ã€åŒæ ·ä¹Ÿæ”¯æŒæ‚¨è‡ªå®šä¹‰çš„æ ‡é¢˜å’Œå¤‡æ³¨ï¼›</span><br><span class="line">6.å¯¼å…¥ä¹¦ç­¾ï¼šä¸€é”®å¿«é€Ÿå¯¼å…¥æµè§ˆå™¨ä¹¦ç­¾ï¼Œå¹¶ä¿ç•™ä¹¦ç­¾ç»“æ„ï¼›</span><br><span class="line">7.å›æ”¶ç«™ï¼šæ”¾å¿ƒçš„åˆ é™¤æ”¶è—ï¼Œå®ƒä»¬éƒ½å°†è‡ªåŠ¨è¿›å…¥å›æ”¶ç«™ï¼Œéšæ—¶æ¢å¤ï¼›</span><br><span class="line">8.è·¨å¹³å°æ”¯æŒï¼šç½‘é¡µ + æµè§ˆå™¨æ‰©å±• + APPï¼›</span><br><span class="line">9.æ³¨é‡éšç§ï¼šæˆ‘ä»¬ååˆ†æ³¨é‡ç”¨æˆ·éšç§ï¼Œæ‚¨çš„æ”¶è—åªæœ‰æ‚¨è‡ªå·±èƒ½çœ‹åˆ°ã€‚</span><br></pre></td></tr></table></figure><p>è¿™æ¬¾æ’ä»¶æ¯”èµ·ä¸Šé¢é‚£æ¬¾å¯ä»¥è¯´åŠŸèƒ½æ˜¯å¼ºå¤§å¾ˆå¤šäº†ï¼Œè·¨å¹³å°ï¼Œåœ¨çº¿åŒæ­¥ï¼Œä¸ä»…å¯ä»¥æ”¶è—ç½‘é¡µè¿˜å¯ä»¥æ”¶è—å¾ˆå¤šå…¶å®ƒç±»å‹çš„å†…å®¹ã€‚æ‰“å¼€ pinbox é¡µé¢å°±å¯ä»¥çœ‹å‡ºä½œè€…éå¸¸çš„ç”¨å¿ƒå•Šï¼Œä¸å¤šè¯´äº†ï¼Œæ„Ÿå…´è¶£çš„è¯»è€…å¯ä»¥è‡ªå·±ä½¿ç”¨æ„Ÿå—ä¸‹ã€‚</p><p><img data-src="https://pic4.zhimg.com/v2-3929cecc5c57ed79e68fde6ce81f2837_b.jpg" alt="img"></p><h3 id="Wappalyzer"><a href="#Wappalyzer" class="headerlink" title="Wappalyzer"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvd2FwcGFseXplci9ncHBvbmdtaGprcGZuYmhhZ3BtamZrYW5uZmJsbGFtZw==" title="https://chrome.google.com/webstore/detail/wappalyzer/gppongmhjkpfnbhagpmjfkannfbllamg">Wappalyzer<i class="fa fa-external-link"></i></span></h3><p>ä¸€æ¬¾å¯ä»¥åˆ†æç½‘ç«™ç”¨åˆ°çš„æŠ€æœ¯æ¡†æ¶çš„æ‰©å±•ã€‚</p><p><img data-src="https://pic1.zhimg.com/v2-a4841bcc39cf5e66956dce1559cae070_b.png" alt="img"></p><h3 id="IP-Whois-amp-Flags-Chrome-amp-Websites-Rating"><a href="#IP-Whois-amp-Flags-Chrome-amp-Websites-Rating" class="headerlink" title="IP Whois &amp; Flags Chrome &amp; Websites Rating"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvaXAtd2hvaXMtZmxhZ3MtY2hyb21lLXdlYi9rbWRmYmFjZ29tYm5kbmxsb2dvaWpobmdnYWxnbWtvbg==" title="https://chrome.google.com/webstore/detail/ip-whois-flags-chrome-web/kmdfbacgombndnllogoijhnggalgmkon">IP Whois &amp; Flags Chrome &amp; Websites Rating<i class="fa fa-external-link"></i></span></h3><p>å¯ä»¥æ˜¾ç¤ºç½‘ç«™çš„å›½æ——ï¼Œæµè¡Œåº¦ï¼Œip ç­‰å…¶å®ƒä¿¡æ¯ã€‚</p><p><img data-src="https://pic2.zhimg.com/v2-f13cf852b115feffd06d8a1a9abc7a71_b.png" alt="img"></p><p>å¦ä¸€æ¬¾æ›´å¼ºå¤§çš„ ip åˆ†ææ‰©å±•æ˜¯ <span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvaXAtYWRkcmVzcy1hbmQtZG9tYWluLWluZi9saGdrZWdlY2NuY2tvaWxpb2tvbmRwYWFhbGJoYWZvYQ==" title="https://chrome.google.com/webstore/detail/ip-address-and-domain-inf/lhgkegeccnckoiliokondpaaalbhafoa">IP Address and Domain Information<i class="fa fa-external-link"></i></span></p><h3 id="æ‰©å±•ç®¡ç†å™¨ï¼ˆExtension-Managerï¼‰"><a href="#æ‰©å±•ç®¡ç†å™¨ï¼ˆExtension-Managerï¼‰" class="headerlink" title="æ‰©å±•ç®¡ç†å™¨ï¼ˆExtension Managerï¼‰"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvZXh0ZW5zaW9uLW1hbmFnZXIvZ2psZGNkbmdtZGtucGlub2VtbmRsaWRwY2Fia2dnY28=" title="https://chrome.google.com/webstore/detail/extension-manager/gjldcdngmdknpinoemndlidpcabkggco">æ‰©å±•ç®¡ç†å™¨ï¼ˆExtension Managerï¼‰<i class="fa fa-external-link"></i></span></h3><p>ç®€å•æ˜“ç”¨çš„æ‰©å±•ç®¡ç†å™¨ï¼Œæ”¯æŒè¿˜æœ‰æœç´¢å’Œåˆ†ç»„åŠŸèƒ½ã€‚é»˜è®¤æ˜¯ç½‘æ ¼è§†å›¾ï¼Œè¿˜å¯ä»¥ä½¿ç”¨æ˜¾ç¤ºä¿¡æ¯æ›´å¤šçš„åˆ—è¡¨è§†å›¾ã€‚</p><p><img data-src="https://pic4.zhimg.com/v2-bcb3590e780b2ea29173c2b108feee53_b.png" alt="img"></p><p>è¿™é‡Œä»‹ç»ä¸€ä¸‹æˆ‘å¹³æ—¶æ˜¯æ€ä¹ˆç”¨è¿™æ¬¾æ‰©å±•çš„ï¼Œæˆ‘ä¸€èˆ¬æ˜¯åˆ†ä¸‰ä¸ªç»„ï¼šé»˜è®¤åˆ†ç»„ï¼Œå¼€å‘åˆ†ç»„ï¼Œæ— æ‰©å±•åˆ†ç»„ã€‚</p><ul><li>é»˜è®¤åˆ†ç»„ï¼šåŒ…å«çš„æ‰©å±•æœ€å¤šï¼Œå°±æ˜¯ä¸€äº›å¹³å¸¸å¯èƒ½ç”¨å¾—ä¸Šçš„æ‰©å±•</li><li>å¼€å‘åˆ†ç»„ï¼šé™¤å»äº†ä¸€äº›å¹¿å‘Šæ‹¦æˆªç­‰å¯èƒ½ä¼šå½±å“æˆ‘åšå‰ç«¯å¼€å‘çš„æ‰©å±•</li><li>æ— æ‰©å±•åˆ†ç»„ï¼šåŸºæœ¬ä¸Šæ²¡æœ‰å¼€å¯æ‰©å±•ï¼Œåªä¿ç•™çš„ä¸€ä¸ªæ–°æ ‡ç­¾é¡µæ‰©å±•</li></ul><p>ä¸åŒåœºæ™¯é€‰æ‹©ä¸åŒçš„æ‰©å±•ç»„ï¼Œé«˜æ•ˆç®¡ç†æ‰©å±•ã€‚</p><h3 id="Online-Download-Manager"><a href="#Online-Download-Manager" class="headerlink" title="Online Download Manager"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvb25saW5lLWRvd25sb2FkLW1hbmFnZXIvb3BqanBtaG9pb2ppZnBwa2tjZGFiaW9iaGFrbGpkZ20=" title="https://chrome.google.com/webstore/detail/online-download-manager/opjjpmhoiojifppkkcdabiobhakljdgm">Online Download Manager<i class="fa fa-external-link"></i></span></h3><p>å¦‚æœä½ è¿˜åœ¨æŠ±æ€¨ chrome è‡ªå¸¦çš„ä¸‹è½½ç®¡ç†å¤ªç®€æ´äº†ï¼Œé‚£ä¹ˆè¿™æ¬¾ä¸‹è½½ç®¡ç†æ‰©å±•ç»å¯¹å€¼å¾—å°è¯•ã€‚è¿™æ¬¾æ’ä»¶é™¤äº†æ¯”è‡ªå¸¦çš„ä¸‹è½½ç®¡ç†åœ¨ç®¡ç†æ–¹é¢åŠŸèƒ½æ›´ä¸°å¯Œï¼Œè¿˜æœ‰ä¸€å¤§ç‰¹è‰²å°±æ˜¯èµ„æºå—…æ¢ï¼Œå¯ä»¥å—…æ¢å‡ºç½‘é¡µä¸­çš„å›¾ç‰‡ï¼Œè§†é¢‘ï¼ŒéŸ³é¢‘èµ„æºã€‚ä»¥å‰æœ‰ä¸€æ¬¾åŒæ ·éå¸¸ä¼˜ç§€çš„ä¸‹è½½ç®¡ç†æ‰©å±•å« chronoï¼Œä½†æ˜¯ä¸é€ ä¸ºå•¥ chrome æ‰©å±•å¸‚åœºå·²ç»æœç´¢ä¸åˆ°äº†(O_O)?</p><p><img data-src="https://pic3.zhimg.com/v2-9314f73804294bb73879dd040d0f283e_b.png" alt="img"></p><h3 id="Copyfish-ğŸŸ-Free-OCR-Software"><a href="#Copyfish-ğŸŸ-Free-OCR-Software" class="headerlink" title="Copyfish ğŸŸ Free OCR Software"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvY29weWZpc2gt8J+Qny1mcmVlLW9jci1zb2Z0L2VlbmpkbmpsZGFwamFqam9mbWxkZ21ramFpZW5lYmJq" title="https://chrome.google.com/webstore/detail/copyfish-ğŸŸ-free-ocr-soft/eenjdnjldapjajjofmldgmkjaienebbj">Copyfish ğŸŸ Free OCR Software<i class="fa fa-external-link"></i></span></h3><p>ä¸€ä¸ª OCR æ–‡å­—è¯†åˆ«æ‰©å±•ã€‚</p><p><img data-src="https://pic4.zhimg.com/v2-1e1085a888f2851517fb121a0c2f32ff_b.png" alt="img"></p><h3 id="Proxy-SwitchyOmega"><a href="#Proxy-SwitchyOmega" class="headerlink" title="Proxy SwitchyOmega"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvcHJveHktc3dpdGNoeW9tZWdhL3BhZGVrZ2NlbWxva2JhZG9oZ2tpZmlqb21jbGdqZ2lm" title="https://chrome.google.com/webstore/detail/proxy-switchyomega/padekgcemlokbadohgkifijomclgjgif">Proxy SwitchyOmega<i class="fa fa-external-link"></i></span></h3><p>æ— è®ºæ˜¯å¼€å‘è¿˜æ˜¯æ—¥å¸¸ä½¿ç”¨éƒ½æ˜¯éå¸¸å¼ºå¤§å®ç”¨çš„å·¥å…·ã€‚è¿™æ˜¯ä¸€æ¬¾ç®¡ç†ä»£ç†çš„æ‰©å±•ï¼Œæ–¹ä¾¿å¿«é€Ÿåˆ‡æ¢å„ç§ä»£ç†æ¨¡å¼ï¼Œå‰ç«¯å¼€å‘ä¹Ÿç»å¸¸ä½¿ç”¨å®ƒæ¥ä»£ç†é¿å…è·¨åŸŸé—®é¢˜ã€‚</p><p><img data-src="https://pic2.zhimg.com/v2-02b3a7c55fd2b46c4c9d42cff93b13e1_b.png" alt="img"></p><h3 id="Markdown-Preview-Plus"><a href="#Markdown-Preview-Plus" class="headerlink" title="Markdown Preview Plus"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvbWFya2Rvd24tcHJldmlldy1wbHVzL2ZlYmlsa2JmY2JoZWJmbm9rYWZlZmVhY2ltamRja2ds" title="https://chrome.google.com/webstore/detail/markdown-preview-plus/febilkbfcbhebfnokafefeacimjdckgl">Markdown Preview Plus<i class="fa fa-external-link"></i></span></h3><p>ä¸€æ¬¾å¯ä»¥è®©ä½ åœ¨æµè§ˆå™¨ä¸­é˜…è¯» markdown æ–‡ä»¶çš„æ‰©å±•ï¼Œé…è‰²è¿˜æ˜¯æŒºæŠ¤çœ¼çš„ã€‚</p><p><img data-src="https://pic4.zhimg.com/v2-06215cb1312993e6f7647270e2fac9e7_b.png" alt="img"></p><p>ä¸è¿‡æˆ‘ç°åœ¨å·²ç»åˆ‡æ¢åˆ°å¦ä¸€æ¬¾æ‰©å±• <span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvbWFya2Rvd24tdmlld2VyL2Nra2RsaW1obWNqbWlrZGxwa21iZ2ZrYWlrb2pjYmpr" title="https://chrome.google.com/webstore/detail/markdown-viewer/ckkdlimhmcjmikdlpkmbgfkaikojcbjk">Markdown Viewer<i class="fa fa-external-link"></i></span> äº†ï¼Œè¯»è€…å¯ä»¥è‡ªè¡Œæ¯”è¾ƒé€‰æ‹©ã€‚</p><h3 id="Markdown-Here"><a href="#Markdown-Here" class="headerlink" title="Markdown Here"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvbWFya2Rvd24taGVyZS9lbGlmaGFrY2pnYWxhaGNjbmprbmVvY2NlbWZhaGZvYQ==" title="https://chrome.google.com/webstore/detail/markdown-here/elifhakcjgalahccnjkneoccemfahfoa">Markdown Here<i class="fa fa-external-link"></i></span></h3><p>å®˜æ–¹æè¿°:</p><blockquote><p>``` Markdown Here å…è®¸ä½ åœ¨å‘é€ç”µå­é‚®ä»¶ä¹‹å‰ç”¨ Markdown è¯­æ³•ç¼–è¾‘å¹¶è½¬æ¢å®ƒ(è®©å®ƒçœ‹èµ·æ¥æ¼‚äº®æäº†!)ã€‚ è¿™å¯¹äºé‚£äº›ä¸å–œæ¬¢åœ¨æ’°å†™ç”µé‚®æ—¶åå¤æ‘†å¼„æ’ç‰ˆæŒ‰é’®çš„äººæ— ç–‘æ˜¯å¥½æ¶ˆæ¯ã€‚ å®ƒç‰¹åˆ«é€‚åˆé‚£äº›è¦åœ¨ç”µå­é‚®ä»¶ä¸­æ’å…¥ä»£ç çš„ç¨‹åºå‘˜ä»¬ â€”â€” æ²¡é”™ï¼Œå®ƒç”šè‡³æ”¯æŒè¯­æ³•é«˜äº®æ˜¾ç¤ºã€‚ å¯¹äºæˆ‘ä»¬ä¹‹ä¸­çš„æ•°å­¦å®¶ä»¬è€Œè¨€ï¼ŒMarkdown Here ä¹Ÿæ”¯æŒè½¬æ¢ TeX å…¬å¼ã€‚ ```</p></blockquote><p><img data-src="https://pic3.zhimg.com/v2-74a505a3864cc5839138a25d8eb7d2a2_b.jpg" alt="img"></p><h3 id="ç±»ä¼¼çš„ç½‘ç«™-å‘ç°ç›¸å…³ç½‘ç«™"><a href="#ç±»ä¼¼çš„ç½‘ç«™-å‘ç°ç›¸å…³ç½‘ç«™" class="headerlink" title="ç±»ä¼¼çš„ç½‘ç«™ - å‘ç°ç›¸å…³ç½‘ç«™"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvc2ltaWxhci1zaXRlcy1kaXNjb3Zlci1yZS9uZWNwYm1iaGhkaXBsbWZobWppY2FiZGVpZ2hrbmRrbg==" title="https://chrome.google.com/webstore/detail/similar-sites-discover-re/necpbmbhhdiplmfhmjicabdeighkndkn">ç±»ä¼¼çš„ç½‘ç«™ - å‘ç°ç›¸å…³ç½‘ç«™<i class="fa fa-external-link"></i></span></h3><p><img data-src="https://pic1.zhimg.com/v2-c7c6d99a3ff23988d0a77701532f7ae8_b.png" alt="img"></p><h3 id="Tampermonkey"><a href="#Tampermonkey" class="headerlink" title="Tampermonkey"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvdGFtcGVybW9ua2V5L2RoZGdmZmtrZWJobWtmam9qZWptcGJsZG1wb2Jma2Zv" title="https://chrome.google.com/webstore/detail/tampermonkey/dhdgffkkebhmkfjojejmpbldmpobfkfo">Tampermonkey<i class="fa fa-external-link"></i></span></h3><p>å¾ˆå¤šç½‘å‹å«è¿™ä¸ªæ‰©å±•å«æ²¹çŒ´ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªç®¡ç†æ³¨å…¥ç½‘ç«™çš„ javascript è„šæœ¬çš„æ‰©å±•ã€‚ä½¿ç”¨å®ƒæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰æŸä¸ªç½‘ç«™æ‰“å¼€æ—¶æ³¨å…¥çš„è„šæœ¬ï¼Œä¹Ÿå¯ä»¥å»ä¸€äº›è®ºå›ç›´æ¥å®‰è£…åˆ«äººåˆ†äº«çš„è„šæœ¬ã€‚æ²¹çŒ´æ­é… idm å¯¹äºæ²»ç–—ç™¾åº¦ç½‘ç›˜èœ—é€Ÿæœ‰å¥‡æ•ˆ,ï¼Œæ¯”è¾ƒå—æ¬¢è¿çš„è„šæœ¬è¿˜æœ‰ç ´è§£ä¼šå‘˜ä¹‹ç±»çš„ã€‚æ¨èè„šæœ¬æº <span class="exturl" data-url="aHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy96aC1DTg==" title="https://greasyfork.org/zh-CN">greasyfork<i class="fa fa-external-link"></i></span>, è¿˜æœ‰ä¸€ä¸ªæ˜¾ç¤ºå½“å‰ç½‘ç«™æ‰€æœ‰å¯ç”¨è„šæœ¬çš„è„šæœ¬ <span class="exturl" data-url="aHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy96aC1DTi9zY3JpcHRzLzI0NTA4LXVzZXJzY3JpcHQtc2hvdy1zaXRlLWFsbC11c2VyanM=" title="https://greasyfork.org/zh-CN/scripts/24508-userscript-show-site-all-userjs">Userscript+<i class="fa fa-external-link"></i></span>ã€‚</p><h3 id="Stylus"><a href="#Stylus" class="headerlink" title="Stylus"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvc3R5bHVzL2NsbmdkYmtwa3BlZWJhaGpja2tqZm9iYWZobmNnbW5l" title="https://chrome.google.com/webstore/detail/stylus/clngdbkpkpeebahjckkjfobafhncgmne">Stylus<i class="fa fa-external-link"></i></span></h3><p>æ²¹çŒ´æ˜¯ç”¨æ¥æ³¨å…¥ javascript è„šæœ¬çš„ï¼Œè€Œè¿™ä¸ªæ˜¯ç”¨æ¥æ³¨å…¥ css æ ·å¼çš„ã€‚</p><h3 id="Infinity-æ–°æ ‡ç­¾é¡µ-Pro"><a href="#Infinity-æ–°æ ‡ç­¾é¡µ-Pro" class="headerlink" title="Infinity æ–°æ ‡ç­¾é¡µ(Pro)"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvaW5maW5pdHktbmV3LXRhYi1wcm8vbm5ua2Rkbm5scGFtb2JhamZpYmZkZ2ZuYmNua2duZ2g=" title="https://chrome.google.com/webstore/detail/infinity-new-tab-pro/nnnkddnnlpamobajfibfdgfnbcnkgngh">Infinity æ–°æ ‡ç­¾é¡µ(Pro)<i class="fa fa-external-link"></i></span></h3><p>è¿™ä¸ªæ‰©å±•è¢«å¤ªå¤šäººæ¨èè¿‡äº†ï¼Œæ‰€ä»¥æˆ‘ä¹Ÿä¸æ•¢æ”¾æ–‡ç« æœ€å¼€å¤´ä»‹ç»ï¼Œæ€•è¢«è®¤ä¸ºæˆ‘æ¨èä¸€å †çƒ‚å¤§è¡—çš„æ‰©å±•ã€‚éå¸¸è‰¯å¿ƒçš„ä¸€æ¬¾æ–°æ ‡ç­¾é¡µæ‰©å±•ï¼Œæœ‰å¾ˆå¤šåœ°æ–¹éƒ½å¯ä»¥è‡ªå®šä¹‰ï¼Œæœ¬æ–‡çš„å°é¢å°±æ˜¯è¿™ä¸ªæ‰©å±•çš„æ™®é€šç‰ˆã€‚æˆ‘ç›®å‰ç”¨çš„æ˜¯ Pro ç‰ˆæœ¬ï¼ŒPro ç‰ˆæœ¬ç›®å‰å¯ä»¥æ— é™æœŸå…è´¹ä½¿ç”¨ï¼Œè‰¯å¿ƒå•Šã€‚Pro ç‰ˆæœ¬ç›¸æ¯”è¾ƒäºæ™®é€šç‰ˆè‡ªå®šä¹‰é¡¹æ›´åŠ ä¸°å¯Œï¼Œè¿˜æ”¯æŒæ–‡ä»¶å¤¹ï¼ŒåŠ¨ç”»ï¼Œå±å¹•ç¼©æ”¾ç­‰æ–°åŠŸèƒ½ã€‚</p><p><img data-src="https://pic2.zhimg.com/v2-2ceb7f4214aa57a051ef29c229651e65_b.png" alt="img"></p><h3 id="HTTPS-Everywhere"><a href="#HTTPS-Everywhere" class="headerlink" title="HTTPS Everywhere"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvaHR0cHMtZXZlcnl3aGVyZS9nY2JvbW1rY2xtY2xwY2hsbGZqZWtjZG9ucG1lamJkcA==" title="https://chrome.google.com/webstore/detail/https-everywhere/gcbommkclmclpchllfjekcdonpmejbdp">HTTPS Everywhere<i class="fa fa-external-link"></i></span></h3><p>åŠ å¯†ç½‘ç»œæµè§ˆï¼Œè‡ªåŠ¨ä½¿ç”¨ HTTPS è¿æ¥è®¿é—®ç«™ç‚¹ï¼Œæ›´åŠ å®‰å…¨ã€‚</p><p>è¿˜æœ‰ä¸€äº›éƒ½ç”¨å¾—ä¸Šçš„æ‰©å±•æˆ‘å°±ç®€å•åˆ—ä¸€ä¸‹ï¼š</p><ul><li><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvYmxhY2stbWVudS1mb3ItZ29vZ2xlL2VpZ25oZGZnYWxkYWJpbGFhZWdtZGZiYWpuZ2ptb2tl" title="https://chrome.google.com/webstore/detail/black-menu-for-google/eignhdfgaldabilaaegmdfbajngjmoke">Black Menu for Googleâ„¢<i class="fa fa-external-link"></i></span> ä¸€ä¸ªèœå•æ‰©å±•è®©ä½ å¿«é€Ÿä½¿ç”¨ Google æä¾›çš„å„ç§æœåŠ¡</li><li><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvZGlzdGlsbC13ZWItbW9uaXRvci9pbmxpa2plbWVla25vZmNra2pvbG5qYnBlaGdhZGdnZQ==" title="https://chrome.google.com/webstore/detail/distill-web-monitor/inlikjemeeknofckkjolnjbpehgadgge">Distill Web Monitor<i class="fa fa-external-link"></i></span> ç›‘æ§ç½‘é¡µå˜åŒ–ï¼ŒæŠ¢è´­ç¥å™¨</li><li><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvY3J4bW91c2UtY2hyb21lLWdlc3R1cmVzL2psZ2twYWljaWtpaGlqYWRnaWZrbGticGRhamJraGpvXQ==" title="https://chrome.google.com/webstore/detail/crxmouse-chrome-gestures/jlgkpaicikihijadgifklkbpdajbkhjo]">crxMouse Chromeâ„¢ æ‰‹åŠ¿<i class="fa fa-external-link"></i></span> æå¤§çš„æ‰©å±•äº† chrome çš„æ‰‹åŠ¿åŠŸèƒ½</li><li><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvZmF0a3VuLWJhdGNoLWRvd25sb2FkLWltYS9ubmpqYWhsaWtpYWJuY2hjcGVoY3BrZGVja2Znbm9oZg==" title="https://chrome.google.com/webstore/detail/fatkun-batch-download-ima/nnjjahlikiabnchcpehcpkdeckfgnohf">Fatkun å›¾ç‰‡æ‰¹é‡ä¸‹è½½<i class="fa fa-external-link"></i></span></li><li><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvaWUtdGFiL2hlaGlqYmZnaWVrbWpma2ZqcGJrYmFtbWpiZGVuYWRk" title="https://chrome.google.com/webstore/detail/ie-tab/hehijbfgiekmjfkfjpbkbammjbdenadd">IE Tab<i class="fa fa-external-link"></i></span> è§£å†³ chrome æ— æ³•ä½¿ç”¨ç½‘é“¶çš„é—®é¢˜</li><li><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvbm90ZS1ib2FyZC1zdGlja3ktbm90ZXMtYS9nb2ZpY21wY2djbm9tYmlvb2hqY2dkaGJhbG9rbmFiYg==" title="https://chrome.google.com/webstore/detail/note-board-sticky-notes-a/goficmpcgcnombioohjcgdhbaloknabb">Note Board - Sticky Notes App<i class="fa fa-external-link"></i></span></li><li><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvbWVnYS9iaWdlZnBmaG5mY29iZGxmYmVkb2ZoaGFpYm5sZ2hvZA==" title="https://chrome.google.com/webstore/detail/mega/bigefpfhnfcobdlfbedofhhaibnlghod">MEGA<i class="fa fa-external-link"></i></span> å…è´¹ 50 G çš„ç½‘ç›˜</li><li><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvb2ZmaWNlLW9ubGluZS9uZGpwbmxhZGNhbGxtamVtbGJhZWJmYWRlY2Zoa2VwYg==" title="https://chrome.google.com/webstore/detail/office-online/ndjpnladcallmjemlbaebfadecfhkepb">Office Online<i class="fa fa-external-link"></i></span> åœ¨æµè§ˆå™¨ä¸­æŸ¥çœ‹ã€ç¼–è¾‘å’Œåˆ›å»º Office æ–‡ä»¶ã€‚</li><li><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvcGRmLXZpZXdlci9vZW1tbmRjYmxkYm9pZWJmbmxhZGRhY2JkZm1hZGFkbQ==" title="https://chrome.google.com/webstore/detail/pdf-viewer/oemmndcbldboiebfnladdacbdfmadadm">PDF Viewer<i class="fa fa-external-link"></i></span> chrome æµè§ˆ pdf</li><li><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvc2NyZWVuY2FzdGlmeS1zY3JlZW4tdmlkZS9tbWVpamltZ2FiYnBiZ3Bka2xubGxwbmNtZG9ma2Nwbg==" title="https://chrome.google.com/webstore/detail/screencastify-screen-vide/mmeijimgabbpbgpdklnllpncmdofkcpn">Screencastify - Screen Video Recorder<i class="fa fa-external-link"></i></span> ç½‘é¡µå½•å±</li><li><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvdGFicy1vdXRsaW5lci9lZ2drYW5vY2dkZGhtYW1sYmlpam5waGhwcGtwa21rbA==" title="https://chrome.google.com/webstore/detail/tabs-outliner/eggkanocgddhmamlbiijnphhppkpkmkl">Tabs Outliner<i class="fa fa-external-link"></i></span> å°†æ ‡ç­¾é¡µæ ‘çŠ¶æ˜¾ç¤º</li><li><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvc3BlZWR0ZXN0LWJ5LW9va2xhL3Bnamppa2RpaWtpaGRmcG9wcGdhaWRjY2FoYWxlaGpo" title="https://chrome.google.com/webstore/detail/speedtest-by-ookla/pgjjikdiikihdfpoppgaidccahalehjh">Speedtest by Ookla<i class="fa fa-external-link"></i></span> æµ‹è¯•ç½‘ç»œé€Ÿåº¦å’Œæ‰“å¼€ç½‘é¡µçš„é€Ÿåº¦</li><li><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvc3VyZmluZ2tleXMvZ2ZibGlvaG5uYXBpZWZqcGpscGpuZWhnbGZwYWtubmM=" title="https://chrome.google.com/webstore/detail/surfingkeys/gfbliohnnapiefjpjlpjnehglfpaknnc">Surfingkeys<i class="fa fa-external-link"></i></span></li><li><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvdmltaXVtL2RiZXBnZ2VvZ2JhaWJoZ25oaG5kb2pwZXBpaWhjbWVi" title="https://chrome.google.com/webstore/detail/vimium/dbepggeogbaibhgnhhndojpepiihcmeb">Vimium<i class="fa fa-external-link"></i></span> åƒ vim ä¸€æ ·æ“æ§ç½‘é¡µï¼Œvim æ°¸ç”Ÿ~</li><li><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvdm9sdW1lLW1hc3Rlci9qZ2hlY2dhYmZnZmRsZG5tYmZraG1mZmNhYmRkaW9rZQ==" title="https://chrome.google.com/webstore/detail/volume-master/jghecgabfgfdldnmbfkhmffcabddioke">Volume Master<i class="fa fa-external-link"></i></span> éŸ³é‡è°ƒèŠ‚å™¨</li><li><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwv54K65LuA6bq85L2g5YCR5bCx5piv5LiN6IO95Yqg5YCL56m65qC85ZGi77yfL3BhcGhjZmRmZmpuYmNna29raWhjZGpsaWloaWNtYnBk" title="https://chrome.google.com/webstore/detail/ç‚ºä»€éº¼ä½ å€‘å°±æ˜¯ä¸èƒ½åŠ å€‹ç©ºæ ¼å‘¢ï¼Ÿ/paphcfdffjnbcgkokihcdjliihicmbpd">ä¸ºä»€ä¹ˆä½ ä»¬å°±æ˜¯ä¸èƒ½åŠ ä¸ªç©ºæ ¼å‘¢ï¼Ÿ<i class="fa fa-external-link"></i></span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2xpc3RlbjEvbGlzdGVuMV9jaHJvbWVfZXh0ZW5zaW9u" title="https://github.com/listen1/listen1_chrome_extension">Listen 1<i class="fa fa-external-link"></i></span> éŸ³ä¹èšåˆ</li><li><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvdmlkZW8tc3BlZWQtY29udHJvbGxlci9uZmZhb2FsYmlsYm1tZmdibmJncHBqaWhvcGFicHBkaw==" title="https://chrome.google.com/webstore/detail/video-speed-controller/nffaoalbilbmmfgbnbgppjihopabppdk">Video Speed Controller<i class="fa fa-external-link"></i></span> è§†é¢‘åŠ é€Ÿæ‰©å±•ï¼Œå¯ä»¥ç”¨æ¥åšåäº‹ï¼ˆã€‚ï¼¾ â–½ ï¼¾ï¼‰</li><li><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvaG92ZXItem9vbS9ub25qZGNqY2hnaGhrZG9vbG5sYmVrY2ZsbG1lZG5ibA==" title="https://chrome.google.com/webstore/detail/hover-zoom/nonjdcjchghhkdoolnlbekcfllmednbl">Hover Zoom<i class="fa fa-external-link"></i></span> é¼ æ ‡æ‚¬æµ®åˆ°å›¾ç‰‡ä¸Šæ˜¾ç¤ºå¤§å›¾</li><li><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvY29udGV4dC1tZW51cy9waGxmbWtmcG1waG9na29tZGRja21nZ2NmcG1mY2hwbg==" title="https://chrome.google.com/webstore/detail/context-menus/phlfmkfpmphogkomddckmggcfpmfchpn">å³é”®æœ<i class="fa fa-external-link"></i></span> æ‰©å±•å³é”®èœå•</li><li><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvdHVybi1vZmYtdGhlLWxpZ2h0cy1mb3IteS9iZmJtam1pb2Ribm5wbGxiYmJmYmxjcGxmamplcGpkbg==" title="https://chrome.google.com/webstore/detail/turn-off-the-lights-for-y/bfbmjmiodbnnpllbbbfblcplfjjepjdn">å…³ç¯çœ‹è§†é¢‘<i class="fa fa-external-link"></i></span></li></ul><h2 id="ç½‘ç«™åŠ å¼ºæ‰©å±•"><a href="#ç½‘ç«™åŠ å¼ºæ‰©å±•" class="headerlink" title="ç½‘ç«™åŠ å¼ºæ‰©å±•"></a>ç½‘ç«™åŠ å¼ºæ‰©å±•</h2><p>github ç›¸å…³çš„æ‰©å±•æ¯”è¾ƒå¤šã€‚</p><h3 id="Awesome-Autocomplete-for-GitHub"><a href="#Awesome-Autocomplete-for-GitHub" class="headerlink" title="Awesome Autocomplete for GitHub"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvYXdlc29tZS1hdXRvY29tcGxldGUtZm9yL2Rqa2ZkanBvZWxwaGhkY2xmamhuZmZtbmxub2tuZm5k" title="https://chrome.google.com/webstore/detail/awesome-autocomplete-for/djkfdjpoelphhdclfjhnffmnlnoknfnd">Awesome Autocomplete for GitHub<i class="fa fa-external-link"></i></span></h3><p>åŠ å¼º github çš„æœç´¢æ¡†ã€‚</p><p><img data-src="https://pic4.zhimg.com/v2-c1e729c498574f6c102d961ba081b487_b.png" alt="img"></p><h3 id="File-Icon-for-GitHub-GitLab-and-Bitbucket"><a href="#File-Icon-for-GitHub-GitLab-and-Bitbucket" class="headerlink" title="File Icon for GitHub, GitLab and Bitbucket"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvZmlsZS1pY29uLWZvci1naXRodWItZ2l0bC9maWNmbWlia2pqbnBvZ2RjZmhmb2ttaWhhbm9sZGJmZQ==" title="https://chrome.google.com/webstore/detail/file-icon-for-github-gitl/ficfmibkjjnpogdcfhfokmihanoldbfe">File Icon for GitHub, GitLab and Bitbucket<i class="fa fa-external-link"></i></span></h3><p>ç»™ github ä»“åº“æ–‡ä»¶æ·»åŠ å›¾æ ‡ã€‚</p><p><img data-src="https://pic1.zhimg.com/v2-d15023e0fc05f372a785bf441ade8d00_b.png" alt="img"></p><h3 id="Octohint"><a href="#Octohint" class="headerlink" title="Octohint"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvb2N0b2hpbnQvaGJrcGprZmRoZWFpbmpra2ViZW9vZmtwZ2Rkbm5icGs=" title="https://chrome.google.com/webstore/detail/octohint/hbkpjkfdheainjkkebeoofkpgddnnbpk">Octohint<i class="fa fa-external-link"></i></span></h3><p>github ä»£ç æ™ºèƒ½é«˜äº®ã€‚</p><p><img data-src="https://pic4.zhimg.com/v2-08f14d4f0a7e2b27f04168591f7f4aeb_b.png" alt="img"></p><h3 id="OctoLinker"><a href="#OctoLinker" class="headerlink" title="OctoLinker"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvb2N0b2xpbmtlci9qbG1hZmJhZW9vZmRlZ29oZGhpbmtoaWxoY2xha2xrcA==" title="https://chrome.google.com/webstore/detail/octolinker/jlmafbaeoofdegohdhinkhilhclaklkp">OctoLinker<i class="fa fa-external-link"></i></span></h3><p>ç›´æ¥ä»ä»£ç è·³è½¬åˆ° gtihub å¯¹åº”ä»“åº“ï¼Œç›¸å¯¹è·¯å¾„ä¹Ÿèƒ½è·³è½¬ï¼Œæ”¯æŒå¾ˆå¤šç¼–ç¨‹è¯­è¨€ã€‚</p><p><img data-src="https://pic3.zhimg.com/v2-37f14183665d9738f6ebbe13526780a6_b.png" alt="img"></p><h3 id="Isometric-Contributions"><a href="#Isometric-Contributions" class="headerlink" title="Isometric Contributions"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvaXNvbWV0cmljLWNvbnRyaWJ1dGlvbnMvbWpvZWRsZmZsY2Nobmxla25uY2VpcGxnYWVvZWdpZW4=" title="https://chrome.google.com/webstore/detail/isometric-contributions/mjoedlfflcchnleknnceiplgaeoegien">Isometric Contributions<i class="fa fa-external-link"></i></span></h3><p>ç«‹ä½“æ˜¾ç¤º github Contributions çš„æ‰©å±•ï¼Œç¬é—´æå‡é€¼æ ¼æœ‰æœ¨æœ‰ã€‚</p><p><img data-src="https://pic1.zhimg.com/v2-49a6fd7c9c3211cc0dc9a3d5d5fc4754_b.png" alt="img"></p><h3 id="Octotree"><a href="#Octotree" class="headerlink" title="Octotree"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvb2N0b3RyZWUvYmtoYWFnamFoZm1qbGphbG9wam5vZWFsbmZuZG5hZ2M=" title="https://chrome.google.com/webstore/detail/octotree/bkhaagjahfmjljalopjnoealnfndnagc">Octotree<i class="fa fa-external-link"></i></span></h3><p>åœ¨å·¦ä¾§æ·»åŠ ä¸€ä¸ªæ–‡ä»¶æµè§ˆå™¨ï¼Œå¯ä»¥æ›´å¿«çš„åœ¨æ–‡ä»¶ä¹‹é—´è·³è½¬ã€‚</p><p><img data-src="https://pic3.zhimg.com/v2-84aa828392d89c51e096ffb9468dbc12_b.png" alt="img"></p><h3 id="Sourcegraph"><a href="#Sourcegraph" class="headerlink" title="Sourcegraph"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvc291cmNlZ3JhcGgvZGdqaGZvbWppZWFhZHBvbGpsbmlkbWJna2RmZnBhY2s=" title="https://chrome.google.com/webstore/detail/sourcegraph/dgjhfomjieaadpoljlnidmbgkdffpack">Sourcegraph<i class="fa fa-external-link"></i></span></h3><p>è¿™ä¸ªæ‰©å±•å‰å®³äº†ï¼Œå°† github å˜å¾—å’Œ IDE ä¸€èˆ¬ï¼Œé›†æˆå„ç§åŠŸèƒ½ã€‚</p><p><img data-src="https://pic1.zhimg.com/v2-41d7ffc22968473a2c853cf4b6255298_b.png" alt="img"></p><p>å’Œ github ç›¸å…³çš„è¿˜æœ‰å‡ ä¸ªæˆ‘å°±ç®€è¦ä»‹ç»ä¸€ä¸‹äº†</p><ul><li><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvZ2F5aHViL21kY2ZmZWxnaGlrZGlhZm5mb2RqbGdsbGVuaGxuZWps" title="https://chrome.google.com/webstore/detail/gayhub/mdcffelghikdiafnfodjlgllenhlnejl">GayHub<i class="fa fa-external-link"></i></span></li><li><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvcmVmaW5lZC1naXRodWIvaGxlcGZvb2hlZ2toaG1qaWVvZWNoYWRkYWVqYW9raGY=" title="https://chrome.google.com/webstore/detail/refined-github/hlepfoohegkhhmjieoechaddaejaokhf">Refined GitHub<i class="fa fa-external-link"></i></span> è¿™ä¸ªå’Œä¸Šé¢çš„éƒ½æ˜¯å¯¹ github æ•´ä½“è¿›è¡ŒåŠ å¼ºçš„æ‰©å±•</li><li><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvZ2l0aHViLWhvdmVyY2FyZC9tbW9haGJibm9qZ2tjbGdjZWFoaGFraG5jY2ltbnBsaw==" title="https://chrome.google.com/webstore/detail/github-hovercard/mmoahbbnojgkclgceahhakhnccimnplk">GitHub Hovercard<i class="fa fa-external-link"></i></span> è¿™ä¸ªåŠ å¼ºäº† github æ‚¬æµ®åœ¨æŸäº›å…ƒç´ ä¸Šçš„åŠŸèƒ½</li></ul><h3 id="v2ex-plus"><a href="#v2ex-plus" class="headerlink" title="v2ex plus"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvdjJleC1wbHVzL2RhZWNsaWptbm9qb2Vtb29ibGNiZmVlY2VvcG5rb2xv" title="https://chrome.google.com/webstore/detail/v2ex-plus/daeclijmnojoemooblcbfeeceopnkolo">v2ex plus<i class="fa fa-external-link"></i></span></h3><p>å®˜æ–¹ä»‹ç»ï¼š</p><blockquote><p>ä¼˜é›…ä¾¿æ·çš„ V2EX æ‰©å±•</p></blockquote><ul><li>å¸–å­ä¼šè¯è¯¦ç»†.</li><li>å¸–å­åˆ—è¡¨ä¸»é¢˜é¢„è§ˆ.</li><li>åªçœ‹æ¥¼ä¸»åŠŸèƒ½.</li><li>æ¥¼ä¸»å›å¤èƒŒæ™¯è‰²é«˜äº®(é¢œè‰²å¯è‡ªå®šä¹‰).</li><li>æ„Ÿè°¢çˆ±å¿ƒé¢œè‰²è‡ªå®šä¹‰.</li><li>æ’å…¥è¡¨æƒ…ä¸å›¾ç‰‡(weibo æˆ– imgur).</li><li>å›å¤å†…å›¾ç‰‡æ—‹è½¬.</li><li>ä¸€é”®ç­¾åˆ°ä¸è‡ªåŠ¨ç­¾åˆ°.</li><li>æ–°æ¶ˆæ¯é€šçŸ¥æé†’å¹¶æ”¹å˜æ‰©å±•æŒ‰é’®é¢œè‰².</li></ul><p>One more thingâ€¦ ^-^</p><h3 id="YouTubeâ„¢-å¹¿å‘Šæ‹¦æˆªå™¨"><a href="#YouTubeâ„¢-å¹¿å‘Šæ‹¦æˆªå™¨" class="headerlink" title="YouTubeâ„¢ å¹¿å‘Šæ‹¦æˆªå™¨"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvdmlkZW8tYWRibG9ja2VyLWZvci15b3V0dS9oZmxlZmpoa2ZlaWFpZ25rY2xtcGhtb2ttbWJoYmhpaw==" title="https://chrome.google.com/webstore/detail/video-adblocker-for-youtu/hflefjhkfeiaignkclmphmokmmbhbhik">YouTubeâ„¢ å¹¿å‘Šæ‹¦æˆªå™¨<i class="fa fa-external-link"></i></span></h3><p>è¿™ä¸ªå¹¿å‘Šæ‹¦æˆªå™¨ä¼šåˆ é™¤ YouTube ä¸Šçš„æ‰€æœ‰å¹¿å‘Šã€‚å‰è´´ç‰‡è§†é¢‘å¹¿å‘Šï¼Œæ–‡å­—å’Œæ¨ªå¹…å¹¿å‘Šã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªå’Œ youtube ç›¸å…³çš„æ‰©å±• <span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvbWFnaWMtYWN0aW9ucy1mb3IteW91dHViZS9hYmpjZmFiYmhhZmJjZGZqb2VjZGdlcGxsbXBmY2VpZg==" title="https://chrome.google.com/webstore/detail/magic-actions-for-youtube/abjcfabbhafbcdfjoecdgepllmpfceif">Magic Actions for YouTubeâ„¢<i class="fa fa-external-link"></i></span></p><h3 id="çœ¼ä¸è§å¿ƒä¸çƒ¦ï¼ˆæ–°æµªå¾®åšï¼‰"><a href="#çœ¼ä¸è§å¿ƒä¸çƒ¦ï¼ˆæ–°æµªå¾®åšï¼‰" class="headerlink" title="çœ¼ä¸è§å¿ƒä¸çƒ¦ï¼ˆæ–°æµªå¾®åšï¼‰"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwv55y85LiN6KeB5b+D5LiN54Om77yI5paw5rWq5b6u5Y2a77yJL2FvZ25hYXBkZm5ubGRuamdsYW5mYmJrbGFha2JwZWpt" title="https://chrome.google.com/webstore/detail/çœ¼ä¸è§å¿ƒä¸çƒ¦ï¼ˆæ–°æµªå¾®åšï¼‰/aognaapdfnnldnjglanfbbklaakbpejm">çœ¼ä¸è§å¿ƒä¸çƒ¦ï¼ˆæ–°æµªå¾®åšï¼‰<i class="fa fa-external-link"></i></span></h3><p>æ–°æµªå¾®åšåŠ å¼ºæ‰©å±•ï¼Œä¸è¿‡è¯„è®ºæœ‰äº›è´Ÿé¢è¯„ä»·ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“æ˜¯ä¸æ˜¯çœŸçš„ï¼Œå¹³æ—¶ä¸æ€ä¹ˆç©å¾®åšã€‚</p><h3 id="æ–°æµªå¾®åšå›¾åºŠ"><a href="#æ–°æµªå¾®åšå›¾åºŠ" class="headerlink" title="æ–°æµªå¾®åšå›¾åºŠ"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwv5paw5rWq5b6u5Y2a5Zu+5bqKL2ZkZmRuZnBkcGxmYmJuZW1tbW9rbGJmamJoZWNwbmhm" title="https://chrome.google.com/webstore/detail/æ–°æµªå¾®åšå›¾åºŠ/fdfdnfpdplfbbnemmmoklbfjbhecpnhf">æ–°æµªå¾®åšå›¾åºŠ<i class="fa fa-external-link"></i></span></h3><p>ç®€å•å¥½ç”¨çš„æ–°æµªå¾®åšå›¾åºŠ,æ”¯æŒé€‰æ‹©/æ‹–æ‹½/ç²˜è´´ä¸Šä¼ å›¾ç‰‡,å¹¶ç”Ÿæˆå›¾ç‰‡åœ°å€,HTML,UBB å’Œ Markdown ç­‰æ ¼å¼,æ”¯æŒæµè§ˆå’Œåˆ é™¤å†å²è®°å½•</p><h3 id="å“”å“©å“”å“©åŠ©æ‰‹ï¼šbilibili-com-ç»¼åˆè¾…åŠ©æ‰©å±•"><a href="#å“”å“©å“”å“©åŠ©æ‰‹ï¼šbilibili-com-ç»¼åˆè¾…åŠ©æ‰©å±•" class="headerlink" title="å“”å“©å“”å“©åŠ©æ‰‹ï¼šbilibili.com ç»¼åˆè¾…åŠ©æ‰©å±•"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwv5ZOU5ZOp5ZOU5ZOp5Yqp5omL77yaYmlsaWJpbGljb20t57u85ZCI6L6F5Yqp5omp5bGVL2twYm5vbWJwbnBjZmZsbG5pYW5qaWJtcGFkam9sYW5o" title="https://chrome.google.com/webstore/detail/å“”å“©å“”å“©åŠ©æ‰‹ï¼šbilibilicom-ç»¼åˆè¾…åŠ©æ‰©å±•/kpbnombpnpcffllnianjibmpadjolanh">å“”å“©å“”å“©åŠ©æ‰‹ï¼šbilibili.com ç»¼åˆè¾…åŠ©æ‰©å±•<i class="fa fa-external-link"></i></span></h3><p>å“”å“©å“”å“©å¼¹å¹•ç½‘è¾…åŠ©æ‰©å±•ï¼Œæ‹¥æœ‰è§†é¢‘åŒºå’Œç›´æ’­åŒºçš„äººæ€§åŒ–åŠŸèƒ½ã€‚</p><p><img data-src="https://pic1.zhimg.com/v2-af198ce22b26ad2d00bc6e7a9c11adc0_b.png" alt="img"></p><h3 id="bilibili-å“”å“©å“”å“©ä¸‹è½½åŠ©æ‰‹"><a href="#bilibili-å“”å“©å“”å“©ä¸‹è½½åŠ©æ‰‹" class="headerlink" title="bilibili å“”å“©å“”å“©ä¸‹è½½åŠ©æ‰‹"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvYmlsaWJpbGnlk5Tlk6nlk5Tlk6nkuIvovb3liqnmiYsvYmZjYmZvYmhjamJraWxjYmVobG5sY2hpaW5va2lpanA=" title="https://chrome.google.com/webstore/detail/bilibiliå“”å“©å“”å“©ä¸‹è½½åŠ©æ‰‹/bfcbfobhcjbkilcbehlnlchiinokiijp">bilibili å“”å“©å“”å“©ä¸‹è½½åŠ©æ‰‹<i class="fa fa-external-link"></i></span></h3><p>bilibili å“”å“©å“”å“©ä¸‹è½½åŠ©æ‰‹å¸®ä½ ä¸‹è½½ç‰ˆæƒå—é™ï¼ˆèƒ½çœ‹ä¸èƒ½ç¼“å­˜ï¼‰çš„ç•ªå‰§å’Œè§†é¢‘ã€‚</p><h2 id="å‰ç«¯æ‰©å±•"><a href="#å‰ç«¯æ‰©å±•" class="headerlink" title="å‰ç«¯æ‰©å±•"></a>å‰ç«¯æ‰©å±•</h2><h3 id="ColorZilla"><a href="#ColorZilla" class="headerlink" title="ColorZilla"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvY29sb3J6aWxsYS9iaGxobmljcGJoaWduYmRoZWRnamhnZG9jbm1ob21ucA==" title="https://chrome.google.com/webstore/detail/colorzilla/bhlhnicpbhignbdhedgjhgdocnmhomnp">ColorZilla<i class="fa fa-external-link"></i></span></h3><p>å–è‰²å™¨ã€‚</p><p><img data-src="https://pic2.zhimg.com/v2-6577f43f8cde605e2e3268514981b885_b.png" alt="img"></p><h3 id="Page-load-time"><a href="#Page-load-time" class="headerlink" title="Page load time"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvcGFnZS1sb2FkLXRpbWUvZnBsb2lvbm1qZ2VjbGJrZW1pcG1rb2dvYW9oY2RiaWc=" title="https://chrome.google.com/webstore/detail/page-load-time/fploionmjgeclbkemipmkogoaohcdbig">Page load time<i class="fa fa-external-link"></i></span></h3><p>ä½¿ç”¨äº† web timing API æ¥ç²¾ç¡®æµ‹é‡é¡µé¢åŠ è½½å„ä¸ªé˜¶æ®µçš„è€—æ—¶ï¼Œéå¸¸çš„ç®€æ´æ¸…æ™°ã€‚</p><p><img data-src="https://pic2.zhimg.com/v2-414189ca196d24e7d8c360677a7e3b1d_b.png" alt="img"></p><h3 id="CSSViewer"><a href="#CSSViewer" class="headerlink" title="CSSViewer"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvY3Nzdmlld2VyL2dnZmdpamJwaWhlZWdlZmxpY2llbW9mb2JobW9mZ2Nl" title="https://chrome.google.com/webstore/detail/cssviewer/ggfgijbpiheegefliciemofobhmofgce">CSSViewer<i class="fa fa-external-link"></i></span></h3><p>css æŸ¥çœ‹å™¨ã€‚</p><p><img data-src="https://pic2.zhimg.com/v2-e0668a798cc18644c87257c3d4c4cc3d_b.png" alt="img"></p><h3 id="EditThisCookie"><a href="#EditThisCookie" class="headerlink" title="EditThisCookie"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvZWRpdHRoaXNjb29raWUvZm5nbWhubnBpbGhwbGFlZWRpZmhjY2Nlb21jbGdmYmc=" title="https://chrome.google.com/webstore/detail/editthiscookie/fngmhnnpilhplaeedifhccceomclgfbg">EditThisCookie<i class="fa fa-external-link"></i></span></h3><p>EditThisCookie æ˜¯ä¸€ä¸ª cookie ç®¡ç†å™¨ã€‚æ‚¨å¯ä»¥æ·»åŠ ï¼Œåˆ é™¤ï¼Œç¼–è¾‘ï¼Œæœç´¢ï¼Œé”å®šå’Œå±è”½ cookiesï¼</p><p>ä¸‹é¢æ˜¯çŸ¥ä¹ç™»å…¥åçš„ cookie ç¼–è¾‘é¡µé¢ã€‚</p><p><img data-src="https://pic4.zhimg.com/v2-ea286fdf8a920ab6f3709660606a9ff7_b.png" alt="img"></p><h3 id="JSON-Viewer-Awesome"><a href="#JSON-Viewer-Awesome" class="headerlink" title="JSON Viewer Awesome"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvanNvbi12aWV3ZXItYXdlc29tZS9pZW1hZGlhaGhiZWJka2xlcGFubWtqZW5mZGViZnBmZQ==" title="https://chrome.google.com/webstore/detail/json-viewer-awesome/iemadiahhbebdklepanmkjenfdebfpfe">JSON Viewer Awesome<i class="fa fa-external-link"></i></span></h3><p>ç¾åŒ– json å†…å®¹ã€‚</p><p><img data-src="https://pic3.zhimg.com/v2-43b9d7f1cc331f365ef969f75d36c4f6_b.png" alt="img"></p><h3 id="JSON-handle"><a href="#JSON-handle" class="headerlink" title="JSON-handle"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvanNvbi1oYW5kbGUvaWFobmhmZGhpZG9tY3BnZ3BhaW1tbWFoZmZpaGtmbmo=" title="https://chrome.google.com/webstore/detail/json-handle/iahnhfdhidomcpggpaimmmahffihkfnj">JSON-handle<i class="fa fa-external-link"></i></span></h3><p>å¯¹ JSON æ ¼å¼çš„å†…å®¹è¿›è¡Œæµè§ˆå’Œç¼–è¾‘ï¼Œä»¥æ ‘å½¢å›¾æ ·å¼å±•ç° JSON æ–‡æ¡£ï¼Œå¹¶å¯å®æ—¶ç¼–è¾‘ã€‚</p><p><img data-src="https://pic1.zhimg.com/v2-a123dbaa4c088461dc5473f5372ae5b8_b.png" alt="img"></p><h3 id="Lighthouse"><a href="#Lighthouse" class="headerlink" title="Lighthouse"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvbGlnaHRob3VzZS9ibGlwbWRjb25sa3BpbmVmZWhubWphbW1manBtcGJqaw==" title="https://chrome.google.com/webstore/detail/lighthouse/blipmdconlkpinefehnmjammfjpmpbjk">Lighthouse<i class="fa fa-external-link"></i></span></h3><p>è°·æ­Œå®˜æ–¹å‡ºå“çš„ä¸€ä¸ªç½‘ç«™æ€§èƒ½æµ‹è¯•ï¼Œåˆ†ææ‰©å±•ã€‚</p><p>ä¸‹é¢æ˜¯è¿™ä¸ªæ‰©å±•ç”Ÿæˆçš„çŸ¥ä¹é¦–é¡µçš„ä¸€ä»½æµ‹è¯•æŠ¥å‘Šï¼Œå¯ä»¥çœ‹å‡ºçŸ¥ä¹æ ¹æœ¬æ²¡åš PWAã€‚</p><p><img data-src="https://pic3.zhimg.com/v2-1f13720b8d571ac49e701f62920d84e6_b.png" alt="img"></p><h3 id="Page-Ruler"><a href="#Page-Ruler" class="headerlink" title="Page Ruler"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvcGFnZS1ydWxlci9lbWxpYW1pb29iZmZmYmdjZmRjaGFiZmlib25laGttZQ==" title="https://chrome.google.com/webstore/detail/page-ruler/emliamioobfffbgcfdchabfibonehkme">Page Ruler<i class="fa fa-external-link"></i></span></h3><p>ä¸€æ¬¾å°ºå¯¸æµ‹é‡å·¥å…·ã€‚</p><p><img data-src="https://pic1.zhimg.com/v2-45ad6aa180403d73bed358712484a0ac_b.png" alt="img"></p><h3 id="ReRes"><a href="#ReRes" class="headerlink" title="ReRes"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvcmVyZXMvZ2llb2Nwa2JibGlkbm9jZWZqYWtsZGVjYWhnZWVpY2E=" title="https://chrome.google.com/webstore/detail/reres/gieocpkbblidnocefjakldecahgeeica">ReRes<i class="fa fa-external-link"></i></span></h3><p>å¯ä»¥æŒ‡å®šç‰¹å®šçš„ url é‡å®šå‘åˆ°ä½ æƒ³å®šå‘çš„ urlã€‚å®˜æ–¹ä»‹ç»ï¼š</p><blockquote><p>Change the response of the request. ReRes å¯ä»¥ç”¨æ¥æ›´æ”¹é¡µé¢è¯·æ±‚å“åº”çš„å†…å®¹ã€‚é€šè¿‡æŒ‡å®šè§„åˆ™ï¼Œæ‚¨å¯ä»¥æŠŠè¯·æ±‚æ˜ å°„åˆ°å…¶ä»–çš„ urlï¼Œä¹Ÿå¯ä»¥æ˜ å°„åˆ°æœ¬æœºçš„æ–‡ä»¶æˆ–è€…ç›®å½•ã€‚ReRes æ”¯æŒå•ä¸ª url æ˜ å°„ï¼Œä¹Ÿæ”¯æŒç›®å½•æ˜ å°„ã€‚</p></blockquote><p><img data-src="https://pic4.zhimg.com/v2-9b1c50e91f7eaf0be671d5524ab318f3_b.jpg" alt="img"></p><p>å¦ä¸€æ¬¾ç”±é˜¿é‡Œçš„ä¸€ä½å¤§ä½¬å¼€å‘çš„å¯ä»¥å®ç°è·¨åŸŸä»¥åŠå’Œè¿™ä¸ªæ’ä»¶ç›¸åŒåŠŸèƒ½çš„æ’ä»¶æ˜¯ï¼š<span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwveHN3aXRjaC9pZGtqaGpnZ3BmZm9scGlkZmtpa2lkY29rZGtkYW9nZw==" title="https://chrome.google.com/webstore/detail/xswitch/idkjhjggpffolpidfkikidcokdkdaogg">XSwitch<i class="fa fa-external-link"></i></span>ã€‚</p><h3 id="User-Agent-Switcher-and-Manager"><a href="#User-Agent-Switcher-and-Manager" class="headerlink" title="User-Agent Switcher and Manager"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvdXNlci1hZ2VudC1zd2l0Y2hlci1hbmQtbS9iaGNoZGNlamhvaGZtaWdqYWZiYW1wb2dtYWFuYmZrZw==" title="https://chrome.google.com/webstore/detail/user-agent-switcher-and-m/bhchdcejhohfmigjafbampogmaanbfkg">User-Agent Switcher and Manager<i class="fa fa-external-link"></i></span></h3><p>è¿™ä¸ªæ‰©å±•èƒ½è®©ä½ è‡ªå®šä¹‰ç½‘ç«™çš„ user-agentï¼Œåˆ‡æ¢ä¸åŒçš„ user-agentï¼ŒæŸ¥çœ‹ç½‘é¡µåœ¨ä¸åŒçš„ user-agent ä¸‹çš„æ•ˆæœã€‚</p><p><img data-src="https://pic2.zhimg.com/v2-2051037c0a827f6e4e6b74fd89f34a89_b.jpg" alt="img"></p><h3 id="WEB-å‰ç«¯åŠ©æ‰‹-FeHelper"><a href="#WEB-å‰ç«¯åŠ©æ‰‹-FeHelper" class="headerlink" title="WEB å‰ç«¯åŠ©æ‰‹(FeHelper)"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvd2Vi5YmN56uv5Yqp5omLZmVoZWxwZXIvcGtnY2NwZWpubWFsbWRpbm1oa2tmYWZlZmFnaWlpYWQ=" title="https://chrome.google.com/webstore/detail/webå‰ç«¯åŠ©æ‰‹fehelper/pkgccpejnmalmdinmhkkfafefagiiiad">WEB å‰ç«¯åŠ©æ‰‹(FeHelper)<i class="fa fa-external-link"></i></span></h3><p>è¿™ä¸ªå°±ä¸ç”¨ä»‹ç»äº†å§ï¼Œå¾ˆå¤šå¼€å‘è€…éƒ½åœ¨ç”¨ï¼Œå›½å†…å¼€å‘è€…å¼€å‘çš„ä¸€å¥—å‰ç«¯å·¥å…·é›†ã€‚</p><p><img data-src="https://pic4.zhimg.com/v2-df57f3e813aa9a3a8a6e0edbb7a6a053_b.jpg" alt="img"></p><h3 id="Restlet-Client-REST-API-Testing"><a href="#Restlet-Client-REST-API-Testing" class="headerlink" title="Restlet Client - REST API Testing"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvcmVzdGxldC1jbGllbnQtcmVzdC1hcGktdC9hZWpvZWxhb2dnZW1iY2FoYWdpbWRpbGlhbWxjZG1mbQ==" title="https://chrome.google.com/webstore/detail/restlet-client-rest-api-t/aejoelaoggembcahagimdiliamlcdmfm">Restlet Client - REST API Testing<i class="fa fa-external-link"></i></span></h3><p>ä¸€æ¬¾ restful api æµ‹è¯•å·¥å…·ï¼Œä¸è¿‡æˆ‘ä¸€èˆ¬éƒ½ç›´æ¥ç”¨ postmanã€‚</p><p><img data-src="https://pic2.zhimg.com/v2-c1cdeedb70a3f6d7155be34746f9e161_b.png" alt="img"></p><h3 id="VisBug"><a href="#VisBug" class="headerlink" title="VisBug"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvdmlzYnVnL2Nkb2NrZW5hZG5hZGxkamJiZ2NhbGxpY2dsZWRiZW9j" title="https://chrome.google.com/webstore/detail/visbug/cdockenadnadldjbbgcallicgledbeoc">VisBug<i class="fa fa-external-link"></i></span></h3><p>è°·æ­Œå…¬å¸å¼€æºçš„ä¸€æ¬¾å‰ç«¯è®¾è®¡ï¼Œè°ƒè¯•å·¥å…·ã€‚</p><p><img data-src="https://pic1.zhimg.com/v2-7ffa0b69b5f8d10650e723b51d516e78_b.png" alt="img"></p><h3 id="Moesif-Orign-amp-CORS-Changer"><a href="#Moesif-Orign-amp-CORS-Changer" class="headerlink" title="Moesif Orign &amp; CORS Changer"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvbW9lc2lmLW9yaWduLWNvcnMtY2hhbmdlci9kaWdmYmZhcGhvampuZGtwY2NsamliZWpqYnBwaWZiYw==" title="https://chrome.google.com/webstore/detail/moesif-orign-cors-changer/digfbfaphojjndkpccljibejjbppifbc">Moesif Orign &amp; CORS Changer<i class="fa fa-external-link"></i></span></h3><p>è§£é™¤æµè§ˆå™¨è·¨åŸŸé™åˆ¶ã€‚</p><p><img data-src="https://pic4.zhimg.com/v2-7aa1b9f843d96b0e98d4f4e0b7f969c3_b.jpg" alt="img"></p><p>è¿˜æœ‰ä¸€äº›æˆ‘å°±ç®€è¦ä»‹ç»ä¸€ä¸‹äº†ï¼š</p><ul><li><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvbGl2ZXJlbG9hZC9qbmloYWpiaHBucHBjZ2diY2dlZGFnbmtpZ2htZGxlaQ==" title="https://chrome.google.com/webstore/detail/livereload/jnihajbhpnppcggbcgedagnkighmdlei">LiveReload<i class="fa fa-external-link"></i></span> liveReload å®˜æ–¹æ‰©å±•</li><li><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvcmVhY3QtZGV2ZWxvcGVyLXRvb2xzL2Zta2FkbWFwZ29mYWRvcGxqYmpma2FwZGtvaWVuaWhp" title="https://chrome.google.com/webstore/detail/react-developer-tools/fmkadmapgofadopljbjfkapdkoienihi">React Developer Tools<i class="fa fa-external-link"></i></span> facebook å®˜æ–¹å¼€å‘ react å¼€å‘æ‰©å±•ã€‚</li><li><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvcmVkdXgtZGV2dG9vbHMvbG1oa3BtYmVrY3Bta25rbGlvZWliZmtwbW1maWJsamQ=" title="https://chrome.google.com/webstore/detail/redux-devtools/lmhkpmbekcpmknklioeibfkpmmfibljd">Redux DevTools<i class="fa fa-external-link"></i></span> redux å¼€å‘æ‰©å±•</li><li><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvbHVjaWQvcG5hb2VsZGxla2JmcG5hbGhhYmdna2NkZGxlZWxhbWM=" title="https://chrome.google.com/webstore/detail/lucid/pnaoeldlekbfpnalhabggkcddleelamc">lucid<i class="fa fa-external-link"></i></span> A React-GraphQL developer tool</li><li><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvdnVlanMtZGV2dG9vbHMvbmhkb2dqbWVqaWdsaXBjY3Bubm5hbmhibGVkYWpicGQ=" title="https://chrome.google.com/webstore/detail/vuejs-devtools/nhdogjmejiglipccpnnnanhbledajbpd">Vue.js devtools<i class="fa fa-external-link"></i></span> vue å®˜æ–¹å¼€å‘ vue å¼€å‘æ‰©å±•</li><li><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvcHVwcGV0ZWVyLXJlY29yZGVyL2RqZWVnaWdnZWdsZWFka2tiZ29wb29uaGppbWdlaGRh" title="https://chrome.google.com/webstore/detail/puppeteer-recorder/djeegiggegleadkkbgopoonhjimgehda">Puppeteer Recorder<i class="fa fa-external-link"></i></span> å½•åˆ¶ puppeteer è„šæœ¬</li><li><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvc2VvcXVha2UvYWtkZ25tY29nbGVlbmhiY2xnaGdobGtrZG5ka2pkamM=" title="https://chrome.google.com/webstore/detail/seoquake/akdgnmcogleenhbclghghlkkdndkjdjc">SEOquake<i class="fa fa-external-link"></i></span> æŸ¥çœ‹ä¸€ä¸ªç½‘ç«™åœ¨å„å¤§æœç´¢å¼•æ“çš„ SEO æƒ…å†µ</li></ul><h2 id="chrome-apps"><a href="#chrome-apps" class="headerlink" title="chrome apps"></a>chrome apps</h2><h3 id="Gliffy-Diagrams"><a href="#Gliffy-Diagrams" class="headerlink" title="Gliffy Diagrams"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvZ2xpZmZ5LWRpYWdyYW1zL2JobWljaWxjbHBsZWZuZmxhcGptbm5nbWtra2twZmFk" title="https://chrome.google.com/webstore/detail/gliffy-diagrams/bhmicilclplefnflapjmnngmkkkkpfad">Gliffy Diagrams<i class="fa fa-external-link"></i></span></h3><p>æœ‰äº†å®ƒï¼Œå°±å¯ä»¥æ›¿ä»£ process on, draw.io ä¹‹ç±»çš„åœ¨çº¿ç”»å›¾å·¥å…·äº†ã€‚</p><p><img data-src="https://pic3.zhimg.com/v2-672f3504cf12e2076130451ff31b290e_b.png" alt="img"></p><h3 id="Secure-Shell-App"><a href="#Secure-Shell-App" class="headerlink" title="Secure Shell App"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvc2VjdXJlLXNoZWxsLWFwcC9wbmhlY2hhcGZhaW5kamhvbXBibmZsY2xkYWJiZ2hqbw==" title="https://chrome.google.com/webstore/detail/secure-shell-app/pnhechapfaindjhompbnflcldabbghjo">Secure Shell App<i class="fa fa-external-link"></i></span></h3><p>ä¸€ä¸ªç»ˆç«¯æ¨¡æ‹Ÿå™¨ï¼Œssh å®¢æˆ·ç«¯ï¼Œæœ‰å…´è¶£å¯ä»¥ä½“éªŒä¸€ä¸‹ï¼Œæˆ‘è‡ªå·±æ˜¯æ²¡æ€ä¹ˆç”¨è¿‡ã€‚</p><p><img data-src="https://pic4.zhimg.com/v2-25d3cfebbd4b62c917cc82ba2aefc26f_b.png" alt="img"></p><h3 id="Text"><a href="#Text" class="headerlink" title="Text"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvdGV4dC9tbWZiY2xqZmdsYm9rcG1raW1iZmdoZGtqbWpoZGdiZw==" title="https://chrome.google.com/webstore/detail/text/mmfbcljfglbokpmkimbfghdkjmjhdgbg">Text<i class="fa fa-external-link"></i></span></h3><p>ä¸€æ¬¾æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œæ”¯æŒè¯­æ³•é«˜äº®ï¼Œè¿˜å¯ä»¥ä¿å­˜å†…å®¹åˆ° Google Drive ä¸Šã€‚</p><p><img data-src="https://pic3.zhimg.com/v2-eb2589a282ad738f4e7c707d8aaccd6a_b.png" alt="img"></p><h3 id="Codelf-Best-GitHub-Stars-organizer"><a href="#Codelf-Best-GitHub-Stars-organizer" class="headerlink" title="Codelf-Best GitHub Stars organizer"></a><span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvY29kZWxmLWJlc3QtZ2l0aHViLXN0YXJzL2pubWphZ2xobW1jcGxla3BmbmJsbmlpYW1tbWRwYWFu" title="https://chrome.google.com/webstore/detail/codelf-best-github-stars/jnmjaglhmmcplekpfnblniiammmdpaan">Codelf-Best GitHub Stars organizer<i class="fa fa-external-link"></i></span></h3><p>ç¨‹åºå‘˜å‘½åå·¥å…·ï¼Œåƒæˆ‘è¿™ç§è‹±è¯­æ¸£æ—¶ä¸æ—¶å°±ä¼šç¢°åˆ°ç»™å˜é‡åå–åå­—å¤´ç–¼çš„æ—¶å€™ï¼Œè¿™ä¸ªæ—¶å€™ä¸å¦¨æ‰“å¼€è¿™ä¸ª app è§£å†³ä½ çš„å‘½åçƒ¦æ¼ã€‚</p><p><img data-src="https://pic1.zhimg.com/v2-8ebd5803a3ef05d8b5e66aeabcde5d8c_b.png" alt="img"></p><h2 id="chrome-æ‰©å±•ï¼Œæ’ä»¶ï¼ŒApp-çš„åŒºåˆ«"><a href="#chrome-æ‰©å±•ï¼Œæ’ä»¶ï¼ŒApp-çš„åŒºåˆ«" class="headerlink" title="chrome æ‰©å±•ï¼Œæ’ä»¶ï¼ŒApp çš„åŒºåˆ«"></a><strong>chrome æ‰©å±•ï¼Œæ’ä»¶ï¼ŒApp çš„åŒºåˆ«</strong></h2><p>è¿™éƒ¨åˆ†å†…å®¹æˆ‘åˆ»æ„æ”¾åˆ°åé¢ï¼Œæ€•ä¸€äº›éä¸“ä¸šç”¨æˆ·çœ‹ä¸æ‡‚ã€‚æˆ‘è§‰å¾—æˆ‘è¿˜æ˜¯æœ‰å¿…è¦æä¸€ä¸‹çš„ï¼Œå®ƒä»¬å‡ ä¸ªå…¶å®æ˜¯æœ‰å¾ˆå¤§åŒºåˆ«çš„ã€‚</p><p>æ‰©å±•å« <strong>extensionï¼Œ</strong>ä½ å¯ä»¥é€šè¿‡è®¿é—®åœ°å€ï¼šchrome://extensions/ æŸ¥çœ‹æ‰€æœ‰æ‰©å±•ï¼Œæ‰€æœ‰å¯ç”¨çš„ chrome æ‰©å±•éƒ½ä¼šæ˜¾ç¤ºåœ¨å³ä¸Šè§’å·¥å…·æ ä¸Šã€‚æˆ‘ä»¬åœ¨ <span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZQ==" title="https://chrome.google.com/webstore">chrome åº”ç”¨å•†åº—<i class="fa fa-external-link"></i></span> ä¸‹è½½å®‰è£…çš„ä¸€èˆ¬å°±æ˜¯ chrome æ‰©å±•ï¼Œå½“ç„¶äº†ï¼Œchrome åº”ç”¨å•†åº—é™¤äº†æ‰©å±•è¿˜å¯ä»¥å®‰è£…ä¸»é¢˜å’Œ appã€‚æŠ€æœ¯ä¸Šæ¥è¯´æŒ‡çš„æ˜¯é€šè¿‡è°ƒç”¨ Chrome æä¾›çš„ Chrome API æ¥æ‰©å±•æµè§ˆå™¨åŠŸèƒ½çš„ä¸€ç§ç»„ä»¶ï¼Œå·¥ä½œåœ¨æµè§ˆå™¨å±‚é¢ï¼Œä½¿ç”¨ HTML + CSS + JavaScript è¯­è¨€å¼€å‘ã€‚ä¾‹å¦‚æ²¹çŒ´ tampermonkeyï¼ŒAD Block ç­‰ã€‚</p><p>æ’ä»¶å« <strong>pluginï¼Œ</strong>æ˜¯æ›´åº•å±‚çš„ chrome ç»„ä»¶ï¼Œå¯ä»¥é€šè¿‡è®¿é—®åœ°å€ï¼šchrome://plugins/ æŸ¥çœ‹æ‰€æœ‰æ’ä»¶ã€‚ä»æŠ€æœ¯è§’åº¦æ¥è¯´ï¼ŒæŒ‡çš„æ˜¯é€šè¿‡è°ƒç”¨ Webkit å†…æ ¸ NPAPI æ¥æ‰©å±•å†…æ ¸åŠŸèƒ½çš„ä¸€ç§ç»„ä»¶ï¼Œå·¥ä½œåœ¨å†…æ ¸å±‚é¢ï¼Œç†è®ºä¸Šå¯ä»¥ç”¨ä»»ä½•ä¸€ç§ç”Ÿæˆæœ¬åœ°äºŒè¿›åˆ¶ç¨‹åºçš„è¯­è¨€å¼€å‘ï¼Œæ¯”å¦‚ C/C++ã€Delphi ç­‰ã€‚æ¯”å¦‚ Flash player æ’ä»¶ï¼Œå°±å±äºè¿™ç§ç±»å‹ã€‚ä¸€èˆ¬åœ¨ç½‘é¡µä¸­ç”¨ <object>æˆ–è€…<embed>æ ‡ç­¾å£°æ˜çš„éƒ¨åˆ†ï¼Œå°±è¦é æ’ä»¶æ¥æ¸²æŸ“ã€‚</object></p><p>å‚è€ƒçŸ¥ä¹é—®é¢˜ï¼š<span class="exturl" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzIwNjI4NzY4" title="https://www.zhihu.com/question/20628768">Chrome çš„æ’ä»¶ï¼ˆPluginï¼‰ä¸æ‰©å±•ï¼ˆExtensionï¼‰æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ<i class="fa fa-external-link"></i></span></p><p>è€Œ chrome APP åˆ™æ˜¯æŒ‡é‚£äº›å¯ä»¥ç‹¬ç«‹äº chrome çª—å£çš„åº”ç”¨ï¼Œæœ‰ç‚¹åƒ PWA å’Œ electronã€‚ä½ å¯ä»¥ç†è§£ä¸ºå°±æ˜¯æ™®é€šçš„æ¡Œé¢è½¯ä»¶ï¼Œåªä¸è¿‡æ˜¯ç”¨ç½‘é¡µæŠ€æœ¯å¼€å‘çš„ã€‚ä¾‹å¦‚ <span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvc2VjdXJlLXNoZWxsLWFwcC9wbmhlY2hhcGZhaW5kamhvbXBibmZsY2xkYWJiZ2hqbw==" title="https://chrome.google.com/webstore/detail/secure-shell-app/pnhechapfaindjhompbnflcldabbghjo">Secure Shell App<i class="fa fa-external-link"></i></span>ã€‚</p><h2 id="æ¨å¹¿ä¸‹è‡ªå·±çš„-chrome-æ‰©å±•å¼€å‘æ¨¡æ¿"><a href="#æ¨å¹¿ä¸‹è‡ªå·±çš„-chrome-æ‰©å±•å¼€å‘æ¨¡æ¿" class="headerlink" title="æ¨å¹¿ä¸‹è‡ªå·±çš„ chrome æ‰©å±•å¼€å‘æ¨¡æ¿"></a><strong>æ¨å¹¿ä¸‹è‡ªå·±çš„ chrome æ‰©å±•å¼€å‘æ¨¡æ¿</strong></h2><p>æˆ‘å‰ä¸ä¹…å†™äº†ä¸€ä¸ª chrome æ‰©å±•ï¼Œå¼€å‘å®Œåå°†å®ƒçš„æ„å»ºé…ç½®æå–å°è£…æˆä¸€ä¸ªæ¨¡æ¿é¡¹ç›®ï¼š<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RqeDY2Ni9hd2Vzb21lLWNocm9tZS1leHRlbnNpb24tYm9pbGVycGxhdGU=" title="https://github.com/tjx666/awesome-chrome-extension-boilerplate">awesome-chrome-extension-boilerplate<i class="fa fa-external-link"></i></span>ã€‚æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼š</p><ul><li>æ”¯æŒä¿®æ”¹ content scripts ä»£ç è‡ªåŠ¨é‡è½½æ‰©å±•å’Œåˆ·æ–°æ³¨å…¥äº† content scripts çš„é¡µé¢ï¼ˆé€šè¿‡è‡ªå®šä¹‰ devServer å’Œ SSEï¼‰</li><li>é€‰é¡¹å’Œå¼¹çª—é¡µé¢æ”¯æŒ react &amp; react hooks &amp; react hot reload &amp; react devtoolsï¼Œå……åˆ†äº«å—ç°ä»£å‰ç«¯å·¥ç¨‹åŒ–çš„ä¾¿æ·ï¼Œè®©ä½ ä»å¼€å‘ SPA æ— ç¼åˆ‡æ¢åˆ° chrome æ‰©å±•å¼€å‘ã€‚</li><li>æ•´ä¸ªæ¨¡æ¿åŒ…æ‹¬ webpack é…ç½®å’Œ devServer éƒ½æ˜¯ç”¨ TypeScript ç¼–å†™çš„ï¼Œä½¿ç”¨ ts é…ç½® webpack å‡å°‘ä½ æŸ¥é˜…æ–‡æ¡£æ¬¡æ•°å’Œæ‰‹æ®‹çš„æ¦‚ç‡ã€‚</li><li>æ”¯æŒ sass/less CSS æ‰©å±•è¯­è¨€ï¼Œä½¿ç”¨ mini-css-extract-plugin æ’ä»¶å°† CSS åˆ†ç¦»æˆ content CSS Script</li><li>é›†æˆäº†ç¤¾åŒºå¾ˆå¤šçš„ä¼˜ç§€ webpack æ’ä»¶ä¼˜åŒ– webpack æ„å»ºå’Œ bundle åˆ†æ</li><li>ä½¿ç”¨ eslint å’Œç›¸å…³æ’ä»¶ lint TypeScriptã€‚ä½¿ç”¨ babel ç¼–è¯‘ TypeScriptï¼Œfork-ts-checker-webpack-plugin æ£€æŸ¥ TypeScript ç±»å‹ï¼Œåœ¨äº«å— babel ç”Ÿæ€ä¸­å„ç§å®ç”¨çš„æ’ä»¶çš„åŒæ—¶è¿˜ä¸ä¸¢å¤±ç±»å‹æ£€æŸ¥çš„èƒ½åŠ›ã€‚</li></ul><p>å¯¹ç¬¬ä¸€æ¡ç‰¹æ€§æ„Ÿå…´è¶£çš„çš„è¯»è€…å¯ä»¥å†é˜…è¯»æˆ‘å¦å¤–ä¸€ç¯‡æ–‡ç« ï¼š<span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8xMDMwNzIyNTE=" title="https://zhuanlan.zhihu.com/p/103072251">ä½¿ç”¨ webpack æ„å»º chrome æ‰©å±•çš„çƒ­æ›´æ–°é—®é¢˜<i class="fa fa-external-link"></i></span>ã€‚</p><h2 id="chrome-åº”ç”¨å•†åº—çš„æ–°æ”¿ç­–"><a href="#chrome-åº”ç”¨å•†åº—çš„æ–°æ”¿ç­–" class="headerlink" title="chrome åº”ç”¨å•†åº—çš„æ–°æ”¿ç­–"></a><strong>chrome åº”ç”¨å•†åº—çš„æ–°æ”¿ç­–</strong></h2><p>æœ€è¿‘æˆ‘åœ¨é€› V2EX çš„æ—¶å€™çœ‹åˆ°æœ‰äººæåˆ° FEHelper è¢«ä¸‹æ¶çš„äº‹æƒ…ã€‚æˆ‘åˆ°<span class="exturl" data-url="aHR0cHM6Ly93d3cuYmFpZHVmZS5jb20vaXRlbS85NTY1YzQ1NDUwZDJmZWU4ZTNlZS5odG1s" title="https://www.baidufe.com/item/9565c45450d2fee8e3ee.html">ä½œè€…çš„åšå®¢<i class="fa fa-external-link"></i></span>çœ‹äº†ä¸€ä¸‹ï¼Œäº†è§£åˆ°æ˜¯å› ä¸ºè¿åäº† chrome åº”ç”¨å•†åº—çš„æ–°æ”¿ç­–ã€‚æ–°æ”¿ç­–è§„å®šå‘å¸ƒçš„æ‰€æœ‰æ‰©å±•å¿…é¡»éµå®ˆå•ä¸€ç”¨é€”åŸåˆ™ï¼Œå¦åˆ™å¼ºåˆ¶ä¸‹æ¶ã€‚è”æƒ³åˆ°æœ€è¿‘æˆ‘å‘å¸ƒ chrome æ‰©å±•çš„æ—¶å€™ï¼Œçœ‹åˆ° chrome æ§åˆ¶å°å°†è¦æ”¹ç‰ˆï¼Œæˆ‘è§‰å¾—å¯èƒ½ google è¿™ä¸¤å¹´æœ‰æ„è¦æ•´æ”¹ chrome æ‰©å±•ç”Ÿæ€äº†ã€‚</p><p>å¦ä¸€ä¸ªè¦è¯´çš„äº‹æƒ…æ˜¯åœ¨çŸ¥ä¹ä¸Šæˆ‘çœ‹åˆ°æœ‰äººè¯„è®º _chrome åº”ç”¨å•†åº—ä»Šå¹´å°±å…³äº†_ã€‚æˆ‘ç‰¹æ„å»æŸ¥äº†ä¸€ä¸‹ç›¸å…³èµ„è®¯ï¼Œå…¶å®æ˜¯ä»–ç†è§£é”™äº†ï¼Œä¸æ˜¯ chrome åº”ç”¨å•†åº—è¦å…³é—­äº†ï¼Œåªæ˜¯å°†åœæ­¢å¯¹ chrome App çš„æ”¯æŒã€‚å¯ä»¥çœ‹ä¸€ä¸‹é›·é”‹ç½‘çš„è¿™ç¯‡æ–‡ç« ï¼š<span class="exturl" data-url="aHR0cHM6Ly9iYWlqaWFoYW8uYmFpZHUuY29tL3M/aWQ9MTY1NTkzMTM1ODkwNDk3MDIzOSZ3ZnI9c3BpZGVyJmZvcj1wYw==" title="https://baijiahao.baidu.com/s?id=1655931358904970239&wfr=spider&for=pc">è°·æ­Œå®£å¸ƒä¸¤å¹´å†…å…³é—­ Chrome Apps<i class="fa fa-external-link"></i></span>ã€‚æˆ‘è´´ä¸€ä¸‹æ—¶é—´è¡¨ï¼š</p><blockquote><p><strong>é›·é”‹ç½‘æ•´ç†å‡ºçš„æ­£å¼æ—¶é—´è¡¨ï¼š</strong> 2020 å¹´ 3 æœˆï¼šChrome ç½‘ä¸Šåº”ç”¨å•†åº—åœæ­¢æ¥å—æ–°çš„ Chrome Appsã€‚å¼€å‘è€…å¯ä»¥åœ¨ 2022 å¹´ 6 æœˆä¹‹å‰æ›´æ–°ç°æœ‰çš„ Chrome Appsã€‚ 2020 å¹´ 6 æœˆï¼šç»ˆæ­¢å¯¹ Windowsï¼ŒMac å’Œ Linux ä¸Šçš„ Chrome Apps çš„æ”¯æŒã€‚æ‹¥æœ‰ Chrome Enterprise å’Œ Chrome Education Upgrade çš„å®¢æˆ·å¯ä»¥è®¿é—®ä¸€é¡¹æ”¿ç­–ï¼Œå°†æ”¯æŒå»¶é•¿è‡³ 2020 å¹´ 12 æœˆã€‚ 2020 å¹´ 12 æœˆï¼šç»ˆæ­¢å¯¹ Windowsï¼ŒMac å’Œ Linux ä¸Šçš„ Chrome Apps çš„æ”¯æŒã€‚ 2021 å¹´ 6 æœˆï¼šç»ˆæ­¢å¯¹ NaClï¼ŒPNaCl å’Œ PPAPI API çš„æ”¯æŒã€‚ 2021 å¹´ 6 æœˆï¼šç»ˆæ­¢å¯¹ Chrome æ“ä½œç³»ç»Ÿä¸Šçš„ Chrome Apps çš„æ”¯æŒã€‚æ‹¥æœ‰ Chrome ä¼ä¸šå‡çº§ç‰ˆçš„å®¢æˆ·å¯ä»¥è®¿é—®ä¸€é¡¹æ”¿ç­–ï¼Œä½†æ˜¯ä»…æ”¯æŒæœŸé™å»¶é•¿è‡³ 2022 å¹´ 6 æœˆã€‚ 2022 å¹´ 6 æœˆï¼šå¯¹æ‰€æœ‰å®¢æˆ·åœæ­¢æ”¯æŒ Chrome OS ä¸Šçš„ Chrome Appsã€‚ é›·é”‹ç½‘æ€»ç»“è¿™ä»½æ—¶é—´è¡¨ï¼ŒChrome Apps åœ¨ä¸Šå¸‚è¿‘ 7 å¹´ä¹‹åï¼Œå°†ä» 2020 å¹´ 3 æœˆå¼€å§‹ä¸€æ­¥æ­¥æ¶ˆå¤±ï¼Œå±Šæ—¶ Chrome Apps å°†ä¸å†æ¥å—æ–°çš„åº”ç”¨ï¼Œè™½ç„¶ç°æœ‰çš„ App å°†ä¸€ç›´ä¿æŒå¯ç”¨çŠ¶æ€ï¼Œä½†æ˜¯æœ€ç»ˆä»…ç»´æŒåˆ° 2022 å¹´ 6 æœˆã€‚</p></blockquote><p>è¿™ç¯‡æ–‡ç« ä¹Ÿæåˆ°äº†ä¸ºä»€ä¹ˆ Google å¯¹ chrome App ä¸ä¸Šå¿ƒäº†ã€‚å…¶å®ä¸»è¦è¿˜æ˜¯å› ä¸ºè¦æ¨ PWA å˜›ï¼Œ19 å¹´çš„ Google å¼€å‘è€…å¤§ä¼šä¸Šï¼Œé‡ç‚¹ä¹‹ä¸€å°±æ˜¯ PWAã€‚æˆ‘çŒœé‚£å‡ æ¬¾ chrome app åˆ°æ—¶å€™æœ‰å¯èƒ½ä¼šè¢«ç§»æ¤åˆ° PWA ä¸Šï¼Œä¸è¿‡æˆ‘è§‰å¾—æ›´æœ‰å¯èƒ½çš„æ˜¯ electronã€‚å…¶å®å·²ç»æœ‰å¾ˆæˆåŠŸçš„å…ˆä¾‹äº†ï¼Œ<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2pncmFwaC9kcmF3aW8tZGVza3RvcA==" title="https://github.com/jgraph/drawio-desktop">draw.io<i class="fa fa-external-link"></i></span> è¿™æ¬¾éå¸¸å¼ºå¤§çš„ web æµç¨‹å›¾å·¥å…·å°±å·²ç»è¢«ç§»æ¤åˆ°äº† electron ä¸Šã€‚</p><h2 id="å†™åœ¨æœ€åçš„ä¸€äº›è¯"><a href="#å†™åœ¨æœ€åçš„ä¸€äº›è¯" class="headerlink" title="å†™åœ¨æœ€åçš„ä¸€äº›è¯"></a>å†™åœ¨æœ€åçš„ä¸€äº›è¯</h2><p>è¿™ç¯‡æ–‡ç« æœ‰ç‚¹é•¿ï¼Œèƒ½çœ‹åˆ°è¿™ä¹Ÿæ˜¯ä¸å®¹æ˜“ã€‚å¾ˆå¤šäººæ˜¯æ–‡ç« å¤ªé•¿å°±ä¸çœ‹çš„ï¼ˆï¼äººï¼œï¼›ï¼‰ã€‚åˆ«çœ‹æˆ‘è¯´äº†è¿™ä¹ˆå¤šæ‰©å±•ï¼Œæˆ‘å¹³æ—¶ä¹Ÿä¸ä¼šæŠŠè¿™ä¹ˆå¤šæ’ä»¶å…¨å¼€ç€ï¼Œæœ‰äº›æ‰©å±•è¿˜æ˜¯æŒºå ç”¨å†…å­˜çš„ã€‚ç‚¹å‡» chrome å³ä¸Šè§’ä¸‰ä¸ªç‚¹ï¼Œé€‰æ‹©æ›´å¤šå·¥å…· -&gt; ä»»åŠ¡ç®¡ç†å™¨å°±å¯ä»¥æ‰“å¼€ chrome ä¸­ä¸ªè¿›ç¨‹å ç”¨èµ„æºæƒ…å†µï¼š</p><p><img data-src="https://pic3.zhimg.com/v2-92ac7cdcbcb0a4f43240d5fda65ebba2_b.png" alt="img"></p><p>å¦‚æœæœ‰ä»€ä¹ˆé—®é¢˜æˆ–è€…ä½ æœ‰æ›´å¥½çš„æ‰©å±•æ¨èï¼Œä¸å¦¨åœ¨è¯„è®ºåŒºç•™è¨€ï¼Œæˆ‘ä¸€èˆ¬éƒ½ä¼šç§¯æå›å¤ã€‚æœ€åï¼Œ<strong>æ„Ÿè°¢å¹¿å¤§ chrome æ‰©å±•å¼€å‘è€…ï¼Œæ˜¯ä½ ä»¬çš„æ— ç§å¥‰çŒ®è®©æˆ‘ä»¬èƒ½å¤Ÿç”¨ä¸Šè¿™äº›è¿™ä¹ˆæ£’çš„æ‰©å±•ã€‚</strong>æˆ‘è§‰å¾—å§ï¼Œå¦‚æœè¯´æŸæ¬¾æ‰©å±•ç¡®å®ç»™è‡ªå·±çš„ç”Ÿæ´»å’Œå·¥ä½œå¸¦æ¥äº†å¾ˆå¤§å¸®åŠ©ï¼Œä¸å¦¨åœ¨èƒ½åŠ›ä¹‹å†…æèµ æ”¯æŒä¸€ä¸‹æ‰©å±•çš„ä½œè€…ï¼Œæ¯•ç«Ÿæ‰©å±•çš„ç»´æŠ¤éœ€è¦ä½œè€…çš„ç²¾åŠ›ç”šè‡³è¯´ä¸å°çš„èµ„é‡‘ã€‚</p><p>å†è¡¥å……ä¸€å¥ï¼šçŸ¥ä¹ markdown å¯¼å…¥çœŸåƒåœ¾ï¼Œå›¾ç‰‡æ€»æ˜¯æ— æ³•ä¸Šä¼  ğŸ˜¤</p><p>æ„Ÿè°¢æ‚¨çš„é˜…è¯»ï¼Œå¦‚æœå¯¹ä½ æœ‰æ‰€å¸®åŠ©ä¸å¦¨åŠ ä¸ªå…³æ³¨ï¼Œç‚¹ä¸ªèµæ”¯æŒä¸€ä¸‹ O(âˆ©_âˆ©)Oã€‚</p><p>æœ¬æ–‡ä¸ºåŸåˆ›å†…å®¹ï¼Œé¦–å‘äº<span class="exturl" data-url="aHR0cDovL3d3dy5seXJlYWw2NjYuY29tLw==" title="http://www.lyreal666.com/">ä¸ªäººåšå®¢<i class="fa fa-external-link"></i></span>ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>]]></content>
      <categories>
        <category>æ¨è</category>
      </categories>
      <tags>
        <tag>chrome extension</tag>
        <tag>chrome</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨ nodejs å†™çˆ¬è™«(äºŒ): æŠ“å– github çƒ­é—¨é¡¹ç›®</title>
    <url>/%E4%BD%BF%E7%94%A8-nodejs-%E5%86%99%E7%88%AC%E8%99%AB-%E4%BA%8C-%E6%8A%93%E5%8F%96-github-%E7%83%AD%E9%97%A8%E9%A1%B9%E7%9B%AE/</url>
    <content><![CDATA[<p>å…¶å®çˆ¬è™«æ˜¯ä¸€ä¸ªå¯¹è®¡ç®—æœºç»¼åˆèƒ½åŠ›è¦æ±‚æ¯”è¾ƒé«˜çš„æŠ€æœ¯æ´»ã€‚</p><p>é¦–å…ˆæ˜¯è¦å¯¹ç½‘ç»œåè®®å°¤å…¶æ˜¯ <code>http</code> åè®®æœ‰åŸºæœ¬çš„äº†è§£, èƒ½å¤Ÿåˆ†æç½‘ç«™çš„æ•°æ®è¯·æ±‚å“åº”ã€‚å­¦ä¼šä½¿ç”¨ä¸€äº›å·¥å…·ï¼Œç®€å•çš„æƒ…å†µä½¿ç”¨ chrome devtools çš„ network é¢æ¿å°±å¤Ÿäº†ã€‚æˆ‘ä¸€èˆ¬è¿˜ä¼šé…åˆ postman æˆ–è€… charles æ¥åˆ†æï¼Œæ›´å¤æ‚çš„æƒ…å†µå¯èƒ½ä¸¾è¦ä½¿ç”¨ä¸“ä¸šçš„æŠ“åŒ…å·¥å…·æ¯”å¦‚ wireshark äº†ã€‚ä½ å¯¹ä¸€ä¸ªç½‘ç«™äº†è§£çš„è¶Šæ·±ï¼Œè¶Šå®¹æ˜“æƒ³å‡ºç®€å•çš„æ–¹å¼æ¥çˆ¬å–ä½ æƒ³è·å–çš„ä¿¡æ¯ã€‚</p><p>é™¤äº†è¦äº†è§£ä¸€äº›è®¡ç®—æœºç½‘ç»œçš„çŸ¥è¯†ï¼Œä½ è¿˜éœ€è¦å…·å¤‡ä¸€å®šçš„å­—ç¬¦ä¸²å¤„ç†èƒ½åŠ›ï¼Œå…·ä½“æ¥è¯´å°±æ˜¯æ­£åˆ™è¡¨è¾¾å¼ç©çš„æºœï¼Œå…¶å®æ­£åˆ™è¡¨è¾¾å¼ä¸€èˆ¬çš„ä½¿ç”¨åœºæ™¯ä¸‹ç”¨ä¸åˆ°å¾ˆå¤šé«˜çº§çŸ¥è¯†ï¼Œæ¯”è¾ƒå¸¸ç”¨çš„æœ‰ç‚¹å°å¤æ‚çš„å°±æ˜¯åˆ†ç»„ï¼Œéè´ªå©ªåŒ¹é…ç­‰ã€‚ä¿—è¯è¯´ï¼Œå­¦å¥½æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¤„ç†å­—ç¬¦ä¸²éƒ½ä¸æ€• ğŸ¤£ã€‚</p><p>è¿˜æœ‰å°±æ˜¯æŒæ¡ä¸€äº›åçˆ¬è™«æŠ€å·§ï¼Œå†™çˆ¬è™«ä½ å¯èƒ½ä¼šç¢°åˆ°å„ç§å„æ ·çš„é—®é¢˜ï¼Œä½†æ˜¯ä¸è¦æ€•ï¼Œå†å¤æ‚çš„ 12306 éƒ½æœ‰äººèƒ½å¤Ÿçˆ¬ï¼Œè¿˜æœ‰ä»€ä¹ˆæ˜¯èƒ½éš¾åˆ°æˆ‘ä»¬çš„ã€‚å¸¸è§çš„çˆ¬è™«ç¢°åˆ°çš„é—®é¢˜æ¯”å¦‚æœåŠ¡å™¨ä¼šæ£€æŸ¥ cookies, æ£€æŸ¥ host å’Œ referer å¤´ï¼Œè¡¨å•ä¸­æœ‰éšè—å­—æ®µï¼ŒéªŒè¯ç ï¼Œè®¿é—®é¢‘ç‡é™åˆ¶ï¼Œéœ€è¦ä»£ç†, spa ç½‘ç«™ç­‰ç­‰ã€‚å…¶å®å•Šï¼Œç»å¤§å¤šæ•°çˆ¬è™«ç¢°åˆ°çš„é—®é¢˜æœ€ç»ˆéƒ½å¯ä»¥é€šè¿‡æ“çºµæµè§ˆå™¨çˆ¬å–çš„ã€‚</p><p>è¿™ç¯‡ä½¿ç”¨ nodejs å†™çˆ¬è™«ç³»åˆ—ç¬¬äºŒç¯‡ã€‚å®æˆ˜ä¸€ä¸ªå°çˆ¬è™«ï¼ŒæŠ“å– github çƒ­é—¨é¡¹ç›®ã€‚æƒ³è¦è¾¾åˆ°ç›®æ ‡:</p><ol><li>å­¦ä¼šä»ç½‘é¡µæºä»£ç ä¸­æå–æ•°æ®è¿™ç§æœ€åŸºæœ¬çš„çˆ¬è™«</li><li>ä½¿ç”¨ json æ–‡ä»¶ä¿å­˜æŠ“å–çš„æ•°æ®</li><li>ç†Ÿæ‚‰æˆ‘ä¸Šä¸€ç¯‡ä»‹ç»çš„ä¸€äº›æ¨¡å—</li><li>å­¦ä¼š node ä¸­æ€æ ·å¤„ç†ç”¨æˆ·è¾“å…¥</li></ol><a id="more"></a><h2 id="åˆ†æéœ€æ±‚"><a href="#åˆ†æéœ€æ±‚" class="headerlink" title="åˆ†æéœ€æ±‚"></a>åˆ†æéœ€æ±‚</h2><p>æˆ‘ä»¬çš„éœ€æ±‚æ˜¯ä» github ä¸ŠæŠ“å–çƒ­é—¨é¡¹ç›®æ•°æ®ï¼Œä¹Ÿå°±æ˜¯ star æ•°æ’åé å‰çš„é¡¹ç›®ã€‚ä½†æ˜¯ github å¥½åƒæ²¡æœ‰å“ªä¸ªé¡µé¢å¯ä»¥çœ‹åˆ°æ’åé å‰çš„é¡¹ç›®ã€‚<strong>å¾€å¾€ç½‘ç«™æä¾›çš„æœç´¢åŠŸèƒ½æ˜¯æˆ‘ä»¬å†™çˆ¬è™«çš„äººåˆ†æçš„é‡ç‚¹å¯¹è±¡</strong>ã€‚</p><p>æˆ‘ä¹‹å‰åœ¨ v2ex çŒæ°´çš„æ—¶å€™ï¼Œçœ‹åˆ°ä¸€ä¸ªè®¨è®º <code>996</code> çš„å¸–å­ä¸Šåˆšå¥½æ•™äº†ä¸€ä¸ªæŸ¥çœ‹ github stars æ•°å‰å‡ çš„ä»“åº“çš„æ–¹æ³•ã€‚å…¶å®å¾ˆç®€å•ï¼Œå°±æ˜¯åœ¨ github æœç´¢æ—¶åŠ ä¸Š star æ•°çš„è¿‡æ»¤æ¡ä»¶æ¯”å¦‚: <code>stars:&gt;60000</code>ï¼Œå°±å¯ä»¥æœç´¢åˆ° github ä¸Šæ‰€æœ‰ star æ•°å¤§äº 60000 çš„ä»“åº“ã€‚åˆ†æä¸‹é¢çš„æˆªå›¾ï¼Œæ³¨æ„å›¾ç‰‡ä¸­çš„æ³¨é‡Š:</p><p><img data-src="https://i.loli.net/2019/04/04/5ca59077e7a3e.png" alt="github-hot-projects"></p><p>åˆ†æä¸€ä¸‹å¯ä»¥å¾—å‡ºä»¥ä¸‹ä¿¡æ¯:</p><ol><li>è¿™ä¸ªæœç´¢ç»“æœé¡µé¢æ˜¯é€šè¿‡ get è¯·æ±‚è¿”å› html æ–‡æ¡£çš„ï¼Œå› ä¸ºæˆ‘ network é€‰æ‹©äº† <code>Doc</code> è¿‡æ»¤</li><li>url ä¸­çš„è¯·æ±‚çš„å‚æ•°æœ‰ 3 ä¸ªï¼Œp(page) ä»£è¡¨é¡µé¢æ•°ï¼Œq(query) ä»£è¡¨æœç´¢å†…å®¹ï¼Œtype ä»£è¡¨æœç´¢å†…å®¹çš„ç±»å‹</li></ol><p>ç„¶åæˆ‘åˆæƒ³ github ä¼šä¸ä¼šæ£€æŸ¥ cookies å’Œå…¶å®ƒè¯·æ±‚å¤´æ¯”å¦‚ refererï¼Œhost ç­‰ï¼Œæ ¹æ®æ˜¯å¦æœ‰è¿™äº›è¯·æ±‚å¤´å†³å®šæ˜¯å¦è¿”å›é¡µé¢ã€‚</p><p><img data-src="https://i.loli.net/2019/04/04/5ca592da2bb41.png" alt="request headers"></p><p>æ¯”è¾ƒç®€å•çš„æµ‹è¯•æ–¹æ³•æ˜¯ç›´æ¥ç”¨å‘½ä»¤è¡Œå·¥å…· <code>curl</code> æ¥æµ‹è¯•, åœ¨ gitbash ä¸­è¾“å…¥ä¸‹é¢å‘½ä»¤å³ <code>curl &quot;è¯·æ±‚çš„url&quot;</code></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl <span class="string">"https://github.com/search?p=2&amp;q=stars%3A%3E60000&amp;type=Repositories"</span></span><br></pre></td></tr></table></figure><p>ä¸å‡ºæ„å¤–çš„æ­£å¸¸çš„è¿”å›äº†é¡µé¢çš„æºä»£ç , è¿™æ ·çš„è¯æˆ‘ä»¬çš„çˆ¬è™«è„šæœ¬å°±ä¸ç”¨åŠ ä¸Šè¯·æ±‚å¤´å’Œ cookies äº†ã€‚</p><p><img data-src="https://i.loli.net/2019/04/04/5ca594909a591.png" alt="gitbash-curl-github"></p><p>é€šè¿‡ chrome çš„æœç´¢åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç½‘é¡µæºä»£ç ä¸­å°±æœ‰æˆ‘ä»¬éœ€è¦çš„é¡¹ç›®ä¿¡æ¯</p><p><img data-src="https://i.loli.net/2019/04/04/5ca595318c77b.png" alt="source code search"></p><p>åˆ†æåˆ°æ­¤ç»“æŸï¼Œè¿™å…¶å®å°±æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„å°çˆ¬è™«ï¼Œæˆ‘ä»¬åªéœ€è¦é…ç½®å¥½æŸ¥è¯¢å‚æ•°ï¼Œé€šè¿‡ http è¯·æ±‚è·å–åˆ°ç½‘é¡µæºä»£ç ï¼Œç„¶ååˆ©ç”¨è§£æåº“è§£æï¼Œè·å–æºä»£ç ä¸­æˆ‘ä»¬éœ€è¦çš„å’Œé¡¹ç›®ç›¸å…³çš„ä¿¡æ¯ï¼Œå†å¤„ç†ä¸€ä¸‹æ•°æ®æˆæ•°ç»„ï¼Œæœ€ååºåˆ—åŒ–æˆ json å­—ç¬¦ä¸²å­˜å‚¨åˆ°åˆ° json æ–‡ä»¶ä¸­ã€‚</p><p><img data-src="https://i.loli.net/2019/04/04/5ca5bb4f43e12.png" alt="postman-github-search"></p><h2 id="åŠ¨æ‰‹æ¥å®ç°è¿™ä¸ªå°çˆ¬è™«"><a href="#åŠ¨æ‰‹æ¥å®ç°è¿™ä¸ªå°çˆ¬è™«" class="headerlink" title="åŠ¨æ‰‹æ¥å®ç°è¿™ä¸ªå°çˆ¬è™«"></a>åŠ¨æ‰‹æ¥å®ç°è¿™ä¸ªå°çˆ¬è™«</h2><h3 id="è·å–æºä»£ç "><a href="#è·å–æºä»£ç " class="headerlink" title="è·å–æºä»£ç "></a>è·å–æºä»£ç </h3><p>æƒ³è¦é€šè¿‡ node è·å–æºä»£ç ï¼Œæˆ‘ä»¬éœ€è¦å…ˆé…ç½®å¥½ url å‚æ•°ï¼Œ å†é€šè¿‡ superagent è¿™ä¸ªå‘é€ http è¯·æ±‚çš„æ¨¡å—æ¥è®¿é—®é…ç½®å¥½çš„ urlã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="meta">'use strict'</span>;</span><br><span class="line"><span class="keyword">const</span> requests = <span class="built_in">require</span>(<span class="string">'superagent'</span>);</span><br><span class="line"><span class="keyword">const</span> cheerio = <span class="built_in">require</span>(<span class="string">'cheerio'</span>);</span><br><span class="line"><span class="keyword">const</span> constants = <span class="built_in">require</span>(<span class="string">'../config/constants'</span>);</span><br><span class="line"><span class="keyword">const</span> logger = <span class="built_in">require</span>(<span class="string">'../config/log4jsConfig'</span>).log4js.getLogger(<span class="string">'githubHotProjects'</span>);</span><br><span class="line"><span class="keyword">const</span> requestUtil = <span class="built_in">require</span>(<span class="string">'./utils/request'</span>);</span><br><span class="line"><span class="keyword">const</span> models = <span class="built_in">require</span>(<span class="string">'./models'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è·å– star æ•°ä¸ä½äº starCount k çš„é¡¹ç›®ç¬¬ page é¡µçš„æºä»£ç </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number&#125;</span> </span>starCount star æ•°é‡ä¸‹é™</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number&#125;</span> </span>page é¡µæ•°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> crawlSourceCode = <span class="keyword">async</span> (starCount, page = <span class="number">1</span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// ä¸‹é™ä¸º starCount k star æ•°</span></span><br><span class="line">  starCount = starCount * <span class="number">1024</span>;</span><br><span class="line">  <span class="comment">// æ›¿æ¢ url ä¸­çš„å‚æ•°</span></span><br><span class="line">  <span class="keyword">const</span> url = constants.searchUrl.replace(<span class="string">'$&#123;starCount&#125;'</span>, starCount).replace(<span class="string">'$&#123;page&#125;'</span>, page);</span><br><span class="line">  <span class="comment">// response.text å³ä¸ºè¿”å›çš„æºä»£ç </span></span><br><span class="line">  <span class="keyword">const</span> &#123; <span class="attr">text</span>: sourceCode &#125; = <span class="keyword">await</span> requestUtil.logRequest(requests.get(<span class="built_in">encodeURI</span>(url)));</span><br><span class="line">  <span class="keyword">return</span> sourceCode;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç ä¸­çš„ constants æ¨¡å—æ˜¯ç”¨æ¥ä¿å­˜é¡¹ç›®ä¸­çš„ä¸€äº›å¸¸é‡é…ç½®çš„ï¼Œåˆ°æ—¶å€™éœ€è¦æ”¹å¸¸é‡ç›´æ¥æ”¹è¿™ä¸ªé…ç½®æ–‡ä»¶å°±è¡Œäº†ï¼Œè€Œä¸”é…ç½®ä¿¡æ¯æ›´é›†ä¸­ï¼Œä¾¿äºæŸ¥çœ‹ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  searchUrl: <span class="string">'https://github.com/search?q=stars:&gt;$&#123;starCount&#125;&amp;p=$&#123;page&#125;&amp;type=Repositories'</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="è§£ææºä»£ç è·å–é¡¹ç›®ä¿¡æ¯"><a href="#è§£ææºä»£ç è·å–é¡¹ç›®ä¿¡æ¯" class="headerlink" title="è§£ææºä»£ç è·å–é¡¹ç›®ä¿¡æ¯"></a>è§£ææºä»£ç è·å–é¡¹ç›®ä¿¡æ¯</h3><p>è¿™é‡Œæˆ‘æŠŠé¡¹ç›®ä¿¡æ¯æŠ½è±¡æˆäº†ä¸€ä¸ª Repository ç±»äº†ã€‚åœ¨é¡¹ç›®çš„ models ç›®å½•ä¸‹çš„ Repository.js ä¸­ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs-extra'</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="class"><span class="keyword">class</span> <span class="title">Repository</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">async</span> saveToLocal(repositories, indent = <span class="number">2</span>) &#123;</span><br><span class="line">    <span class="keyword">await</span> fs.writeJSON(path.resolve(__dirname, <span class="string">'../../out/repositories.json'</span>), repositories, &#123; <span class="attr">spaces</span>: indent &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">constructor</span>(&#123; name, author, language, digest, starCount, lastUpdate &#125; = &#123;&#125;) &#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.author = author;</span><br><span class="line">    <span class="keyword">this</span>.language = language;</span><br><span class="line">    <span class="keyword">this</span>.digest = digest;</span><br><span class="line">    <span class="keyword">this</span>.starCount = starCount;</span><br><span class="line">    <span class="keyword">this</span>.lastUpdate = lastUpdate;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  display() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`   é¡¹ç›®: <span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span> ä½œè€…: <span class="subst">$&#123;<span class="keyword">this</span>.author&#125;</span> è¯­è¨€: <span class="subst">$&#123;<span class="keyword">this</span>.language&#125;</span> star: <span class="subst">$&#123;<span class="keyword">this</span>.starCount&#125;</span></span></span><br><span class="line"><span class="string">æ‘˜è¦: <span class="subst">$&#123;<span class="keyword">this</span>.digest&#125;</span></span></span><br><span class="line"><span class="string">æœ€åæ›´æ–°: <span class="subst">$&#123;<span class="keyword">this</span>.lastUpdate&#125;</span></span></span><br><span class="line"><span class="string">`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>è§£æè·å–åˆ°çš„æºä»£ç æˆ‘ä»¬éœ€è¦ä½¿ç”¨ cheerio è¿™ä¸ªè§£æåº“ï¼Œä½¿ç”¨æ–¹å¼å’Œ jquery å¾ˆç›¸ä¼¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è·å– star æ•°ä¸ä½äº starCount k çš„é¡¹ç›®é¡µè¡¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number&#125;</span> </span>starCount star æ•°é‡ä¸‹é™</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;number&#125;</span> </span>page é¡µæ•°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> crawlProjectsByPage = <span class="keyword">async</span> (starCount, page = <span class="number">1</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> sourceCode = <span class="keyword">await</span> crawlSourceCode(starCount, page);</span><br><span class="line">  <span class="keyword">const</span> $ = cheerio.load(sourceCode);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä¸‹é¢ cheerio å¦‚æœ jquery æ¯”è¾ƒç†Ÿåº”è¯¥æ²¡æœ‰éšœç¢, ä¸ç†Ÿçš„è¯ github å®˜æ–¹ä»“åº“å¯ä»¥æŸ¥çœ‹ api, api å¹¶ä¸æ˜¯å¾ˆå¤š</span></span><br><span class="line">  <span class="comment">// æŸ¥çœ‹ elements é¢æ¿, å‘ç°æ¯ä¸ªä»“åº“çš„ä¿¡æ¯åœ¨ä¸€ä¸ª li æ ‡ç­¾å†…, ä¸‹é¢çš„ä»£ç æ—¶å»ºè®®æ‰“å¼€å¼€å‘è€…å·¥å…·çš„ elements é¢æ¿, å‚ç…§ç€é˜…è¯»</span></span><br><span class="line">  <span class="keyword">const</span> repositoryLiSelector = <span class="string">'.repo-list-item'</span>;</span><br><span class="line">  <span class="keyword">const</span> repositoryLis = $(repositoryLiSelector);</span><br><span class="line">  <span class="keyword">const</span> repositories = [];</span><br><span class="line">  repositoryLis.each(<span class="function">(<span class="params">index, li</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> $li = $(li);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–å¸¦æœ‰ä»“åº“ä½œè€…å’Œä»“åº“åçš„ a é“¾æ¥</span></span><br><span class="line">    <span class="keyword">const</span> nameLink = $li.find(<span class="string">'h3 a'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æå–å‡ºä»“åº“åå’Œä½œè€…å</span></span><br><span class="line">    <span class="keyword">const</span> [author, name] = nameLink.text().split(<span class="string">'/'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–é¡¹ç›®æ‘˜è¦</span></span><br><span class="line">    <span class="keyword">const</span> digestP = $($li.find(<span class="string">'p'</span>)[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">const</span> digest = digestP.text().trim();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–è¯­è¨€</span></span><br><span class="line">    <span class="comment">// å…ˆè·å–ç±»åä¸º .repo-language-color çš„é‚£ä¸ª span, åœ¨è·å–åŒ…å«è¯­è¨€æ–‡å­—çš„çˆ¶ div</span></span><br><span class="line">    <span class="comment">// è¿™é‡Œè¦æ³¨æ„æœ‰äº›ä»“åº“æ˜¯æ²¡æœ‰è¯­è¨€çš„, æ˜¯è·å–ä¸åˆ°é‚£ä¸ª span çš„, language ä¸ºç©ºå­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="keyword">const</span> languageDiv = $li.find(<span class="string">'.repo-language-color'</span>).parent();</span><br><span class="line">    <span class="comment">// è¿™é‡Œæ³¨æ„ä½¿ç”¨ String.trim() å»é™¤ä¸¤ä¾§çš„ç©ºç™½ç¬¦</span></span><br><span class="line">    <span class="keyword">const</span> language = languageDiv.text().trim();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å– star æ•°é‡</span></span><br><span class="line">    <span class="keyword">const</span> starCountLinkSelector = <span class="string">'.muted-link'</span>;</span><br><span class="line">    <span class="keyword">const</span> links = $li.find(starCountLinkSelector);</span><br><span class="line">    <span class="comment">// é€‰æ‹©å™¨ä¸º .muted-link è¿˜æœ‰å¯èƒ½æ˜¯é‚£ä¸ª issues é“¾æ¥</span></span><br><span class="line">    <span class="keyword">const</span> starCountLink = $(links.length === <span class="number">2</span> ? links[<span class="number">1</span>] : links[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">const</span> starCount = starCountLink.text().trim();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–æœ€åæ›´æ–°æ—¶é—´</span></span><br><span class="line">    <span class="keyword">const</span> lastUpdateElementSelector = <span class="string">'relative-time'</span>;</span><br><span class="line">    <span class="keyword">const</span> lastUpdate = $li</span><br><span class="line">      .find(lastUpdateElementSelector)</span><br><span class="line">      .text()</span><br><span class="line">      .trim();</span><br><span class="line">    <span class="keyword">const</span> repository = <span class="keyword">new</span> models.Repository(&#123;</span><br><span class="line">      name,</span><br><span class="line">      author,</span><br><span class="line">      language,</span><br><span class="line">      digest,</span><br><span class="line">      starCount,</span><br><span class="line">      lastUpdate,</span><br><span class="line">    &#125;);</span><br><span class="line">    repositories.push(repository);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> repositories;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æœ‰æ—¶å€™æœç´¢ç»“æœæ˜¯æœ‰å¾ˆå¤šé¡µçš„ï¼Œæ‰€ä»¥æˆ‘è¿™é‡Œåˆå†™äº†ä¸€ä¸ªæ–°çš„å‡½æ•°ç”¨æ¥è·å–æŒ‡å®šé¡µé¢æ•°é‡çš„ä»“åº“ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> crawlProjectsByPagesCount = <span class="keyword">async</span> (starCount, pagesCount) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (pagesCount === <span class="literal">undefined</span>) &#123;</span><br><span class="line">    pagesCount = <span class="keyword">await</span> getPagesCount(starCount);</span><br><span class="line">    logger.warn(<span class="string">`æœªæŒ‡å®šæŠ“å–çš„é¡µé¢æ•°é‡, å°†æŠ“å–æ‰€æœ‰ä»“åº“, æ€»å…±<span class="subst">$&#123;pagesCount&#125;</span>é¡µ`</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> allRepositories = [];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> tasks = <span class="built_in">Array</span>.from(&#123; <span class="attr">length</span>: pagesCount &#125;, (ele, index) =&gt; &#123;</span><br><span class="line">    <span class="comment">// å› ä¸ºé¡µæ•°æ˜¯ä» 1 å¼€å§‹çš„, æ‰€ä»¥è¿™é‡Œè¦ i + 1</span></span><br><span class="line">    <span class="keyword">return</span> crawlProjectsByPage(starCount, index + <span class="number">1</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä½¿ç”¨ Promise.all æ¥å¹¶å‘æ“ä½œ</span></span><br><span class="line">  <span class="keyword">const</span> resultRepositoriesArray = <span class="keyword">await</span> <span class="built_in">Promise</span>.all(tasks);</span><br><span class="line">  resultRepositoriesArray.forEach(<span class="function"><span class="params">repositories</span> =&gt;</span> allRepositories.push(...repositories));</span><br><span class="line">  <span class="keyword">return</span> allRepositories;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="è®©çˆ¬è™«é¡¹ç›®æ›´äººæ€§åŒ–"><a href="#è®©çˆ¬è™«é¡¹ç›®æ›´äººæ€§åŒ–" class="headerlink" title="è®©çˆ¬è™«é¡¹ç›®æ›´äººæ€§åŒ–"></a>è®©çˆ¬è™«é¡¹ç›®æ›´äººæ€§åŒ–</h3><p>åªæ˜¯å†™ä¸ªè„šæœ¬ï¼Œåœ¨ä»£ç é‡Œé¢é…ç½®å‚æ•°ç„¶åå»çˆ¬ï¼Œè¿™æœ‰ç‚¹å¤ªç®€é™‹äº†ã€‚è¿™é‡Œæˆ‘ä½¿ç”¨äº†ä¸€ä¸ªå¯ä»¥åŒæ­¥è·å–ç”¨æˆ·è¾“å…¥çš„åº“<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2Fuc2VraS9yZWFkbGluZS1zeW5j" title="https://github.com/anseki/readline-sync">readline-sync<i class="fa fa-external-link"></i></span>ï¼ŒåŠ äº†ä¸€ç‚¹ç”¨æˆ·äº¤äº’ï¼Œåç»­çš„çˆ¬è™«æ•™ç¨‹æˆ‘å¯èƒ½ä¼šè€ƒè™‘ä½¿ç”¨ electron æ¥åšä¸ªç®€å•çš„ç•Œé¢, ä¸‹é¢æ˜¯ç¨‹åºçš„å¯åŠ¨ä»£ç ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> readlineSync = <span class="built_in">require</span>(<span class="string">'readline-sync'</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; crawlProjectsByPage, crawlProjectsByPagesCount &#125; = <span class="built_in">require</span>(<span class="string">'./crawlHotProjects'</span>);</span><br><span class="line"><span class="keyword">const</span> models = <span class="built_in">require</span>(<span class="string">'./models'</span>);</span><br><span class="line"><span class="keyword">const</span> logger = <span class="built_in">require</span>(<span class="string">'../config/log4jsConfig'</span>).log4js.getLogger(<span class="string">'githubHotProjects'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> main = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> isContinue = <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">do</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> starCount = readlineSync.questionInt(<span class="string">`è¾“å…¥ä½ æƒ³è¦æŠ“å–çš„ github ä¸Šé¡¹ç›®çš„ star æ•°é‡ä¸‹é™, å•ä½(k): `</span>, &#123;</span><br><span class="line">      encoding: <span class="string">'utf-8'</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">const</span> crawlModes = [<span class="string">'æŠ“å–æŸä¸€é¡µ'</span>, <span class="string">'æŠ“å–ä¸€å®šæ•°é‡é¡µæ•°'</span>, <span class="string">'æŠ“å–æ‰€æœ‰é¡µ'</span>];</span><br><span class="line">    <span class="keyword">const</span> index = readlineSync.keyInSelect(crawlModes, <span class="string">'è¯·é€‰æ‹©ä¸€ç§æŠ“å–æ¨¡å¼'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> repositories = [];</span><br><span class="line">    <span class="keyword">switch</span> (index) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0</span>: &#123;</span><br><span class="line">        <span class="keyword">const</span> page = readlineSync.questionInt(<span class="string">'è¯·è¾“å…¥ä½ è¦æŠ“å–çš„å…·ä½“é¡µæ•°: '</span>);</span><br><span class="line">        repositories = <span class="keyword">await</span> crawlProjectsByPage(starCount, page);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>: &#123;</span><br><span class="line">        <span class="keyword">const</span> pagesCount = readlineSync.questionInt(<span class="string">'è¯·è¾“å…¥ä½ è¦æŠ“å–çš„é¡µé¢æ•°é‡: '</span>);</span><br><span class="line">        repositories = <span class="keyword">await</span> crawlProjectsByPagesCount(starCount, pagesCount);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span>: &#123;</span><br><span class="line">        repositories = <span class="keyword">await</span> crawlProjectsByPagesCount(starCount);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    repositories.forEach(<span class="function"><span class="params">repository</span> =&gt;</span> repository.display());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> isSave = readlineSync.keyInYN(<span class="string">'è¯·é—®æ˜¯å¦è¦ä¿å­˜åˆ°æœ¬åœ°(json æ ¼å¼) ?'</span>);</span><br><span class="line">    isSave &amp;&amp; models.Repository.saveToLocal(repositories);</span><br><span class="line">    isContinue = readlineSync.keyInYN(<span class="string">'ç»§ç»­è¿˜æ˜¯é€€å‡º ?'</span>);</span><br><span class="line">  &#125; <span class="keyword">while</span> (isContinue);</span><br><span class="line">  logger.info(<span class="string">'ç¨‹åºæ­£å¸¸é€€å‡º...'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">main();</span><br></pre></td></tr></table></figure><h3 id="æ¥çœ‹çœ‹æœ€åçš„æ•ˆæœ"><a href="#æ¥çœ‹çœ‹æœ€åçš„æ•ˆæœ" class="headerlink" title="æ¥çœ‹çœ‹æœ€åçš„æ•ˆæœ"></a>æ¥çœ‹çœ‹æœ€åçš„æ•ˆæœ</h3><p>è¿™é‡Œè¦æä¸€ä¸‹ readline-sync çš„ä¸€ä¸ª bug,ï¼Œåœ¨ windows ä¸Š, vscode ä¸­ä½¿ç”¨ git bash æ—¶ï¼Œä¸­æ–‡ä¼šä¹±ç ï¼Œæ— è®ºä½ æ–‡ä»¶æ ¼å¼æ˜¯ä¸æ˜¯ utf-8ã€‚æœäº†ä¸€äº› issuesï¼Œ åœ¨ powershell ä¸­åˆ‡æ¢ç¼–ç ä¸º utf-8 å°±å¯ä»¥æ­£å¸¸æ˜¾ç¤ºï¼Œä¹Ÿå°±æ˜¯æŠŠé¡µç åˆ‡åˆ° <code>65001</code>ã€‚</p><p><img data-src="https://i.loli.net/2019/04/05/5ca71256f4137.png" alt="example"></p><p><img data-src="https://i.loli.net/2019/04/05/5ca711441ccb8.png" alt="repositories-json"></p><p>é¡¹ç›®çš„å®Œæ•´æºä»£ç ä»¥åŠåç»­çš„æ•™ç¨‹æºä»£ç éƒ½ä¼šä¿å­˜åœ¨æˆ‘çš„ github ä»“åº“: <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RqeDY2Ni9TcGlkZXJz" title="https://github.com/tjx666/Spiders">Spiders<i class="fa fa-external-link"></i></span>ã€‚å¦‚æœæˆ‘çš„æ•™ç¨‹å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œå¸Œæœ›ä¸è¦åå•¬æ‚¨çš„ star ğŸ˜Šã€‚åç»­çš„æ•™ç¨‹å¯èƒ½å°±æ˜¯ä¸€ä¸ªæ›´å¤æ‚çš„æ¡ˆä¾‹ï¼Œé€šè¿‡åˆ†æ ajax è¯·æ±‚æ¥ç›´æ¥è®¿é—®æ¥å£ã€‚</p>]]></content>
      <categories>
        <category>åç«¯</category>
      </categories>
      <tags>
        <tag>node</tag>
        <tag>spider</tag>
        <tag>github</tag>
      </tags>
  </entry>
  <entry>
    <title>æ€»ç»“ä¸‹ javascript ä¸­çš„ä¸€äº›å°æŠ€å·§</title>
    <url>/%E6%80%BB%E7%BB%93%E4%B8%8B-javascript-%E4%B8%AD%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B0%8F%E6%8A%80%E5%B7%A7/</url>
    <content><![CDATA[<p>è¿™ç¯‡æ–‡ç« ä¸»è¦è®°å½•ä¸€ä¸‹å¹³æ—¶è‡ªå·±å®è·µå¾—åˆ°çš„, åšå®¢ä¸­å­¦ä¹ çš„ä»¥åŠåœ¨ä¸€äº›é¡¹ç›®æºç ä¸­çœ‹åˆ°çš„ javascript æŠ€å·§ã€‚æœ‰äº›ä¸œè¥¿å¯ä»¥è¯´æ˜¯å¥‡æ·«æŠ€å·§ï¼Œæœ‰äº›å¯èƒ½æ˜¯ ES6+ ä¸­ä¸€äº›æ¯”è¾ƒå…·æœ‰å®ç”¨æ€§çš„æ–°è¯­æ³•ã€‚</p><a id="more"></a><h3 id="amp-amp-å’Œ-çš„å¦™ç”¨"><a href="#amp-amp-å’Œ-çš„å¦™ç”¨" class="headerlink" title="&amp;&amp; å’Œ || çš„å¦™ç”¨"></a>&amp;&amp; å’Œ || çš„å¦™ç”¨</h3><p>æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦åœ¨æŸä¸ªå‡½æ•°æˆ–å˜é‡ä¸º true æ—¶æ‰§è¡Œå¦å¤–ä¸€ä¸ªå‡½æ•°ã€‚ä¾‹å¦‚:</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> task1 = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'æ‰§è¡Œ task1'</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Math</span>.random() &gt;= <span class="number">0.5</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> task2 = <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'task1 æ‰§è¡ŒæˆåŠŸåæ‰§è¡Œ task2'</span>);</span><br><span class="line"><span class="keyword">if</span> (task1()) task2();</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ if è¯­å¥å¯ä»¥ä½¿ç”¨ <code>&amp;&amp;</code> ç›´æ¥ç®€å†™ä¸º:</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">task1() &amp;&amp; task2();</span><br></pre></td></tr></table></figure><p>å¦‚æœè¿˜è¦åœ¨ task1 å¤±è´¥(ä¹Ÿå°±æ˜¯ task1 è¿”å› false)åæ‰§è¡Œ task3, å¯ä»¥ä½¿ç”¨:</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> task3 = <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'task1 æ‰§è¡Œå¤±è´¥åæ‰§è¡Œ task3'</span>);</span><br><span class="line">(task1() &amp;&amp; task2()) || task3();</span><br></pre></td></tr></table></figure><p>æœ¬è´¨ä¸Šè¿˜æ˜¯åˆ©ç”¨äº† <code>&amp;&amp;</code> å’Œ <code>||</code> çš„çŸ­è·¯ç‰¹æ€§ã€‚</p><p>å…¶å®è¿™é‡Œä½¿ç”¨æ¡ä»¶è¿ç®—ç¬¦ä¹Ÿæ˜¯å¯ä»¥çš„:</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">task1() ? task2() : task3();</span><br></pre></td></tr></table></figure><p>ä¸‹é¢å±•ç¤ºçš„æˆ‘æœ€è¿‘çš„ä¸€ä¸ªä½¿ç”¨ <strong>react hooks</strong> å¼€å‘çš„é¡¹ç›®ä¸­çš„ä¸€ä¸ªä»£ç ç‰‡æ®µï¼Œè¿™é‡Œåˆ©ç”¨äº† <strong>render props</strong>:</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> ProfileItem = <span class="function"><span class="params">props</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; name, value, render &#125; = props;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div className=<span class="string">"profile-item"</span>&gt;</span><br><span class="line">      &lt;span className=<span class="string">"item-name"</span>&gt;&#123;name&#125;&lt;<span class="regexp">/span&gt;</span></span><br><span class="line"><span class="regexp">      &lt;form action=""&gt;</span></span><br><span class="line"><span class="regexp">        &#123;/</span>* æ ¹æ®æ˜¯å¦æœ‰ render è¿™ä¸ª props æ¥è¿”å›ä¸åŒçš„å†…å®¹ *<span class="regexp">/&#125;</span></span><br><span class="line"><span class="regexp">        &#123;(render &amp;&amp; render(props)) || &lt;SimpleProfileItemContent value=&#123;value&#125; /</span>&gt;&#125;</span><br><span class="line">      &lt;<span class="regexp">/form&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="å‡½æ•°é»˜è®¤å€¼"><a href="#å‡½æ•°é»˜è®¤å€¼" class="headerlink" title="å‡½æ•°é»˜è®¤å€¼"></a>å‡½æ•°é»˜è®¤å€¼</h3><h4 id="ES5-ç‰ˆæœ¬"><a href="#ES5-ç‰ˆæœ¬" class="headerlink" title="ES5 ç‰ˆæœ¬"></a>ES5 ç‰ˆæœ¬</h4><p>ä½¿ç”¨çŸ­è·¯æˆ–æ“ä½œç¬¦æ¥è®¾ç½®å‡½æ•°é»˜è®¤å€¼çš„æ–¹å¼å…¶å®å¾ˆå¸¸è§ã€‚ä½†æ˜¯æœ‰ä¸€äº›å‘ï¼Œä¸‹é¢å±•ç¤ºçš„ä»£ç ä¸­å½“é»˜è®¤å€¼å‚æ•°ä¸ºä¸€ä¸ªæ•°å­—æ—¶ï¼Œä¼ å‚ä¸º 0 è¿˜æ˜¯ä¼šä½¿ç”¨é»˜è®¤å€¼ï¼Œå¿…é¡»å¯¹ y ä¸º 0 çš„æ—¶å€™å•ç‹¬è¿›è¡Œåˆ¤æ–­ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> pow = <span class="function">(<span class="params">x, y</span>) =&gt;</span> &#123;</span><br><span class="line">  y = y || <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> result = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, max = y; i &lt; max; i++) &#123;</span><br><span class="line">    result *= x;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(pow(<span class="number">2</span>)); <span class="comment">// =&gt; 4</span></span><br><span class="line"><span class="built_in">console</span>.log(pow(<span class="number">2</span>, <span class="number">3</span>)); <span class="comment">// =&gt; 8</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å½“ y ä¼ å€¼ä¸º 0 æ—¶, y å–å€¼ 2</span></span><br><span class="line"><span class="built_in">console</span>.log(pow(<span class="number">2</span>, <span class="number">0</span>)); <span class="comment">// =&gt; 4</span></span><br></pre></td></tr></table></figure><h4 id="ES6-ç‰ˆæœ¬"><a href="#ES6-ç‰ˆæœ¬" class="headerlink" title="ES6 ç‰ˆæœ¬"></a>ES6 ç‰ˆæœ¬</h4><p>ES6 åœ¨è¯­æ³•å±‚é¢æä¾›çš„é»˜è®¤å€¼è¯­æ³•å°±é è°±çš„å¤šäº†</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> pow = <span class="function">(<span class="params">x, y = <span class="number">2</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> result = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, max = y; i &lt; max; i++) &#123;</span><br><span class="line">    result *= x;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(pow(<span class="number">2</span>)); <span class="comment">// =&gt; 4</span></span><br><span class="line"><span class="built_in">console</span>.log(pow(<span class="number">2</span>, <span class="number">3</span>)); <span class="comment">// =&gt; 8</span></span><br><span class="line"><span class="built_in">console</span>.log(pow(<span class="number">2</span>, <span class="number">0</span>)); <span class="comment">// =&gt; 1</span></span><br></pre></td></tr></table></figure><h3 id="ç±»æ•°ç»„è½¬æ•°ç»„"><a href="#ç±»æ•°ç»„è½¬æ•°ç»„" class="headerlink" title="ç±»æ•°ç»„è½¬æ•°ç»„"></a>ç±»æ•°ç»„è½¬æ•°ç»„</h3><p>ç±»æ•°ç»„æŒ‡çš„æ˜¯åƒ <code>arguments</code> ï¼Œ<code>jquery</code> å¯¹è±¡ä¸€æ ·å¯ä»¥ä½¿ç”¨ä¸‹æ ‡è®¿é—®è¿˜æœ‰ length å±æ€§çš„å’Œæ•°ç»„å¾ˆåƒä½†å¹¶ä¸æ˜¯æ•°ç»„çš„ä¸€ç±»å¯¹è±¡ã€‚</p><p>ç±»æ•°ç»„æ²¡æœ‰ <code>slice</code>, <code>map</code> ç­‰é›†åˆå‡½æ•°ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬æœ‰æ—¶å€™éœ€è¦å°†ç±»æ•°ç»„è½¬æ¢æˆæ•°ç»„çš„åŸå› ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, max = <span class="built_in">arguments</span>.length; i &lt; max; i++) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">arguments</span>[i]);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">Array</span>.isArray(<span class="built_in">arguments</span>)); <span class="comment">// =&gt; false</span></span><br><span class="line">  <span class="comment">// ç±»æ•°ç»„æ²¡æœ‰ slice, forEach, map ç­‰é›†åˆå‡½æ•°</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">arguments</span>.slice === <span class="literal">undefined</span>); <span class="comment">// =&gt; true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func(<span class="string">'Google'</span>, <span class="string">'facebook'</span>, <span class="string">'Microsoft'</span>);</span><br><span class="line"><span class="comment">// =&gt;</span></span><br><span class="line"><span class="comment">// Google</span></span><br><span class="line"><span class="comment">// facebook</span></span><br><span class="line"><span class="comment">// Microsoft</span></span><br></pre></td></tr></table></figure><h4 id="ES5-ä¸­çš„è½¬æ¢æ–¹æ³•"><a href="#ES5-ä¸­çš„è½¬æ¢æ–¹æ³•" class="headerlink" title="ES5 ä¸­çš„è½¬æ¢æ–¹æ³•"></a>ES5 ä¸­çš„è½¬æ¢æ–¹æ³•</h4><p>å°† Array åŸå‹ä¸­çš„ slice æ–¹æ³•ç»‘å®šåˆ° arguments å¯¹è±¡ä¸Šè°ƒç”¨ï¼Œå¹¶ä¸”ä¸ä¼ å‚æ•°ç›®çš„ä¸ºäº†è®©å…¶è¿”å›æ‰€æœ‰çš„å…ƒç´ ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> array = <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(array.slice(<span class="number">0</span>, <span class="number">1</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func(<span class="string">'Google'</span>, <span class="string">'facebook'</span>, <span class="string">'Microsoft'</span>); <span class="comment">// =&gt; [ 'Google' ]</span></span><br></pre></td></tr></table></figure><h4 id="ES6-ä¸­çš„è½¬æ¢æ–¹æ³•"><a href="#ES6-ä¸­çš„è½¬æ¢æ–¹æ³•" class="headerlink" title="ES6 ä¸­çš„è½¬æ¢æ–¹æ³•"></a>ES6 ä¸­çš„è½¬æ¢æ–¹æ³•</h4><p>ES6 å°†ç±»æ•°ç»„è½¬æ¢æˆæ•°ç»„çš„æ–¹æ³•å¤šä¸€äº›ã€‚</p><p>ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log([...arguments]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func(<span class="string">'Google'</span>, <span class="string">'facebook'</span>, <span class="string">'Microsoft'</span>); <span class="comment">// [ 'Google', 'facebook', 'Microsoft' ]</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ Array.from</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="built_in">Array</span>.from(<span class="built_in">arguments</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func(<span class="string">'Google'</span>, <span class="string">'facebook'</span>, <span class="string">'Microsoft'</span>); <span class="comment">// [ 'Google', 'facebook', 'Microsoft' ]</span></span><br></pre></td></tr></table></figure><h3 id="æ„é€ ä¸€ä¸ªè¿ç»­æ•´æ•°çš„æ•°ç»„"><a href="#æ„é€ ä¸€ä¸ªè¿ç»­æ•´æ•°çš„æ•°ç»„" class="headerlink" title="æ„é€ ä¸€ä¸ªè¿ç»­æ•´æ•°çš„æ•°ç»„"></a>æ„é€ ä¸€ä¸ªè¿ç»­æ•´æ•°çš„æ•°ç»„</h3><p>è¿™é‡Œå°±ç›´æ¥ç»™å‡ºæˆ‘è§‰å¾—æœ€å¥½çš„æ–¹æ³•äº†</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è¾“å‡º 2 å¼€å§‹è¿ç»­çš„8ä¸ªæ•´æ•°</span></span><br><span class="line"><span class="keyword">const</span> array = <span class="built_in">Array</span>.from(&#123; <span class="attr">length</span>: <span class="number">8</span> &#125;).map(<span class="function">(<span class="params">ele, index</span>) =&gt;</span> index + <span class="number">2</span>);</span><br><span class="line"><span class="built_in">console</span>.log(array); <span class="comment">// =&gt; [ 2, 3, 4, 5, 6, 7, 8, 9 ]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯„è®ºåŒºæŒ‡å‡ºæœ‰æ›´ç®€æ´çš„ç‰ˆæœ¬, Array.from è‡ªå¸¦çš„æ˜ å°„å‡½æ•°</span></span><br><span class="line"><span class="keyword">const</span> array = <span class="built_in">Array</span>.from(&#123; <span class="attr">length</span>: <span class="number">8</span> &#125;, (ele, index) =&gt; index + <span class="number">2</span>);</span><br><span class="line"><span class="built_in">console</span>.log(array); <span class="comment">// =&gt; [ 2, 3, 4, 5, 6, 7, 8, 9 ]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿˜æœ‰ä¸€ä¸ªç½‘å‹æŒ‡å‡ºå¯ä»¥åˆ©ç”¨ Array.prototype.keys æ¥æ„é€ </span></span><br><span class="line"><span class="keyword">const</span> array = [...Array(<span class="number">8</span>).keys()].map(<span class="function">(<span class="params">ele, index</span>) =&gt;</span> index + <span class="number">2</span>);</span><br></pre></td></tr></table></figure><h3 id="å‡½æ•°å‚æ•°ä½¿ç”¨è§£æ„èµ‹å€¼"><a href="#å‡½æ•°å‚æ•°ä½¿ç”¨è§£æ„èµ‹å€¼" class="headerlink" title="å‡½æ•°å‚æ•°ä½¿ç”¨è§£æ„èµ‹å€¼"></a>å‡½æ•°å‚æ•°ä½¿ç”¨è§£æ„èµ‹å€¼</h3><p>å‡½æ•°å‚æ•°æ¯”è¾ƒå¤šçš„æ—¶å€™æˆ‘ä»¬å¾€å¾€ä¼šè®©å‚æ•°ç›´æ¥æ¥å—ä¸€ä¸ªé…ç½®å¯¹è±¡ã€‚ä½†æ˜¯ä½¿ç”¨å¯¹è±¡å‚æ•°æˆ‘ä»¬æ— æ³•è®¾ç½®é»˜è®¤å€¼ï¼Œåœ¨å‡½æ•°ä½“ä¸­ä½¿ç”¨å¯¹è±¡å‚æ•°æ—¶è¿˜éœ€è¦ä½¿ç”¨é€šè¿‡å¯¹è±¡å‚æ•°æ¥è®¿é—®ï¼Œå½“è®¿é—®æ¬¡æ•°æ¯”è¾ƒå¤šæˆ–è€…åµŒå¥—æ¯”è¾ƒæ·±å°±ä¼šè§‰å¾—ä¸æ–¹ä¾¿ã€‚åœ¨å‡½æ•°å‚æ•°ä¸­ä½¿ç”¨è§£æ„èµ‹å€¼å°±è§£å†³äº†ä¸Šé¢çš„é—®é¢˜ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å¿…é¡»ç»™å¯¹è±¡å‚æ•°è®¾ç½®é»˜è®¤å€¼, ä¸ç„¶ä¼ å‚æ•°æ—¶å› ä¸ºæ²¡æœ‰è§£æ„å¯¹è±¡ä¼šæŠ¥é”™</span></span><br><span class="line"><span class="keyword">const</span> getUsers = <span class="function">(<span class="params">&#123; offset = <span class="number">0</span>, limit = <span class="number">1</span>, orderBy = <span class="string">'salary'</span> &#125; = &#123;&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// æ ¹æ®æ¡ä»¶æŸ¥è¯¢æ•°æ®åº“è¿”å›ç”¨æˆ·æ•°æ®</span></span><br><span class="line">  <span class="built_in">console</span>.log(&#123; offset, limit, orderBy &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">getUsers(&#123; <span class="attr">offset</span>: <span class="number">10</span>, <span class="attr">limit</span>: <span class="number">20</span>, <span class="attr">orderBy</span>: <span class="string">'age'</span> &#125;); <span class="comment">// =&gt; &#123; offset: 10, limit: 20, orderBy: 'age' &#125;</span></span><br><span class="line">getUsers(); <span class="comment">// =&gt; &#123; offset: 0, limit: 1, orderBy: 'salary' &#125;</span></span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨-å°†å…¶å®ƒç±»å‹è½¬æ¢æˆ-bool-å‹"><a href="#ä½¿ç”¨-å°†å…¶å®ƒç±»å‹è½¬æ¢æˆ-bool-å‹" class="headerlink" title="ä½¿ç”¨ !! å°†å…¶å®ƒç±»å‹è½¬æ¢æˆ bool å‹"></a>ä½¿ç”¨ !! å°†å…¶å®ƒç±»å‹è½¬æ¢æˆ bool å‹</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(!!&#123;&#125;); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(!!<span class="number">0</span>); <span class="comment">// false</span></span><br><span class="line"><span class="built_in">console</span>.log(!![]); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(!!<span class="literal">undefined</span>); <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> httpGet = <span class="function">(<span class="params">url, retry</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (!!retry) &#123;</span><br><span class="line">    <span class="comment">// è¶…æ—¶é‡å‘</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="JSON-stringify"><a href="#JSON-stringify" class="headerlink" title="JSON.stringify"></a>JSON.stringify</h3><h4 id="æ·±åº¦å…‹éš†"><a href="#æ·±åº¦å…‹éš†" class="headerlink" title="æ·±åº¦å…‹éš†"></a>æ·±åº¦å…‹éš†</h4><p>ä½¿ç”¨å…ˆåºåˆ—åŒ–å†ååºåˆ—åŒ–è¿™ç§æ–¹å¼æ¥æ·±åº¦å…‹éš†å¯¹è±¡åœ¨ä¸€èˆ¬æƒ…å†µä¸‹å¾ˆæ–¹ä¾¿ï¼Œç¼ºç‚¹å°±æ˜¯æ— æ³•å…‹éš†å‡½æ•°ä»¥åŠç»§æ‰¿çš„å±æ€§ã€‚</p><p>å¦‚æœè¿˜è¦å…‹éš†å‡½æ•°å±æ€§ï¼Œæ¨èä½¿ç”¨ lodash çš„ cloneDeepã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> me = &#123;</span><br><span class="line">  name: <span class="string">'lyreal666'</span>,</span><br><span class="line">  age: <span class="number">23</span>,</span><br><span class="line">  speak() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`Hello, I'm ly!`</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> clonedMe = <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(me));</span><br><span class="line"><span class="built_in">console</span>.log(clonedMe); <span class="comment">// =&gt; &#123; name: 'lyreal666', age: 23 &#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(clonedMe.speak === <span class="literal">undefined</span>); <span class="comment">// =&gt; true</span></span><br></pre></td></tr></table></figure><h4 id="ä½¿ç”¨ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰å‚æ•°"><a href="#ä½¿ç”¨ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰å‚æ•°" class="headerlink" title="ä½¿ç”¨ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰å‚æ•°"></a>ä½¿ç”¨ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰å‚æ•°</h4><p>JSON.stringify çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ç”¨æ¥å¯¹å±æ€§å€¼è¿›è¡Œå¤„ç†çš„ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°åˆ™æ˜¯ç”¨æ¥æŒ‡å®šè¾“å‡ºçš„ json å­—ç¬¦ä¸²çš„ç¼©è¿›é•¿åº¦ï¼Œå¯ä»¥ä¼ æ•°å­—ä¹Ÿå¯ä»¥ä¼ å­—ç¬¦ä¸²ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> me = &#123;</span><br><span class="line">  name: <span class="string">'lyreal666'</span>,</span><br><span class="line">  age: <span class="number">23</span>,</span><br><span class="line">  speak() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`Hello, I'm ly!`</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> jsonStr = <span class="built_in">JSON</span>.stringify(me, (key, value) =&gt; (key === <span class="string">'name'</span> ? <span class="string">'è€ä½™'</span> : value), <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(jsonStr);</span><br><span class="line"><span class="comment">/* =&gt;</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">  "name": "è€ä½™",</span></span><br><span class="line"><span class="comment">  "age": 23</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h3 id="ä¼˜é›…çš„éå†å¯¹åƒ"><a href="#ä¼˜é›…çš„éå†å¯¹åƒ" class="headerlink" title="ä¼˜é›…çš„éå†å¯¹åƒ"></a>ä¼˜é›…çš„éå†å¯¹åƒ</h3><p>ä½¿ç”¨è§£æ„èµ‹å€¼å’Œ Object.entriesã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> me = &#123;</span><br><span class="line">  name: <span class="string">'lyreal666'</span>,</span><br><span class="line">  age: <span class="number">23</span>,</span><br><span class="line">  speak() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`Hello, I'm ly!`</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> [key, value] <span class="keyword">of</span> <span class="built_in">Object</span>.entries(me)) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;key&#125;</span>: <span class="subst">$&#123;value&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* =&gt;</span></span><br><span class="line"><span class="comment">name: lyreal666</span></span><br><span class="line"><span class="comment">age: 23</span></span><br><span class="line"><span class="comment">speak: speak() &#123;</span></span><br><span class="line"><span class="comment">        console.log(`Hello, I'm ly!`);</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h3 id="æ¸…ç©ºæ•°ç»„çš„æœ€å¿«æ–¹æ³•"><a href="#æ¸…ç©ºæ•°ç»„çš„æœ€å¿«æ–¹æ³•" class="headerlink" title="æ¸…ç©ºæ•°ç»„çš„æœ€å¿«æ–¹æ³•"></a>æ¸…ç©ºæ•°ç»„çš„æœ€å¿«æ–¹æ³•</h3><p>è¯„è®ºåŒºæœ‰äººè¯´è¿™ç§ç›´æ¥ä¿®æ”¹ <code>length</code> çš„åšæ³•æ˜¯æœ‰é—®é¢˜çš„, æˆ‘ä¹‹å‰ä¹Ÿçœ‹è¿‡å…³äºæ¸…ç©ºæ•°ç»„çš„æ–¹æ³•çš„è®¨è®º, ä½†æ˜¯æˆ‘è§‰å¾—ä¸€èˆ¬æƒ…å†µä¸‹è¿™æ ·ç”¨æ˜¯æ²¡ä»€ä¹ˆé—®é¢˜çš„, æ—¢ç®€å•, åˆä¸ç”¨é‡æ–°åˆ†é…å†…å­˜ç»™æ–°æ•°ç»„ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> array = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line">array.length = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">console</span>.log(array); <span class="comment">// =&gt; []</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç½‘å‹æŒ‡å‡ºå¯ä»¥æ›´å¥½çš„æ–¹å¼æ˜¯ç›´æ¥èµ‹å€¼ç©ºæ•°ç»„</span></span><br><span class="line"><span class="keyword">let</span> array = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line">array = [];</span><br></pre></td></tr></table></figure><h3 id="åˆ¤æ–­ä¸€ä¸ªæ•´æ•°æ˜¯å¦æ˜¯-1"><a href="#åˆ¤æ–­ä¸€ä¸ªæ•´æ•°æ˜¯å¦æ˜¯-1" class="headerlink" title="åˆ¤æ–­ä¸€ä¸ªæ•´æ•°æ˜¯å¦æ˜¯ -1"></a>åˆ¤æ–­ä¸€ä¸ªæ•´æ•°æ˜¯å¦æ˜¯ -1</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ~ æ“ä½œç¬¦çš„è¿ç®—è§„å¾‹å¯ä»¥ç®€å•è®°ä½œå°†åŠ ä¸€çš„ç»“æœå–å</span></span><br><span class="line"><span class="built_in">console</span>.log(~<span class="number">1</span>); <span class="comment">// =&gt; -2</span></span><br><span class="line"><span class="built_in">console</span>.log(~<span class="number">0</span>); <span class="comment">// =&gt; -1</span></span><br><span class="line"><span class="built_in">console</span>.log(~<span class="number">-3</span>); <span class="comment">// =&gt; 2</span></span><br><span class="line"><span class="built_in">console</span>.log(~<span class="number">-1</span>); <span class="comment">// =&gt; 0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> number = <span class="number">-2</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯å¦ä¸º -1</span></span><br><span class="line"><span class="keyword">if</span> (!~number) &#123;</span><br><span class="line">  <span class="comment">// å½“ number æ˜¯ -1 çš„æ“ä½œ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç«‹å³æ‰§è¡Œå‡½æ•°"><a href="#ç«‹å³æ‰§è¡Œå‡½æ•°" class="headerlink" title="ç«‹å³æ‰§è¡Œå‡½æ•°"></a>ç«‹å³æ‰§è¡Œå‡½æ•°</h3><p>ç«‹å³æ‰§è¡Œå‡½æ•°å¯ä»¥è®©æˆ‘ä»¬çš„ä»£ç ä¸­çš„å˜é‡ä¸æ±¡æŸ“å¤–éƒ¨å˜é‡ï¼Œå¸¸è§çš„ä½¿ç”¨æ–¹å¼æ˜¯åƒä¸‹é¢è¿™æ ·çš„ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨æ‹¬å·å°†å‡½æ•°æ‹¬èµ·æ¥è°ƒç”¨</span></span><br><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">window, $</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// å†…éƒ¨ä»£ç </span></span><br><span class="line">&#125;)(<span class="built_in">window</span>, jQuery);</span><br></pre></td></tr></table></figure><p>æ›´ä¼˜é›…çš„æ–¹å¼æ˜¯ä¸‹é¢è¿™ç§ï¼Œäº‹å®ä¸Šå¾ˆå¤šå…¶å®ƒçš„ç®—æœ¯è¿ç®—ç¬¦æ¯”å¦‚ +, -, *, ~ ç­‰ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">! <span class="function"><span class="keyword">function</span>(<span class="params">window, $</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// å†…éƒ¨ä»£ç </span></span><br><span class="line">&#125; (<span class="built_in">window</span>, jQuery)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿˜å¯ä»¥ä½¿ç”¨ +, -, * ç­‰</span></span><br><span class="line">+ <span class="function"><span class="keyword">function</span>(<span class="params">window, $</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// å†…éƒ¨ä»£ç </span></span><br><span class="line">&#125; (<span class="built_in">window</span>, jQuery)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ›´ç¥å¥‡çš„æ˜¯è¿˜å¯ä»¥ç”¨ new, typeof ç­‰æ“ä½œç¬¦</span></span><br><span class="line"><span class="keyword">new</span> <span class="function"><span class="keyword">function</span>(<span class="params">window, $</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// å†…éƒ¨ä»£ç </span></span><br><span class="line">&#125; (<span class="built_in">window</span>, jQuery)ï¼›</span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨-set-æ¥å¯¹æ•°ç»„å»é‡å¤"><a href="#ä½¿ç”¨-set-æ¥å¯¹æ•°ç»„å»é‡å¤" class="headerlink" title="ä½¿ç”¨ set æ¥å¯¹æ•°ç»„å»é‡å¤"></a>ä½¿ç”¨ set æ¥å¯¹æ•°ç»„å»é‡å¤</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log([...new <span class="built_in">Set</span>([<span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>])]); <span class="comment">// =&gt; [ 1, 3, 2 ]</span></span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨-reduce-è¿ä¹˜æˆ–è¿åŠ "><a href="#ä½¿ç”¨-reduce-è¿ä¹˜æˆ–è¿åŠ " class="headerlink" title="ä½¿ç”¨ reduce è¿ä¹˜æˆ–è¿åŠ "></a>ä½¿ç”¨ reduce è¿ä¹˜æˆ–è¿åŠ </h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> array = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line"><span class="comment">// è¿åŠ </span></span><br><span class="line"><span class="built_in">console</span>.log(array.reduce(<span class="function">(<span class="params">p, c</span>) =&gt;</span> p + c)); <span class="comment">// =&gt; 10</span></span><br><span class="line"><span class="comment">// è¿ä¹˜</span></span><br><span class="line"><span class="built_in">console</span>.log(array.reduce(<span class="function">(<span class="params">p, c</span>) =&gt;</span> p * c)); <span class="comment">// =&gt; 24</span></span><br></pre></td></tr></table></figure><h3 id="å–æ•´"><a href="#å–æ•´" class="headerlink" title="å–æ•´"></a>å–æ•´</h3><p>Math ä¸­çš„ä¸€å †å–æ•´å‡½æ•°è¿™é‡Œå°±ä¸è¯´äº†ï¼Œä¸»è¦æ˜¯æä¸€äº›æ¯”è¾ƒå·§å¦™åœ°å–æ•´æ–¹å¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(~~<span class="number">3.14</span>); <span class="comment">// =&gt; 3</span></span><br><span class="line"><span class="built_in">console</span>.log(~~<span class="number">-2.5</span>); <span class="comment">// =&gt; -2</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">6.18</span> | <span class="number">0</span>); <span class="comment">// =&gt; 6</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">-3.6</span> | <span class="number">0</span>); <span class="comment">// =&gt; -3</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">9.9</span> &gt;&gt; <span class="number">0</span>); <span class="comment">// =&gt; 9</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">-2.1</span> &gt;&gt; <span class="number">0</span>); <span class="comment">// =&gt; -2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// superagent æ˜¯ä¸€ä¸ªå¾ˆå®ç”¨çš„å‘é€ http è¯·æ±‚çš„ node æ¨¡å—ï¼Œå®ƒå¯¹è¿”å›ç çš„å¤„ç†å°±ç”¨åˆ°äº† |</span></span><br><span class="line"><span class="keyword">var</span> type = (status / <span class="number">100</span>) | <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// status / class</span></span><br><span class="line">res.status = status;</span><br><span class="line">res.statusType = type;</span><br><span class="line"></span><br><span class="line"><span class="comment">// basics</span></span><br><span class="line">res.info = <span class="number">1</span> == type;</span><br><span class="line">res.ok = <span class="number">2</span> == type;</span><br><span class="line">res.clientError = <span class="number">4</span> == type;</span><br><span class="line">res.serverError = <span class="number">5</span> == type;</span><br><span class="line">res.error = <span class="number">4</span> == type || <span class="number">5</span> == type;</span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨-å°†å…¶å®ƒç±»å‹è½¬æ¢æˆ-number-ç±»å‹"><a href="#ä½¿ç”¨-å°†å…¶å®ƒç±»å‹è½¬æ¢æˆ-number-ç±»å‹" class="headerlink" title="ä½¿ç”¨ + å°†å…¶å®ƒç±»å‹è½¬æ¢æˆ number ç±»å‹"></a>ä½¿ç”¨ + å°†å…¶å®ƒç±»å‹è½¬æ¢æˆ number ç±»å‹</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(+<span class="string">'3.14'</span>); <span class="comment">// =&gt; 3.14</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> +<span class="string">'3.14'</span>); <span class="comment">// =&gt; number</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> sleep = <span class="function"><span class="params">milliseconds</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> resolve(), milliseconds);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å½“ç„¶è¿™é‡Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ console.time æ¥æµ‹è¯•</span></span><br><span class="line">!(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">main</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> start = +<span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">  <span class="keyword">await</span> sleep(<span class="number">3000</span>);</span><br><span class="line">  <span class="keyword">const</span> end = +<span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`æ‰§è¡Œäº†<span class="subst">$&#123;end - start&#125;</span>`</span>); <span class="comment">// æ‰§è¡Œäº† 3002</span></span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨ç§‘å­¦è®¡æ•°æ³•è¡¨ç¤ºå¤§æ•°å­—"><a href="#ä½¿ç”¨ç§‘å­¦è®¡æ•°æ³•è¡¨ç¤ºå¤§æ•°å­—" class="headerlink" title="ä½¿ç”¨ç§‘å­¦è®¡æ•°æ³•è¡¨ç¤ºå¤§æ•°å­—"></a>ä½¿ç”¨ç§‘å­¦è®¡æ•°æ³•è¡¨ç¤ºå¤§æ•°å­—</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> str1 = <span class="string">'hello'</span>;</span><br><span class="line"><span class="keyword">const</span> str2 = <span class="string">' world'</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.time(<span class="string">'æµ‹è¯• + æ‹¼æ¥å­—ç¬¦ä¸²'</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">200000000</span>; i++) &#123;</span><br><span class="line">  <span class="keyword">const</span> joinedStr = str1 + str2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.timeEnd(<span class="string">'æµ‹è¯• + æ‹¼æ¥å­—ç¬¦ä¸²'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.time(<span class="string">'æµ‹è¯•æ¨¡æ¿å­—ç¬¦ä¸²æ‹¼æ¥å­—ç¬¦ä¸²'</span>);</span><br><span class="line"><span class="comment">// ä½¿ç”¨ç§‘å­¦è®¡æ•°æ³•æ¯”æ‰“ 8 ä¸ª 0 æ–¹ä¾¿ä¸å°‘</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">2e8</span>; i++) &#123;</span><br><span class="line">  <span class="keyword">const</span> joinedStr = <span class="string">`<span class="subst">$&#123;str1&#125;</span><span class="subst">$&#123;str2&#125;</span>`</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.timeEnd(<span class="string">'æµ‹è¯•æ¨¡æ¿å­—ç¬¦ä¸²æ‹¼æ¥å­—ç¬¦ä¸²'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* =&gt;</span></span><br><span class="line"><span class="comment">æµ‹è¯• + æ‹¼æ¥å­—ç¬¦ä¸²: 3238.037ms</span></span><br><span class="line"><span class="comment">æµ‹è¯•æ¨¡æ¿å­—ç¬¦ä¸²æ‹¼æ¥å­—ç¬¦ä¸²: 3680.225ms</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h3 id="äº¤æ¢å˜é‡å€¼"><a href="#äº¤æ¢å˜é‡å€¼" class="headerlink" title="äº¤æ¢å˜é‡å€¼"></a>äº¤æ¢å˜é‡å€¼</h3><p>ç›´æ¥åˆ©ç”¨è§£æ„èµ‹å€¼</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="number">666</span>;</span><br><span class="line"><span class="keyword">let</span> b = <span class="number">999</span>;</span><br><span class="line">[a, b] = [b, a];</span><br><span class="line"><span class="built_in">console</span>.log(&#123; a, b &#125;); <span class="comment">// =&gt; &#123; a: 999, b: 666 &#125;</span></span><br></pre></td></tr></table></figure><h3 id="è·å–éšæœºå­—ç¬¦ä¸²"><a href="#è·å–éšæœºå­—ç¬¦ä¸²" class="headerlink" title="è·å–éšæœºå­—ç¬¦ä¸²"></a>è·å–éšæœºå­—ç¬¦ä¸²</h3><p>æˆªå–ä¸‹æ ‡ 2 å¼€å§‹åçš„å­—ç¬¦ä¸²æ˜¯å› ä¸ºä¸éœ€è¦ Math.random() è¿”å›çš„å°æ•°æ„æˆçš„å­—ç¬¦ä¸²çš„ <code>0.</code> è¿™ä¸¤ä¸ªå­—ç¬¦ã€‚ä½¿ç”¨ 36 è¿›åˆ¶å¯ä»¥åˆ¶é€ å­—ç¬¦ç§ç±»æ›´å¤šäº›çš„éšæœºå­—ç¬¦ä¸²</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">console.log(Math.random().toString(16).substring(2)); &#x2F;&#x2F; 13ä½ &#x3D;&gt; 45d9d0bb10b31</span><br><span class="line">console.log(Math.random().toString(36).substring(2)); &#x2F;&#x2F; 11ä½ &#x3D;&gt; zwcx1yewjvj</span><br></pre></td></tr></table></figure><h3 id="æ‰å¹³åŒ–æ•°ç»„"><a href="#æ‰å¹³åŒ–æ•°ç»„" class="headerlink" title="æ‰å¹³åŒ–æ•°ç»„"></a>æ‰å¹³åŒ–æ•°ç»„</h3><p>ES 2019 æ–°å¢äº† Array.prototype.flatï¼Œç›®å‰ chrome æœ€æ–°æ­£å¼ç‰ˆ 73.0.3683.103 å·²ç»æ”¯æŒäº†, node æœ€æ–°çš„ LTS 10.15.3 è¿˜ä¸æ”¯æŒ, node æœ€æ–°å¼€å‘ç‰ˆ 11.13.0 æ˜¯æ”¯æŒçš„ã€‚è¿™é‡Œè´´ä¸€ä¸ªåœ¨æ˜é‡‘ä¸€ä¸ªå…„å¼Ÿé¢ç»é‡Œé¢çœ‹åˆ°çš„æ¯”è¾ƒ hack çš„æ–¹æ³•ï¼Œè¿™é‡Œè¦æ³¨æ„æ ¹æ®æƒ…å†µåšç±»å‹è½¬æ¢ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> array = [<span class="number">1</span>, [<span class="number">2</span>, [<span class="number">3</span>, <span class="number">4</span>], <span class="number">5</span>], <span class="number">6</span>, <span class="number">7</span>];</span><br><span class="line"><span class="built_in">console</span>.log(</span><br><span class="line">  array</span><br><span class="line">    .toString()</span><br><span class="line">    .split(<span class="string">','</span>)</span><br><span class="line">    .map(<span class="function"><span class="params">ele</span> =&gt;</span> <span class="built_in">Number</span>.parseInt(ele))</span><br><span class="line">); <span class="comment">// =&gt; [ 1, 2, 3, 4, 5, 6, 7 ]</span></span><br></pre></td></tr></table></figure><p>æœ¬æ–‡ä¸ºåŸåˆ›å†…å®¹ï¼Œé¦–å‘äº<span class="exturl" data-url="aHR0cDovL3d3dy5seXJlYWw2NjYuY29t" title="http://www.lyreal666.com">ä¸ªäººåšå®¢<i class="fa fa-external-link"></i></span>ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>javascript</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨ nodejs å†™çˆ¬è™«(ä¸€): å¸¸ç”¨æ¨¡å—å’Œ js è¯­æ³•</title>
    <url>/%E4%BD%BF%E7%94%A8-nodejs-%E5%86%99%E7%88%AC%E8%99%AB-%E4%B8%80-%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97%E5%92%8C-js-%E8%AF%AD%E6%B3%95/</url>
    <content><![CDATA[<p>æœ¬ç¯‡æ˜¯ä½¿ç”¨ nodejs å†™çˆ¬è™«ç³»åˆ—æ•™ç¨‹çš„ç¬¬ä¸€ç¯‡, ä»‹ç»äº†ä½¿ç”¨ nodejs å†™çˆ¬è™«è¿‡ç¨‹ä¸­å¸¸ç”¨çš„æ¨¡å—å’Œä¸€äº›å¿…é¡»æŒæ¡çš„ js è¯­æ³•</p><a id="more"></a><h2 id="å¸¸ç”¨æ¨¡å—"><a href="#å¸¸ç”¨æ¨¡å—" class="headerlink" title="å¸¸ç”¨æ¨¡å—"></a>å¸¸ç”¨æ¨¡å—</h2><p>å¸¸ç”¨æ¨¡å—æœ‰ä»¥ä¸‹å‡ ä¸ª:</p><ol><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2pwcmljaGFyZHNvbi9ub2RlLWZzLWV4dHJh" title="https://github.com/jprichardson/node-fs-extra">fs-extra<i class="fa fa-external-link"></i></span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3Zpc2lvbm1lZGlhL3N1cGVyYWdlbnQ=" title="https://github.com/visionmedia/superagent">superagent<i class="fa fa-external-link"></i></span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2NoZWVyaW9qcy9jaGVlcmlv" title="https://github.com/cheeriojs/cheerio">cheerio<i class="fa fa-external-link"></i></span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2xvZzRqcy1ub2RlL2xvZzRqcy1ub2Rl" title="https://github.com/log4js-node/log4js-node">log4js<i class="fa fa-external-link"></i></span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NlcXVlbGl6ZS9zZXF1ZWxpemU=" title="https://github.com/sequelize/sequelize">sequelize<i class="fa fa-external-link"></i></span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2NoYWxrL2NoYWxr" title="https://github.com/chalk/chalk">chalk<i class="fa fa-external-link"></i></span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0dvb2dsZUNocm9tZS9wdXBwZXRlZXI=" title="https://github.com/GoogleChrome/puppeteer">puppeteer<i class="fa fa-external-link"></i></span></li></ol><h3 id="fs-extra"><a href="#fs-extra" class="headerlink" title="fs-extra"></a>fs-extra</h3><p>ä½¿ç”¨ async/await çš„å‰ææ˜¯å¿…é¡»å°†æ¥å£å°è£…æˆ promise, çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­:</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> sleep = <span class="function"><span class="params">milliseconds</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> resolve(), milliseconds);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> main = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">await</span> sleep(<span class="number">5000</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'5ç§’å...'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">main();</span><br></pre></td></tr></table></figure><p>é€šè¿‡åœ¨ async å‡½æ•°ä¸­ä½¿ç”¨ await + promise çš„æ–¹å¼æ¥ç»„ç»‡å¼‚æ­¥ä»£ç å°±åƒæ˜¯åŒæ­¥ä»£ç ä¸€èˆ¬ï¼Œéå¸¸çš„è‡ªç„¶å’Œæœ‰åŠ©äºæˆ‘ä»¬åˆ†æä»£ç çš„æ‰§è¡Œæµç¨‹ã€‚</p><p>åœ¨ node ä¸­ï¼Œ fs æ¨¡å—æ˜¯ä¸€ä¸ªå¾ˆå¸¸ç”¨çš„æ“ä½œæ–‡ä»¶çš„ native æ¨¡å—ï¼Œfs (file system) æ¨¡å—æä¾›äº†å’Œæ–‡ä»¶ç³»ç»Ÿç›¸å…³çš„ä¸€äº›åŒæ­¥å’Œå¼‚æ­¥çš„ api, æœ‰æ—¶å€™ä½¿ç”¨åŒæ­¥ api éå¸¸æœ‰å¿…è¦ï¼Œæ¯”å¦‚ä½ è¦åœ¨ä¸€ä¸ªè‡ªå·±å†™çš„æ¨¡å—ä¸­çš„åœ¨è®¿é—®æ–‡ä»¶åå¯¼å‡ºä¸€äº›æ¥å£æ—¶ï¼Œè¿™ä¸ªæ—¶å€™ç”¨åŒæ­¥çš„ api å°±å¾ˆå®ç”¨ã€‚çœ‹ä¸ªä¾‹å­ï¼š</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs-extra'</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; log4js &#125; = <span class="built_in">require</span>(<span class="string">'../../config/log4jsConfig'</span>);</span><br><span class="line"><span class="keyword">const</span> log = log4js.getLogger(<span class="string">'qupingce'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> createModels = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> models = &#123;&#125;;</span><br><span class="line">  <span class="keyword">const</span> fileNames = fs.readdirSync(path.resolve(__dirname, <span class="string">'.'</span>));</span><br><span class="line"></span><br><span class="line">  fileNames</span><br><span class="line">    .filter(<span class="function"><span class="params">fileName</span> =&gt;</span> fileName !== <span class="string">'index.js'</span>)</span><br><span class="line">    .map(<span class="function"><span class="params">fileName</span> =&gt;</span> fileName.slice(<span class="number">0</span>, <span class="number">-3</span>))</span><br><span class="line">    .forEach(<span class="function"><span class="params">modelName</span> =&gt;</span> &#123;</span><br><span class="line">      log.info(<span class="string">`Sequelize define model <span class="subst">$&#123;modelName&#125;</span>!`</span>);</span><br><span class="line">      models[modelName] = <span class="built_in">require</span>(path.resolve(__dirname, <span class="string">`./<span class="subst">$&#123;modelName&#125;</span>.js`</span>));</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="keyword">return</span> models;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = createModels();</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ¨¡å—è®¿é—®äº†å½“å‰ç›®å½•ä¸‹æ‰€æœ‰çš„ model æ¨¡å—å¹¶å¯¼å‡º models, å¦‚æœæ˜¯ä½¿ç”¨å¼‚æ­¥æ¥å£ä¹Ÿå°±æ˜¯ fs.readdir, è¿™æ ·çš„è¯ä½ åœ¨åˆ«çš„æ¨¡å—å¯¼å…¥è¿™ä¸ªæ¨¡å—æ˜¯è·å–ä¸åˆ° models çš„ï¼Œ åŸå› æ˜¯ require æ˜¯åŒæ­¥æ“ä½œï¼Œè€Œæ¥å£æ˜¯å¼‚æ­¥çš„ï¼ŒåŒæ­¥ä»£ç æ— æ³•ç«‹å³è·å¾—å¼‚æ­¥æ“ä½œçš„ç»“æœã€‚</p><p>ä¸ºäº†å……åˆ†å‘æŒ¥ node å¼‚æ­¥çš„ä¼˜åŠ¿ï¼Œæˆ‘ä»¬è¿˜æ˜¯åº”è¯¥å°½é‡ä½¿ç”¨å¼‚æ­¥æ¥å£ã€‚</p><p>æˆ‘ä»¬å®Œå…¨å¯ä»¥ä½¿ç”¨ fs-extra æ¨¡å—æ¥ä»£æ›¿ fs æ¨¡å—, ç±»ä¼¼çš„æ¨¡å—è¿˜æœ‰ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL25vcm1hbGl6ZS9teg==" title="https://github.com/normalize/mz">mz<i class="fa fa-external-link"></i></span>ã€‚fs-extra åŒ…å«äº†æ‰€æœ‰çš„ fs æ¨¡å—çš„æ¥å£ï¼Œè¿˜å¯¹æ¯ä¸ªå¼‚æ­¥æ¥å£æä¾›äº† promise æ”¯æŒï¼Œæ›´æ£’çš„æ˜¯ fs-extra è¿˜æä¾›äº†ä¸€äº›å…¶å®ƒçš„å®ç”¨æ–‡ä»¶æ“ä½œå‡½æ•°ï¼Œ æ¯”å¦‚åˆ é™¤ç§»åŠ¨æ–‡ä»¶çš„æ“ä½œã€‚æ›´è¯¦ç»†çš„ä»‹ç»è¯·æŸ¥çœ‹å®˜æ–¹ä»“åº“ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2pwcmljaGFyZHNvbi9ub2RlLWZzLWV4dHJh" title="https://github.com/jprichardson/node-fs-extra">fs-extra<i class="fa fa-external-link"></i></span>ã€‚</p><h3 id="superagent"><a href="#superagent" class="headerlink" title="superagent"></a>superagent</h3><p>superagent æ˜¯ä¸€ä¸ª node çš„ http client, å¯ä»¥ç±»æ¯” java ä¸­çš„ httpclient å’Œ okhttp, python ä¸­çš„ requestsã€‚å¯ä»¥è®©æˆ‘ä»¬æ¨¡æ‹Ÿ http è¯·æ±‚ã€‚superagent è¿™ä¸ªåº“æœ‰å¾ˆå¤šå®ç”¨çš„ç‰¹ç‚¹ã€‚</p><ol><li><p>superagent ä¼šæ ¹æ® response çš„ content-type è‡ªåŠ¨åºåˆ—åŒ–ï¼Œé€šè¿‡ response.body å°±å¯ä»¥è·å–åˆ°åºåˆ—åŒ–åçš„è¿”å›å†…å®¹</p></li><li><p>è¿™ä¸ªåº“ä¼šè‡ªåŠ¨ç¼“å­˜å’Œå‘é€ cookies, ä¸éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨ç®¡ç† cookies</p></li><li><p>å†æ¥å°±æ˜¯å®ƒçš„ api æ˜¯é“¾å¼è°ƒç”¨é£æ ¼çš„ï¼Œè°ƒç”¨èµ·æ¥å¾ˆçˆ½ï¼Œä¸è¿‡ä½¿ç”¨çš„æ—¶å€™è¦æ³¨æ„è°ƒç”¨é¡ºåº</p></li><li><p>å®ƒçš„å¼‚æ­¥ api éƒ½æ˜¯è¿”å› promise çš„ã€‚</p></li></ol><p>éå¸¸æ–¹ä¾¿æœ‰æœ¨æœ‰ ğŸ˜‹ã€‚å®˜æ–¹æ–‡æ¡£å°±æ˜¯å¾ˆé•¿çš„ä¸€é¡µï¼Œç›®å½•æ¸…æ™°ï¼Œå¾ˆå®¹æ˜“å°±æœç´¢åˆ°ä½ éœ€è¦çš„å†…å®¹ã€‚æœ€åï¼Œsuperagent è¿˜æ”¯æŒæ’ä»¶é›†æˆï¼Œæ¯”å¦‚ä½ éœ€è¦åœ¨è¶…æ—¶åè‡ªåŠ¨é‡å‘ï¼Œå¯ä»¥ä½¿ç”¨ superagent-retryã€‚æ›´å¤šæ’ä»¶å¯ä»¥å» npm å®˜ç½‘ä¸Šæœç´¢å…³é”®å­— <code>superagent-</code>ã€‚æ›´å¤šè¯¦æƒ…æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£<span class="exturl" data-url="aHR0cHM6Ly92aXNpb25tZWRpYS5naXRodWIuaW8vc3VwZXJhZ2VudC8=" title="https://visionmedia.github.io/superagent/">superagent<i class="fa fa-external-link"></i></span></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å®˜æ–¹æ–‡æ¡£çš„ä¸€ä¸ªè°ƒç”¨ç¤ºä¾‹</span></span><br><span class="line">request</span><br><span class="line">  .post(<span class="string">'/api/pet'</span>)</span><br><span class="line">  .send(&#123; <span class="attr">name</span>: <span class="string">'Manny'</span>, <span class="attr">species</span>: <span class="string">'cat'</span> &#125;)</span><br><span class="line">  .set(<span class="string">'X-API-Key'</span>, <span class="string">'foobar'</span>)</span><br><span class="line">  .set(<span class="string">'Accept'</span>, <span class="string">'application/json'</span>)</span><br><span class="line">  .then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">    alert(<span class="string">'yay got '</span> + <span class="built_in">JSON</span>.stringify(res.body));</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><h3 id="cheerio"><a href="#cheerio" class="headerlink" title="cheerio"></a>cheerio</h3><p>å†™è¿‡çˆ¬è™«çš„äººéƒ½çŸ¥é“, æˆ‘ä»¬ç»å¸¸ä¼šæœ‰è§£æ html çš„éœ€æ±‚, ä»ç½‘é¡µæºä»£ç ä¸­çˆ¬å–ä¿¡æ¯åº”è¯¥æ˜¯æœ€åŸºç¡€çš„çˆ¬è™«æ‰‹æ®µäº†ã€‚python ä¸­æœ‰ beautifulsoup, java ä¸­æœ‰ jsoup, node ä¸­æœ‰ cheerioã€‚</p><p>cheerio æ˜¯ä¸ºæœåŠ¡å™¨ç«¯è®¾è®¡çš„ï¼Œç»™ä½ è¿‘ä¹å®Œæ•´çš„ jquery ä½“éªŒã€‚ä½¿ç”¨ cheerio æ¥è§£æ html è·å–å…ƒç´ ï¼Œè°ƒç”¨æ–¹å¼å’Œ jquery æ“ä½œ dom å…ƒç´ ç”¨æ³•å®Œå…¨ä¸€è‡´ã€‚è€Œä¸”è¿˜æä¾›äº†ä¸€äº›æ–¹ä¾¿çš„æ¥å£, æ¯”å¦‚è·å– html, çœ‹ä¸€ä¸ªä¾‹å­:</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> cheerio = <span class="built_in">require</span>(<span class="string">'cheerio'</span>);</span><br><span class="line"><span class="keyword">const</span> $ = cheerio.load(<span class="string">'&lt;h2 class="title"&gt;Hello world&lt;/h2&gt;'</span>);</span><br><span class="line"></span><br><span class="line">$(<span class="string">'h2.title'</span>).text(<span class="string">'Hello there!'</span>);</span><br><span class="line">$(<span class="string">'h2'</span>).addClass(<span class="string">'welcome'</span>);</span><br><span class="line"></span><br><span class="line">$.html();</span><br><span class="line"><span class="comment">//=&gt; &lt;h2 class="title welcome"&gt;Hello there!&lt;/h2&gt;</span></span><br></pre></td></tr></table></figure><p>å®˜æ–¹ä»“åº“: <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2NoZWVyaW9qcy9jaGVlcmlv" title="https://github.com/cheeriojs/cheerio">cheerio<i class="fa fa-external-link"></i></span></p><h3 id="log4js"><a href="#log4js" class="headerlink" title="log4js"></a>log4js</h3><p>log4j æ˜¯ä¸€ä¸ªä¸º node è®¾è®¡çš„æ—¥å¿—æ¨¡å—ã€‚ åœºæ™¯ç®€å•æƒ…å†µä¸‹å¯ä»¥è€ƒè™‘ä½¿ç”¨ debug æ¨¡å—ã€‚ log4js æ¯”è¾ƒç¬¦åˆæˆ‘å¯¹æ—¥å¿—åº“çš„éœ€æ±‚ï¼Œå…¶å®ä»–ä¿©å®šä½ä¹Ÿä¸ä¸€æ ·ï¼Œdebug æ¨¡å—æ˜¯ä¸ºè°ƒè¯•è€Œè®¾è®¡çš„ï¼Œlog4js åˆ™æ˜¯ä¸€ä¸ªæ—¥å¿—åº“ï¼Œè‚¯å®šå¾—æä¾›æ–‡ä»¶è¾“å‡ºå’Œåˆ†çº§ç­‰å¸¸è§„åŠŸèƒ½ã€‚</p><p>log4js æ¨¡å—çœ‹åå­—æœ‰ç‚¹å‘ java ä¸­å¾ˆæœ‰åçš„æ—¥å¿—åº“ log4j çœ‹é½çš„èŠ‚å¥ã€‚log4j æœ‰ä»¥ä¸‹ç‰¹ç‚¹:</p><ol><li>å¯ä»¥è‡ªå®šä¹‰ appender(è¾“å‡ºç›®æ ‡)ï¼Œlo4js ç”šè‡³æä¾›äº†è¾“å‡ºåˆ°é‚®ä»¶ç­‰ç›®æ ‡çš„ appender</li><li>é€šè¿‡ç»„åˆä¸åŒçš„ appender, å¯ä»¥å®ç°ä¸åŒç›®çš„çš„ logger(æ—¥å¿—å™¨)</li><li>æä¾›äº†æ—¥å¿—åˆ†çº§åŠŸèƒ½ï¼Œå®˜æ–¹çš„ FAQ ä¸­æåˆ°äº†å¦‚æœè¦å¯¹ appender å®ç°çº§åˆ«è¿‡æ»¤ï¼Œå¯ä»¥ä½¿ç”¨ <strong>logLevelFilter</strong></li><li>æä¾›äº†æ»šåŠ¨æ—¥å¿—å’Œè‡ªå®šä¹‰è¾“å‡ºæ ¼å¼</li></ol><p>ä¸‹é¢é€šè¿‡æˆ‘æœ€è¿‘ä¸€ä¸ªçˆ¬è™«é¡¹ç›®çš„é…ç½®æ–‡ä»¶æ¥æ„Ÿå—ä»¥ä¸‹è¿™ä¸ªåº“çš„ç‰¹ç‚¹:</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> log4js = <span class="built_in">require</span>(<span class="string">'log4js'</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs-extra'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> infoFilePath = path.resolve(__dirname, <span class="string">'../out/log/info.log'</span>);</span><br><span class="line"><span class="keyword">const</span> errorFilePath = path.resolve(__dirname, <span class="string">'../out/log/error.log'</span>);</span><br><span class="line">log4js.configure(&#123;</span><br><span class="line">  appenders: &#123;</span><br><span class="line">    dateFile: &#123;</span><br><span class="line">      type: <span class="string">'dateFile'</span>,</span><br><span class="line">      filename: infoFilePath,</span><br><span class="line">      pattern: <span class="string">'yyyy-MM-dd'</span>,</span><br><span class="line">      compress: <span class="literal">false</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    errorDateFile: &#123;</span><br><span class="line">      type: <span class="string">'dateFile'</span>,</span><br><span class="line">      filename: errorFilePath,</span><br><span class="line">      pattern: <span class="string">'yyyy-MM-dd'</span>,</span><br><span class="line">      compress: <span class="literal">false</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    justErrorsToFile: &#123;</span><br><span class="line">      type: <span class="string">'logLevelFilter'</span>,</span><br><span class="line">      appender: <span class="string">'errorDateFile'</span>,</span><br><span class="line">      level: <span class="string">'error'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    out: &#123;</span><br><span class="line">      type: <span class="string">'console'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  categories: &#123;</span><br><span class="line">    <span class="keyword">default</span>: &#123;</span><br><span class="line">      appenders: [<span class="string">'out'</span>],</span><br><span class="line">      level: <span class="string">'trace'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    qupingce: &#123;</span><br><span class="line">      appenders: [<span class="string">'out'</span>, <span class="string">'dateFile'</span>, <span class="string">'justErrorsToFile'</span>],</span><br><span class="line">      level: <span class="string">'trace'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> clear = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> files = <span class="keyword">await</span> fs.readdir(path.resolve(__dirname, <span class="string">'../out/log'</span>));</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> fileName <span class="keyword">of</span> files) &#123;</span><br><span class="line">    fs.remove(path.resolve(__dirname, <span class="string">`../out/log/<span class="subst">$&#123;fileName&#125;</span>`</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  log4js,</span><br><span class="line">  clear,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="sequelize"><a href="#sequelize" class="headerlink" title="sequelize"></a>sequelize</h3><p>å†™é¡¹ç›®æˆ‘ä»¬å¾€å¾€ä¼šæœ‰æŒä¹…åŒ–çš„éœ€æ±‚ï¼Œç®€å•çš„åœºæ™¯å¯ä»¥ä½¿ç”¨ JSON ä¿å­˜æ•°æ®ï¼Œå¦‚æœæ•°æ®é‡æ¯”è¾ƒå¤§è¿˜è¦ä¾¿äºç®¡ç†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¦è€ƒè™‘ç”¨æ•°æ®åº“äº†ã€‚å¦‚æœæ˜¯æ“ä½œ mysql å’Œ sqllite å»ºè®®ä½¿ç”¨ sequelize, å¦‚æœæ˜¯ mongodb, æˆ‘æ›´æ¨èç”¨ä¸“é—¨ä¸º mongodb è®¾è®¡çš„ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0F1dG9tYXR0aWMvbW9uZ29vc2U=" title="https://github.com/Automattic/mongoose">mongoose<i class="fa fa-external-link"></i></span></p><p>sequelize æœ‰å‡ ç‚¹æˆ‘è§‰å¾—è¿˜æ˜¯æœ‰ç‚¹ä¸å¤ªå¥½ï¼Œæ¯”å¦‚é»˜è®¤ç”Ÿæˆ <code>id</code> (primary key), <code>createdAt</code> å’Œ <code>updatedAt</code>ã€‚</p><p>æŠ›å¼€ä¸€äº›è‡ªä½œä¸»å¼ çš„å°æ¯›ç—…ï¼Œsequelize è®¾è®¡çš„è¿˜æ˜¯å¾ˆå¥½çš„ã€‚å†…ç½®çš„æ“ä½œç¬¦ï¼Œhooks, è¿˜æœ‰ validators å¾ˆæœ‰æ„æ€ã€‚sequelize è¿˜æä¾›äº† promise å’Œ typescript æ”¯æŒã€‚å¦‚æœæ˜¯ä½¿ç”¨ typescript å¼€å‘é¡¹ç›®ï¼Œè¿˜æœ‰å¦å¤–ä¸€ä¸ªå¾ˆå¥½çš„ orm é€‰æ‹© : <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R5cGVvcm0vdHlwZW9ybQ==" title="https://github.com/typeorm/typeorm">typeorm<i class="fa fa-external-link"></i></span>ã€‚æ›´å¤šå†…å®¹å¯ä»¥æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£: <span class="exturl" data-url="aHR0cDovL2RvY3Muc2VxdWVsaXplanMuY29tLw==" title="http://docs.sequelizejs.com/">sequelize<i class="fa fa-external-link"></i></span></p><h3 id="chalk"><a href="#chalk" class="headerlink" title="chalk"></a>chalk</h3><p>chalk ä¸­æ–‡æ„æ€æ˜¯ç²‰ç¬”çš„æ„æ€ï¼Œè¿™ä¸ªæ¨¡å—æ˜¯ node å¾ˆæœ‰ç‰¹è‰²å’Œå®ç”¨çš„ä¸€ä¸ªæ¨¡å—ï¼Œå®ƒå¯ä»¥ä¸ºä½ è¾“å‡ºçš„å†…å®¹æ·»åŠ é¢œè‰²ï¼Œ ä¸‹åˆ’çº¿ï¼Œ èƒŒæ™¯è‰²ç­‰è£…é¥°ã€‚å½“æˆ‘ä»¬å†™é¡¹ç›®çš„æ—¶å€™å¾€å¾€éœ€è¦è®°å½•ä¸€äº›æ­¥éª¤å’Œäº‹ä»¶ï¼Œæ¯”å¦‚æ‰“å¼€æ•°æ®åº“é“¾æ¥ï¼Œå‘å‡º http è¯·æ±‚ç­‰ã€‚æˆ‘ä»¬å¯ä»¥é€‚å½“ä½¿ç”¨ chalk æ¥çªå‡ºæŸäº›å†…å®¹ï¼Œä¾‹å¦‚è¯·æ±‚çš„ url åŠ ä¸Šä¸‹åˆ’çº¿ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> logRequest = <span class="function">(<span class="params">response, isDetailed = <span class="literal">false</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> URL = chalk.underline.yellow(response.request.url);</span><br><span class="line">  <span class="keyword">const</span> basicInfo = <span class="string">`<span class="subst">$&#123;response.request.method&#125;</span> Status: <span class="subst">$&#123;response.status&#125;</span> Content-Type: <span class="subst">$&#123;response.type&#125;</span> URL=<span class="subst">$&#123;URL&#125;</span>`</span>;</span><br><span class="line">  <span class="keyword">if</span> (!isDetailed) &#123;</span><br><span class="line">    logger.info(basicInfo);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> detailInfo = <span class="string">`<span class="subst">$&#123;basicInfo&#125;</span>\ntext: <span class="subst">$&#123;response.text&#125;</span>`</span>;</span><br><span class="line">    logger.info(detailInfo);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>è°ƒç”¨ä¸Šé¢çš„ logRequest æ•ˆæœ:</p><p><img data-src="https://i.loli.net/2019/04/02/5ca3724e74da1.png" alt="chalk"></p><p>æ›´å¤šå†…å®¹æŸ¥çœ‹å®˜æ–¹ä»“åº“<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2NoYWxrL2NoYWxr" title="https://github.com/chalk/chalk">chalk<i class="fa fa-external-link"></i></span></p><h3 id="puppeteer"><a href="#puppeteer" class="headerlink" title="puppeteer"></a>puppeteer</h3><p>å¦‚æœè¿™ä¸ªåº“æ²¡å¬è¯´è¿‡ï¼Œä½ å¯èƒ½å¬è¯´è¿‡ seleniumã€‚puppeteer æ˜¯ Google Chrome å›¢é˜Ÿå¼€æºçš„ä¸€ä¸ªé€šè¿‡ devtools åè®®æ“çºµ chrome æˆ–è€… Chromium çš„ node æ¨¡å—ã€‚Google å‡ºå“ï¼Œè´¨é‡æœ‰æ‰€ä¿è¯ã€‚è¿™ä¸ªæ¨¡å—æä¾›äº†ä¸€äº›é«˜çº§çš„ api, é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¸ªåº“æ“çºµçš„æµè§ˆå™¨ç”¨æˆ·æ˜¯çœ‹ä¸åˆ°ç•Œé¢çš„ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„æ— å¤´(headless)æµè§ˆå™¨ã€‚å½“ç„¶å¯ä»¥é€šè¿‡é…ç½®ä¸€äº›å‚æ•°æ¥å¯åŠ¨æœ‰ç•Œé¢çš„æ¨¡å¼ã€‚åœ¨ chrome ä¸­è¿˜æœ‰ä¸€äº›ä¸“é—¨å½•åˆ¶ puppeteer æ“ä½œçš„æ‰©å±•, æ¯”å¦‚<span class="exturl" data-url="aHR0cHM6Ly9jaHJvbWUuZ29vZ2xlLmNvbS93ZWJzdG9yZS9kZXRhaWwvcHVwcGV0ZWVyLXJlY29yZGVyL2RqZWVnaWdnZWdsZWFka2tiZ29wb29uaGppbWdlaGRh" title="https://chrome.google.com/webstore/detail/puppeteer-recorder/djeegiggegleadkkbgopoonhjimgehda">Puppeteer Recorder<i class="fa fa-external-link"></i></span>ã€‚ä½¿ç”¨è¿™ä¸ªåº“æˆ‘ä»¬å¯ä»¥ç”¨æ¥æŠ“å–ä¸€äº›é€šè¿‡ js æ¸²æŸ“è€Œä¸æ˜¯ç›´æ¥å­˜åœ¨äºé¡µé¢æºä»£ç ä¸­çš„ä¿¡æ¯ã€‚æ¯”å¦‚ spa é¡µé¢ï¼Œé¡µé¢å†…å®¹éƒ½æ˜¯ js æ¸²æŸ“å‡ºæ¥çš„ã€‚è¿™ä¸ªæ—¶å€™ puppeteer å°±ä¸ºæˆ‘ä»¬è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨ puppeteer åœ¨é¡µé¢æŸä¸ªæ ‡ç­¾å‡ºç°æ—¶è·å–åˆ°é¡µé¢å½“æ—¶çš„æ¸²æŸ“å‡ºæ¥çš„ htmlã€‚äº‹å®ä¸Šï¼Œå¾€å¾€å¾ˆå¤šæ¯”è¾ƒå›°éš¾çš„çˆ¬è™«è§£å†³çš„æœ€ç»ˆæ³•å®å°±æ˜¯æ“çºµæµè§ˆå™¨ã€‚</p><h2 id="å‰ç½®çš„-js-è¯­æ³•"><a href="#å‰ç½®çš„-js-è¯­æ³•" class="headerlink" title="å‰ç½®çš„ js è¯­æ³•"></a>å‰ç½®çš„ js è¯­æ³•</h2><h3 id="async-await"><a href="#async-await" class="headerlink" title="async/await"></a>async/await</h3><p>é¦–å…ˆè¦æçš„å°±æ˜¯ async/await, å› ä¸º node åœ¨å¾ˆæ—©çš„æ—¶å€™(node 8 LTS)å°±å·²ç»æ”¯æŒ async/await, ç°åœ¨å†™åç«¯é¡¹ç›®æ²¡ç†ç”±ä¸ç”¨ async/await äº†ã€‚ä½¿ç”¨ async/await å¯ä»¥è®©æˆ‘ä»¬ä»å›è°ƒç‚¼ç‹±çš„å›°å¢ƒä¸­è§£è„±å‡ºæ¥ã€‚è¿™é‡Œä¸»è¦æä¸€ä¸‹å…³äºä½¿ç”¨ async/await æ—¶å¯èƒ½ä¼šç¢°åˆ°çš„é—®é¢˜</p><h4 id="ä½¿ç”¨-async-await-æ€æ ·å¹¶å‘ï¼Ÿ"><a href="#ä½¿ç”¨-async-await-æ€æ ·å¹¶å‘ï¼Ÿ" class="headerlink" title="ä½¿ç”¨ async/await æ€æ ·å¹¶å‘ï¼Ÿ"></a>ä½¿ç”¨ async/await æ€æ ·å¹¶å‘ï¼Ÿ</h4><p>æ¥çœ‹ä¸€æ®µæµ‹è¯•ä»£ç :</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> sleep = <span class="function"><span class="params">milliseconds</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> resolve(), milliseconds);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> test1 = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, max = <span class="number">3</span>; i &lt; max; i++) &#123;</span><br><span class="line">    <span class="keyword">await</span> sleep(<span class="number">1000</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> test2 = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="built_in">Array</span>.from(&#123; <span class="attr">length</span>: <span class="number">3</span> &#125;).forEach(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">await</span> sleep(<span class="number">1000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> main = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.time(<span class="string">'æµ‹è¯• for å¾ªç¯ä½¿ç”¨ await'</span>);</span><br><span class="line">  <span class="keyword">await</span> test1();</span><br><span class="line">  <span class="built_in">console</span>.timeEnd(<span class="string">'æµ‹è¯• for å¾ªç¯ä½¿ç”¨ await'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.time(<span class="string">'æµ‹è¯• forEach è°ƒç”¨ async å‡½æ•°'</span>);</span><br><span class="line">  <span class="keyword">await</span> test2();</span><br><span class="line">  <span class="built_in">console</span>.timeEnd(<span class="string">'æµ‹è¯• forEach è°ƒç”¨ async å‡½æ•°'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">main();</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœæ˜¯:</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æµ‹è¯• for å¾ªç¯ä½¿ç”¨ await: 3003.905ms</span><br><span class="line">æµ‹è¯• forEach è°ƒç”¨ async å‡½æ•°: 0.372ms</span><br></pre></td></tr></table></figure><p>æˆ‘æƒ³å¯èƒ½ä¼šæœ‰äº›äººä¼šè®¤ä¸ºæµ‹è¯• forEach çš„ç»“æœä¼šæ˜¯ 1 ç§’å·¦å³ï¼Œäº‹å®ä¸Šæµ‹è¯• 2 ç­‰åŒäºä»¥ä¸‹ä»£ç :</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> test2 = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="comment">// Array.from(&#123;length: 3&#125;).forEach(async () =&gt; &#123;</span></span><br><span class="line">  <span class="comment">//     await sleep(1000);</span></span><br><span class="line">  <span class="comment">// &#125;);</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">Array</span>.from(&#123; <span class="attr">length</span>: <span class="number">3</span> &#125;).forEach(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    sleep(<span class="number">1000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ä»ä¸Šé¢çš„è¿è¡Œç»“æœä¹Ÿå¯ä»¥çœ‹å‡ºç›´æ¥åœ¨ for å¾ªç¯ä¸­ä½¿ç”¨ await + promise, è¿™æ ·ç­‰åŒäº<strong>åŒæ­¥</strong>è°ƒç”¨, æ‰€ä»¥è€—æ—¶æ˜¯ 3 ç§’å·¦å³ã€‚å¦‚æœè¦å¹¶å‘åˆ™åº”è¯¥ç›´æ¥è°ƒç”¨ promise, å› ä¸º forEach æ˜¯ä¸ä¼šå¸®ä½  await çš„ï¼Œæ‰€ä»¥ç­‰ä»·äºä¸Šé¢çš„ä»£ç ï¼Œä¸‰ä¸ªä»»åŠ¡ç›´æ¥å¼‚æ­¥å¹¶å‘äº†ã€‚</p><h4 id="å¤„ç†å¤šä¸ªå¼‚æ­¥ä»»åŠ¡"><a href="#å¤„ç†å¤šä¸ªå¼‚æ­¥ä»»åŠ¡" class="headerlink" title="å¤„ç†å¤šä¸ªå¼‚æ­¥ä»»åŠ¡"></a>å¤„ç†å¤šä¸ªå¼‚æ­¥ä»»åŠ¡</h4><p>ä¸Šé¢çš„ä»£ç è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯æµ‹è¯• 2 ä¸­å¹¶æ²¡æœ‰ç­‰å¾…ä¸‰ä¸ªä»»åŠ¡éƒ½æ‰§è¡Œå®Œå°±ç›´æ¥ç»“æŸäº†ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦ç­‰å¾…å¤šä¸ªå¹¶å‘ä»»åŠ¡ç»“æŸä¹‹åå†æ‰§è¡Œåç»­ä»»åŠ¡ã€‚å…¶å®å¾ˆç®€å•ï¼Œåˆ©ç”¨ä¸‹ Promise æä¾›çš„å‡ ä¸ªå·¥å…·å‡½æ•°å°±å¯ä»¥äº†ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> sleep = <span class="function">(<span class="params">milliseconds, id = <span class="string">''</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">`ä»»åŠ¡<span class="subst">$&#123;id&#125;</span>æ‰§è¡Œç»“æŸ`</span>);</span><br><span class="line">      resolve(id);</span><br><span class="line">    &#125;, milliseconds);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> test2 = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> tasks = <span class="built_in">Array</span>.from(&#123; <span class="attr">length</span>: <span class="number">3</span> &#125;).map(<span class="function">(<span class="params">ele, index</span>) =&gt;</span> sleep(<span class="number">1000</span>, index));</span><br><span class="line">  <span class="keyword">const</span> resultArray = <span class="keyword">await</span> <span class="built_in">Promise</span>.all(tasks);</span><br><span class="line">  <span class="built_in">console</span>.log(&#123; resultArray &#125;);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'æ‰€æœ‰ä»»åŠ¡æ‰§è¡Œç»“æŸ'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> main = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.time(<span class="string">'ä½¿ç”¨ Promise.all å¤„ç†å¤šä¸ªå¹¶å‘ä»»åŠ¡'</span>);</span><br><span class="line">  <span class="keyword">await</span> test2();</span><br><span class="line">  <span class="built_in">console</span>.timeEnd(<span class="string">'ä½¿ç”¨ Promise.all å¤„ç†å¤šä¸ªå¹¶å‘ä»»åŠ¡'</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">main();</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœ:</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ä»»åŠ¡0æ‰§è¡Œç»“æŸ</span><br><span class="line">ä»»åŠ¡1æ‰§è¡Œç»“æŸ</span><br><span class="line">ä»»åŠ¡2æ‰§è¡Œç»“æŸ</span><br><span class="line">&#123; resultArray: [ 0, 1, 2 ] &#125;</span><br><span class="line">æ‰€æœ‰ä»»åŠ¡æ‰§è¡Œç»“æŸ</span><br><span class="line">ä½¿ç”¨ Promise.all å¤„ç†å¤šä¸ªå¹¶å‘ä»»åŠ¡: 1018.628ms</span><br></pre></td></tr></table></figure><p>é™¤äº† Promise.all, Promise è¿˜æœ‰ race ç­‰æ¥å£ï¼Œä¸è¿‡æœ€å¸¸ç”¨åº”è¯¥å°±æ˜¯ all å’Œ race äº†ã€‚</p><h3 id="æ­£åˆ™è¡¨è¾¾å¼"><a href="#æ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼"></a>æ­£åˆ™è¡¨è¾¾å¼</h3><p>æ­£åˆ™è¡¨è¾¾å¼æ˜¯å¤„ç†å­—ç¬¦ä¸²å¼ºæœ‰åŠ›çš„å·¥å…·ã€‚æ ¸å¿ƒæ˜¯åŒ¹é…ï¼Œç”±æ­¤è¡ç”Ÿå‡ºæå–ï¼ŒæŸ¥æ‰¾ï¼Œ æ›¿æ¢çš„ç­‰æ“ä½œã€‚</p><p>æœ‰æ—¶å€™æˆ‘ä»¬é€šè¿‡ cheerio ä¸­è·å–åˆ°æŸä¸ªæ ‡ç­¾å†…çš„æ–‡æœ¬æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æå–å…¶ä¸­çš„éƒ¨åˆ†ä¿¡æ¯ï¼Œè¿™ä¸ªæ—¶å€™æ­£åˆ™è¡¨è¾¾å¼å°±è¯¥ä¸Šåœºäº†ã€‚æ­£åˆ™è¡¨è¾¾å¼çš„ç›¸å…³è¯­æ³•è¿™é‡Œå°±ä¸è¯¦ç»†è¯´æ˜äº†ï¼Œ å…¥é—¨æ¨èçœ‹<span class="exturl" data-url="aHR0cHM6Ly93d3cubGlhb3h1ZWZlbmcuY29tL3dpa2kvMDAxNDM0NDQ2Njg5ODY3YjI3MTU3ZTg5NmU3NGQ1MWE4OWMyNWNjOGI0M2JkYjMwMDAvMDAxNDM0NDk5NTAzOTIwYmI3YjQyZmY2NjI3NDIwZGEyY2VhZTRiYWJmNmM0ZjIwMDA=" title="https://www.liaoxuefeng.com/wiki/001434446689867b27157e896e74d51a89c25cc8b43bdb3000/001434499503920bb7b42ff6627420da2ceae4babf6c4f2000">å»–é›ªå³°çš„æ­£åˆ™è¡¨è¾¾å¼æ•™ç¨‹<i class="fa fa-external-link"></i></span>ã€‚æ¥çœ‹ä¸ªå®ä¾‹:</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æœåŠ¡å™¨è¿”å›çš„ img url æ˜¯: /GetFile/getUploadImg?fileName=9b1cc22c74bc44c8af78b46e0ca4c352.png</span></span><br><span class="line"><span class="comment">// ç°åœ¨æˆ‘åªæƒ³æå–æ–‡ä»¶åï¼Œåç¼€åä¹Ÿä¸è¦</span></span><br><span class="line"><span class="keyword">const</span> imgUrl = <span class="string">'/GetFile/getUploadImg?fileName=9b1cc22c74bc44c8af78b46e0ca4c352.png'</span>;</span><br><span class="line"><span class="keyword">const</span> imgReg = <span class="regexp">/\/GetFile\/getUploadImg\?fileName=(.+)\..+/</span>;</span><br><span class="line"><span class="keyword">const</span> imgName = imgUrl.match(imgReg)[<span class="number">1</span>];</span><br><span class="line"><span class="built_in">console</span>.log(imgName); <span class="comment">// =&gt; 9b1cc22c74bc44c8af78b46e0ca4c352</span></span><br></pre></td></tr></table></figure><p>æš‚æ—¶å…ˆä»‹ç»åˆ°è¿™é‡Œäº†ï¼Œåç»­æœ‰æ›´å¤šå†…å®¹ä¼šç»§ç»­è¡¥å……ã€‚</p><p>æœ¬æ–‡ä¸ºåŸåˆ›å†…å®¹ï¼Œé¦–å‘äº<span class="exturl" data-url="aHR0cDovL3d3dy5seXJlYWw2NjYuY29t" title="http://www.lyreal666.com">ä¸ªäººåšå®¢<i class="fa fa-external-link"></i></span>, è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚å¦‚æœæœ‰é—®é¢˜æ¬¢è¿é‚®ä»¶éªšæ‰° <span class="exturl" data-url="bWFpbHRvOnl0ajI3MTMxNTE3MTNAZ21haWwuY29t" title="mailto:ytj2713151713@gmail.com">ytj2713151713@gmail.com<i class="fa fa-external-link"></i></span>ã€‚</p>]]></content>
      <categories>
        <category>åç«¯</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>node</tag>
        <tag>spider</tag>
        <tag>package</tag>
        <tag>module</tag>
      </tags>
  </entry>
  <entry>
    <title>react native æ€»ç»“</title>
    <url>/react-native-%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<p>æœ€è¿‘ç”¨ react native åšäº†ä¸€ä¸ªç§»åŠ¨ç«¯è·¨å¹³å° Appã€‚<strong>Learn once, write everywhere</strong> ç¡®å®ä¸æ˜¯å¹çš„ã€‚</p><p>æœ¬æ–‡ä¸»è¦ç”±ä»¥ä¸‹å‡ éƒ¨åˆ†æ„æˆ:</p><ol><li>ä¸ºä»€ä¹ˆæˆ‘é€‰æ‹©äº† react native</li><li>react natve å¼€å‘ App ä½“éªŒ</li><li>react native çš„æœ‰å“ªäº›å‘</li><li>å¯¹æœªæ¥ç§»åŠ¨è·¨å¹³å°å¼€å‘çš„å±•æœ›</li></ol><a id="more"></a><h2 id="ä¸ºä»€ä¹ˆæˆ‘é€‰æ‹©äº†-react-native"><a href="#ä¸ºä»€ä¹ˆæˆ‘é€‰æ‹©äº†-react-native" class="headerlink" title="ä¸ºä»€ä¹ˆæˆ‘é€‰æ‹©äº† react native"></a>ä¸ºä»€ä¹ˆæˆ‘é€‰æ‹©äº† react native</h2><p>å½“å‰æ¯”è¾ƒç«çš„å¼€å‘åŸç”Ÿ APP çš„è·¨å¹³å°æŠ€æœ¯å…¶å®æŒºå¤šçš„ï¼Œh5+, mui, uniAPP, hybird, react native, weex, flutterã€‚æœ€å…·ç«äº‰åŠ›å½“å± react native, weex, lutter äº†ã€‚</p><h3 id="weex"><a href="#weex" class="headerlink" title="weex"></a>weex</h3><p>å¯¹äº weex æˆ‘ä¸€å¼€å§‹æ˜¯å¾ˆçœ‹å¥½çš„ï¼Œåˆæ˜¯åŸºäº vue, åˆæ¯” react native å¼€æºçš„æ™šï¼Œç„¶ååˆæ˜¯é˜¿é‡Œå¼€æºçš„, è§‰å¾—åº”è¯¥åœ¨è®¾è®¡ä¸Šä¸ä¼šå·®äº react nativeã€‚ä¹‹æ‰€ä»¥ä¸ç”¨ weex, æœ‰å‡ ä¸ªåŸå› ã€‚é¦–å…ˆæ˜¯æˆ‘å¯¹ vue çš„ç†Ÿç»ƒåº¦æ˜¯ä¸åŠ react çš„ï¼Œæˆ‘ä¹‹å‰ç”¨ react ç‹¬ç«‹å¼€å‘è¿‡æ¯”è¾ƒå¤§çš„ç½‘ç«™ä»¥åŠå°ç¨‹åºï¼Œå°ç¨‹åºçš„é£æ ¼å’Œ react çš„é£æ ¼è¿˜æ˜¯å¾ˆåƒçš„ï¼Œ ä½†æ˜¯ vue æˆ‘åªæ˜¯çœ‹è¿‡ä¸¤éæ–‡æ¡£ï¼Œåšè¿‡ä¸€äº›å° demoã€‚ç„¶åå°±æ˜¯æˆ‘åœ¨ä¸€äº›æŠ€æœ¯è®ºå›æ¯”å¦‚: çŸ¥ä¹, v2exï¼Œæœç´¢äº†ä¸€äº›å…³äº weex çš„è¯„ä»·ï¼Œæ™®ééƒ½è®¤ä¸º weex å‘å¤šï¼Œå½“ç„¶æ˜¯ç›¸å¯¹ä¸ react native æ¥è¯´ï¼Œ å…¶å®æˆ‘å¼€å‘è¿‡ react native ä¹‹åå°±å‘ç° react native ä¹Ÿæœ‰å¾ˆå¤šå‘ã€‚æœ€åå°±æ˜¯å½“æ—¶é—²é±¼å®˜æ–¹å®£å¸ƒä½¿ç”¨ flutter çš„æ¶ˆæ¯ï¼Œè®©æˆ‘å½»åº•çš„å¦å†³äº†é€‰æ‹© weexã€‚ç°åœ¨æ‰“å¼€ github ä¸Š weex å®˜æ–¹ä»“åº“ï¼Œå‘ç° weex å·²ç»æ‰˜ç®¡ç»™ apache äº†â€¦</p><h3 id="flutter"><a href="#flutter" class="headerlink" title="flutter"></a>flutter</h3><p>flutter åº”è¯¥æ˜¯è¿™ä¸‰ä¸ªé‡Œé¢æœ€æ™šå¼€æºçš„äº†ï¼Œç”± Google å¼€æºçš„ä¸€ä¸ªè·¨å¹³å° UI æ¡†æ¶ã€‚flutter ä½¿ç”¨ Google å…¬å¸å¼€å‘çš„ dart è¯­è¨€å¼€å‘ï¼Œè€Œå¦å¤–ä¸¤ä¸ªéƒ½æ˜¯ä½¿ç”¨ javascriptã€‚çœ‹äº†ä¸€äº›å…³äº flutter çš„è¯„æµ‹æ–‡ç« ï¼Œæ™®ééƒ½æ˜¯ flutter çš„æ€§èƒ½è¦å¥½äº react nativeã€‚å›½å†…ç¬¬ä¸€å®¶å…¬å¼€ä½¿ç”¨ flutter çš„å¤§å‚åº”è¯¥å°±æ˜¯é˜¿é‡Œé—²é±¼äº†ï¼Œå¥½åƒè¿˜å’Œ flutter å®˜æ–¹æœ‰æ·±åº¦åˆä½œã€‚å¯¹äº flutter æˆ‘æ˜¯å¾ˆçœ‹å¥½çš„ï¼Œå› ä¸º flutter èƒŒé  Google, Google æ­£åœ¨å¼€å‘çš„ Fusion æ“ä½œç³»ç»Ÿçš„å®˜æ–¹è¯­è¨€å°±æ˜¯ dart, ç”šè‡³æœ‰å¯èƒ½ä»¥å android ç³»ç»Ÿå°±ä¼šå°†åº•å±‚çš„ linux ç³»ç»Ÿæ¢æˆäº† fusion ç³»ç»Ÿã€‚å­¦ä¹  flutter ä¸€ä¸¾å¤šå¾—å•Šã€‚å¦‚æœæ—¶é—´å…è®¸çš„è¯æˆ‘å¯èƒ½ä¼šé€‰æ‹© fluter æ¥å¼€å‘æˆ‘é‚£ä¸ªé¡¹ç›®äº†ã€‚ä½†æ˜¯æˆ‘æ²¡æ—¶é—´å•Šï¼Œå¤§æ¦‚ä¸¤ä¸‰ä¸ªæ˜ŸæœŸå°±è¦äº¤äº§å“ï¼Œæˆ‘å¯¹ dart ä¸ç†Ÿï¼Œå¯¹ flutter å¼€å‘æµç¨‹æ›´æ˜¯ä¸€ç‚¹éƒ½ä¸äº†è§£ã€‚</p><h3 id="react-native"><a href="#react-native" class="headerlink" title="react native"></a>react native</h3><p>çœ‹çœ‹ github ä¸Š react native çš„ star <strong>74.3k</strong>ï¼Œå…¶å—æ¬¢è¿ç¨‹åº¦å¯æƒ³è€ŒçŸ¥ã€‚æ—¶è‡³ä»Šæ—¥ï¼Œæˆ‘ä»ç„¶è®¤ä¸ºå¼€å‘ä¸€äº›å°å‹çš„ App ä½¿ç”¨ react native æ˜¯ä¸ªå¾ˆå¥½çš„é€‰æ‹©ï¼Œreact native ç›¸å¯¹ä¸å¦å¤–ä¸¤è€…æœ€å¤§çš„ä¼˜åŠ¿å°±æ˜¯ç”Ÿæ€ã€‚</p><blockquote><p>æ‰€ä»¥æˆ‘æœ€åé€‰æ‹©äº† react nativeã€‚</p></blockquote><h2 id="react-native-çš„å¼€å‘ä½“éªŒ"><a href="#react-native-çš„å¼€å‘ä½“éªŒ" class="headerlink" title="react native çš„å¼€å‘ä½“éªŒ"></a>react native çš„å¼€å‘ä½“éªŒ</h2><h3 id="å’Œ-react-å¼€å‘åŒºåˆ«å¹¶ä¸å¤§"><a href="#å’Œ-react-å¼€å‘åŒºåˆ«å¹¶ä¸å¤§" class="headerlink" title="å’Œ react å¼€å‘åŒºåˆ«å¹¶ä¸å¤§"></a>å’Œ react å¼€å‘åŒºåˆ«å¹¶ä¸å¤§</h3><p>åœ¨å­¦ä¹  react native ä¹‹å‰æˆ‘è¿˜æ‹…å¿ƒä¼šä¸ä¼šå’Œ react çš„åŒºåˆ«æŒºå¤§çš„ï¼Œçœ‹å®Œäº†å®˜æ–¹æ–‡æ¡£å‰å‡ èŠ‚åï¼Œæˆ‘å®Œå…¨æ‰“æ¶ˆäº†è¿™ä¸ªé¡¾è™‘ã€‚ä½¿ç”¨ react native å¼€å‘ APP å’Œä½¿ç”¨ react å¼€å‘ç½‘é¡µå¹¶æ²¡æœ‰ä»€ä¹ˆå¤§åŒºåˆ«ï¼Œreact å…¨å®¶æ¡¶å®Œå…¨å¯ç”¨ã€‚ç”±äº react native å¼€å‘çš„ APP æœ€åæ˜¯ä½¿ç”¨åŸç”Ÿæ§ä»¶æ¸²æŸ“çš„ï¼Œæ‰€ä»¥è‚¯å®šæ˜¯ä¸èƒ½æ˜¯ html é‚£ä¸€å¥—æ ‡ç­¾äº†ï¼Œä¸ç„¶è¦åšçš„é€‚é…å·¥ä½œå¤ªå¤§å¤ªå¤æ‚äº†ã€‚ä½¿ç”¨ react native å¼€å‘å¿…é¡»ç”¨ react native è®¾è®¡çš„ä¸€å¥—ç»„ä»¶åº“ã€‚react native å®˜æ–¹çš„ç»„ä»¶åº“å…¶å®ç›¸å¯¹ä¸ html æ¥è¯´è¿˜æ˜¯å°‘å¾ˆå¤šçš„ï¼Œ æ¯”å¦‚æ²¡æœ‰æ ‡é¢˜ç»„ä»¶ç­‰ã€‚ä½†æ˜¯ä¹Ÿå¤Ÿç”¨äº†ï¼Œä¸å¤Ÿç”¨è‡ªå·±é€ ï¼Œä¹Ÿæœ‰å¾ˆå¤šä¼˜ç§€çš„ç¬¬ä¸‰æ–¹ç»„ä»¶åº“æˆ–è€…ç»„ä»¶ã€‚github ä¸Š <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2pvbmRvdC9hd2Vzb21lLXJlYWN0LW5hdGl2ZQ==" title="https://github.com/jondot/awesome-react-native">awesome-react-native<i class="fa fa-external-link"></i></span> ä¸Šåˆ—å‡ºäº†å¾ˆå¤šä¼˜ç§€çš„ rn èµ„æºï¼Œæˆ‘åœ¨å¼€å‘ APP çš„æ—¶å€™ç»å¸¸å»è¿™ä¸ªä»“åº“çœ‹æ˜¯å¦æœ‰åˆé€‚çš„å¯ä»¥æ‹¿æ¥ç”¨ã€‚html ä¸­çš„ div å¯¹åº”ä¸ rn ä¸­ View, span å¯¹åº” Textã€‚åœ¨ react native ä¸­æˆ‘ä»¬ä»ç„¶å¯ä»¥è·å–åˆ°ç»„ä»¶å¯¹è±¡ï¼Œå¹¶è°ƒç”¨ç»„ä»¶å¯¹è±¡çš„ä¸€äº›å‡½æ•°ã€‚</p><h3 id="å¼€å‘æ•ˆç‡æ¯”åŸç”Ÿå¼€å‘é«˜å¾ˆå¤š"><a href="#å¼€å‘æ•ˆç‡æ¯”åŸç”Ÿå¼€å‘é«˜å¾ˆå¤š" class="headerlink" title="å¼€å‘æ•ˆç‡æ¯”åŸç”Ÿå¼€å‘é«˜å¾ˆå¤š"></a>å¼€å‘æ•ˆç‡æ¯”åŸç”Ÿå¼€å‘é«˜å¾ˆå¤š</h3><p>æˆ‘ä»¥å‰ä¹Ÿå¼€å‘è¿‡ç®€å•çš„åŸç”Ÿ APPï¼Œ ä½¿ç”¨ xml é‚£éäººç±»æ ‡è®°è¯­è¨€ï¼Œjava ä»£ç çš„å•°å—¦ï¼Œ è®°å¿†çŠ¹æ–°ã€‚ä½¿ç”¨ react native å¼€å‘ App, å…¶å®åªè¦ä½ æ‡‚ js å’Œç»„ä»¶åŒ–æŠ€æœ¯å°±å¯ä»¥ä¸Šæ‰‹äº†ï¼Œå¹¶ä¸” react native è¿˜æœ‰è·¨å¹³å°å’Œçƒ­æ›´æ–°ä¸¤å¤§æ€æ‰‹çº§ç‰¹æ€§ï¼Œå¦‚æœå›¢é˜Ÿä¸­æœ‰ä¼š rn å¼€å‘çš„ï¼Œä½¿ç”¨ rn æ¥ä»£æ›¿ h5 æ˜¯ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚è·¨å¹³å°å¯¹äºå°å…¬å¸æ¥è¯´å¯ä»¥å‡å°‘æ‹›äººæˆæœ¬ï¼Œè¯±æƒ‘åŠ›ä¸å°ï¼Œçƒ­æ›´æ–°å¯ä»¥è®© APP åœ¨ä¸å‡çº§ç‰ˆæœ¬çš„æƒ…å†µä¸‹å‡çº§ APP é¡µé¢ï¼Œç”±äºæ˜¯æ¸²æŸ“ä¸ºåŸç”Ÿæ§ä»¶ï¼Œè¿˜æœ‰å„ç§æ–¹ä¾¿çš„å’Œç³»ç»Ÿäº¤äº’çš„ APIï¼Œè‚¯å®šæ¯” h5 æŠ€æœ¯è¦å¥½ã€‚ä½¿ç”¨ rn å¼€å‘ï¼Œè¿˜å¯ä»¥é¿å¼€ Apple store çš„å®¡æ ¸ï¼Œå¿«é€Ÿå‡çº§åº”ç”¨ã€‚</p><h2 id="react-native-ä¸­çš„é‚£äº›å‘"><a href="#react-native-ä¸­çš„é‚£äº›å‘" class="headerlink" title="react native ä¸­çš„é‚£äº›å‘"></a>react native ä¸­çš„é‚£äº›å‘</h2><p>react native ä¸­æœ‰å¾ˆå¤šå‘ï¼Œè€Œä¸”æœ‰äº›å‘è¿˜æ˜¯æ³¨å®šæ— æ³•è§£å†³çš„ï¼Œå› ä¸ºè¿™æ˜¯ react native æœ¬èº«çš„æŠ€æœ¯æ¶æ„å†³å®šçš„ï¼Œå°½ç®¡æœ‰å¾ˆå¤šå‘ï¼Œä½†æ˜¯ä¸€èˆ¬éƒ½æœ‰è§£å†³åŠæ³•ï¼Œä½†æ˜¯è¿™äº›å‘ç¡®å®æ˜¯ react native è¿™ä¸ªæ¡†æ¶æœ¬èº«çš„ bug, ä¸åº”è¯¥ç”±å¼€å‘è€…æ¥è§£å†³ã€‚è€Œä¸”æœ‰äº›è§£å†³åŠæ³•å¾ˆ hack, ä¸ä¸€å®šé€‚ç”¨ä½ çš„ä½¿ç”¨åœºæ™¯ã€‚ä¸‹é¢åˆ—ä¸¾ä¸€äº› react native ä¸­çš„å‘ã€‚</p><h3 id="è·¨å¹³å°ä¸å½»åº•"><a href="#è·¨å¹³å°ä¸å½»åº•" class="headerlink" title="è·¨å¹³å°ä¸å½»åº•"></a>è·¨å¹³å°ä¸å½»åº•</h3><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œé€‰æ‹© rn è¿™ç±»è·¨å¹³å°æ¡†æ¶ï¼Œå¾ˆå¤§ä¸€éƒ¨åˆ†åŸå› å°±æ˜¯çœ‹é‡äº†å…¶è·¨å¹³å°èƒ½åŠ›ï¼Œä½†æ˜¯å½“æˆ‘ä½¿ç”¨ rn æ—¶ï¼Œæ‰“å¼€å®˜æ–¹æ–‡æ¡£æŸ¥çœ‹åŸºç¡€ç»„ä»¶ <code>Text</code> çš„å±æ€§çœ‹åˆ°çš„æ˜¯è¿™æ ·çš„</p><img data-src="/react-native-%E6%80%BB%E7%BB%93/android-ios-difference.png" title="å¹³å°å·®å¼‚"><p>åœ¨ä¸ä¹…å‰ Airbnb å…¬å¸å®£å¸ƒæ”¾å¼ƒ react native çš„æ–‡ç« ä¸­å°±è¯´åˆ°äº†è¿™ä¸€ç‚¹ï¼Œè¯´æ˜¯å› ä¸ºè·¨å¹³å°çš„ä¸å½»åº•ï¼Œéœ€è¦å¯¹ç»´æŒ android å’Œ ios çš„ä¸€è‡´æ€§è¦æŠ•å…¥å¾ˆå¤§çš„ç²¾åŠ›ã€‚å…¶å®ä½œä¸ºå‰ç«¯å·¥ç¨‹å»ºè®¾æä¸ºä¼˜ç§€çš„ facebook å…¬å¸ï¼Œè®²é“ç†å¼€æºå‡ºæ¥çš„æ¡†æ¶ä¸åº”è¯¥åšä¸å¥½å¹³å°ä¸€è‡´æ€§å•Šã€‚å…¶å®åŸå› è¿˜æ˜¯ rn æœ¬èº«çš„æŠ€æœ¯æ¶æ„çš„å±€é™æ€§å¯¼è‡´çš„ã€‚ç”±äº rn æœ€ç»ˆæ¸²æŸ“æ§ä»¶æ—¶æ˜¯è°ƒç”¨åŸç”Ÿçš„æ§ä»¶ï¼Œæ¯”å¦‚åœ¨å®‰å“å¹³å° rn çš„ Text ç»„ä»¶è°ƒç”¨çš„å¯èƒ½å°±æ˜¯åŸç”Ÿçš„ TextViewã€‚é‚£ android å’Œ ios ä¸¤ä¸ªç§»åŠ¨æ“ä½œç³»ç»Ÿæœ¬èº«åŸç”Ÿç»„ä»¶å°±æ˜¯æœ‰ä¸åŒçš„ï¼Œæœ‰äº›ç‰¹æ€§å¯èƒ½ ios æœ‰ï¼Œandroid å¹¶æ²¡æœ‰ï¼Œ æ‰€ä»¥è¿™ä¸€ç±»å±æ€§åœ¨ rn ä¸­å°±åªå¥½åšå¹³å°åŒºåˆ†äº†ã€‚flutter æ˜¯æ²¡é—®é¢˜çš„ï¼Œå› ä¸º flutter çš„è§†å›¾æ˜¯è‡ªç»˜çš„ï¼Œå¹¶ä¸ä¾èµ–åŸç”Ÿæ§ä»¶ã€‚</p><h3 id="å¯¼èˆª-è·¯ç”±-å¾ˆæ··ä¹±"><a href="#å¯¼èˆª-è·¯ç”±-å¾ˆæ··ä¹±" class="headerlink" title="å¯¼èˆª(è·¯ç”±)å¾ˆæ··ä¹±"></a>å¯¼èˆª(è·¯ç”±)å¾ˆæ··ä¹±</h3><p>æ—¶è‡³ä»Šæ—¥ï¼Œå®˜æ–¹æ¨èä½¿ç”¨<span class="exturl" data-url="aHR0cHM6Ly9mYWNlYm9vay5naXRodWIuaW8vcmVhY3QtbmF0aXZlL2RvY3MvbmF2aWdhdGlvbiNyZWFjdC1uYXZpZ2F0aW9u" title="https://facebook.github.io/react-native/docs/navigation#react-navigation">React Navigation<i class="fa fa-external-link"></i></span>æ¥å¤„ç†é¡µé¢ä¹‹é—´çš„è·³è½¬ã€‚ä½†æ˜¯å‘¢ï¼Œå½“æˆ‘åœ¨ windows ç³»ç»Ÿä½¿ç”¨å¼€å‘çš„æ—¶å€™ï¼Œå‘ç°è¿™ä¸ªåº“ link åç”Ÿäº§çš„æ„å»ºè„šæœ¬ä¸­çš„è·¯å¾„éƒ½æ˜¯é”™è¯¯çš„ï¼Œéœ€è¦æˆ‘æ‰‹åŠ¨è½¬ä¹‰ï¼Œè¿™å¼€å‘æ€åº¦ä¹Ÿå¤ªå·®åŠ²äº†å§ï¼Ÿå¹¶ä¸” react native çš„è·¯ç”±å†å²ä¸Šå‘ç”Ÿè¿‡å¥½å‡ æ¬¡å¤§æ”¹ï¼Œåªå­¦æœ€æ–°ç‰ˆçš„ react navigation çš„æˆ‘çœ‹åˆ° github ä¸Šçš„ rn å¼€æºé¡¹ç›®çš„æ—¶å€™ï¼Œåˆ«äººç”¨çš„è·¯ç”±çœ‹çš„æˆ‘å¾ˆæ‡µé€¼ï¼Œè™½ç„¶ä¸è‡³äºçœ‹ä¸æ‡‚ï¼Œä½†æ˜¯å†™æ³•å®Œå…¨ä¸ä¸€æ ·ã€‚</p><h3 id="å¼€å‘å·¥å…·æœ‰å¾…å®Œå–„"><a href="#å¼€å‘å·¥å…·æœ‰å¾…å®Œå–„" class="headerlink" title="å¼€å‘å·¥å…·æœ‰å¾…å®Œå–„"></a>å¼€å‘å·¥å…·æœ‰å¾…å®Œå–„</h3><p>ä½¿ç”¨å®˜æ–¹è„šæ‰‹æ¶ react-native-cli å¼€å‘æ—¶ï¼Œçƒ­é‡è½½åŸºæœ¬ä¸Šæ˜¯åºŸçš„ï¼Œå¤§æ¦‚ç‡çƒ­é‡è½½ä¼šæœ‰é—®é¢˜ï¼Œæˆ‘ä¸€èˆ¬éƒ½æ˜¯åªç”¨è‡ªåŠ¨é‡è½½ã€‚æœ‰æ—¶å€™è¿˜ä¼šå‡ºç°ä¸€ä¸ªå¾ˆæ¶å¿ƒçš„æƒ…å†µï¼Œå°±æ˜¯å½“å‡ºç°è¯­æ³•é”™è¯¯æ—¶ï¼Œä½ å³ä¾¿æ˜¯ä¿®å¤é”™è¯¯äº†ï¼Œ reload åè¿˜æ˜¯æŠ¥åŒä¸€ä¸ªè¯­æ³•é”™è¯¯ï¼Œåªæœ‰é€€å‡º cli, é‡æ–° <strong>react-native run-android</strong> æ‰è¡Œã€‚</p><h3 id="è°ƒå¼ä½“éªŒæå·®"><a href="#è°ƒå¼ä½“éªŒæå·®" class="headerlink" title="è°ƒå¼ä½“éªŒæå·®"></a>è°ƒå¼ä½“éªŒæå·®</h3><p>ä½¿ç”¨<code>react-native-debugger</code> æ¥ debug rn appï¼Œæ‰“å¼€ dom è§†å›¾ï¼Œä¼°è®¡ä½ è¦æ‰“å¼€ äºŒï¼Œä¸‰åå±‚åµŒå¥—æ‰èƒ½çœ‹åˆ°ä½ æƒ³çœ‹åˆ°çš„éƒ¨åˆ†ã€‚ä¸è§£å†³åµŒå¥—å±‚æ¬¡è¿‡å¤šçš„é—®é¢˜ï¼Œè¿™è°ƒè¯•å™¨ä½“éªŒä¹Ÿå¤ªå·®äº†ã€‚</p><img data-src="/react-native-%E6%80%BB%E7%BB%93/react-native-debugger.png" title="è°ƒå¼ä½“éªŒæå·®"><h3 id="ScrollView-ä¸­çš„-TextInput"><a href="#ScrollView-ä¸­çš„-TextInput" class="headerlink" title="ScrollView ä¸­çš„ TextInput"></a>ScrollView ä¸­çš„ TextInput</h3><p>å½“ ScrollView ä¸­æœ‰ TextInput æ—¶, å¦‚æœæ»‘åœ¨ TextInput ä¸Šé¢å±å¹•ä¸ä¼šæ»šåŠ¨ã€‚è¿™ä¹ˆåŸºç¡€çš„ä½“éªŒä¸åº”è¯¥æœ‰å¼€å‘è€…æ¥è§£å†³å§ï¼Œgithub ä¸Šé¢é’ˆå¯¹è¿™ä¸ª issue æœ‰äººæå‡ºäº†è§£å†³åŠæ³•ï¼Œ ä½†æ˜¯å¹¶ä¸é€‚åˆæˆ‘çš„ä½¿ç”¨åœºæ™¯ã€‚</p><img data-src="/react-native-%E6%80%BB%E7%BB%93/TextInputInScrollView.png" title="TextInput åœ¨ ScrollView ä¸­çš„ bug"><h2 id="å¯¹æœªæ¥ç§»åŠ¨è·¨å¹³å°å¼€å‘çš„å±•æœ›"><a href="#å¯¹æœªæ¥ç§»åŠ¨è·¨å¹³å°å¼€å‘çš„å±•æœ›" class="headerlink" title="å¯¹æœªæ¥ç§»åŠ¨è·¨å¹³å°å¼€å‘çš„å±•æœ›"></a>å¯¹æœªæ¥ç§»åŠ¨è·¨å¹³å°å¼€å‘çš„å±•æœ›</h2><p>çœ‹å¥½ flutterï¼Œæˆ‘æœ€è¿‘åœ¨å­¦ä¹  dart è¯­æ³•ï¼Œæ„Ÿè§‰ dart éå¸¸ä¸é”™ï¼Œæ„Ÿè§‰ç³…åˆäº† js å’Œ java çš„å¾ˆå¤šç‰¹ç‚¹ã€‚ä¸è¿‡æˆ‘è¿˜è¦æ—¶é—´å»æ·±å…¥å­¦ä¹ ï¼Œå¼ºç±»å‹ + ç»„ä»¶åŒ–å¼€å‘ï¼Œå¼€å‘ä½“éªŒå¾ˆå¥½ã€‚flutter åœ¨æ¶æ„é£æ ¼ä¸Šå’Œ react å¾ˆåƒï¼Œreact æ²¡ç™½å­¦å•Šã€‚ç°åœ¨ flutter å·®çš„å°±æ˜¯æ—¶é—´ï¼Œç­‰ç”Ÿæ€å»ºç«‹å¥½äº†ï¼Œå„æ–¹é¢æ’ä»¶éƒ½æœ‰äº†ä»¥åï¼Œä¼°è®¡æœ‰ä¸€æ‰¹åŸç”Ÿå¼€å‘è¦å¤±ä¸šå–½ã€‚æœ€è¿‘çœ‹åˆ° React Native å®˜æ–¹ twitter è¯´ react native æ­£åœ¨ç”±å†…åˆ°å¤–å¤§é‡æ„ï¼Œä¸çŸ¥é“é‡æ„å®Œä¼šä¸ä¼šæœ‰æƒŠå–œï¼Œfacebook è¯´ä¸å®šèƒ½å¤§åŠ›å‡ºå¥‡è¿¹ ğŸ˜ã€‚æœ‰å¯èƒ½ç­‰é‡æ„å®Œå°±å‡º 1.0 ç¨³å®šç‰ˆäº†ï¼Œç°åœ¨ react native è¿˜åœç•™åœ¨ 0.58 â€¦</p>]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>react native</tag>
      </tags>
  </entry>
</search>
